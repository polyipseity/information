---
aliases:
  - ELEC 4110 M-QAM
  - ELEC4110 M-QAM
  - M-QAM
tags:
  - flashcard/active/special/academia/HKUST/ELEC_4110/M-QAM
  - language/in/English
---

# _M_-QAM

- see: [general/quadrature amplitude modulation](../../../../general/quadrature%20amplitude%20modulation.md)

{@{_Quadrature amplitude modulation_ (M-QAM)}@} extends {@{PSK \(which only varies phase\)}@} by {@{varying both phase and amplitude}@}, arranging {@{$\sqrt{M}\times\sqrt{M}$ points}@} on {@{a rectangular grid in the complex plane}@}. {@{Each symbol}@} carries {@{$\log_2M$ bits}@}. $M$ can be {@{increased without increasing bandwidth}@}, enabling {@{equal spectral efficiency to PSK for comparable error performance}@} while operating at {@{higher signal-to-noise ratios \(higher transmit power\)}@}. M-QAM requires {@{two orthogonal carrier tones (in-phase and quadrature components)}@} regardless of {@{the modulation order $M$}@}. <!--SR:!2026-11-11,253,330!2026-11-09,251,330!2026-11-27,265,330!2026-12-09,276,330!2026-12-11,277,330!2026-10-28,241,330!2026-10-30,243,330!2026-10-20,235,330!2026-11-08,251,330!2026-11-12,254,330!2026-11-20,260,330!2026-11-08,251,330-->

## waveforms

For {@{symbol index $m = 0, \ldots, M - 1$}@} {@{the waveform}@} is {@{$$s_m(t)=I_m\,\sqrt{\frac{2E}{T_s} }\;\cos(2\pi f_c t)-Q_m\,\sqrt{\frac{2E}{T_s} }\;\sin(2\pi f_c t), \qquad 0\le t<T_s\,,$$}@} where {@{$I_m$ and $Q_m$ are the in-phase and quadrature amplitudes}@} chosen from {@{a rectangular grid}@} (e.g., {@{$\{-3,-1,1,3\}$ for 16-QAM}@}). {@{The scaling factor $\sqrt{2E/T_s}$}@} ensures that {@{each symbol has unit average energy $E$}@} before {@{any overall power scaling is applied}@}. <!--SR:!2026-11-13,255,330!2026-12-23,287,330!2026-03-12,67,310!2026-12-10,276,330!2026-10-30,243,330!2026-10-23,237,330!2026-11-01,245,330!2026-12-20,285,330!2026-11-25,264,330-->

Typically, {@{$\alpha = \sqrt{E}$ is written}@} so that {@{$\alpha$ represents half of the spacing between symbols}@}. <!--SR:!2026-10-27,241,330!2026-11-07,250,330-->

## constellation

{@{An $M$-ary QAM constellation}@} forms {@{a rectangular grid of points in the two-dimensional signal space}@}. {@{The horizontal axis}@} represents {@{the in-phase component}@} and {@{the vertical axis}@} {@{the quadrature component}@}, resulting in {@{$\sqrt{M}\times\sqrt{M}$ equally spaced points}@}. This arrangement {@{maximizes Euclidean distance between adjacent symbols}@} while {@{keeping the average power bounded}@}. <!--SR:!2026-11-07,250,330!2026-10-18,233,330!2026-12-15,281,330!2026-12-22,286,330!2026-10-29,242,330!2026-11-10,252,330!2026-11-07,250,330!2026-10-31,244,330!2026-11-22,262,330-->

Assume {@{equiprobable symbols and AWGN}@}. {@{The decision regions}@} for {@{an $M$-ary QAM constellation}@} are {@{rectangular cells that surround each lattice point}@}. For {@{a square grid with spacing $d$}@}, {@{the horizontal and vertical boundaries}@} lie {@{midway between adjacent points}@}, so {@{the region associated with the symbol}@} at {@{coordinates $(i,j)$}@} is {@{$$R_{i,j}=\Bigl\{(x,y)\;\big|\;(i-\tfrac12)d \le x < (i+\tfrac12)d,\; (j-\tfrac12)d \le y < (j+\tfrac12)d\Bigr\} \,,$$}@} and {@{the receiver}@} simply selects {@{the symbol whose cell contains the received in-phase and quadrature components}@}. {@{The formula above}@} assumes {@{interior points only}@} and does not {@{account for symbols on the outer edges of the grid}@}. To {@{accommodate boundary points}@}, one can {@{extend each outermost cell to infinity}@} along {@{the corresponding axis}@}. <!--SR:!2026-12-07,274,330!2026-11-18,259,330!2026-10-24,238,330!2026-11-08,251,330!2026-11-09,251,330!2026-11-16,257,330!2026-12-21,285,330!2026-11-12,254,330!2026-03-12,67,310!2026-11-07,250,330!2026-11-12,254,330!2026-07-03,158,310!2026-11-06,249,330!2026-11-15,256,330!2026-10-25,239,330!2026-11-28,267,330!2026-10-19,234,330!2026-11-06,249,330-->

## comparison with M-PSK

In practice, {@{16-QAM}@} is {@{more popular than 16-PSK}@}. Both uses {@{sixteen symbols}@}, but QAM distributes {@{points on a rectangular grid}@}, allowing {@{the constellation}@} to be {@{expanded along both amplitude axes}@}. {@{This layout}@} achieves {@{higher spectral efficiency for a given minimum distance requirement}@} because it can maintain {@{larger symbol separations at lower energy per bit}@} than PSK, whose points are {@{confined to a circle}@} and must be {@{packed more tightly in phase}@}. As a result, 16-QAM delivers {@{superior error performance at moderate SNRs}@} and is therefore {@{the preferred choice for many high-rate communication systems}@}. <!--SR:!2026-12-01,269,330!2026-11-02,246,330!2026-11-08,251,330!2026-12-13,279,330!2026-12-03,270,330!2026-10-27,241,330!2026-10-19,234,330!2026-11-06,249,330!2026-11-26,265,330!2026-12-05,272,330!2026-10-22,237,330!2026-11-16,257,330!2026-03-12,67,310-->

In particular, when {@{$M > 4$}@}, {@{M-QAM}@} is {@{better than M-PSK}@} in the sense that it {@{achieves a higher spectral efficiency at lower SNR per bit}@}. <!--SR:!2026-11-12,254,330!2026-12-23,287,330!2026-10-24,238,330!2026-11-22,262,330-->

## energy

Using {@{$E = \alpha^2$}@}. To calculate {@{the average symbol energy $E_s$}@}, we sum up {@{the squares of the coordinates of all points and divide by $M$}@}. Start with {@{positive $x$-coordinates}@}: {@{$$\alpha^2 + (3\alpha)^2 + (5\alpha)^2 + \cdots = E \sum_{k = 1}^{\sqrt M / 2} (2k - 1)^2 \,.$$}@} Then, multiply by {@{2 to account for the negative $x$-coordinates}@}, then {@{$\sqrt{M}$ to account for the number of rows}@}, and finally {@{another 2 to account for the $y$-coordinates}@}: {@{$$4E \sqrt M \sum_{k = 1}^{\sqrt M / 2} (2k - 1)^2 \,.$$}@} Finally, divide by {@{$M$ for the average symbol energy $E_s$}@}: {@{$$\boxed{E_s = \frac {4E} {\sqrt M} \sum_{k = 1}^{\sqrt M / 2} (2k - 1)^2} \,.$$}@} <!--SR:!2026-10-26,240,330!2026-03-12,67,310!2026-11-15,256,330!2026-11-04,247,330!2026-10-20,235,330!2026-11-01,245,330!2026-04-16,95,290!2026-12-16,281,330!2026-11-13,255,330!2026-04-15,82,350!2026-04-13,80,350-->

This equation is {@{unwieldy for large $M$}@}: {@{$$\boxed{E_s = \frac {4E} {\sqrt M} \sum_{k = 1}^{\sqrt M / 2} (2k - 1)^2} \,.$$}@} Using {@{the sum of odd squares}@}: {@{$$\sum_{k = 1}^n (2n - 1)^2 = \frac {n(2n + 1)(2n - 1)} 3 \,,$$}@} we have by letting {@{$n = \sqrt M / 2$}@} {@{$$\boxed{E_s = \frac {4E} {\sqrt M} \frac {\sqrt M(\sqrt M + 1)(\sqrt M - 1)} 6 = \frac 2 3 (M - 1) E } \,,$$}@} which is {@{much easier to use}@}. Conversely, {@{$E$}@} can be {@{written from $E_s$}@} by: {@{$$\boxed{E = \frac 3 2 \frac {E_s} {M - 1} } \,.$$}@} <!--SR:!2026-12-02,269,330!2026-08-28,178,310!2026-12-02,270,330!2026-04-15,88,270!2026-03-12,67,310!2026-08-27,177,310!2026-12-17,282,330!2026-11-07,250,330!2026-10-03,207,310!2026-04-12,79,350-->

## error analysis

{@{A M-QAM}@} can be analyzed as {@{two independent M-PAM}@}, each having {@{$\sqrt M = 2^{k / 2}$ points}@}. This is possible because {@{the noise variance in the two coordinates}@} are {@{independent and both have a variance of $N_0 / 2$}@}. <!--SR:!2026-11-08,251,330!2026-11-06,249,330!2026-11-13,255,330!2026-10-21,236,330!2026-12-19,284,330-->

Assuming {@{equiprobable bits and AWGN}@}, {@{a $\sqrt M$-PAM}@} has the error probability: {@{$$P_{\mathrm{\sqrt M-PAM} } = 2 (1 - 1 / \sqrt M) Q\left(\sqrt {\frac {2E} {N_0} } \right) = \boxed {2 \left( \frac {\sqrt M - 1} {\sqrt M} \right) Q\left(\sqrt {\frac 3 {M - 1} \frac {E_s} {N_0} } \right) } \,.$$}@} The number within {@{$Q(\cdot)$}@} is obtained by considering {@{half the shortest distance is $\sqrt E$ and the noise variance is $N_0 / 2$}@}. The factor {@{$2(1 - 1 / \sqrt M)$}@} is obtained by considering {@{the error regions for each transmitted symbol is two-sided}@}, so {@{multiply by 2}@}, but {@{except those two on the edges}@}, so {@{further multiply by $1 - 1 / \sqrt M$}@}. <!--SR:!2026-11-13,255,330!2026-10-22,237,330!2026-03-14,63,250!2026-11-08,251,330!2026-11-16,257,330!2026-10-26,240,330!2026-10-22,237,330!2026-11-10,252,330!2026-10-28,241,330!2026-10-29,242,330-->

Then, we see {@{the M-QAM symbol error probability $P_M$}@} is: {@{$$P_{eM} = 1 - (1 - P_{\sqrt M} )^2 \le 1 - (1 - 2P_{\sqrt M}) = 2P_{\sqrt M} = \boxed{4 \left(\frac {\sqrt M - 1} {\sqrt M} \right) Q\left(\sqrt {\frac 3 {M - 1} \frac {E_s} {N_0} } \right) } \,,$$}@} where {@{the inequality in the middle}@} is {@{tight for small $P_{\sqrt M}$}@}. <!--SR:!2026-12-02,270,330!2026-10-21,236,330!2026-11-11,253,330!2026-12-04,272,330-->

Compare {@{M-QAM with M-PSK}@}. Their {@{symbol error probabilities are}@}: {@{$$\begin{aligned} P_{\text{M-QAM} } & \approx 4 \left(\frac {\sqrt M - 1} {\sqrt M} \right) Q\left(\sqrt{\frac 3 {M - 1} \frac {E_s} {N_0} } \right) \\ P_{\text{M-PSK} } & \approx 2 Q\left(\sqrt{\frac {2E_s \sin^2(\pi / M) } {N_0} } \right) \,. \end{aligned}$$}@} Compare {@{the factors multiplying $E_s$}@}. Observe {@{the _gain_ of M-QAM over M-PSK}@}, i.e. {@{how much larger the argument to $Q(\cdot)$ is for a fixed $E_s$}@}: {@{$$\text{gain} = \frac {3 / (M - 1)} {2 \sin^2(\pi / M) } \,.$$}@} As {@{$M$ increases}@}, this gain {@{increases rapidly}@}. In particular, when {@{$M > 4$}@}, {@{M-QAM}@} is {@{better than M-PSK}@} in the sense that it {@{achieves a higher spectral efficiency at lower SNR per bit}@}. <!--SR:!2026-11-16,257,330!2026-10-19,234,330!2026-06-05,123,290!2026-12-14,280,330!2026-12-08,275,330!2026-11-15,256,330!2026-11-11,253,330!2026-12-26,290,330!2026-12-24,288,330!2026-10-21,236,330!2026-11-09,251,330!2026-11-30,268,330!2026-11-07,250,330-->

### symbol error probability bounds

For {@{$M$-quadrature amplitude keying}@} {@{the exact symbol-error probability}@} can be {@{_tightly bounded_ by simple analytic expressions}@} that involve {@{only the _symbol_ SNR $E_s/N_0$ and the constellation size $M$}@}. In particular, for {@{all $M\ge2$}@}: {@{$$Q\!\left(\sqrt{\frac {3E_s} {(M - 1)N_0} } \right) \;\leq\;P_{eM}\;\leq\; 4 \frac {\sqrt M - 1} {\sqrt M} \,Q\!\left(\sqrt{\frac {3E_s} {(M - 1)N_0} } \right) \,.$$}@} {@{This upper bound}@} becomes {@{asymptotically exact \("very tight"\)}@} as {@{$E_s/N_0$ increases}@}, as {@{$4 \frac {\sqrt M - 1} {\sqrt M}$ is also the average number of nearest symbols}@}. Here, we see {@{increasing the _symbol_ SNR $E_s / N_0$}@} {@{decreases the symbol error probability}@}, while {@{increasing $M$}@} {@{increases it}@}. <!--SR:!2026-11-13,255,330!2026-11-29,267,330!2026-11-08,251,330!2026-10-23,237,330!2026-11-15,256,330!2026-09-07,185,310!2026-11-24,263,330!2026-11-18,259,330!2026-11-19,259,330!2026-11-18,259,330!2026-11-30,268,330!2026-12-01,269,330!2026-11-26,265,330!2026-10-20,235,330-->

{@{The _lower bound_}@} can be obtained {@{using the minimum distance arguments outlined in [M-ary transmission § error analysis for minimum distance](M-ary%20transmission.md#error%20analysis%20for%20minimum%20distance)}@}; here, {@{half of the minimum distance $d_{\text{min} } / 2$}@} is: {@{$$\boxed{\frac {d_{\text{min} } } 2 = \sqrt{E} = \sqrt{\frac {3E_s} {2(M - 1)} } } \,.$$}@} However, {@{the _upper bound_}@} obtained would have had {@{a factor of $M - 1$ instead of $4 \frac {\sqrt M - 1} {\sqrt M}$}@}. To obtain {@{the factor $4 \frac {\sqrt M - 1} {\sqrt M}$}@}, we need to consider {@{the error regions}@}. For {@{a fixed constellation point _not_ on the _boundary_}@}, consider {@{the union of the error regions of the 4 nearest point}@} and compare it against {@{the union of the error regions of the $M - 5$ other points}@}. We see {@{the former fully contains the latter as a subset}@}. So {@{the union bound}@} can be {@{made much tighter}@} by noting {@{the error regions contributed by the $M - 5$ other points}@} are {@{already contained in the union of the error regions for the nearest 4 points}@}, and thus {@{can be discarded}@}, resulting in {@{the factor 4 instead of $M - 1$}@}. For {@{constellation points on the _boundary_}@}, there are {@{less neighboring error regions}@}, so {@{the factor is 3 for non-corner edge points and 2 for corner points}@}. Taking {@{the average \(as we are assuming equiprobable symbols\)}@}, the factor {@{comes out to be $4 \frac {\sqrt M - 1} {\sqrt M}$}@}. Some sources state {@{the factor 4 instead}@} as they {@{also assume points on the boundary have 4 neighbors for simplicity}@}. <!--SR:!2026-10-31,244,330!2026-11-23,263,330!2026-11-27,266,330!2026-11-08,251,330!2026-11-26,265,330!2026-10-30,243,330!2026-11-07,250,330!2026-11-18,259,330!2026-10-24,238,330!2026-11-19,259,330!2026-11-11,253,330!2026-11-27,266,330!2026-11-10,252,330!2026-10-23,237,330!2026-12-24,288,330!2026-12-03,271,330!2026-07-16,168,310!2026-03-12,67,310!2026-04-17,84,350!2026-04-13,80,350!2026-04-13,80,350!2026-04-17,84,350!2026-04-06,73,350!2026-04-12,79,350!2026-04-09,76,350-->

### bit error probability

In {@{M-quadrature amplitude modulation}@} the {@{bit-error probability}@} is {@{not fixed by the modulation order alone}@}; it also depends on {@{how bits are mapped to constellation points (the labeling scheme)}@}.  For {@{ordinary binary coding}@}, {@{a symbol error}@} can {@{flip several bits}@}, whereas {@{Gray coding}@} ensures that {@{adjacent symbols differ in only one bit}@}. <!--SR:!2026-11-22,262,330!2026-11-01,245,330!2026-11-02,246,330!2026-03-12,67,310!2026-11-17,258,330!2026-11-06,249,330!2026-10-18,233,330!2026-11-28,266,330!2026-11-17,258,330-->  

Consequently, with {@{Gray coding}@} {@{most symbol errors}@}—those that are {@{statistically most likely}@} because the receiver is {@{confused between neighboring points}@}—result in {@{exactly one erroneous bit}@}, greatly reducing {@{the overall bit-error rate}@}. Thus, we have {@{the following approximation for modulation schemes using Gray coding}@}: {@{$$\boxed{P_{e, b} \approx \frac {P_{e, M} } k = \frac {P_{e, M} } {\log_2 M} } \,,$$}@} which is {@{accurate when SNR is moderate to high}@}. <!--SR:!2026-11-09,251,330!2026-11-08,251,330!2026-10-22,237,330!2026-11-08,251,330!2026-11-17,258,330!2026-12-12,278,330!2026-11-24,263,330!2026-09-15,191,310!2026-11-02,246,330-->

## bit coding

In {@{an $M$-ary QAM constellation}@} {@{the symbols}@} are arranged on {@{a two-dimensional grid}@}, typically {@{$\sqrt{M}\times\sqrt{M}$}@}.  {@{Each symbol}@} is indexed by {@{an integer $k\in[0,M-1]$}@} whose {@{binary representation of length $\log_2 M$}@} is {@{used as the bit pattern}@}.  With {@{this natural mapping}@} {@{the most significant bit changes only}@} when {@{traversing rows or columns}@}, but {@{adjacent symbols}@} may {@{differ in several bits}@}. <!--SR:!2026-11-23,263,330!2026-11-07,250,330!2026-11-17,258,330!2026-10-28,241,330!2026-11-21,261,330!2026-03-12,67,310!2026-12-25,289,330!2026-10-31,244,330!2026-10-28,241,330!2026-10-27,241,330!2026-11-09,251,330!2026-12-18,283,330!2026-11-07,250,330-->

{@{Gray coding for QAM}@} aims to {@{minimize the Hamming distance between neighboring points}@} so that {@{a single symbol error}@} results in {@{at most one erroneous bit}@}.  {@{A Gray code}@} can be generated by first constructing {@{a one-dimensional Gray sequence of length $\sqrt{M}$}@} (using {@{the recursive "mirror and toggle" method}@}), then forming {@{the two-dimensional grid}@} by pairing {@{every element of the sequence with every other}@}, preserving {@{the Gray property along both axes}@}. <!--SR:!2026-12-17,282,330!2026-03-12,67,310!2026-12-06,273,330!2026-11-10,252,330!2026-12-16,281,330!2026-11-06,249,330!2026-11-14,255,330!2026-10-19,234,330!2026-10-25,239,330!2026-11-23,263,330-->

{@{The assignment of Gray codes to QAM points}@} is done {@{row-by-row}@}: the{@{ Gray index}@} for {@{a point at coordinates $(i,j)$}@} is obtained by {@{concatenating the $j$-th Gray bit (for the column) with the $i$-th Gray bit (for the row)}@}.  This yields a labeling where {@{horizontal and vertical neighbors differ in only one bit}@}, and {@{diagonal neighbors differ in only two bits}@}, thereby reducing {@{the average bit-error probability}@} under {@{additive white Gaussian noise}@}. <!--SR:!2026-10-29,242,330!2026-12-13,279,330!2026-11-21,261,330!2026-03-12,67,310!2026-10-18,233,330!2026-12-04,271,330!2026-12-01,268,330!2026-12-14,280,330!2026-11-20,260,330-->

{@{Another possible assignment \(different from above\)}@} for {@{16-QAM}@} is as follows. First, write {@{$[00, 01, 10, 11]$ in Z-order at the top left quadrant}@}. Then {@{_mirror_ \(not simply copying\) this quadrant across both axes}@} to {@{generate the remaining quadrants}@}. These are {@{the upper 2 bits}@}. For {@{the lower 2 bits}@}, for {@{each quadrant in Z-order}@}, write {@{the corresponding element of $[00, 01, 10, 11]$ 4 times}@}. We see {@{the upper bits}@} {@{"vary" faster over shorter distances}@}. \(annotation: __this course__: Maybe {@{use this}@}?\) <!--SR:!2026-10-29,242,330!2026-10-25,239,330!2026-10-30,243,330!2026-03-12,67,310!2026-11-25,264,330!2026-07-31,178,310!2026-10-26,240,330!2026-12-18,283,330!2026-10-27,241,330!2026-11-29,268,330!2026-11-06,249,330!2026-04-16,83,350-->
