#!/usr/bin/env sh
# Husky prepare-commit-msg hook (wrapper)
# For cross-platform compatibility we forward to the Node implementation in
# `.husky/prepare-commit-msg.js` so logic is easier to maintain.

NODE_CMD=node

# If Node isn't available, print a clear and prominent warning but allow the
# commit/merge to continue (do not block developer workflows).
if ! command -v "$NODE_CMD" >/dev/null 2>&1; then
  cat <<'EOF' >&2
========================================
WARNING: Node.js is not installed or not on PATH.
The prepare-commit-msg hook was skipped; merge commit messages will not be
standardized by this hook. To enable it, install Node.js and run 'pnpm install'.
========================================
EOF
  exit 0
fi

SCRIPT_DIR=$(dirname "$0")
"$NODE_CMD" "$SCRIPT_DIR/prepare-commit-msg.js" "$@" 2>&1 | sed 's/^/[prepare-commit-msg] /' >&2 || {
  cat <<'EOF' >&2
========================================
WARNING: prepare-commit-msg hook failed to set a standardized commit message.
You can still proceed with the merge; manually adjust the merge commit message
if you want. Check the hook output above for details.
========================================
EOF
}

exit 0


