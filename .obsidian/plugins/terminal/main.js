/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD.
If you want to view the source, please visit the repository of this plugin.
*/
"use strict";var Wn=Object.create;var mt=Object.defineProperty;var zn=Object.getOwnPropertyDescriptor;var $n=Object.getOwnPropertyNames;var Kn=Object.getPrototypeOf,qn=Object.prototype.hasOwnProperty;var Vn=(t,s,n)=>s in t?mt(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var te=(t,s)=>()=>(s||t((s={exports:{}}).exports,s),s.exports),tt=(t,s)=>{for(var n in s)mt(t,n,{get:s[n],enumerable:!0})},wi=(t,s,n,l)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of $n(s))!qn.call(t,o)&&o!==n&&mt(t,o,{get:()=>s[o],enumerable:!(l=zn(s,o))||l.enumerable});return t};var rt=(t,s,n)=>(n=t!=null?Wn(Kn(t)):{},wi(s||!t||!t.__esModule?mt(n,"default",{value:t,enumerable:!0}):n,t)),Gn=t=>wi(mt({},"__esModule",{value:!0}),t);var ve=(t,s,n)=>(Vn(t,typeof s!="symbol"?s+"":s,n),n),br=(t,s,n)=>{if(!s.has(t))throw TypeError("Cannot "+n)};var q=(t,s,n)=>(br(t,s,"read from private field"),n?n.call(t):s.get(t)),Q=(t,s,n)=>{if(s.has(t))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(t):s.set(t,n)},ye=(t,s,n,l)=>(br(t,s,"write to private field"),l?l.call(t,n):s.set(t,n),n);var Z=(t,s,n)=>(br(t,s,"access private method"),n);var Fi=te(kr=>{var qe=require("path"),Fe=process.platform==="win32",Ne=require("fs"),Oo=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function To(){var t;if(Oo){var s=new Error;t=n}else t=l;return t;function n(o){o&&(s.message=o.message,o=s,l(o))}function l(o){if(o){if(process.throwDeprecation)throw o;if(!process.noDeprecation){var e="fs: missing callback "+(o.stack||o.message);process.traceDeprecation?console.trace(e):console.error(e)}}}}function Ao(t){return typeof t=="function"?t:To()}var Pl=qe.normalize;Fe?De=/(.*?)(?:[\/\\]+|$)/g:De=/(.*?)(?:[\/]+|$)/g;var De;Fe?bt=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/:bt=/^[\/]*/;var bt;kr.realpathSync=function(s,n){if(s=qe.resolve(s),n&&Object.prototype.hasOwnProperty.call(n,s))return n[s];var l=s,o={},e={},r,c,d,g;a();function a(){var p=bt.exec(s);r=p[0].length,c=p[0],d=p[0],g="",Fe&&!e[d]&&(Ne.lstatSync(d),e[d]=!0)}for(;r<s.length;){De.lastIndex=r;var f=De.exec(s);if(g=c,c+=f[0],d=g+f[1],r=De.lastIndex,!(e[d]||n&&n[d]===d)){var m;if(n&&Object.prototype.hasOwnProperty.call(n,d))m=n[d];else{var _=Ne.lstatSync(d);if(!_.isSymbolicLink()){e[d]=!0,n&&(n[d]=d);continue}var i=null;if(!Fe){var u=_.dev.toString(32)+":"+_.ino.toString(32);o.hasOwnProperty(u)&&(i=o[u])}i===null&&(Ne.statSync(d),i=Ne.readlinkSync(d)),m=qe.resolve(g,i),n&&(n[d]=m),Fe||(o[u]=i)}s=qe.resolve(m,s.slice(r)),a()}}return n&&(n[l]=s),s};kr.realpath=function(s,n,l){if(typeof l!="function"&&(l=Ao(n),n=null),s=qe.resolve(s),n&&Object.prototype.hasOwnProperty.call(n,s))return process.nextTick(l.bind(null,null,n[s]));var o=s,e={},r={},c,d,g,a;f();function f(){var p=bt.exec(s);c=p[0].length,d=p[0],g=p[0],a="",Fe&&!r[g]?Ne.lstat(g,function(h){if(h)return l(h);r[g]=!0,m()}):process.nextTick(m)}function m(){if(c>=s.length)return n&&(n[o]=s),l(null,s);De.lastIndex=c;var p=De.exec(s);return a=d,d+=p[0],g=a+p[1],c=De.lastIndex,r[g]||n&&n[g]===g?process.nextTick(m):n&&Object.prototype.hasOwnProperty.call(n,g)?u(n[g]):Ne.lstat(g,_)}function _(p,h){if(p)return l(p);if(!h.isSymbolicLink())return r[g]=!0,n&&(n[g]=g),process.nextTick(m);if(!Fe){var v=h.dev.toString(32)+":"+h.ino.toString(32);if(e.hasOwnProperty(v))return i(null,e[v],g)}Ne.stat(g,function(y){if(y)return l(y);Ne.readlink(g,function(b,w){Fe||(e[v]=w),i(b,w)})})}function i(p,h,v){if(p)return l(p);var y=qe.resolve(a,h);n&&(n[v]=y),u(y)}function u(p){s=qe.resolve(p,s.slice(c)),f()}}});var Ar=te((Il,zi)=>{zi.exports=je;je.realpath=je;je.sync=Tr;je.realpathSync=Tr;je.monkeypatch=Po;je.unmonkeypatch=Bo;var st=require("fs"),Rr=st.realpath,Or=st.realpathSync,Do=process.version,ji=/^v[0-5]\./.test(Do),Ui=Fi();function Wi(t){return t&&t.syscall==="realpath"&&(t.code==="ELOOP"||t.code==="ENOMEM"||t.code==="ENAMETOOLONG")}function je(t,s,n){if(ji)return Rr(t,s,n);typeof s=="function"&&(n=s,s=null),Rr(t,s,function(l,o){Wi(l)?Ui.realpath(t,s,n):n(l,o)})}function Tr(t,s){if(ji)return Or(t,s);try{return Or(t,s)}catch(n){if(Wi(n))return Ui.realpathSync(t,s);throw n}}function Po(){st.realpath=je,st.realpathSync=Tr}function Bo(){st.realpath=Rr,st.realpathSync=Or}});var Ki=te((Ml,$i)=>{$i.exports=function(t,s){for(var n=[],l=0;l<t.length;l++){var o=s(t[l],l);Io(o)?n.push.apply(n,o):n.push(o)}return n};var Io=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"}});var Xi=te((Hl,Yi)=>{"use strict";Yi.exports=Vi;function Vi(t,s,n){t instanceof RegExp&&(t=qi(t,n)),s instanceof RegExp&&(s=qi(s,n));var l=Gi(t,s,n);return l&&{start:l[0],end:l[1],pre:n.slice(0,l[0]),body:n.slice(l[0]+t.length,l[1]),post:n.slice(l[1]+s.length)}}function qi(t,s){var n=s.match(t);return n?n[0]:null}Vi.range=Gi;function Gi(t,s,n){var l,o,e,r,c,d=n.indexOf(t),g=n.indexOf(s,d+1),a=d;if(d>=0&&g>0){if(t===s)return[d,g];for(l=[],e=n.length;a>=0&&!c;)a==d?(l.push(a),d=n.indexOf(t,a+1)):l.length==1?c=[l.pop(),g]:(o=l.pop(),o<e&&(e=o,r=g),g=n.indexOf(s,a+1)),a=d<g&&d>=0?d:g;l.length&&(c=[e,r])}return c}});var ss=te((Nl,is)=>{var Mo=Ki(),Ji=Xi();is.exports=Fo;var Zi="\0SLASH"+Math.random()+"\0",Qi="\0OPEN"+Math.random()+"\0",Pr="\0CLOSE"+Math.random()+"\0",es="\0COMMA"+Math.random()+"\0",ts="\0PERIOD"+Math.random()+"\0";function Dr(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function Ho(t){return t.split("\\\\").join(Zi).split("\\{").join(Qi).split("\\}").join(Pr).split("\\,").join(es).split("\\.").join(ts)}function No(t){return t.split(Zi).join("\\").split(Qi).join("{").split(Pr).join("}").split(es).join(",").split(ts).join(".")}function rs(t){if(!t)return[""];var s=[],n=Ji("{","}",t);if(!n)return t.split(",");var l=n.pre,o=n.body,e=n.post,r=l.split(",");r[r.length-1]+="{"+o+"}";var c=rs(e);return e.length&&(r[r.length-1]+=c.shift(),r.push.apply(r,c)),s.push.apply(s,r),s}function Fo(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),nt(Ho(t),!0).map(No)):[]}function jo(t){return"{"+t+"}"}function Uo(t){return/^-?0\d/.test(t)}function Wo(t,s){return t<=s}function zo(t,s){return t>=s}function nt(t,s){var n=[],l=Ji("{","}",t);if(!l||/\$$/.test(l.pre))return[t];var o=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(l.body),e=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(l.body),r=o||e,c=l.body.indexOf(",")>=0;if(!r&&!c)return l.post.match(/,.*\}/)?(t=l.pre+"{"+l.body+Pr+l.post,nt(t)):[t];var d;if(r)d=l.body.split(/\.\./);else if(d=rs(l.body),d.length===1&&(d=nt(d[0],!1).map(jo),d.length===1)){var a=l.post.length?nt(l.post,!1):[""];return a.map(function(O){return l.pre+d[0]+O})}var g=l.pre,a=l.post.length?nt(l.post,!1):[""],f;if(r){var m=Dr(d[0]),_=Dr(d[1]),i=Math.max(d[0].length,d[1].length),u=d.length==3?Math.abs(Dr(d[2])):1,p=Wo,h=_<m;h&&(u*=-1,p=zo);var v=d.some(Uo);f=[];for(var y=m;p(y,_);y+=u){var b;if(e)b=String.fromCharCode(y),b==="\\"&&(b="");else if(b=String(y),v){var w=i-b.length;if(w>0){var S=new Array(w+1).join("0");y<0?b="-"+S+b.slice(1):b=S+b}}f.push(b)}}else f=Mo(d,function(R){return nt(R,!1)});for(var C=0;C<f.length;C++)for(var L=0;L<a.length;L++){var x=g+f[C]+a[L];(!s||r||x)&&n.push(x)}return n}});var Vt=te((Fl,cs)=>{cs.exports=de;de.Minimatch=oe;var Ct=function(){try{return require("path")}catch(t){}}()||{sep:"/"};de.sep=Ct.sep;var Mr=de.GLOBSTAR=oe.GLOBSTAR={},$o=ss(),ns={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Br="[^/]",Ir=Br+"*?",Ko="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",qo="(?:(?!(?:\\/|^)\\.).)*?",os=Vo("().*{}+?[]^$\\!");function Vo(t){return t.split("").reduce(function(s,n){return s[n]=!0,s},{})}var as=/\/+/;de.filter=Go;function Go(t,s){return s=s||{},function(n,l,o){return de(n,t,s)}}function Ue(t,s){s=s||{};var n={};return Object.keys(t).forEach(function(l){n[l]=t[l]}),Object.keys(s).forEach(function(l){n[l]=s[l]}),n}de.defaults=function(t){if(!t||typeof t!="object"||!Object.keys(t).length)return de;var s=de,n=function(o,e,r){return s(o,e,Ue(t,r))};return n.Minimatch=function(o,e){return new s.Minimatch(o,Ue(t,e))},n.Minimatch.defaults=function(o){return s.defaults(Ue(t,o)).Minimatch},n.filter=function(o,e){return s.filter(o,Ue(t,e))},n.defaults=function(o){return s.defaults(Ue(t,o))},n.makeRe=function(o,e){return s.makeRe(o,Ue(t,e))},n.braceExpand=function(o,e){return s.braceExpand(o,Ue(t,e))},n.match=function(l,o,e){return s.match(l,o,Ue(t,e))},n};oe.defaults=function(t){return de.defaults(t).Minimatch};function de(t,s,n){return qt(s),n||(n={}),!n.nocomment&&s.charAt(0)==="#"?!1:new oe(s,n).match(t)}function oe(t,s){if(!(this instanceof oe))return new oe(t,s);qt(t),s||(s={}),t=t.trim(),!s.allowWindowsEscape&&Ct.sep!=="/"&&(t=t.split(Ct.sep).join("/")),this.options=s,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!s.partial,this.make()}oe.prototype.debug=function(){};oe.prototype.make=Yo;function Yo(){var t=this.pattern,s=this.options;if(!s.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate();var n=this.globSet=this.braceExpand();s.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,n),n=this.globParts=n.map(function(l){return l.split(as)}),this.debug(this.pattern,n),n=n.map(function(l,o,e){return l.map(this.parse,this)},this),this.debug(this.pattern,n),n=n.filter(function(l){return l.indexOf(!1)===-1}),this.debug(this.pattern,n),this.set=n}oe.prototype.parseNegate=Xo;function Xo(){var t=this.pattern,s=!1,n=this.options,l=0;if(!n.nonegate){for(var o=0,e=t.length;o<e&&t.charAt(o)==="!";o++)s=!s,l++;l&&(this.pattern=t.substr(l)),this.negate=s}}de.braceExpand=function(t,s){return ls(t,s)};oe.prototype.braceExpand=ls;function ls(t,s){return s||(this instanceof oe?s=this.options:s={}),t=typeof t=="undefined"?this.pattern:t,qt(t),s.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:$o(t)}var Jo=1024*64,qt=function(t){if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>Jo)throw new TypeError("pattern is too long")};oe.prototype.parse=Zo;var Kt={};function Zo(t,s){qt(t);var n=this.options;if(t==="**")if(n.noglobstar)t="*";else return Mr;if(t==="")return"";var l="",o=!!n.nocase,e=!1,r=[],c=[],d,g=!1,a=-1,f=-1,m=t.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",_=this;function i(){if(d){switch(d){case"*":l+=Ir,o=!0;break;case"?":l+=Br,o=!0;break;default:l+="\\"+d;break}_.debug("clearStateChar %j %j",d,l),d=!1}}for(var u=0,p=t.length,h;u<p&&(h=t.charAt(u));u++){if(this.debug("%s	%s %s %j",t,u,l,h),e&&os[h]){l+="\\"+h,e=!1;continue}switch(h){case"/":return!1;case"\\":i(),e=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",t,u,l,h),g){this.debug("  in class"),h==="!"&&u===f+1&&(h="^"),l+=h;continue}_.debug("call clearStateChar %j",d),i(),d=h,n.noext&&i();continue;case"(":if(g){l+="(";continue}if(!d){l+="\\(";continue}r.push({type:d,start:u-1,reStart:l.length,open:ns[d].open,close:ns[d].close}),l+=d==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",d,l),d=!1;continue;case")":if(g||!r.length){l+="\\)";continue}i(),o=!0;var v=r.pop();l+=v.close,v.type==="!"&&c.push(v),v.reEnd=l.length;continue;case"|":if(g||!r.length||e){l+="\\|",e=!1;continue}i(),l+="|";continue;case"[":if(i(),g){l+="\\"+h;continue}g=!0,f=u,a=l.length,l+=h;continue;case"]":if(u===f+1||!g){l+="\\"+h,e=!1;continue}var y=t.substring(f+1,u);try{RegExp("["+y+"]")}catch(W){var b=this.parse(y,Kt);l=l.substr(0,a)+"\\["+b[0]+"\\]",o=o||b[1],g=!1;continue}o=!0,g=!1,l+=h;continue;default:i(),e?e=!1:os[h]&&!(h==="^"&&g)&&(l+="\\"),l+=h}}for(g&&(y=t.substr(f+1),b=this.parse(y,Kt),l=l.substr(0,a)+"\\["+b[0],o=o||b[1]),v=r.pop();v;v=r.pop()){var w=l.slice(v.reStart+v.open.length);this.debug("setting tail",l,v),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(W,K,j){return j||(j="\\"),K+K+j+"|"}),this.debug(`tail=%j
   %s`,w,w,v,l);var S=v.type==="*"?Ir:v.type==="?"?Br:"\\"+v.type;o=!0,l=l.slice(0,v.reStart)+S+"\\("+w}i(),e&&(l+="\\\\");var C=!1;switch(l.charAt(0)){case"[":case".":case"(":C=!0}for(var L=c.length-1;L>-1;L--){var x=c[L],R=l.slice(0,x.reStart),O=l.slice(x.reStart,x.reEnd-8),I=l.slice(x.reEnd-8,x.reEnd),N=l.slice(x.reEnd);I+=N;var F=R.split("(").length-1,E=N;for(u=0;u<F;u++)E=E.replace(/\)[+*?]?/,"");N=E;var k="";N===""&&s!==Kt&&(k="$");var T=R+O+N+k+I;l=T}if(l!==""&&o&&(l="(?=.)"+l),C&&(l=m+l),s===Kt)return[l,o];if(!o)return ea(t);var P=n.nocase?"i":"";try{var H=new RegExp("^"+l+"$",P)}catch(W){return new RegExp("$.")}return H._glob=t,H._src=l,H}de.makeRe=function(t,s){return new oe(t,s||{}).makeRe()};oe.prototype.makeRe=Qo;function Qo(){if(this.regexp||this.regexp===!1)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var s=this.options,n=s.noglobstar?Ir:s.dot?Ko:qo,l=s.nocase?"i":"",o=t.map(function(e){return e.map(function(r){return r===Mr?n:typeof r=="string"?ta(r):r._src}).join("\\/")}).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,l)}catch(e){this.regexp=!1}return this.regexp}de.match=function(t,s,n){n=n||{};var l=new oe(s,n);return t=t.filter(function(o){return l.match(o)}),l.options.nonull&&!t.length&&t.push(s),t};oe.prototype.match=function(s,n){if(typeof n=="undefined"&&(n=this.partial),this.debug("match",s,this.pattern),this.comment)return!1;if(this.empty)return s==="";if(s==="/"&&n)return!0;var l=this.options;Ct.sep!=="/"&&(s=s.split(Ct.sep).join("/")),s=s.split(as),this.debug(this.pattern,"split",s);var o=this.set;this.debug(this.pattern,"set",o);var e,r;for(r=s.length-1;r>=0&&(e=s[r],!e);r--);for(r=0;r<o.length;r++){var c=o[r],d=s;l.matchBase&&c.length===1&&(d=[e]);var g=this.matchOne(d,c,n);if(g)return l.flipNegate?!0:!this.negate}return l.flipNegate?!1:this.negate};oe.prototype.matchOne=function(t,s,n){var l=this.options;this.debug("matchOne",{this:this,file:t,pattern:s}),this.debug("matchOne",t.length,s.length);for(var o=0,e=0,r=t.length,c=s.length;o<r&&e<c;o++,e++){this.debug("matchOne loop");var d=s[e],g=t[o];if(this.debug(s,d,g),d===!1)return!1;if(d===Mr){this.debug("GLOBSTAR",[s,d,g]);var a=o,f=e+1;if(f===c){for(this.debug("** at the end");o<r;o++)if(t[o]==="."||t[o]===".."||!l.dot&&t[o].charAt(0)===".")return!1;return!0}for(;a<r;){var m=t[a];if(this.debug(`
globstar while`,t,a,s,f,m),this.matchOne(t.slice(a),s.slice(f),n))return this.debug("globstar found match!",a,r,m),!0;if(m==="."||m===".."||!l.dot&&m.charAt(0)==="."){this.debug("dot detected!",t,a,s,f);break}this.debug("globstar swallow a segment, and continue"),a++}return!!(n&&(this.debug(`
>>> no match, partial?`,t,a,s,f),a===r))}var _;if(typeof d=="string"?(_=g===d,this.debug("string match",d,g,_)):(_=g.match(d),this.debug("pattern match",d,g,_)),!_)return!1}if(o===r&&e===c)return!0;if(o===r)return n;if(e===c)return o===r-1&&t[o]==="";throw new Error("wtf?")};function ea(t){return t.replace(/\\(.)/g,"$1")}function ta(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var hs=te((jl,Hr)=>{typeof Object.create=="function"?Hr.exports=function(s,n){n&&(s.super_=n,s.prototype=Object.create(n.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}))}:Hr.exports=function(s,n){if(n){s.super_=n;var l=function(){};l.prototype=n.prototype,s.prototype=new l,s.prototype.constructor=s}}});var Yt=te((Ul,Gt)=>{"use strict";function us(t){return t.charAt(0)==="/"}function ds(t){var s=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,n=s.exec(t),l=n[1]||"",o=Boolean(l&&l.charAt(1)!==":");return Boolean(n[2]||o)}Gt.exports=process.platform==="win32"?ds:us;Gt.exports.posix=us;Gt.exports.win32=ds});var Fr=te(We=>{We.setopts=aa;We.ownProp=fs;We.makeAbs=wt;We.finish=la;We.mark=ca;We.isIgnored=ps;We.childrenIgnored=ha;function fs(t,s){return Object.prototype.hasOwnProperty.call(t,s)}var ra=require("fs"),ot=require("path"),ia=Vt(),_s=Yt(),Nr=ia.Minimatch;function sa(t,s){return t.localeCompare(s,"en")}function na(t,s){t.ignore=s.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(oa))}function oa(t){var s=null;if(t.slice(-3)==="/**"){var n=t.replace(/(\/\*\*)+$/,"");s=new Nr(n,{dot:!0})}return{matcher:new Nr(t,{dot:!0}),gmatcher:s}}function aa(t,s,n){if(n||(n={}),n.matchBase&&s.indexOf("/")===-1){if(n.noglobstar)throw new Error("base matching requires globstar");s="**/"+s}t.silent=!!n.silent,t.pattern=s,t.strict=n.strict!==!1,t.realpath=!!n.realpath,t.realpathCache=n.realpathCache||Object.create(null),t.follow=!!n.follow,t.dot=!!n.dot,t.mark=!!n.mark,t.nodir=!!n.nodir,t.nodir&&(t.mark=!0),t.sync=!!n.sync,t.nounique=!!n.nounique,t.nonull=!!n.nonull,t.nosort=!!n.nosort,t.nocase=!!n.nocase,t.stat=!!n.stat,t.noprocess=!!n.noprocess,t.absolute=!!n.absolute,t.fs=n.fs||ra,t.maxLength=n.maxLength||1/0,t.cache=n.cache||Object.create(null),t.statCache=n.statCache||Object.create(null),t.symlinks=n.symlinks||Object.create(null),na(t,n),t.changedCwd=!1;var l=process.cwd();fs(n,"cwd")?(t.cwd=ot.resolve(n.cwd),t.changedCwd=t.cwd!==l):t.cwd=l,t.root=n.root||ot.resolve(t.cwd,"/"),t.root=ot.resolve(t.root),process.platform==="win32"&&(t.root=t.root.replace(/\\/g,"/")),t.cwdAbs=_s(t.cwd)?t.cwd:wt(t,t.cwd),process.platform==="win32"&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),t.nomount=!!n.nomount,n.nonegate=!0,n.nocomment=!0,n.allowWindowsEscape=!1,t.minimatch=new Nr(s,n),t.options=t.minimatch.options}function la(t){for(var s=t.nounique,n=s?[]:Object.create(null),l=0,o=t.matches.length;l<o;l++){var e=t.matches[l];if(!e||Object.keys(e).length===0){if(t.nonull){var r=t.minimatch.globSet[l];s?n.push(r):n[r]=!0}}else{var c=Object.keys(e);s?n.push.apply(n,c):c.forEach(function(d){n[d]=!0})}}if(s||(n=Object.keys(n)),t.nosort||(n=n.sort(sa)),t.mark){for(var l=0;l<n.length;l++)n[l]=t._mark(n[l]);t.nodir&&(n=n.filter(function(d){var g=!/\/$/.test(d),a=t.cache[d]||t.cache[wt(t,d)];return g&&a&&(g=a!=="DIR"&&!Array.isArray(a)),g}))}t.ignore.length&&(n=n.filter(function(d){return!ps(t,d)})),t.found=n}function ca(t,s){var n=wt(t,s),l=t.cache[n],o=s;if(l){var e=l==="DIR"||Array.isArray(l),r=s.slice(-1)==="/";if(e&&!r?o+="/":!e&&r&&(o=o.slice(0,-1)),o!==s){var c=wt(t,o);t.statCache[c]=t.statCache[n],t.cache[c]=t.cache[n]}}return o}function wt(t,s){var n=s;return s.charAt(0)==="/"?n=ot.join(t.root,s):_s(s)||s===""?n=s:t.changedCwd?n=ot.resolve(t.cwd,s):n=ot.resolve(s),process.platform==="win32"&&(n=n.replace(/\\/g,"/")),n}function ps(t,s){return t.ignore.length?t.ignore.some(function(n){return n.matcher.match(s)||!!(n.gmatcher&&n.gmatcher.match(s))}):!1}function ha(t,s){return t.ignore.length?t.ignore.some(function(n){return!!(n.gmatcher&&n.gmatcher.match(s))}):!1}});var ys=te((ql,Ss)=>{Ss.exports=ms;ms.GlobSync=ie;var ua=Ar(),gs=Vt(),zl=gs.Minimatch,$l=Wr().Glob,Kl=require("util"),jr=require("path"),vs=require("assert"),Xt=Yt(),Ve=Fr(),da=Ve.setopts,Ur=Ve.ownProp,fa=Ve.childrenIgnored,_a=Ve.isIgnored;function ms(t,s){if(typeof s=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new ie(t,s).found}function ie(t,s){if(!t)throw new Error("must provide pattern");if(typeof s=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof ie))return new ie(t,s);if(da(this,t,s),this.noprocess)return this;var n=this.minimatch.set.length;this.matches=new Array(n);for(var l=0;l<n;l++)this._process(this.minimatch.set[l],l,!1);this._finish()}ie.prototype._finish=function(){if(vs.ok(this instanceof ie),this.realpath){var t=this;this.matches.forEach(function(s,n){var l=t.matches[n]=Object.create(null);for(var o in s)try{o=t._makeAbs(o);var e=ua.realpathSync(o,t.realpathCache);l[e]=!0}catch(r){if(r.syscall==="stat")l[t._makeAbs(o)]=!0;else throw r}})}Ve.finish(this)};ie.prototype._process=function(t,s,n){vs.ok(this instanceof ie);for(var l=0;typeof t[l]=="string";)l++;var o;switch(l){case t.length:this._processSimple(t.join("/"),s);return;case 0:o=null;break;default:o=t.slice(0,l).join("/");break}var e=t.slice(l),r;o===null?r=".":((Xt(o)||Xt(t.map(function(g){return typeof g=="string"?g:"[*]"}).join("/")))&&(!o||!Xt(o))&&(o="/"+o),r=o);var c=this._makeAbs(r);if(!fa(this,r)){var d=e[0]===gs.GLOBSTAR;d?this._processGlobStar(o,r,c,e,s,n):this._processReaddir(o,r,c,e,s,n)}};ie.prototype._processReaddir=function(t,s,n,l,o,e){var r=this._readdir(n,e);if(r){for(var c=l[0],d=!!this.minimatch.negate,g=c._glob,a=this.dot||g.charAt(0)===".",f=[],m=0;m<r.length;m++){var _=r[m];if(_.charAt(0)!=="."||a){var i;d&&!t?i=!_.match(c):i=_.match(c),i&&f.push(_)}}var u=f.length;if(u!==0){if(l.length===1&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(var m=0;m<u;m++){var _=f[m];t&&(t.slice(-1)!=="/"?_=t+"/"+_:_=t+_),_.charAt(0)==="/"&&!this.nomount&&(_=jr.join(this.root,_)),this._emitMatch(o,_)}return}l.shift();for(var m=0;m<u;m++){var _=f[m],p;t?p=[t,_]:p=[_],this._process(p.concat(l),o,e)}}}};ie.prototype._emitMatch=function(t,s){if(!_a(this,s)){var n=this._makeAbs(s);if(this.mark&&(s=this._mark(s)),this.absolute&&(s=n),!this.matches[t][s]){if(this.nodir){var l=this.cache[n];if(l==="DIR"||Array.isArray(l))return}this.matches[t][s]=!0,this.stat&&this._stat(s)}}};ie.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var s,n,l;try{n=this.fs.lstatSync(t)}catch(e){if(e.code==="ENOENT")return null}var o=n&&n.isSymbolicLink();return this.symlinks[t]=o,!o&&n&&!n.isDirectory()?this.cache[t]="FILE":s=this._readdir(t,!1),s};ie.prototype._readdir=function(t,s){var n;if(s&&!Ur(this.symlinks,t))return this._readdirInGlobStar(t);if(Ur(this.cache,t)){var l=this.cache[t];if(!l||l==="FILE")return null;if(Array.isArray(l))return l}try{return this._readdirEntries(t,this.fs.readdirSync(t))}catch(o){return this._readdirError(t,o),null}};ie.prototype._readdirEntries=function(t,s){if(!this.mark&&!this.stat)for(var n=0;n<s.length;n++){var l=s[n];t==="/"?l=t+l:l=t+"/"+l,this.cache[l]=!0}return this.cache[t]=s,s};ie.prototype._readdirError=function(t,s){switch(s.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var l=new Error(s.code+" invalid cwd "+this.cwd);throw l.path=this.cwd,l.code=s.code,l}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw s;this.silent||console.error("glob error",s);break}};ie.prototype._processGlobStar=function(t,s,n,l,o,e){var r=this._readdir(n,e);if(r){var c=l.slice(1),d=t?[t]:[],g=d.concat(c);this._process(g,o,!1);var a=r.length,f=this.symlinks[n];if(!(f&&e))for(var m=0;m<a;m++){var _=r[m];if(!(_.charAt(0)==="."&&!this.dot)){var i=d.concat(r[m],c);this._process(i,o,!0);var u=d.concat(r[m],l);this._process(u,o,!0)}}}};ie.prototype._processSimple=function(t,s){var n=this._stat(t);if(this.matches[s]||(this.matches[s]=Object.create(null)),!!n){if(t&&Xt(t)&&!this.nomount){var l=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=jr.join(this.root,t):(t=jr.resolve(this.root,t),l&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(s,t)}};ie.prototype._stat=function(t){var s=this._makeAbs(t),n=t.slice(-1)==="/";if(t.length>this.maxLength)return!1;if(!this.stat&&Ur(this.cache,s)){var r=this.cache[s];if(Array.isArray(r)&&(r="DIR"),!n||r==="DIR")return r;if(n&&r==="FILE")return!1}var l,o=this.statCache[s];if(!o){var e;try{e=this.fs.lstatSync(s)}catch(c){if(c&&(c.code==="ENOENT"||c.code==="ENOTDIR"))return this.statCache[s]=!1,!1}if(e&&e.isSymbolicLink())try{o=this.fs.statSync(s)}catch(c){o=e}else o=e}this.statCache[s]=o;var r=!0;return o&&(r=o.isDirectory()?"DIR":"FILE"),this.cache[s]=this.cache[s]||r,n&&r==="FILE"?!1:r};ie.prototype._mark=function(t){return Ve.mark(this,t)};ie.prototype._makeAbs=function(t){return Ve.makeAbs(this,t)}});var zr=te((Vl,Cs)=>{Cs.exports=bs;function bs(t,s){if(t&&s)return bs(t)(s);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(l){n[l]=t[l]}),n;function n(){for(var l=new Array(arguments.length),o=0;o<l.length;o++)l[o]=arguments[o];var e=t.apply(this,l),r=l[l.length-1];return typeof e=="function"&&e!==r&&Object.keys(r).forEach(function(c){e[c]=r[c]}),e}}});var Kr=te((Gl,$r)=>{var ws=zr();$r.exports=ws(Jt);$r.exports.strict=ws(Es);Jt.proto=Jt(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Jt(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Es(this)},configurable:!0})});function Jt(t){var s=function(){return s.called?s.value:(s.called=!0,s.value=t.apply(this,arguments))};return s.called=!1,s}function Es(t){var s=function(){if(s.called)throw new Error(s.onceError);return s.called=!0,s.value=t.apply(this,arguments)},n=t.name||"Function wrapped with `once`";return s.onceError=n+" shouldn't be called more than once",s.called=!1,s}});var xs=te((Yl,Ls)=>{var pa=zr(),Et=Object.create(null),ga=Kr();Ls.exports=pa(va);function va(t,s){return Et[t]?(Et[t].push(s),null):(Et[t]=[s],ma(t))}function ma(t){return ga(function s(){var n=Et[t],l=n.length,o=Sa(arguments);try{for(var e=0;e<l;e++)n[e].apply(null,o)}finally{n.length>l?(n.splice(0,l),process.nextTick(function(){s.apply(null,o)})):delete Et[t]}})}function Sa(t){for(var s=t.length,n=[],l=0;l<s;l++)n[l]=t[l];return n}});var Wr=te((Zl,Rs)=>{Rs.exports=Ge;var ya=Ar(),ks=Vt(),Xl=ks.Minimatch,ba=hs(),Ca=require("events").EventEmitter,qr=require("path"),Vr=require("assert"),Lt=Yt(),Yr=ys(),Ye=Fr(),wa=Ye.setopts,Gr=Ye.ownProp,Xr=xs(),Jl=require("util"),Ea=Ye.childrenIgnored,La=Ye.isIgnored,xa=Kr();function Ge(t,s,n){if(typeof s=="function"&&(n=s,s={}),s||(s={}),s.sync){if(n)throw new TypeError("callback provided to sync glob");return Yr(t,s)}return new V(t,s,n)}Ge.sync=Yr;var ka=Ge.GlobSync=Yr.GlobSync;Ge.glob=Ge;function Ra(t,s){if(s===null||typeof s!="object")return t;for(var n=Object.keys(s),l=n.length;l--;)t[n[l]]=s[n[l]];return t}Ge.hasMagic=function(t,s){var n=Ra({},s);n.noprocess=!0;var l=new V(t,n),o=l.minimatch.set;if(!t)return!1;if(o.length>1)return!0;for(var e=0;e<o[0].length;e++)if(typeof o[0][e]!="string")return!0;return!1};Ge.Glob=V;ba(V,Ca);function V(t,s,n){if(typeof s=="function"&&(n=s,s=null),s&&s.sync){if(n)throw new TypeError("callback provided to sync glob");return new ka(t,s)}if(!(this instanceof V))return new V(t,s,n);wa(this,t,s),this._didRealPath=!1;var l=this.minimatch.set.length;this.matches=new Array(l),typeof n=="function"&&(n=xa(n),this.on("error",n),this.on("end",function(d){n(null,d)}));var o=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(l===0)return c();for(var e=!0,r=0;r<l;r++)this._process(this.minimatch.set[r],r,!1,c);e=!1;function c(){--o._processing,o._processing<=0&&(e?process.nextTick(function(){o._finish()}):o._finish())}}V.prototype._finish=function(){if(Vr(this instanceof V),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Ye.finish(this),this.emit("end",this.found)}};V.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var t=this.matches.length;if(t===0)return this._finish();for(var s=this,n=0;n<this.matches.length;n++)this._realpathSet(n,l);function l(){--t===0&&s._finish()}};V.prototype._realpathSet=function(t,s){var n=this.matches[t];if(!n)return s();var l=Object.keys(n),o=this,e=l.length;if(e===0)return s();var r=this.matches[t]=Object.create(null);l.forEach(function(c,d){c=o._makeAbs(c),ya.realpath(c,o.realpathCache,function(g,a){g?g.syscall==="stat"?r[c]=!0:o.emit("error",g):r[a]=!0,--e===0&&(o.matches[t]=r,s())})})};V.prototype._mark=function(t){return Ye.mark(this,t)};V.prototype._makeAbs=function(t){return Ye.makeAbs(this,t)};V.prototype.abort=function(){this.aborted=!0,this.emit("abort")};V.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))};V.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var s=0;s<t.length;s++){var n=t[s];this._emitMatch(n[0],n[1])}}if(this._processQueue.length){var l=this._processQueue.slice(0);this._processQueue.length=0;for(var s=0;s<l.length;s++){var o=l[s];this._processing--,this._process(o[0],o[1],o[2],o[3])}}}};V.prototype._process=function(t,s,n,l){if(Vr(this instanceof V),Vr(typeof l=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([t,s,n,l]);return}for(var o=0;typeof t[o]=="string";)o++;var e;switch(o){case t.length:this._processSimple(t.join("/"),s,l);return;case 0:e=null;break;default:e=t.slice(0,o).join("/");break}var r=t.slice(o),c;e===null?c=".":((Lt(e)||Lt(t.map(function(a){return typeof a=="string"?a:"[*]"}).join("/")))&&(!e||!Lt(e))&&(e="/"+e),c=e);var d=this._makeAbs(c);if(Ea(this,c))return l();var g=r[0]===ks.GLOBSTAR;g?this._processGlobStar(e,c,d,r,s,n,l):this._processReaddir(e,c,d,r,s,n,l)}};V.prototype._processReaddir=function(t,s,n,l,o,e,r){var c=this;this._readdir(n,e,function(d,g){return c._processReaddir2(t,s,n,l,o,e,g,r)})};V.prototype._processReaddir2=function(t,s,n,l,o,e,r,c){if(!r)return c();for(var d=l[0],g=!!this.minimatch.negate,a=d._glob,f=this.dot||a.charAt(0)===".",m=[],_=0;_<r.length;_++){var i=r[_];if(i.charAt(0)!=="."||f){var u;g&&!t?u=!i.match(d):u=i.match(d),u&&m.push(i)}}var p=m.length;if(p===0)return c();if(l.length===1&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(var _=0;_<p;_++){var i=m[_];t&&(t!=="/"?i=t+"/"+i:i=t+i),i.charAt(0)==="/"&&!this.nomount&&(i=qr.join(this.root,i)),this._emitMatch(o,i)}return c()}l.shift();for(var _=0;_<p;_++){var i=m[_],h;t&&(t!=="/"?i=t+"/"+i:i=t+i),this._process([i].concat(l),o,e,c)}c()};V.prototype._emitMatch=function(t,s){if(!this.aborted&&!La(this,s)){if(this.paused){this._emitQueue.push([t,s]);return}var n=Lt(s)?s:this._makeAbs(s);if(this.mark&&(s=this._mark(s)),this.absolute&&(s=n),!this.matches[t][s]){if(this.nodir){var l=this.cache[n];if(l==="DIR"||Array.isArray(l))return}this.matches[t][s]=!0;var o=this.statCache[n];o&&this.emit("stat",s,o),this.emit("match",s)}}};V.prototype._readdirInGlobStar=function(t,s){if(this.aborted)return;if(this.follow)return this._readdir(t,!1,s);var n="lstat\0"+t,l=this,o=Xr(n,e);o&&l.fs.lstat(t,o);function e(r,c){if(r&&r.code==="ENOENT")return s();var d=c&&c.isSymbolicLink();l.symlinks[t]=d,!d&&c&&!c.isDirectory()?(l.cache[t]="FILE",s()):l._readdir(t,!1,s)}};V.prototype._readdir=function(t,s,n){if(!this.aborted&&(n=Xr("readdir\0"+t+"\0"+s,n),!!n)){if(s&&!Gr(this.symlinks,t))return this._readdirInGlobStar(t,n);if(Gr(this.cache,t)){var l=this.cache[t];if(!l||l==="FILE")return n();if(Array.isArray(l))return n(null,l)}var o=this;o.fs.readdir(t,Oa(this,t,n))}};function Oa(t,s,n){return function(l,o){l?t._readdirError(s,l,n):t._readdirEntries(s,o,n)}}V.prototype._readdirEntries=function(t,s,n){if(!this.aborted){if(!this.mark&&!this.stat)for(var l=0;l<s.length;l++){var o=s[l];t==="/"?o=t+o:o=t+"/"+o,this.cache[o]=!0}return this.cache[t]=s,n(null,s)}};V.prototype._readdirError=function(t,s,n){if(!this.aborted){switch(s.code){case"ENOTSUP":case"ENOTDIR":var l=this._makeAbs(t);if(this.cache[l]="FILE",l===this.cwdAbs){var o=new Error(s.code+" invalid cwd "+this.cwd);o.path=this.cwd,o.code=s.code,this.emit("error",o),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",s),this.abort()),this.silent||console.error("glob error",s);break}return n()}};V.prototype._processGlobStar=function(t,s,n,l,o,e,r){var c=this;this._readdir(n,e,function(d,g){c._processGlobStar2(t,s,n,l,o,e,g,r)})};V.prototype._processGlobStar2=function(t,s,n,l,o,e,r,c){if(!r)return c();var d=l.slice(1),g=t?[t]:[],a=g.concat(d);this._process(a,o,!1,c);var f=this.symlinks[n],m=r.length;if(f&&e)return c();for(var _=0;_<m;_++){var i=r[_];if(!(i.charAt(0)==="."&&!this.dot)){var u=g.concat(r[_],d);this._process(u,o,!0,c);var p=g.concat(r[_],l);this._process(p,o,!0,c)}}c()};V.prototype._processSimple=function(t,s,n){var l=this;this._stat(t,function(o,e){l._processSimple2(t,s,o,e,n)})};V.prototype._processSimple2=function(t,s,n,l,o){if(this.matches[s]||(this.matches[s]=Object.create(null)),!l)return o();if(t&&Lt(t)&&!this.nomount){var e=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=qr.join(this.root,t):(t=qr.resolve(this.root,t),e&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(s,t),o()};V.prototype._stat=function(t,s){var n=this._makeAbs(t),l=t.slice(-1)==="/";if(t.length>this.maxLength)return s();if(!this.stat&&Gr(this.cache,n)){var o=this.cache[n];if(Array.isArray(o)&&(o="DIR"),!l||o==="DIR")return s(null,o);if(l&&o==="FILE")return s()}var e,r=this.statCache[n];if(r!==void 0){if(r===!1)return s(null,r);var c=r.isDirectory()?"DIR":"FILE";return l&&c==="FILE"?s():s(null,c,r)}var d=this,g=Xr("stat\0"+n,a);g&&d.fs.lstat(n,g);function a(f,m){if(m&&m.isSymbolicLink())return d.fs.stat(n,function(_,i){_?d._stat2(t,n,null,m,s):d._stat2(t,n,_,i,s)});d._stat2(t,n,f,m,s)}};V.prototype._stat2=function(t,s,n,l,o){if(n&&(n.code==="ENOENT"||n.code==="ENOTDIR"))return this.statCache[s]=!1,o();var e=t.slice(-1)==="/";if(this.statCache[s]=l,s.slice(-1)==="/"&&l&&!l.isDirectory())return o(null,!1,l);var r=!0;return l&&(r=l.isDirectory()?"DIR":"FILE"),this.cache[s]=this.cache[s]||r,e&&r==="FILE"?o():o(null,r,l)}});var Ms=te((Ql,Is)=>{var Y=require("assert"),Ds=require("path"),Os=require("fs"),at;try{at=Wr()}catch(t){}var Ta={nosort:!0,silent:!0},Jr=0,xt=process.platform==="win32",Ps=t=>{if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(n=>{t[n]=t[n]||Os[n],n=n+"Sync",t[n]=t[n]||Os[n]}),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,t.glob===!1&&(t.disableGlob=!0),t.disableGlob!==!0&&at===void 0)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");t.disableGlob=t.disableGlob||!1,t.glob=t.glob||Ta},Qr=(t,s,n)=>{typeof s=="function"&&(n=s,s={}),Y(t,"rimraf: missing path"),Y.equal(typeof t,"string","rimraf: path should be a string"),Y.equal(typeof n,"function","rimraf: callback function required"),Y(s,"rimraf: invalid options argument provided"),Y.equal(typeof s,"object","rimraf: options should be object"),Ps(s);let l=0,o=null,e=0,r=d=>{o=o||d,--e===0&&n(o)},c=(d,g)=>{if(d)return n(d);if(e=g.length,e===0)return n();g.forEach(a=>{let f=m=>{if(m){if((m.code==="EBUSY"||m.code==="ENOTEMPTY"||m.code==="EPERM")&&l<s.maxBusyTries)return l++,setTimeout(()=>Zr(a,s,f),l*100);if(m.code==="EMFILE"&&Jr<s.emfileWait)return setTimeout(()=>Zr(a,s,f),Jr++);m.code==="ENOENT"&&(m=null)}Jr=0,r(m)};Zr(a,s,f)})};if(s.disableGlob||!at.hasMagic(t))return c(null,[t]);s.lstat(t,(d,g)=>{if(!d)return c(null,[t]);at(t,s.glob,c)})},Zr=(t,s,n)=>{Y(t),Y(s),Y(typeof n=="function"),s.lstat(t,(l,o)=>{if(l&&l.code==="ENOENT")return n(null);if(l&&l.code==="EPERM"&&xt&&Ts(t,s,l,n),o&&o.isDirectory())return Zt(t,s,l,n);s.unlink(t,e=>{if(e){if(e.code==="ENOENT")return n(null);if(e.code==="EPERM")return xt?Ts(t,s,e,n):Zt(t,s,e,n);if(e.code==="EISDIR")return Zt(t,s,e,n)}return n(e)})})},Ts=(t,s,n,l)=>{Y(t),Y(s),Y(typeof l=="function"),s.chmod(t,438,o=>{o?l(o.code==="ENOENT"?null:n):s.stat(t,(e,r)=>{e?l(e.code==="ENOENT"?null:n):r.isDirectory()?Zt(t,s,n,l):s.unlink(t,l)})})},As=(t,s,n)=>{Y(t),Y(s);try{s.chmodSync(t,438)}catch(o){if(o.code==="ENOENT")return;throw n}let l;try{l=s.statSync(t)}catch(o){if(o.code==="ENOENT")return;throw n}l.isDirectory()?Qt(t,s,n):s.unlinkSync(t)},Zt=(t,s,n,l)=>{Y(t),Y(s),Y(typeof l=="function"),s.rmdir(t,o=>{o&&(o.code==="ENOTEMPTY"||o.code==="EEXIST"||o.code==="EPERM")?Aa(t,s,l):o&&o.code==="ENOTDIR"?l(n):l(o)})},Aa=(t,s,n)=>{Y(t),Y(s),Y(typeof n=="function"),s.readdir(t,(l,o)=>{if(l)return n(l);let e=o.length;if(e===0)return s.rmdir(t,n);let r;o.forEach(c=>{Qr(Ds.join(t,c),s,d=>{if(!r){if(d)return n(r=d);--e===0&&s.rmdir(t,n)}})})})},Bs=(t,s)=>{s=s||{},Ps(s),Y(t,"rimraf: missing path"),Y.equal(typeof t,"string","rimraf: path should be a string"),Y(s,"rimraf: missing options"),Y.equal(typeof s,"object","rimraf: options should be object");let n;if(s.disableGlob||!at.hasMagic(t))n=[t];else try{s.lstatSync(t),n=[t]}catch(l){n=at.sync(t,s.glob)}if(n.length)for(let l=0;l<n.length;l++){let o=n[l],e;try{e=s.lstatSync(o)}catch(r){if(r.code==="ENOENT")return;r.code==="EPERM"&&xt&&As(o,s,r)}try{e&&e.isDirectory()?Qt(o,s,null):s.unlinkSync(o)}catch(r){if(r.code==="ENOENT")return;if(r.code==="EPERM")return xt?As(o,s,r):Qt(o,s,r);if(r.code!=="EISDIR")throw r;Qt(o,s,r)}}},Qt=(t,s,n)=>{Y(t),Y(s);try{s.rmdirSync(t)}catch(l){if(l.code==="ENOENT")return;if(l.code==="ENOTDIR")throw n;(l.code==="ENOTEMPTY"||l.code==="EEXIST"||l.code==="EPERM")&&Da(t,s)}},Da=(t,s)=>{Y(t),Y(s),s.readdirSync(t).forEach(o=>Bs(Ds.join(t,o),s));let n=xt?100:1,l=0;do{let o=!0;try{let e=s.rmdirSync(t,s);return o=!1,e}finally{if(++l<n&&o)continue}}while(!0)};Is.exports=Qr;Qr.sync=Bs});var en=te((ec,Pe)=>{/*!
 * Tmp
 *
 * Copyright (c) 2011-2017 KARASZI Istvan <github@spam.raszi.hu>
 *
 * MIT Licensed
 */var ne=require("fs"),si=require("os"),fe=require("path"),Hs=require("crypto"),we={fs:ne.constants,os:si.constants},js=Ms(),Ns="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Us=/XXXXXX/,Pa=3,Ws=(we.O_CREAT||we.fs.O_CREAT)|(we.O_EXCL||we.fs.O_EXCL)|(we.O_RDWR||we.fs.O_RDWR),Ba=si.platform()==="win32",Ia=we.EBADF||we.os.errno.EBADF,Ma=we.ENOENT||we.os.errno.ENOENT,zs=448,$s=384,Ha="exit",lt=[],Ks=ne.rmdirSync.bind(ne),qs=js.sync,Vs=!1;function ni(t,s){let n=ct(t,s),l=n[0],o=n[1];try{Js(l)}catch(r){return o(r)}let e=l.tries;(function r(){try{let c=Xs(l);ne.stat(c,function(d){if(!d)return e-- >0?r():o(new Error("Could not get a unique tmp filename, max tries reached "+c));o(null,c)})}catch(c){o(c)}})()}function oi(t){let s=ct(t),n=s[0];Js(n);let l=n.tries;do{let o=Xs(n);try{ne.statSync(o)}catch(e){return o}}while(l-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function Na(t,s){let n=ct(t,s),l=n[0],o=n[1];ni(l,function(r,c){if(r)return o(r);ne.open(c,Ws,l.mode||$s,function(g,a){if(g)return o(g);if(l.discardDescriptor)return ne.close(a,function(m){return o(m,c,void 0,ti(c,-1,l,!1))});{let f=l.discardDescriptor||l.detachDescriptor;o(null,c,a,ti(c,f?-1:a,l,!1))}})})}function Fa(t){let s=ct(t),n=s[0],l=n.discardDescriptor||n.detachDescriptor,o=oi(n);var e=ne.openSync(o,Ws,n.mode||$s);return n.discardDescriptor&&(ne.closeSync(e),e=void 0),{name:o,fd:e,removeCallback:ti(o,l?-1:e,n,!0)}}function ja(t,s){let n=ct(t,s),l=n[0],o=n[1];ni(l,function(r,c){if(r)return o(r);ne.mkdir(c,l.mode||zs,function(g){if(g)return o(g);o(null,c,Gs(c,l,!1))})})}function Ua(t){let s=ct(t),n=s[0],l=oi(n);return ne.mkdirSync(l,n.mode||zs),{name:l,removeCallback:Gs(l,n,!0)}}function Wa(t,s){let n=function(l){if(l&&!ii(l))return s(l);s()};0<=t[0]?ne.close(t[0],function(){ne.unlink(t[1],n)}):ne.unlink(t[1],n)}function za(t){let s=null;try{0<=t[0]&&ne.closeSync(t[0])}catch(n){if(!Ka(n)&&!ii(n))throw n}finally{try{ne.unlinkSync(t[1])}catch(n){ii(n)||(s=n)}}if(s!==null)throw s}function ti(t,s,n,l){let o=er(za,[s,t],l),e=er(Wa,[s,t],l,o);return n.keep||lt.unshift(o),l?o:e}function Gs(t,s,n){let l=s.unsafeCleanup?js:ne.rmdir.bind(ne),o=s.unsafeCleanup?qs:Ks,e=er(o,t,n),r=er(l,t,n,e);return s.keep||lt.unshift(e),n?e:r}function er(t,s,n,l){let o=!1;return function e(r){if(!o){let c=l||e,d=lt.indexOf(c);return d>=0&&lt.splice(d,1),o=!0,n||t===Ks||t===qs?t(s):t(s,r||function(){})}}}function $a(){if(Vs)for(;lt.length;)try{lt[0]()}catch(t){}}function Fs(t){let s=[],n=null;try{n=Hs.randomBytes(t)}catch(o){n=Hs.pseudoRandomBytes(t)}for(var l=0;l<t;l++)s.push(Ns[n[l]%Ns.length]);return s.join("")}function Ys(t){return t===null||ue(t)||!t.trim()}function ue(t){return typeof t=="undefined"}function ct(t,s){if(typeof t=="function")return[{},t];if(ue(t))return[{},s];let n={};for(let l of Object.getOwnPropertyNames(t))n[l]=t[l];return[n,s]}function Xs(t){let s=t.tmpdir;if(!ue(t.name))return fe.join(s,t.dir,t.name);if(!ue(t.template))return fe.join(s,t.dir,t.template).replace(Us,Fs(6));let n=[t.prefix?t.prefix:"tmp","-",process.pid,"-",Fs(12),t.postfix?"-"+t.postfix:""].join("");return fe.join(s,t.dir,n)}function Js(t){t.tmpdir=Qs(t);let s=t.tmpdir;if(ue(t.name)||ei(t.name,"name",s),ue(t.dir)||ei(t.dir,"dir",s),!ue(t.template)&&(ei(t.template,"template",s),!t.template.match(Us)))throw new Error(`Invalid template, found "${t.template}".`);if(!ue(t.tries)&&isNaN(t.tries)||t.tries<0)throw new Error(`Invalid tries, found "${t.tries}".`);t.tries=ue(t.name)?t.tries||Pa:1,t.keep=!!t.keep,t.detachDescriptor=!!t.detachDescriptor,t.discardDescriptor=!!t.discardDescriptor,t.unsafeCleanup=!!t.unsafeCleanup,t.dir=ue(t.dir)?"":fe.relative(s,ri(t.dir,s)),t.template=ue(t.template)?void 0:fe.relative(s,ri(t.template,s)),t.template=Ys(t.template)?void 0:fe.relative(t.dir,t.template),t.name=ue(t.name)?void 0:ai(t.name),t.prefix=ue(t.prefix)?"":t.prefix,t.postfix=ue(t.postfix)?"":t.postfix}function ri(t,s){let n=ai(t);return n.startsWith(s)?fe.resolve(n):fe.resolve(fe.join(s,n))}function ai(t){return Ys(t)?t:t.replace(/["']/g,"")}function ei(t,s,n){if(s==="name"){if(fe.isAbsolute(t))throw new Error(`${s} option must not contain an absolute path, found "${t}".`);let l=fe.basename(t);if(l===".."||l==="."||l!==t)throw new Error(`${s} option must not contain a path, found "${t}".`)}else{if(fe.isAbsolute(t)&&!t.startsWith(n))throw new Error(`${s} option must be relative to "${n}", found "${t}".`);let l=ri(t,n);if(!l.startsWith(n))throw new Error(`${s} option must be relative to "${n}", found "${l}".`)}}function Ka(t){return Zs(t,-Ia,"EBADF")}function ii(t){return Zs(t,-Ma,"ENOENT")}function Zs(t,s,n){return Ba?t.code===n:t.code===n&&t.errno===s}function qa(){Vs=!0}function Qs(t){return fe.resolve(ai(t&&t.tmpdir||si.tmpdir()))}process.addListener(Ha,$a);Object.defineProperty(Pe.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return Qs()}});Pe.exports.dir=ja;Pe.exports.dirSync=Ua;Pe.exports.file=Na;Pe.exports.fileSync=Fa;Pe.exports.tmpName=ni;Pe.exports.tmpNameSync=oi;Pe.exports.setGracefulCleanup=qa});var On=te((At,vi)=>{(function(t,s){typeof At=="object"&&typeof vi=="object"?vi.exports=s():typeof define=="function"&&define.amd?define([],s):typeof At=="object"?At.SerializeAddon=s():t.SerializeAddon=s()})(At,function(){return(()=>{"use strict";var t={};return(()=>{var s=t;function n(g,a,f){return Math.max(a,Math.min(g,f))}Object.defineProperty(s,"__esModule",{value:!0}),s.HTMLSerializeHandler=s.SerializeAddon=void 0;class l{constructor(a){this._buffer=a}serialize(a){let f=this._buffer.getNullCell(),m=this._buffer.getNullCell(),_=f,i=a.start.x,u=a.end.x,p=a.start.y,h=a.end.y;this._beforeSerialize(u-i,i,u);for(let v=i;v<=u;v++){let y=this._buffer.getLine(v);if(y){let b=v!==a.start.x?0:p,w=v!==a.end.x?y.length:h;for(let S=b;S<w;S++){let C=y.getCell(S,_===f?m:f);C?(this._nextCell(C,_,v,S),_=C):console.warn(`Can't get cell at row=${v}, col=${S}`)}}this._rowEnd(v,v===u)}return this._afterSerialize(),this._serializeString()}_nextCell(a,f,m,_){}_rowEnd(a,f){}_beforeSerialize(a,f,m){}_afterSerialize(){}_serializeString(){return""}}function o(g,a){return g.getFgColorMode()===a.getFgColorMode()&&g.getFgColor()===a.getFgColor()}function e(g,a){return g.getBgColorMode()===a.getBgColorMode()&&g.getBgColor()===a.getBgColor()}function r(g,a){return g.isInverse()===a.isInverse()&&g.isBold()===a.isBold()&&g.isUnderline()===a.isUnderline()&&g.isBlink()===a.isBlink()&&g.isInvisible()===a.isInvisible()&&g.isItalic()===a.isItalic()&&g.isDim()===a.isDim()&&g.isStrikethrough()===a.isStrikethrough()}class c extends l{constructor(a,f){super(a),this._terminal=f,this._rowIndex=0,this._allRows=new Array,this._allRowSeparators=new Array,this._currentRow="",this._nullCellCount=0,this._cursorStyle=this._buffer.getNullCell(),this._cursorStyleRow=0,this._cursorStyleCol=0,this._backgroundCell=this._buffer.getNullCell(),this._firstRow=0,this._lastCursorRow=0,this._lastCursorCol=0,this._lastContentCursorRow=0,this._lastContentCursorCol=0,this._thisRowLastChar=this._buffer.getNullCell(),this._thisRowLastSecondChar=this._buffer.getNullCell(),this._nextRowFirstChar=this._buffer.getNullCell()}_beforeSerialize(a,f,m){this._allRows=new Array(a),this._lastContentCursorRow=f,this._lastCursorRow=f,this._firstRow=f}_rowEnd(a,f){var m;this._nullCellCount>0&&!e(this._cursorStyle,this._backgroundCell)&&(this._currentRow+=`\x1B[${this._nullCellCount}X`);let _="";if(!f){a-this._firstRow>=this._terminal.rows&&((m=this._buffer.getLine(this._cursorStyleRow))===null||m===void 0||m.getCell(this._cursorStyleCol,this._backgroundCell));let i=this._buffer.getLine(a),u=this._buffer.getLine(a+1);if(u.isWrapped){_="";let p=i.getCell(i.length-1,this._thisRowLastChar),h=i.getCell(i.length-2,this._thisRowLastSecondChar),v=u.getCell(0,this._nextRowFirstChar),y=v.getWidth()>1,b=!1;(v.getChars()&&y?this._nullCellCount<=1:this._nullCellCount<=0)&&((p.getChars()||p.getWidth()===0)&&e(p,v)&&(b=!0),y&&(h.getChars()||h.getWidth()===0)&&e(p,v)&&e(h,v)&&(b=!0)),b||(_="-".repeat(this._nullCellCount+1),_+="\x1B[1D\x1B[1X",this._nullCellCount>0&&(_+="\x1B[A",_+=`\x1B[${i.length-this._nullCellCount}C`,_+=`\x1B[${this._nullCellCount}X`,_+=`\x1B[${i.length-this._nullCellCount}D`,_+="\x1B[B"),this._lastContentCursorRow=a+1,this._lastContentCursorCol=0,this._lastCursorRow=a+1,this._lastCursorCol=0)}else _=`\r
`,this._lastCursorRow=a+1,this._lastCursorCol=0}this._allRows[this._rowIndex]=this._currentRow,this._allRowSeparators[this._rowIndex++]=_,this._currentRow="",this._nullCellCount=0}_diffStyle(a,f){let m=[],_=!o(a,f),i=!e(a,f),u=!r(a,f);if(_||i||u)if(a.isAttributeDefault())f.isAttributeDefault()||m.push(0);else{if(_){let p=a.getFgColor();a.isFgRGB()?m.push(38,2,p>>>16&255,p>>>8&255,255&p):a.isFgPalette()?p>=16?m.push(38,5,p):m.push(8&p?90+(7&p):30+(7&p)):m.push(39)}if(i){let p=a.getBgColor();a.isBgRGB()?m.push(48,2,p>>>16&255,p>>>8&255,255&p):a.isBgPalette()?p>=16?m.push(48,5,p):m.push(8&p?100+(7&p):40+(7&p)):m.push(49)}u&&(a.isInverse()!==f.isInverse()&&m.push(a.isInverse()?7:27),a.isBold()!==f.isBold()&&m.push(a.isBold()?1:22),a.isUnderline()!==f.isUnderline()&&m.push(a.isUnderline()?4:24),a.isBlink()!==f.isBlink()&&m.push(a.isBlink()?5:25),a.isInvisible()!==f.isInvisible()&&m.push(a.isInvisible()?8:28),a.isItalic()!==f.isItalic()&&m.push(a.isItalic()?3:23),a.isDim()!==f.isDim()&&m.push(a.isDim()?2:22),a.isStrikethrough()!==f.isStrikethrough()&&m.push(a.isStrikethrough()?9:29))}return m}_nextCell(a,f,m,_){if(a.getWidth()===0)return;let i=a.getChars()==="",u=this._diffStyle(a,this._cursorStyle);if(i?!e(this._cursorStyle,a):u.length>0){this._nullCellCount>0&&(e(this._cursorStyle,this._backgroundCell)||(this._currentRow+=`\x1B[${this._nullCellCount}X`),this._currentRow+=`\x1B[${this._nullCellCount}C`,this._nullCellCount=0),this._lastContentCursorRow=this._lastCursorRow=m,this._lastContentCursorCol=this._lastCursorCol=_,this._currentRow+=`\x1B[${u.join(";")}m`;let p=this._buffer.getLine(m);p!==void 0&&(p.getCell(_,this._cursorStyle),this._cursorStyleRow=m,this._cursorStyleCol=_)}i?this._nullCellCount+=a.getWidth():(this._nullCellCount>0&&(e(this._cursorStyle,this._backgroundCell)||(this._currentRow+=`\x1B[${this._nullCellCount}X`),this._currentRow+=`\x1B[${this._nullCellCount}C`,this._nullCellCount=0),this._currentRow+=a.getChars(),this._lastContentCursorRow=this._lastCursorRow=m,this._lastContentCursorCol=this._lastCursorCol=_+a.getWidth())}_serializeString(){let a=this._allRows.length;this._buffer.length-this._firstRow<=this._terminal.rows&&(a=this._lastContentCursorRow+1-this._firstRow,this._lastCursorCol=this._lastContentCursorCol,this._lastCursorRow=this._lastContentCursorRow);let f="";for(let h=0;h<a;h++)f+=this._allRows[h],h+1<a&&(f+=this._allRowSeparators[h]);let m=this._buffer.baseY+this._buffer.cursorY,_=this._buffer.cursorX;var i;(m!==this._lastCursorRow||_!==this._lastCursorCol)&&((i=m-this._lastCursorRow)>0?f+=`\x1B[${i}B`:i<0&&(f+=`\x1B[${-i}A`),(h=>{h>0?f+=`\x1B[${h}C`:h<0&&(f+=`\x1B[${-h}D`)})(_-this._lastCursorCol));let u=this._terminal._core._inputHandler._curAttrData,p=this._diffStyle(u,this._cursorStyle);return p.length>0&&(f+=`\x1B[${p.join(";")}m`),f}}s.SerializeAddon=class{constructor(){}activate(g){this._terminal=g}_serializeBuffer(g,a,f){let m=a.length,_=new c(a,g),i=f===void 0?m:n(f+g.rows,0,m);return _.serialize({start:{x:m-i,y:0},end:{x:m-1,y:g.cols}})}_serializeBufferAsHTML(g,a){var f,m;let _=g.buffer.active,i=new d(_,g,a);if((f=a.onlySelection)===null||f===void 0||!f){let p=_.length,h=a.scrollback,v=h===void 0?p:n(h+g.rows,0,p);return i.serialize({start:{x:p-v,y:0},end:{x:p-1,y:g.cols}})}let u=(m=this._terminal)===null||m===void 0?void 0:m.getSelectionPosition();return u!==void 0?i.serialize({start:{x:u.start.y,y:u.start.x},end:{x:u.end.y,y:u.end.x}}):""}_serializeModes(g){let a="",f=g.modes;if(f.applicationCursorKeysMode&&(a+="\x1B[?1h"),f.applicationKeypadMode&&(a+="\x1B[?66h"),f.bracketedPasteMode&&(a+="\x1B[?2004h"),f.insertMode&&(a+="\x1B[4h"),f.originMode&&(a+="\x1B[?6h"),f.reverseWraparoundMode&&(a+="\x1B[?45h"),f.sendFocusMode&&(a+="\x1B[?1004h"),f.wraparoundMode===!1&&(a+="\x1B[?7l"),f.mouseTrackingMode!=="none")switch(f.mouseTrackingMode){case"x10":a+="\x1B[?9h";break;case"vt200":a+="\x1B[?1000h";break;case"drag":a+="\x1B[?1002h";break;case"any":a+="\x1B[?1003h"}return a}serialize(g){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let a=this._serializeBuffer(this._terminal,this._terminal.buffer.normal,g==null?void 0:g.scrollback);return g!=null&&g.excludeAltBuffer||this._terminal.buffer.active.type!=="alternate"||(a+=`\x1B[?1049h\x1B[H${this._serializeBuffer(this._terminal,this._terminal.buffer.alternate,void 0)}`),g!=null&&g.excludeModes||(a+=this._serializeModes(this._terminal)),a}serializeAsHTML(g){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._serializeBufferAsHTML(this._terminal,g||{})}dispose(){}};class d extends l{constructor(a,f,m){super(a),this._terminal=f,this._options=m,this._currentRow="",this._htmlContent="",this._colors=f._core._themeService.colors}_padStart(a,f,m){return f>>=0,m=m!=null?m:" ",a.length>f?a:((f-=a.length)>m.length&&(m+=m.repeat(f/m.length)),m.slice(0,f)+a)}_beforeSerialize(a,f,m){var _,i,u,p,h;this._htmlContent+="<html><body><!--StartFragment--><pre>";let v="#000000",y="#ffffff";(_=this._options.includeGlobalBackground)!==null&&_!==void 0&&_&&(v=(u=(i=this._terminal.options.theme)===null||i===void 0?void 0:i.foreground)!==null&&u!==void 0?u:"#ffffff",y=(h=(p=this._terminal.options.theme)===null||p===void 0?void 0:p.background)!==null&&h!==void 0?h:"#000000");let b=[];b.push("color: "+v+";"),b.push("background-color: "+y+";"),b.push("font-family: "+this._terminal.options.fontFamily+";"),b.push("font-size: "+this._terminal.options.fontSize+"px;"),this._htmlContent+="<div style='"+b.join(" ")+"'>"}_afterSerialize(){this._htmlContent+="</div>",this._htmlContent+="</pre><!--EndFragment--></body></html>"}_rowEnd(a,f){this._htmlContent+="<div><span>"+this._currentRow+"</span></div>",this._currentRow=""}_getHexColor(a,f){let m=f?a.getFgColor():a.getBgColor();return(f?a.isFgRGB():a.isBgRGB())?[m>>16&255,m>>8&255,255&m].map(_=>this._padStart(_.toString(16),2,"0")).join(""):(f?a.isFgPalette():a.isBgPalette())?this._colors.ansi[m].css:void 0}_diffStyle(a,f){let m=[],_=!o(a,f),i=!e(a,f),u=!r(a,f);if(_||i||u){let p=this._getHexColor(a,!0);p&&m.push("color: "+p+";");let h=this._getHexColor(a,!1);return h&&m.push("background-color: "+h+";"),a.isInverse()&&m.push("color: #000000; background-color: #BFBFBF;"),a.isBold()&&m.push("font-weight: bold;"),a.isUnderline()&&m.push("text-decoration: underline;"),a.isBlink()&&m.push("text-decoration: blink;"),a.isInvisible()&&m.push("visibility: hidden;"),a.isItalic()&&m.push("font-style: italic;"),a.isDim()&&m.push("opacity: 0.5;"),a.isStrikethrough()&&m.push("text-decoration: line-through;"),m}}_nextCell(a,f,m,_){if(a.getWidth()===0)return;let i=a.getChars()==="",u=this._diffStyle(a,f);u&&(this._currentRow+=u.length===0?"</span><span>":"</span><span style='"+u.join(" ")+"'>"),this._currentRow+=i?" ":a.getChars()}_serializeString(){return this._htmlContent}}s.HTMLSerializeHandler=d})(),t})()})});var An=te((fr,mi)=>{(function(t,s){typeof fr=="object"&&typeof mi=="object"?mi.exports=s():typeof define=="function"&&define.amd?define([],s):typeof fr=="object"?fr.FitAddon=s():t.FitAddon=s()})(self,function(){return(()=>{"use strict";var t={};return(()=>{var s=t;Object.defineProperty(s,"__esModule",{value:!0}),s.FitAddon=void 0,s.FitAddon=class{constructor(){}activate(n){this._terminal=n}dispose(){}fit(){let n=this.proposeDimensions();if(!n||!this._terminal||isNaN(n.cols)||isNaN(n.rows))return;let l=this._terminal._core;this._terminal.rows===n.rows&&this._terminal.cols===n.cols||(l._renderService.clear(),this._terminal.resize(n.cols,n.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let n=this._terminal._core,l=n._renderService.dimensions;if(l.css.cell.width===0||l.css.cell.height===0)return;let o=this._terminal.options.scrollback===0?0:n.viewport.scrollBarWidth,e=window.getComputedStyle(this._terminal.element.parentElement),r=parseInt(e.getPropertyValue("height")),c=Math.max(0,parseInt(e.getPropertyValue("width"))),d=window.getComputedStyle(this._terminal.element),g=r-(parseInt(d.getPropertyValue("padding-top"))+parseInt(d.getPropertyValue("padding-bottom"))),a=c-(parseInt(d.getPropertyValue("padding-right"))+parseInt(d.getPropertyValue("padding-left")))-o;return{cols:Math.max(2,Math.floor(a/l.css.cell.width)),rows:Math.max(1,Math.floor(g/l.css.cell.height))}}}})(),t})()})});var Dn=te((_r,Si)=>{(function(t,s){typeof _r=="object"&&typeof Si=="object"?Si.exports=s():typeof define=="function"&&define.amd?define([],s):typeof _r=="object"?_r.SearchAddon=s():t.SearchAddon=s()})(self,function(){return(()=>{"use strict";var t={345:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.forwardEvent=e.EventEmitter=void 0,e.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=r=>(this._listeners.push(r),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===r)return void this._listeners.splice(c,1)}}})),this._event}fire(r,c){let d=[];for(let g=0;g<this._listeners.length;g++)d.push(this._listeners[g]);for(let g=0;g<d.length;g++)d[g].call(void 0,r,c)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},e.forwardEvent=function(r,c){return r(d=>c.fire(d))}},859:(o,e)=>{function r(c){for(let d of c)d.dispose();c.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.toDisposable=e.Disposable=void 0,e.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){let d=this._disposables.indexOf(c);d!==-1&&this._disposables.splice(d,1)}},e.toDisposable=function(c){return{dispose:c}},e.disposeArray=r,e.getDisposeArrayDisposable=function(c){return{dispose:()=>r(c)}}}},s={};function n(o){var e=s[o];if(e!==void 0)return e.exports;var r=s[o]={exports:{}};return t[o](r,r.exports,n),r.exports}var l={};return(()=>{var o=l;Object.defineProperty(o,"__esModule",{value:!0}),o.SearchAddon=void 0;let e=n(345),r=n(859),c=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";class d extends r.Disposable{constructor(){super(...arguments),this._linesCacheTimeoutId=0,this._onDidChangeResults=this.register(new e.EventEmitter),this.onDidChangeResults=this._onDidChangeResults.event}activate(a){this._terminal=a,this._onDataDisposable=this.register(this._terminal.onWriteParsed(()=>this._updateMatches())),this._onResizeDisposable=this.register(this._terminal.onResize(()=>this._updateMatches())),this.register((0,r.toDisposable)(()=>{var f,m;this.clearDecorations(),(f=this._onDataDisposable)===null||f===void 0||f.dispose(),(m=this._onResizeDisposable)===null||m===void 0||m.dispose()}))}_updateMatches(){var a;this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&(!((a=this._lastSearchOptions)===null||a===void 0)&&a.decorations)&&(this._highlightTimeout=setTimeout(()=>{var f,m;this.findPrevious(this._cachedSearchTerm,Object.assign(Object.assign({},this._lastSearchOptions),{incremental:!0,noScroll:!0})),this._resultIndex=this._searchResults?this._searchResults.size-1:-1,this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:(m=(f=this._searchResults)===null||f===void 0?void 0:f.size)!==null&&m!==void 0?m:-1})},200))}clearDecorations(a){var f,m,_,i;(f=this._selectedDecoration)===null||f===void 0||f.dispose(),(m=this._searchResults)===null||m===void 0||m.clear(),(_=this._resultDecorations)===null||_===void 0||_.forEach(u=>{for(let p of u)p.dispose()}),(i=this._resultDecorations)===null||i===void 0||i.clear(),this._searchResults=void 0,this._resultDecorations=void 0,a||(this._cachedSearchTerm=void 0)}clearActiveDecoration(){var a;(a=this._selectedDecoration)===null||a===void 0||a.dispose(),this._selectedDecoration=void 0}findNext(a,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=f,f!=null&&f.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&a===this._cachedSearchTerm||this._highlightAllMatches(a,f)),this._fireResults(a,this._findNextAndSelect(a,f),f)}_highlightAllMatches(a,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!a||a.length===0)return void this.clearDecorations();f=f||{},this.clearDecorations(!0),this._searchResults=new Map,this._resultDecorations=new Map;let m=this._resultDecorations,_=this._find(a,0,0,f);for(;_&&!this._searchResults.get(`${_.row}-${_.col}`);)if(this._searchResults.set(`${_.row}-${_.col}`,_),_=this._find(a,_.col+_.term.length>=this._terminal.cols?_.row+1:_.row,_.col+_.term.length>=this._terminal.cols?0:_.col+1,f),this._searchResults.size>1e3)return this.clearDecorations(),void(this._resultIndex=void 0);this._searchResults.forEach(i=>{let u=this._createResultDecoration(i,f.decorations);if(u){let p=m.get(u.marker.line)||[];p.push(u),m.set(u.marker.line,p)}})}_find(a,f,m,_){var i;if(!this._terminal||!a||a.length===0)return(i=this._terminal)===null||i===void 0||i.clearSelection(),void this.clearDecorations();if(m>this._terminal.cols)throw new Error(`Invalid col: ${m} to search in terminal of ${this._terminal.cols} cols`);let u;this._initLinesCache();let p={startRow:f,startCol:m};if(u=this._findInLine(a,p,_),!u)for(let h=f+1;h<this._terminal.buffer.active.baseY+this._terminal.rows&&(p.startRow=h,p.startCol=0,u=this._findInLine(a,p,_),!u);h++);return u}_findNextAndSelect(a,f){var m;if(!this._terminal||!a||a.length===0)return(m=this._terminal)===null||m===void 0||m.clearSelection(),this.clearDecorations(),this._cachedSearchTerm=void 0,this._resultIndex=-1,!1;this._cachedSearchTerm!==a&&(this._resultIndex=void 0,this._terminal.clearSelection());let _,i=0,u=0;if(this._terminal.hasSelection()){let v=!!f&&f.incremental;_=this._terminal.getSelectionPosition(),u=v?_.start.y:_.end.y,i=v?_.start.x:_.end.x}this._initLinesCache();let p={startRow:u,startCol:i},h=this._findInLine(a,p,f);if(!h)for(let v=u+1;v<this._terminal.buffer.active.baseY+this._terminal.rows&&(p.startRow=v,p.startCol=0,h=this._findInLine(a,p,f),!h);v++);if(!h&&u!==0)for(let v=0;v<u&&(p.startRow=v,p.startCol=0,h=this._findInLine(a,p,f),!h);v++);return!h&&_&&(p.startRow=_.start.y,p.startCol=0,h=this._findInLine(a,p,f)),this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0?this._resultIndex=0:(this._resultIndex++,this._resultIndex>=this._searchResults.size&&(this._resultIndex=0))),this._selectResult(h,f==null?void 0:f.decorations,f==null?void 0:f.noScroll)}findPrevious(a,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=f,f!=null&&f.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&a===this._cachedSearchTerm||this._highlightAllMatches(a,f)),this._fireResults(a,this._findPreviousAndSelect(a,f),f)}_fireResults(a,f,m){var _;return m!=null&&m.decorations&&(this._resultIndex!==void 0&&((_=this._searchResults)===null||_===void 0?void 0:_.size)!==void 0?this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:this._searchResults.size}):this._onDidChangeResults.fire(void 0)),this._cachedSearchTerm=a,f}_findPreviousAndSelect(a,f){var m;if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let _;if(!this._terminal||!a||a.length===0)return _=void 0,(m=this._terminal)===null||m===void 0||m.clearSelection(),this.clearDecorations(),this._resultIndex=-1,!1;this._cachedSearchTerm!==a&&(this._resultIndex=void 0,this._terminal.clearSelection());let i=this._terminal.buffer.active.baseY+this._terminal.rows,u=this._terminal.cols,p=!0,h=!!f&&f.incremental,v;this._terminal.hasSelection()&&(v=this._terminal.getSelectionPosition(),i=v.start.y,u=v.start.x),this._initLinesCache();let y={startRow:i,startCol:u};if(h?(_=this._findInLine(a,y,f,!1),_&&_.row===i&&_.col===u||(v&&(y.startRow=v.end.y,y.startCol=v.end.x),_=this._findInLine(a,y,f,!0))):_=this._findInLine(a,y,f,p),!_){y.startCol=Math.max(y.startCol,this._terminal.cols);for(let b=i-1;b>=0&&(y.startRow=b,_=this._findInLine(a,y,f,p),!_);b--);}if(!_&&i!==this._terminal.buffer.active.baseY+this._terminal.rows)for(let b=this._terminal.buffer.active.baseY+this._terminal.rows;b>=i&&(y.startRow=b,_=this._findInLine(a,y,f,p),!_);b--);return this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0||this._resultIndex<0?this._resultIndex=this._searchResults.size-1:(this._resultIndex--,this._resultIndex===-1&&(this._resultIndex=this._searchResults.size-1))),!(_||!v)||this._selectResult(_,f==null?void 0:f.decorations,f==null?void 0:f.noScroll)}_initLinesCache(){let a=this._terminal;this._linesCache||(this._linesCache=new Array(a.buffer.active.length),this._cursorMoveListener=a.onCursorMove(()=>this._destroyLinesCache()),this._resizeListener=a.onResize(()=>this._destroyLinesCache())),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._cursorMoveListener&&(this._cursorMoveListener.dispose(),this._cursorMoveListener=void 0),this._resizeListener&&(this._resizeListener.dispose(),this._resizeListener=void 0),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(a,f,m){return(a===0||c.includes(f[a-1]))&&(a+m.length===f.length||c.includes(f[a+m.length]))}_findInLine(a,f,m={},_=!1){var i;let u=this._terminal,p=f.startRow,h=f.startCol,v=u.buffer.active.getLine(p);if(v!=null&&v.isWrapped)return _?void(f.startCol+=u.cols):(f.startRow--,f.startCol+=u.cols,this._findInLine(a,f,m));let y=(i=this._linesCache)===null||i===void 0?void 0:i[p];y||(y=this._translateBufferLineToStringWithWrap(p,!0),this._linesCache&&(this._linesCache[p]=y));let[b,w]=y,S=this._bufferColsToStringOffset(p,h),C=m.caseSensitive?a:a.toLowerCase(),L=m.caseSensitive?b:b.toLowerCase(),x=-1;if(m.regex){let R=RegExp(C,"g"),O;if(_)for(;O=R.exec(L.slice(0,S));)x=R.lastIndex-O[0].length,a=O[0],R.lastIndex-=a.length-1;else O=R.exec(L.slice(S)),O&&O[0].length>0&&(x=S+(R.lastIndex-O[0].length),a=O[0])}else _?S-C.length>=0&&(x=L.lastIndexOf(C,S-C.length)):x=L.indexOf(C,S);if(x>=0){if(m.wholeWord&&!this._isWholeWord(x,L,a))return;let R=0;for(;R<w.length-1&&x>=w[R+1];)R++;let O=R;for(;O<w.length-1&&x+a.length>=w[O+1];)O++;let I=x-w[R],N=x+a.length-w[O],F=this._stringLengthToBufferSize(p+R,I);return{term:a,col:F,row:p+R,size:this._stringLengthToBufferSize(p+O,N)-F+u.cols*(O-R)}}}_stringLengthToBufferSize(a,f){let m=this._terminal.buffer.active.getLine(a);if(!m)return 0;for(let _=0;_<f;_++){let i=m.getCell(_);if(!i)break;let u=i.getChars();u.length>1&&(f-=u.length-1);let p=m.getCell(_+1);p&&p.getWidth()===0&&f++}return f}_bufferColsToStringOffset(a,f){let m=this._terminal,_=a,i=0,u=m.buffer.active.getLine(_);for(;f>0&&u;){for(let p=0;p<f&&p<m.cols;p++){let h=u.getCell(p);if(!h)break;h.getWidth()&&(i+=h.getCode()===0?1:h.getChars().length)}if(_++,u=m.buffer.active.getLine(_),u&&!u.isWrapped)break;f-=m.cols}return i}_translateBufferLineToStringWithWrap(a,f){var m;let _=this._terminal,i=[],u=[0],p=_.buffer.active.getLine(a);for(;p;){let h=_.buffer.active.getLine(a+1),v=!!h&&h.isWrapped,y=p.translateToString(!v&&f);if(v&&h){let b=p.getCell(p.length-1);b&&b.getCode()===0&&b.getWidth()===1&&((m=h.getCell(0))===null||m===void 0?void 0:m.getWidth())===2&&(y=y.slice(0,-1))}if(i.push(y),!v)break;u.push(u[u.length-1]+y.length),a++,p=h}return[i.join(""),u]}_selectResult(a,f,m){var _,i;let u=this._terminal;if(this.clearActiveDecoration(),!a)return u.clearSelection(),!1;if(u.select(a.col,a.row,a.size),f){let p=u.registerMarker(-u.buffer.active.baseY-u.buffer.active.cursorY+a.row);p&&(this._selectedDecoration=u.registerDecoration({marker:p,x:a.col,width:a.size,backgroundColor:f.activeMatchBackground,layer:"top",overviewRulerOptions:{color:f.activeMatchColorOverviewRuler}}),(_=this._selectedDecoration)===null||_===void 0||_.onRender(h=>this._applyStyles(h,f.activeMatchBorder,!0)),(i=this._selectedDecoration)===null||i===void 0||i.onDispose(()=>p.dispose()))}if(!m&&(a.row>=u.buffer.active.viewportY+u.rows||a.row<u.buffer.active.viewportY)){let p=a.row-u.buffer.active.viewportY;p-=Math.floor(u.rows/2),u.scrollLines(p)}return!0}_applyStyles(a,f,m){a.clientWidth<=0||(a.classList.contains("xterm-find-result-decoration")||(a.classList.add("xterm-find-result-decoration"),f&&(a.style.outline=`1px solid ${f}`)),m&&a.classList.add("xterm-find-active-result-decoration"))}_createResultDecoration(a,f){var m;let _=this._terminal,i=_.registerMarker(-_.buffer.active.baseY-_.buffer.active.cursorY+a.row);if(!i)return;let u=_.registerDecoration({marker:i,x:a.col,width:a.size,backgroundColor:f.matchBackground,overviewRulerOptions:!((m=this._resultDecorations)===null||m===void 0)&&m.get(i.line)?void 0:{color:f.matchOverviewRuler,position:"center"}});return u==null||u.onRender(p=>this._applyStyles(p,f.matchBorder,!1)),u==null||u.onDispose(()=>i.dispose()),u}}o.SearchAddon=d})(),l})()})});var Bn=te((pr,yi)=>{(function(t,s){if(typeof pr=="object"&&typeof yi=="object")yi.exports=s();else if(typeof define=="function"&&define.amd)define([],s);else{var n=s();for(var l in n)(typeof pr=="object"?pr:t)[l]=n[l]}})(self,function(){return(()=>{"use strict";var t={4567:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AccessibilityManager=void 0;let c=r(9042),d=r(6114),g=r(9924),a=r(3656),f=r(844),m=r(5596),_=r(9631);class i extends f.Disposable{constructor(p,h){super(),this._terminal=p,this._renderService=h,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityTreeRoot=document.createElement("div"),this._accessibilityTreeRoot.classList.add("xterm-accessibility"),this._accessibilityTreeRoot.tabIndex=0,this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let v=0;v<this._terminal.rows;v++)this._rowElements[v]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[v]);if(this._topBoundaryFocusListener=v=>this._handleBoundaryFocus(v,0),this._bottomBoundaryFocusListener=v=>this._handleBoundaryFocus(v,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityTreeRoot.appendChild(this._rowContainer),this._renderRowsDebouncer=new g.TimeBasedDebouncer(this._renderRows.bind(this)),this._refreshRows(),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityTreeRoot.appendChild(this._liveRegion),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityTreeRoot),this.register(this._renderRowsDebouncer),this.register(this._terminal.onResize(v=>this._handleResize(v.rows))),this.register(this._terminal.onRender(v=>this._refreshRows(v.start,v.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(v=>this._handleChar(v))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(v=>this._handleTab(v))),this.register(this._terminal.onKey(v=>this._handleKey(v.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new m.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,a.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this.register((0,f.toDisposable)(()=>{(0,_.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0}))}_handleBoundaryFocus(p,h){let v=p.target,y=this._rowElements[h===0?1:this._rowElements.length-2];if(v.getAttribute("aria-posinset")===(h===0?"1":`${this._terminal.buffer.lines.length}`)||p.relatedTarget!==y)return;let b,w;if(h===0?(b=v,w=this._rowElements.pop(),this._rowContainer.removeChild(w)):(b=this._rowElements.shift(),w=v,this._rowContainer.removeChild(b)),b.removeEventListener("focus",this._topBoundaryFocusListener),w.removeEventListener("focus",this._bottomBoundaryFocusListener),h===0){let S=this._createAccessibilityTreeNode();this._rowElements.unshift(S),this._rowContainer.insertAdjacentElement("afterbegin",S)}else{let S=this._createAccessibilityTreeNode();this._rowElements.push(S),this._rowContainer.appendChild(S)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(h===0?-1:1),this._rowElements[h===0?1:this._rowElements.length-2].focus(),p.preventDefault(),p.stopImmediatePropagation()}_handleResize(p){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let h=this._rowContainer.children.length;h<this._terminal.rows;h++)this._rowElements[h]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[h]);for(;this._rowElements.length>p;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let p=document.createElement("div");return p.setAttribute("role","listitem"),p.tabIndex=-1,this._refreshRowDimensions(p),p}_handleTab(p){for(let h=0;h<p;h++)this._handleChar(" ")}_handleChar(p){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==p&&(this._charsToAnnounce+=p):this._charsToAnnounce+=p,p===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=c.tooMuchOutput)),d.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityTreeRoot.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,d.isMac&&(0,_.removeElementFromParent)(this._liveRegion)}_handleKey(p){this._clearLiveRegion(),/\p{Control}/u.test(p)||this._charsToConsume.push(p)}_refreshRows(p,h){this._renderRowsDebouncer.refresh(p,h,this._terminal.rows)}_renderRows(p,h){let v=this._terminal.buffer,y=v.lines.length.toString();for(let b=p;b<=h;b++){let w=v.translateBufferLineToString(v.ydisp+b,!0),S=(v.ydisp+b+1).toString(),C=this._rowElements[b];C&&(w.length===0?C.innerText="\xA0":C.textContent=w,C.setAttribute("aria-posinset",S),C.setAttribute("aria-setsize",y))}this._announceCharacters()}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityTreeRoot.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let p=0;p<this._terminal.rows;p++)this._refreshRowDimensions(this._rowElements[p])}}_refreshRowDimensions(p){p.style.height=`${this._renderService.dimensions.css.cell.height}px`}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}}e.AccessibilityManager=i},3614:(o,e)=>{function r(a){return a.replace(/\r?\n/g,"\r")}function c(a,f){return f?"\x1B[200~"+a+"\x1B[201~":a}function d(a,f,m){a=c(a=r(a),m.decPrivateModes.bracketedPasteMode),m.triggerDataEvent(a,!0),f.value=""}function g(a,f,m){let _=m.getBoundingClientRect(),i=a.clientX-_.left-10,u=a.clientY-_.top-10;f.style.width="20px",f.style.height="20px",f.style.left=`${i}px`,f.style.top=`${u}px`,f.style.zIndex="1000",f.focus()}Object.defineProperty(e,"__esModule",{value:!0}),e.rightClickHandler=e.moveTextAreaUnderMouseCursor=e.paste=e.handlePasteEvent=e.copyHandler=e.bracketTextForPaste=e.prepareTextForTerminal=void 0,e.prepareTextForTerminal=r,e.bracketTextForPaste=c,e.copyHandler=function(a,f){a.clipboardData&&a.clipboardData.setData("text/plain",f.selectionText),a.preventDefault()},e.handlePasteEvent=function(a,f,m){a.stopPropagation(),a.clipboardData&&d(a.clipboardData.getData("text/plain"),f,m)},e.paste=d,e.moveTextAreaUnderMouseCursor=g,e.rightClickHandler=function(a,f,m,_,i){g(a,f,m),i&&_.rightClickSelect(a),f.value=_.selectionText,f.select()}},7239:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorContrastCache=void 0;let c=r(1505);e.ColorContrastCache=class{constructor(){this._color=new c.TwoKeyMap,this._css=new c.TwoKeyMap}setCss(d,g,a){this._css.set(d,g,a)}getCss(d,g){return this._css.get(d,g)}setColor(d,g,a){this._color.set(d,g,a)}getColor(d,g){return this._color.get(d,g)}clear(){this._color.clear(),this._css.clear()}}},9631:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.removeElementFromParent=void 0,e.removeElementFromParent=function(...r){var c;for(let d of r)(c=d==null?void 0:d.parentElement)===null||c===void 0||c.removeChild(d)}},3656:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.addDisposableDomListener=void 0,e.addDisposableDomListener=function(r,c,d,g){r.addEventListener(c,d,g);let a=!1;return{dispose:()=>{a||(a=!0,r.removeEventListener(c,d,g))}}}},6465:function(o,e,r){var c=this&&this.__decorate||function(i,u,p,h){var v,y=arguments.length,b=y<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,p):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(i,u,p,h);else for(var w=i.length-1;w>=0;w--)(v=i[w])&&(b=(y<3?v(b):y>3?v(u,p,b):v(u,p))||b);return y>3&&b&&Object.defineProperty(u,p,b),b},d=this&&this.__param||function(i,u){return function(p,h){u(p,h,i)}};Object.defineProperty(e,"__esModule",{value:!0}),e.Linkifier2=void 0;let g=r(2585),a=r(8460),f=r(844),m=r(3656),_=class extends f.Disposable{constructor(i){super(),this._bufferService=i,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._activeLine=-1,this._onShowLinkUnderline=this.register(new a.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new a.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,f.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,f.toDisposable)(()=>{this._lastMouseEvent=void 0}))}get currentLink(){return this._currentLink}registerLinkProvider(i){return this._linkProviders.push(i),{dispose:()=>{let u=this._linkProviders.indexOf(i);u!==-1&&this._linkProviders.splice(u,1)}}}attachToDom(i,u,p){this._element=i,this._mouseService=u,this._renderService=p,this.register((0,m.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,m.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,m.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,m.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(i){if(this._lastMouseEvent=i,!this._element||!this._mouseService)return;let u=this._positionFromMouseEvent(i,this._element,this._mouseService);if(!u)return;this._isMouseOut=!1;let p=i.composedPath();for(let h=0;h<p.length;h++){let v=p[h];if(v.classList.contains("xterm"))break;if(v.classList.contains("xterm-hover"))return}this._lastBufferCell&&u.x===this._lastBufferCell.x&&u.y===this._lastBufferCell.y||(this._handleHover(u),this._lastBufferCell=u)}_handleHover(i){if(this._activeLine!==i.y)return this._clearCurrentLink(),void this._askForLink(i,!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,i)||(this._clearCurrentLink(),this._askForLink(i,!0))}_askForLink(i,u){var p,h;this._activeProviderReplies&&u||((p=this._activeProviderReplies)===null||p===void 0||p.forEach(y=>{y==null||y.forEach(b=>{b.link.dispose&&b.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=i.y);let v=!1;for(let[y,b]of this._linkProviders.entries())u?!((h=this._activeProviderReplies)===null||h===void 0)&&h.get(y)&&(v=this._checkLinkProviderResult(y,i,v)):b.provideLinks(i.y,w=>{var S,C;if(this._isMouseOut)return;let L=w==null?void 0:w.map(x=>({link:x}));(S=this._activeProviderReplies)===null||S===void 0||S.set(y,L),v=this._checkLinkProviderResult(y,i,v),((C=this._activeProviderReplies)===null||C===void 0?void 0:C.size)===this._linkProviders.length&&this._removeIntersectingLinks(i.y,this._activeProviderReplies)})}_removeIntersectingLinks(i,u){let p=new Set;for(let h=0;h<u.size;h++){let v=u.get(h);if(v)for(let y=0;y<v.length;y++){let b=v[y],w=b.link.range.start.y<i?0:b.link.range.start.x,S=b.link.range.end.y>i?this._bufferService.cols:b.link.range.end.x;for(let C=w;C<=S;C++){if(p.has(C)){v.splice(y--,1);break}p.add(C)}}}}_checkLinkProviderResult(i,u,p){var h;if(!this._activeProviderReplies)return p;let v=this._activeProviderReplies.get(i),y=!1;for(let b=0;b<i;b++)this._activeProviderReplies.has(b)&&!this._activeProviderReplies.get(b)||(y=!0);if(!y&&v){let b=v.find(w=>this._linkAtPosition(w.link,u));b&&(p=!0,this._handleNewLink(b))}if(this._activeProviderReplies.size===this._linkProviders.length&&!p)for(let b=0;b<this._activeProviderReplies.size;b++){let w=(h=this._activeProviderReplies.get(b))===null||h===void 0?void 0:h.find(S=>this._linkAtPosition(S.link,u));if(w){p=!0,this._handleNewLink(w);break}}return p}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(i){if(!this._element||!this._mouseService||!this._currentLink)return;let u=this._positionFromMouseEvent(i,this._element,this._mouseService);u&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,u)&&this._currentLink.link.activate(i,this._currentLink.link.text)}_clearCurrentLink(i,u){this._element&&this._currentLink&&this._lastMouseEvent&&(!i||!u||this._currentLink.link.range.start.y>=i&&this._currentLink.link.range.end.y<=u)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,f.disposeArray)(this._linkCacheDisposables))}_handleNewLink(i){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;let u=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);u&&this._linkAtPosition(i.link,u)&&(this._currentLink=i,this._currentLink.state={decorations:{underline:i.link.decorations===void 0||i.link.decorations.underline,pointerCursor:i.link.decorations===void 0||i.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,i.link,this._lastMouseEvent),i.link.decorations={},Object.defineProperties(i.link.decorations,{pointerCursor:{get:()=>{var p,h;return(h=(p=this._currentLink)===null||p===void 0?void 0:p.state)===null||h===void 0?void 0:h.decorations.pointerCursor},set:p=>{var h,v;!((h=this._currentLink)===null||h===void 0)&&h.state&&this._currentLink.state.decorations.pointerCursor!==p&&(this._currentLink.state.decorations.pointerCursor=p,this._currentLink.state.isHovered&&((v=this._element)===null||v===void 0||v.classList.toggle("xterm-cursor-pointer",p)))}},underline:{get:()=>{var p,h;return(h=(p=this._currentLink)===null||p===void 0?void 0:p.state)===null||h===void 0?void 0:h.decorations.underline},set:p=>{var h,v,y;!((h=this._currentLink)===null||h===void 0)&&h.state&&((y=(v=this._currentLink)===null||v===void 0?void 0:v.state)===null||y===void 0?void 0:y.decorations.underline)!==p&&(this._currentLink.state.decorations.underline=p,this._currentLink.state.isHovered&&this._fireUnderlineEvent(i.link,p))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(p=>{let h=p.start===0?0:p.start+1+this._bufferService.buffer.ydisp,v=this._currentLink?this._lastMouseEvent:void 0;if(this._clearCurrentLink(h,p.end+1+this._bufferService.buffer.ydisp),v&&this._element){let y=this._positionFromMouseEvent(v,this._element,this._mouseService);y&&this._askForLink(y,!1)}})))}_linkHover(i,u,p){var h;!((h=this._currentLink)===null||h===void 0)&&h.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(u,!0),this._currentLink.state.decorations.pointerCursor&&i.classList.add("xterm-cursor-pointer")),u.hover&&u.hover(p,u.text)}_fireUnderlineEvent(i,u){let p=i.range,h=this._bufferService.buffer.ydisp,v=this._createLinkUnderlineEvent(p.start.x-1,p.start.y-h-1,p.end.x,p.end.y-h-1,void 0);(u?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(v)}_linkLeave(i,u,p){var h;!((h=this._currentLink)===null||h===void 0)&&h.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(u,!1),this._currentLink.state.decorations.pointerCursor&&i.classList.remove("xterm-cursor-pointer")),u.leave&&u.leave(p,u.text)}_linkAtPosition(i,u){let p=i.range.start.y*this._bufferService.cols+i.range.start.x,h=i.range.end.y*this._bufferService.cols+i.range.end.x,v=u.y*this._bufferService.cols+u.x;return p<=v&&v<=h}_positionFromMouseEvent(i,u,p){let h=p.getCoords(i,u,this._bufferService.cols,this._bufferService.rows);if(h)return{x:h[0],y:h[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(i,u,p,h,v){return{x1:i,y1:u,x2:p,y2:h,cols:this._bufferService.cols,fg:v}}};_=c([d(0,g.IBufferService)],_),e.Linkifier2=_},9042:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.tooMuchOutput=e.promptLabel=void 0,e.promptLabel="Terminal input",e.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(o,e,r){var c=this&&this.__decorate||function(_,i,u,p){var h,v=arguments.length,y=v<3?i:p===null?p=Object.getOwnPropertyDescriptor(i,u):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(_,i,u,p);else for(var b=_.length-1;b>=0;b--)(h=_[b])&&(y=(v<3?h(y):v>3?h(i,u,y):h(i,u))||y);return v>3&&y&&Object.defineProperty(i,u,y),y},d=this&&this.__param||function(_,i){return function(u,p){i(u,p,_)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OscLinkProvider=void 0;let g=r(511),a=r(2585),f=class{constructor(_,i,u){this._bufferService=_,this._optionsService=i,this._oscLinkService=u}provideLinks(_,i){var u;let p=this._bufferService.buffer.lines.get(_-1);if(!p)return void i(void 0);let h=[],v=this._optionsService.rawOptions.linkHandler,y=new g.CellData,b=p.getTrimmedLength(),w=-1,S=-1,C=!1;for(let L=0;L<b;L++)if(S!==-1||p.hasContent(L)){if(p.loadCell(L,y),y.hasExtendedAttrs()&&y.extended.urlId){if(S===-1){S=L,w=y.extended.urlId;continue}C=y.extended.urlId!==w}else S!==-1&&(C=!0);if(C||S!==-1&&L===b-1){let x=(u=this._oscLinkService.getLinkData(w))===null||u===void 0?void 0:u.uri;if(x){let R={start:{x:S+1,y:_},end:{x:L+(C||L!==b-1?0:1),y:_}},O=!1;if(!(v!=null&&v.allowNonHttpProtocols))try{let I=new URL(x);["http:","https:"].includes(I.protocol)||(O=!0)}catch(I){O=!0}O||h.push({text:x,range:R,activate:(I,N)=>v?v.activate(I,N,R):m(0,N),hover:(I,N)=>{var F;return(F=v==null?void 0:v.hover)===null||F===void 0?void 0:F.call(v,I,N,R)},leave:(I,N)=>{var F;return(F=v==null?void 0:v.leave)===null||F===void 0?void 0:F.call(v,I,N,R)}})}C=!1,y.hasExtendedAttrs()&&y.extended.urlId?(S=L,w=y.extended.urlId):(S=-1,w=-1)}}i(h)}};function m(_,i){if(confirm(`Do you want to navigate to ${i}?

WARNING: This link could potentially be dangerous`)){let u=window.open();if(u){try{u.opener=null}catch(p){}u.location.href=i}else console.warn("Opening link blocked as opener could not be cleared")}}f=c([d(0,a.IBufferService),d(1,a.IOptionsService),d(2,a.IOscLinkService)],f),e.OscLinkProvider=f},6193:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RenderDebouncer=void 0,e.RenderDebouncer=class{constructor(r,c){this._parentWindow=r,this._renderCallback=c,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(r){return this._refreshCallbacks.push(r),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(r,c,d){this._rowCount=d,r=r!==void 0?r:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,r):r,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();let r=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(r,c),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let r of this._refreshCallbacks)r(0);this._refreshCallbacks=[]}}},5596:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ScreenDprMonitor=void 0;let c=r(844);class d extends c.Disposable{constructor(a){super(),this._parentWindow=a,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,c.toDisposable)(()=>{this.clearListener()}))}setListener(a){this._listener&&this.clearListener(),this._listener=a,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var a;this._outerListener&&((a=this._resolutionMediaMatchList)===null||a===void 0||a.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}e.ScreenDprMonitor=d},3236:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;let c=r(2950),d=r(1680),g=r(3614),a=r(2584),f=r(5435),m=r(9312),_=r(6114),i=r(3656),u=r(9042),p=r(4567),h=r(1296),v=r(7399),y=r(8460),b=r(8437),w=r(3230),S=r(4725),C=r(428),L=r(8934),x=r(6465),R=r(5114),O=r(8969),I=r(8055),N=r(4269),F=r(5941),E=r(3107),k=r(5744),T=r(9074),P=r(2585),H=r(3730),W=r(844),K=r(6731),j=typeof window!="undefined"?window.document:null;class $ extends O.CoreTerminal{constructor(A={}){super(A),this.browser=_,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new y.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new y.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new y.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new y.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new y.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new y.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new y.EventEmitter),this._onBlur=this.register(new y.EventEmitter),this._onA11yCharEmitter=this.register(new y.EventEmitter),this._onA11yTabEmitter=this.register(new y.EventEmitter),this._onWillOpen=this.register(new y.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(x.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(H.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(T.DecorationService),this._instantiationService.setService(P.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((B,M)=>this.refresh(B,M))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(B=>this._reportWindowsOptions(B))),this.register(this._inputHandler.onColor(B=>this._handleColorEvent(B))),this.register((0,y.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,y.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,y.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,y.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(B=>this._afterResize(B.cols,B.rows))),this.register((0,W.toDisposable)(()=>{var B,M;this._customKeyEventHandler=void 0,(M=(B=this.element)===null||B===void 0?void 0:B.parentNode)===null||M===void 0||M.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(A){if(this._themeService)for(let B of A){let M,U="";switch(B.index){case 256:M="foreground",U="10";break;case 257:M="background",U="11";break;case 258:M="cursor",U="12";break;default:M="ansi",U="4;"+B.index}switch(B.type){case 0:let X=I.color.toColorRGB(M==="ansi"?this._themeService.colors.ansi[B.index]:this._themeService.colors[M]);this.coreService.triggerDataEvent(`${a.C0.ESC}]${U};${(0,F.toRgbString)(X)}${a.C1_ESCAPED.ST}`);break;case 1:if(M==="ansi")this._themeService.modifyColors(z=>z.ansi[B.index]=I.rgba.toColor(...B.color));else{let z=M;this._themeService.modifyColors(J=>J[z]=I.rgba.toColor(...B.color))}break;case 2:this._themeService.restoreColor(B.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(A){var B;A?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new p.AccessibilityManager(this,this._renderService)):((B=this._accessibilityManager)===null||B===void 0||B.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(A){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(a.C0.ESC+"[I"),this.updateCursorStyle(A),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var A;return(A=this.textarea)===null||A===void 0?void 0:A.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(a.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let A=this.buffer.ybase+this.buffer.y,B=this.buffer.lines.get(A);if(!B)return;let M=Math.min(this.buffer.x,this.cols-1),U=this._renderService.dimensions.css.cell.height,X=B.getWidth(M),z=this._renderService.dimensions.css.cell.width*X,J=this.buffer.y*this._renderService.dimensions.css.cell.height,re=M*this._renderService.dimensions.css.cell.width;this.textarea.style.left=re+"px",this.textarea.style.top=J+"px",this.textarea.style.width=z+"px",this.textarea.style.height=U+"px",this.textarea.style.lineHeight=U+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,i.addDisposableDomListener)(this.element,"copy",B=>{this.hasSelection()&&(0,g.copyHandler)(B,this._selectionService)}));let A=B=>(0,g.handlePasteEvent)(B,this.textarea,this.coreService);this.register((0,i.addDisposableDomListener)(this.textarea,"paste",A)),this.register((0,i.addDisposableDomListener)(this.element,"paste",A)),_.isFirefox?this.register((0,i.addDisposableDomListener)(this.element,"mousedown",B=>{B.button===2&&(0,g.rightClickHandler)(B,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,i.addDisposableDomListener)(this.element,"contextmenu",B=>{(0,g.rightClickHandler)(B,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),_.isLinux&&this.register((0,i.addDisposableDomListener)(this.element,"auxclick",B=>{B.button===1&&(0,g.moveTextAreaUnderMouseCursor)(B,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,i.addDisposableDomListener)(this.textarea,"keyup",A=>this._keyUp(A),!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"keydown",A=>this._keyDown(A),!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"keypress",A=>this._keyPress(A),!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionupdate",A=>this._compositionHelper.compositionupdate(A))),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,i.addDisposableDomListener)(this.textarea,"input",A=>this._inputEvent(A),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(A){var B;if(!A)throw new Error("Terminal requires a parent element.");A.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=A.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),A.appendChild(this.element);let M=j.createDocumentFragment();this._viewportElement=j.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),M.appendChild(this._viewportElement),this._viewportScrollArea=j.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=j.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=j.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),M.appendChild(this.screenElement),this.textarea=j.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",u.promptLabel),_.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(R.CoreBrowserService,this.textarea,(B=this._document.defaultView)!==null&&B!==void 0?B:window),this._instantiationService.setService(S.ICoreBrowserService,this._coreBrowserService),this.register((0,i.addDisposableDomListener)(this.textarea,"focus",U=>this._handleTextAreaFocus(U))),this.register((0,i.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(C.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(S.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(K.ThemeService),this._instantiationService.setService(S.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(N.CharacterJoinerService),this._instantiationService.setService(S.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(w.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(S.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(U=>this._onRender.fire(U))),this.onResize(U=>this._renderService.resize(U.cols,U.rows)),this._compositionView=j.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(c.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(M);try{this._onWillOpen.fire(this.element)}catch(U){}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(L.MouseService),this._instantiationService.setService(S.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(d.Viewport,U=>this.scrollLines(U,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(m.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(S.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(U=>this.scrollLines(U.amount,U.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(U=>this._renderService.handleSelectionChanged(U.start,U.end,U.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(U=>{this.textarea.value=U,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(U=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,i.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(E.BufferDecorationRenderer,this.screenElement)),this.register((0,i.addDisposableDomListener)(this.element,"mousedown",U=>this._selectionService.handleMouseDown(U))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new p.AccessibilityManager(this,this._renderService)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",U=>this._handleScreenReaderModeOptionChange(U))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(k.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",U=>{!this._overviewRulerRenderer&&U&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(k.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(h.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){let A=this,B=this.element;function M(z){let J=A._mouseService.getMouseReportCoords(z,A.screenElement);if(!J)return!1;let re,ee;switch(z.overrideType||z.type){case"mousemove":ee=32,z.buttons===void 0?(re=3,z.button!==void 0&&(re=z.button<3?z.button:3)):re=1&z.buttons?0:4&z.buttons?1:2&z.buttons?2:3;break;case"mouseup":ee=0,re=z.button<3?z.button:3;break;case"mousedown":ee=1,re=z.button<3?z.button:3;break;case"wheel":if(A.viewport.getLinesScrolled(z)===0)return!1;ee=z.deltaY<0?0:1,re=4;break;default:return!1}return!(ee===void 0||re===void 0||re>4)&&A.coreMouseService.triggerMouseEvent({col:J.col,row:J.row,x:J.x,y:J.y,button:re,action:ee,ctrl:z.ctrlKey,alt:z.altKey,shift:z.shiftKey})}let U={mouseup:null,wheel:null,mousedrag:null,mousemove:null},X={mouseup:z=>(M(z),z.buttons||(this._document.removeEventListener("mouseup",U.mouseup),U.mousedrag&&this._document.removeEventListener("mousemove",U.mousedrag)),this.cancel(z)),wheel:z=>(M(z),this.cancel(z,!0)),mousedrag:z=>{z.buttons&&M(z)},mousemove:z=>{z.buttons||M(z)}};this.register(this.coreMouseService.onProtocolChange(z=>{z?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(z)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&z?U.mousemove||(B.addEventListener("mousemove",X.mousemove),U.mousemove=X.mousemove):(B.removeEventListener("mousemove",U.mousemove),U.mousemove=null),16&z?U.wheel||(B.addEventListener("wheel",X.wheel,{passive:!1}),U.wheel=X.wheel):(B.removeEventListener("wheel",U.wheel),U.wheel=null),2&z?U.mouseup||(U.mouseup=X.mouseup):(this._document.removeEventListener("mouseup",U.mouseup),U.mouseup=null),4&z?U.mousedrag||(U.mousedrag=X.mousedrag):(this._document.removeEventListener("mousemove",U.mousedrag),U.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,i.addDisposableDomListener)(B,"mousedown",z=>{if(z.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(z))return M(z),U.mouseup&&this._document.addEventListener("mouseup",U.mouseup),U.mousedrag&&this._document.addEventListener("mousemove",U.mousedrag),this.cancel(z)})),this.register((0,i.addDisposableDomListener)(B,"wheel",z=>{if(!U.wheel){if(!this.buffer.hasScrollback){let J=this.viewport.getLinesScrolled(z);if(J===0)return;let re=a.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(z.deltaY<0?"A":"B"),ee="";for(let G=0;G<Math.abs(J);G++)ee+=re;return this.coreService.triggerDataEvent(ee,!0),this.cancel(z,!0)}return this.viewport.handleWheel(z)?this.cancel(z):void 0}},{passive:!1})),this.register((0,i.addDisposableDomListener)(B,"touchstart",z=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(z),this.cancel(z)},{passive:!0})),this.register((0,i.addDisposableDomListener)(B,"touchmove",z=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(z)?void 0:this.cancel(z)},{passive:!1}))}refresh(A,B){var M;(M=this._renderService)===null||M===void 0||M.refreshRows(A,B)}updateCursorStyle(A){var B;!((B=this._selectionService)===null||B===void 0)&&B.shouldColumnSelect(A)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(A,B,M=0){super.scrollLines(A,B,M),this.refresh(0,this.rows-1)}paste(A){(0,g.paste)(A,this.textarea,this.coreService)}attachCustomKeyEventHandler(A){this._customKeyEventHandler=A}registerLinkProvider(A){return this.linkifier2.registerLinkProvider(A)}registerCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let B=this._characterJoinerService.register(A);return this.refresh(0,this.rows-1),B}deregisterCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(A)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(A){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+A)}registerDecoration(A){return this._decorationService.registerDecoration(A)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(A,B,M){this._selectionService.setSelection(A,B,M)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var A;(A=this._selectionService)===null||A===void 0||A.clearSelection()}selectAll(){var A;(A=this._selectionService)===null||A===void 0||A.selectAll()}selectLines(A,B){var M;(M=this._selectionService)===null||M===void 0||M.selectLines(A,B)}_keyDown(A){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;let B=this.browser.isMac&&this.options.macOptionIsMeta&&A.altKey;if(!B&&!this._compositionHelper.keydown(A))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;B||A.key!=="Dead"&&A.key!=="AltGraph"||(this._unprocessedDeadKey=!0);let M=(0,v.evaluateKeyboardEvent)(A,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(A),M.type===3||M.type===2){let U=this.rows-1;return this.scrollLines(M.type===2?-U:U),this.cancel(A,!0)}return M.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,A)||(M.cancel&&this.cancel(A,!0),!M.key||!!(A.key&&!A.ctrlKey&&!A.altKey&&!A.metaKey&&A.key.length===1&&A.key.charCodeAt(0)>=65&&A.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(M.key!==a.C0.ETX&&M.key!==a.C0.CR||(this.textarea.value=""),this._onKey.fire({key:M.key,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(M.key,!0),!this.optionsService.rawOptions.screenReaderMode||A.altKey||A.ctrlKey?this.cancel(A,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(A,B){let M=A.isMac&&!this.options.macOptionIsMeta&&B.altKey&&!B.ctrlKey&&!B.metaKey||A.isWindows&&B.altKey&&B.ctrlKey&&!B.metaKey||A.isWindows&&B.getModifierState("AltGraph");return B.type==="keypress"?M:M&&(!B.keyCode||B.keyCode>47)}_keyUp(A){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1||(function(B){return B.keyCode===16||B.keyCode===17||B.keyCode===18}(A)||this.focus(),this.updateCursorStyle(A),this._keyPressHandled=!1)}_keyPress(A){let B;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;if(this.cancel(A),A.charCode)B=A.charCode;else if(A.which===null||A.which===void 0)B=A.keyCode;else{if(A.which===0||A.charCode===0)return!1;B=A.which}return!(!B||(A.altKey||A.ctrlKey||A.metaKey)&&!this._isThirdLevelShift(this.browser,A)||(B=String.fromCharCode(B),this._onKey.fire({key:B,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(B,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(A){if(A.data&&A.inputType==="insertText"&&(!A.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let B=A.data;return this.coreService.triggerDataEvent(B,!0),this.cancel(A),!0}return!1}resize(A,B){A!==this.cols||B!==this.rows?super.resize(A,B):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(A,B){var M,U;(M=this._charSizeService)===null||M===void 0||M.measure(),(U=this.viewport)===null||U===void 0||U.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let A=1;A<this.rows;A++)this.buffer.lines.push(this.buffer.getBlankLine(b.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var A,B;this.options.rows=this.rows,this.options.cols=this.cols;let M=this._customKeyEventHandler;this._setup(),super.reset(),(A=this._selectionService)===null||A===void 0||A.reset(),this._decorationService.reset(),this._customKeyEventHandler=M,this.refresh(0,this.rows-1),(B=this.viewport)===null||B===void 0||B.syncScrollArea()}clearTextureAtlas(){var A;(A=this._renderService)===null||A===void 0||A.clearTextureAtlas()}_reportFocus(){var A;!((A=this.element)===null||A===void 0)&&A.classList.contains("focus")?this.coreService.triggerDataEvent(a.C0.ESC+"[I"):this.coreService.triggerDataEvent(a.C0.ESC+"[O")}_reportWindowsOptions(A){if(this._renderService)switch(A){case f.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:let B=this._renderService.dimensions.css.canvas.width.toFixed(0),M=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${a.C0.ESC}[4;${M};${B}t`);break;case f.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:let U=this._renderService.dimensions.css.cell.width.toFixed(0),X=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${a.C0.ESC}[6;${X};${U}t`)}}cancel(A,B){if(this.options.cancelEvents||B)return A.preventDefault(),A.stopPropagation(),!1}}e.Terminal=$},9924:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TimeBasedDebouncer=void 0,e.TimeBasedDebouncer=class{constructor(r,c=1e3){this._renderCallback=r,this._debounceThresholdMS=c,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(r,c,d){this._rowCount=d,r=r!==void 0?r:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,r):r,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c;let g=Date.now();if(g-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=g,this._innerRefresh();else if(!this._additionalRefreshRequested){let a=g-this._lastRefreshMs,f=this._debounceThresholdMS-a;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},f)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let r=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(r,c)}}},1680:function(o,e,r){var c=this&&this.__decorate||function(i,u,p,h){var v,y=arguments.length,b=y<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,p):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(i,u,p,h);else for(var w=i.length-1;w>=0;w--)(v=i[w])&&(b=(y<3?v(b):y>3?v(u,p,b):v(u,p))||b);return y>3&&b&&Object.defineProperty(u,p,b),b},d=this&&this.__param||function(i,u){return function(p,h){u(p,h,i)}};Object.defineProperty(e,"__esModule",{value:!0}),e.Viewport=void 0;let g=r(844),a=r(3656),f=r(4725),m=r(2585),_=class extends g.Disposable{constructor(i,u,p,h,v,y,b,w,S){super(),this._scrollLines=i,this._viewportElement=u,this._scrollArea=p,this._bufferService=h,this._optionsService=v,this._charSizeService=y,this._renderService=b,this._coreBrowserService=w,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,a.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(C=>this._activeBuffer=C.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(C=>this._renderDimensions=C)),this._handleThemeChange(S.colors),this.register(S.onChangeColors(C=>this._handleThemeChange(C))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(i){this._viewportElement.style.backgroundColor=i.background.css}_refresh(i){if(i)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;let u=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==u&&(this._lastRecordedBufferHeight=u,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}let i=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==i&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=i),this._refreshAnimationFrame=null}syncScrollArea(i=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(i);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(i)}_handleScroll(i){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);let u=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(u)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;let i=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(i*(this._smoothScrollState.target-this._smoothScrollState.origin)),i<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(i,u){let p=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(u<0&&this._viewportElement.scrollTop!==0||u>0&&p<this._lastRecordedBufferHeight)||(i.cancelable&&i.preventDefault(),!1)}handleWheel(i){let u=this._getPixelsScrolled(i);return u!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+u:this._smoothScrollState.target+=u,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=u,this._bubbleScroll(i,u))}_getPixelsScrolled(i){if(i.deltaY===0||i.shiftKey)return 0;let u=this._applyScrollModifier(i.deltaY,i);return i.deltaMode===WheelEvent.DOM_DELTA_LINE?u*=this._currentRowHeight:i.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(u*=this._currentRowHeight*this._bufferService.rows),u}getLinesScrolled(i){if(i.deltaY===0||i.shiftKey)return 0;let u=this._applyScrollModifier(i.deltaY,i);return i.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(u/=this._currentRowHeight+0,this._wheelPartialScroll+=u,u=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):i.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(u*=this._bufferService.rows),u}_applyScrollModifier(i,u){let p=this._optionsService.rawOptions.fastScrollModifier;return p==="alt"&&u.altKey||p==="ctrl"&&u.ctrlKey||p==="shift"&&u.shiftKey?i*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:i*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(i){this._lastTouchY=i.touches[0].pageY}handleTouchMove(i){let u=this._lastTouchY-i.touches[0].pageY;return this._lastTouchY=i.touches[0].pageY,u!==0&&(this._viewportElement.scrollTop+=u,this._bubbleScroll(i,u))}};_=c([d(3,m.IBufferService),d(4,m.IOptionsService),d(5,f.ICharSizeService),d(6,f.IRenderService),d(7,f.ICoreBrowserService),d(8,f.IThemeService)],_),e.Viewport=_},3107:function(o,e,r){var c=this&&this.__decorate||function(i,u,p,h){var v,y=arguments.length,b=y<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,p):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(i,u,p,h);else for(var w=i.length-1;w>=0;w--)(v=i[w])&&(b=(y<3?v(b):y>3?v(u,p,b):v(u,p))||b);return y>3&&b&&Object.defineProperty(u,p,b),b},d=this&&this.__param||function(i,u){return function(p,h){u(p,h,i)}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferDecorationRenderer=void 0;let g=r(3656),a=r(4725),f=r(844),m=r(2585),_=class extends f.Disposable{constructor(i,u,p,h){super(),this._screenElement=i,this._bufferService=u,this._decorationService=p,this._renderService=h,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,g.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(v=>this._removeDecoration(v))),this.register((0,f.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let i of this._decorationService.decorations)this._renderDecoration(i);this._dimensionsChanged=!1}_renderDecoration(i){this._refreshStyle(i),this._dimensionsChanged&&this._refreshXPosition(i)}_createElement(i){var u;let p=document.createElement("div");p.classList.add("xterm-decoration"),p.style.width=`${Math.round((i.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,p.style.height=(i.options.height||1)*this._renderService.dimensions.css.cell.height+"px",p.style.top=(i.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",p.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let h=(u=i.options.x)!==null&&u!==void 0?u:0;return h&&h>this._bufferService.cols&&(p.style.display="none"),this._refreshXPosition(i,p),p}_refreshStyle(i){let u=i.marker.line-this._bufferService.buffers.active.ydisp;if(u<0||u>=this._bufferService.rows)i.element&&(i.element.style.display="none",i.onRenderEmitter.fire(i.element));else{let p=this._decorationElements.get(i);p||(p=this._createElement(i),i.element=p,this._decorationElements.set(i,p),this._container.appendChild(p)),p.style.top=u*this._renderService.dimensions.css.cell.height+"px",p.style.display=this._altBufferIsActive?"none":"block",i.onRenderEmitter.fire(p)}}_refreshXPosition(i,u=i.element){var p;if(!u)return;let h=(p=i.options.x)!==null&&p!==void 0?p:0;(i.options.anchor||"left")==="right"?u.style.right=h?h*this._renderService.dimensions.css.cell.width+"px":"":u.style.left=h?h*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(i){var u;(u=this._decorationElements.get(i))===null||u===void 0||u.remove(),this._decorationElements.delete(i),i.dispose()}};_=c([d(1,m.IBufferService),d(2,m.IDecorationService),d(3,a.IRenderService)],_),e.BufferDecorationRenderer=_},5871:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorZoneStore=void 0,e.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(r){if(r.options.overviewRulerOptions){for(let c of this._zones)if(c.color===r.options.overviewRulerOptions.color&&c.position===r.options.overviewRulerOptions.position){if(this._lineIntersectsZone(c,r.marker.line))return;if(this._lineAdjacentToZone(c,r.marker.line,r.options.overviewRulerOptions.position))return void this._addLineToZone(c,r.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=r.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=r.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=r.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=r.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:r.options.overviewRulerOptions.color,position:r.options.overviewRulerOptions.position,startBufferLine:r.marker.line,endBufferLine:r.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(r){this._linePadding=r}_lineIntersectsZone(r,c){return c>=r.startBufferLine&&c<=r.endBufferLine}_lineAdjacentToZone(r,c,d){return c>=r.startBufferLine-this._linePadding[d||"full"]&&c<=r.endBufferLine+this._linePadding[d||"full"]}_addLineToZone(r,c){r.startBufferLine=Math.min(r.startBufferLine,c),r.endBufferLine=Math.max(r.endBufferLine,c)}}},5744:function(o,e,r){var c=this&&this.__decorate||function(v,y,b,w){var S,C=arguments.length,L=C<3?y:w===null?w=Object.getOwnPropertyDescriptor(y,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(v,y,b,w);else for(var x=v.length-1;x>=0;x--)(S=v[x])&&(L=(C<3?S(L):C>3?S(y,b,L):S(y,b))||L);return C>3&&L&&Object.defineProperty(y,b,L),L},d=this&&this.__param||function(v,y){return function(b,w){y(b,w,v)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OverviewRulerRenderer=void 0;let g=r(5871),a=r(3656),f=r(4725),m=r(844),_=r(2585),i={full:0,left:0,center:0,right:0},u={full:0,left:0,center:0,right:0},p={full:0,left:0,center:0,right:0},h=class extends m.Disposable{constructor(v,y,b,w,S,C,L){var x;super(),this._viewportElement=v,this._screenElement=y,this._bufferService=b,this._decorationService=w,this._renderService=S,this._optionsService=C,this._coreBrowseService=L,this._colorZoneStore=new g.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(x=this._viewportElement.parentElement)===null||x===void 0||x.insertBefore(this._canvas,this._viewportElement);let R=this._canvas.getContext("2d");if(!R)throw new Error("Ctx cannot be null");this._ctx=R,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,m.toDisposable)(()=>{var O;(O=this._canvas)===null||O===void 0||O.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,a.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){let v=Math.floor(this._canvas.width/3),y=Math.ceil(this._canvas.width/3);u.full=this._canvas.width,u.left=v,u.center=y,u.right=v,this._refreshDrawHeightConstants(),p.full=0,p.left=0,p.center=u.left,p.right=u.left+u.center}_refreshDrawHeightConstants(){i.full=Math.round(2*this._coreBrowseService.dpr);let v=this._canvas.height/this._bufferService.buffer.lines.length,y=Math.round(Math.max(Math.min(v,12),6)*this._coreBrowseService.dpr);i.left=y,i.center=y,i.right=y}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let y of this._decorationService.decorations)this._colorZoneStore.addDecoration(y);this._ctx.lineWidth=1;let v=this._colorZoneStore.zones;for(let y of v)y.position!=="full"&&this._renderColorZone(y);for(let y of v)y.position==="full"&&this._renderColorZone(y);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(v){this._ctx.fillStyle=v.color,this._ctx.fillRect(p[v.position||"full"],Math.round((this._canvas.height-1)*(v.startBufferLine/this._bufferService.buffers.active.lines.length)-i[v.position||"full"]/2),u[v.position||"full"],Math.round((this._canvas.height-1)*((v.endBufferLine-v.startBufferLine)/this._bufferService.buffers.active.lines.length)+i[v.position||"full"]))}_queueRefresh(v,y){this._shouldUpdateDimensions=v||this._shouldUpdateDimensions,this._shouldUpdateAnchor=y||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};h=c([d(2,_.IBufferService),d(3,_.IDecorationService),d(4,f.IRenderService),d(5,_.IOptionsService),d(6,f.ICoreBrowserService)],h),e.OverviewRulerRenderer=h},2950:function(o,e,r){var c=this&&this.__decorate||function(_,i,u,p){var h,v=arguments.length,y=v<3?i:p===null?p=Object.getOwnPropertyDescriptor(i,u):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(_,i,u,p);else for(var b=_.length-1;b>=0;b--)(h=_[b])&&(y=(v<3?h(y):v>3?h(i,u,y):h(i,u))||y);return v>3&&y&&Object.defineProperty(i,u,y),y},d=this&&this.__param||function(_,i){return function(u,p){i(u,p,_)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CompositionHelper=void 0;let g=r(4725),a=r(2585),f=r(2584),m=class{constructor(_,i,u,p,h,v){this._textarea=_,this._compositionView=i,this._bufferService=u,this._optionsService=p,this._coreService=h,this._renderService=v,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(_){this._compositionView.textContent=_.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(_){if(this._isComposing||this._isSendingComposition){if(_.keyCode===229||_.keyCode===16||_.keyCode===17||_.keyCode===18)return!1;this._finalizeComposition(!1)}return _.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(_){if(this._compositionView.classList.remove("active"),this._isComposing=!1,_){let i={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let u;this._isSendingComposition=!1,i.start+=this._dataAlreadySent.length,u=this._isComposing?this._textarea.value.substring(i.start,i.end):this._textarea.value.substring(i.start),u.length>0&&this._coreService.triggerDataEvent(u,!0)}},0)}else{this._isSendingComposition=!1;let i=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(i,!0)}}_handleAnyTextareaChanges(){let _=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let i=this._textarea.value,u=i.replace(_,"");this._dataAlreadySent=u,i.length>_.length?this._coreService.triggerDataEvent(u,!0):i.length<_.length?this._coreService.triggerDataEvent(`${f.C0.DEL}`,!0):i.length===_.length&&i!==_&&this._coreService.triggerDataEvent(i,!0)}},0)}updateCompositionElements(_){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let i=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),u=this._renderService.dimensions.css.cell.height,p=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,h=i*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=h+"px",this._compositionView.style.top=p+"px",this._compositionView.style.height=u+"px",this._compositionView.style.lineHeight=u+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let v=this._compositionView.getBoundingClientRect();this._textarea.style.left=h+"px",this._textarea.style.top=p+"px",this._textarea.style.width=Math.max(v.width,1)+"px",this._textarea.style.height=Math.max(v.height,1)+"px",this._textarea.style.lineHeight=v.height+"px"}_||setTimeout(()=>this.updateCompositionElements(!0),0)}}};m=c([d(2,a.IBufferService),d(3,a.IOptionsService),d(4,a.ICoreService),d(5,g.IRenderService)],m),e.CompositionHelper=m},9806:(o,e)=>{function r(c,d,g){let a=g.getBoundingClientRect(),f=c.getComputedStyle(g),m=parseInt(f.getPropertyValue("padding-left")),_=parseInt(f.getPropertyValue("padding-top"));return[d.clientX-a.left-m,d.clientY-a.top-_]}Object.defineProperty(e,"__esModule",{value:!0}),e.getCoords=e.getCoordsRelativeToElement=void 0,e.getCoordsRelativeToElement=r,e.getCoords=function(c,d,g,a,f,m,_,i,u){if(!m)return;let p=r(c,d,g);return p?(p[0]=Math.ceil((p[0]+(u?_/2:0))/_),p[1]=Math.ceil(p[1]/i),p[0]=Math.min(Math.max(p[0],1),a+(u?1:0)),p[1]=Math.min(Math.max(p[1],1),f),p):void 0}},9504:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.moveToCellSequence=void 0;let c=r(2584);function d(i,u,p,h){let v=i-g(i,p),y=u-g(u,p),b=Math.abs(v-y)-function(w,S,C){let L=0,x=w-g(w,C),R=S-g(S,C);for(let O=0;O<Math.abs(x-R);O++){let I=a(w,S)==="A"?-1:1,N=C.buffer.lines.get(x+I*O);N!=null&&N.isWrapped&&L++}return L}(i,u,p);return _(b,m(a(i,u),h))}function g(i,u){let p=0,h=u.buffer.lines.get(i),v=h==null?void 0:h.isWrapped;for(;v&&i>=0&&i<u.rows;)p++,h=u.buffer.lines.get(--i),v=h==null?void 0:h.isWrapped;return p}function a(i,u){return i>u?"A":"B"}function f(i,u,p,h,v,y){let b=i,w=u,S="";for(;b!==p||w!==h;)b+=v?1:-1,v&&b>y.cols-1?(S+=y.buffer.translateBufferLineToString(w,!1,i,b),b=0,i=0,w++):!v&&b<0&&(S+=y.buffer.translateBufferLineToString(w,!1,0,i+1),b=y.cols-1,i=b,w--);return S+y.buffer.translateBufferLineToString(w,!1,i,b)}function m(i,u){let p=u?"O":"[";return c.C0.ESC+p+i}function _(i,u){i=Math.floor(i);let p="";for(let h=0;h<i;h++)p+=u;return p}e.moveToCellSequence=function(i,u,p,h){let v=p.buffer.x,y=p.buffer.y;if(!p.buffer.hasScrollback)return function(S,C,L,x,R,O){return d(C,x,R,O).length===0?"":_(f(S,C,S,C-g(C,R),!1,R).length,m("D",O))}(v,y,0,u,p,h)+d(y,u,p,h)+function(S,C,L,x,R,O){let I;I=d(C,x,R,O).length>0?x-g(x,R):C;let N=x,F=function(E,k,T,P,H,W){let K;return K=d(T,P,H,W).length>0?P-g(P,H):k,E<T&&K<=P||E>=T&&K<P?"C":"D"}(S,C,L,x,R,O);return _(f(S,I,L,N,F==="C",R).length,m(F,O))}(v,y,i,u,p,h);let b;if(y===u)return b=v>i?"D":"C",_(Math.abs(v-i),m(b,h));b=y>u?"D":"C";let w=Math.abs(y-u);return _(function(S,C){return C.cols-S}(y>u?i:v,p)+(w-1)*p.cols+1+((y>u?v:i)-1),m(b,h))}},1296:function(o,e,r){var c=this&&this.__decorate||function(S,C,L,x){var R,O=arguments.length,I=O<3?C:x===null?x=Object.getOwnPropertyDescriptor(C,L):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(S,C,L,x);else for(var N=S.length-1;N>=0;N--)(R=S[N])&&(I=(O<3?R(I):O>3?R(C,L,I):R(C,L))||I);return O>3&&I&&Object.defineProperty(C,L,I),I},d=this&&this.__param||function(S,C){return function(L,x){C(L,x,S)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomRenderer=void 0;let g=r(9631),a=r(3787),f=r(2223),m=r(6171),_=r(4725),i=r(8055),u=r(8460),p=r(844),h=r(2585),v="xterm-dom-renderer-owner-",y="xterm-focus",b=1,w=class extends p.Disposable{constructor(S,C,L,x,R,O,I,N,F,E){super(),this._element=S,this._screenElement=C,this._viewportElement=L,this._linkifier2=x,this._charSizeService=O,this._optionsService=I,this._bufferService=N,this._coreBrowserService=F,this._terminalClass=b++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new u.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,m.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(E.onChangeColors(k=>this._injectCss(k))),this._injectCss(E.colors),this._rowFactory=R.createInstance(a.DomRendererRowFactory,document),this._element.classList.add(v+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(k=>this._handleLinkHover(k))),this.register(this._linkifier2.onHideLinkUnderline(k=>this._handleLinkLeave(k))),this.register((0,p.toDisposable)(()=>{this._element.classList.remove(v+this._terminalClass),(0,g.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement)}))}_updateDimensions(){let S=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*S,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*S),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/S),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/S),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let L of this._rowElements)L.style.width=`${this.dimensions.css.canvas.width}px`,L.style.height=`${this.dimensions.css.cell.height}px`,L.style.lineHeight=`${this.dimensions.css.cell.height}px`,L.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let C=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=C,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(S){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let C=`${this._terminalSelector} .xterm-rows { color: ${S.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;C+=`${this._terminalSelector} span:not(.${a.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${a.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${a.ITALIC_CLASS} { font-style: italic;}`,C+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",C+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${S.cursor.css};  color: ${S.cursorAccent.css}; } 50% {  background-color: ${S.cursorAccent.css};  color: ${S.cursor.css}; }}`,C+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_BLOCK_CLASS} { outline: 1px solid ${S.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${a.CURSOR_CLASS}.${a.CURSOR_BLINK_CLASS}:not(.${a.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${a.CURSOR_CLASS}.${a.CURSOR_BLINK_CLASS}.${a.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${S.cursor.css}; color: ${S.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${S.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${S.cursor.css} inset;}`,C+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${S.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${S.selectionInactiveBackgroundOpaque.css};}`;for(let[L,x]of S.ansi.entries())C+=`${this._terminalSelector} .xterm-fg-${L} { color: ${x.css}; }${this._terminalSelector} .xterm-bg-${L} { background-color: ${x.css}; }`;C+=`${this._terminalSelector} .xterm-fg-${f.INVERTED_DEFAULT_COLOR} { color: ${i.color.opaque(S.background).css}; }${this._terminalSelector} .xterm-bg-${f.INVERTED_DEFAULT_COLOR} { background-color: ${S.foreground.css}; }`,this._themeStyleElement.textContent=C}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(S,C){for(let L=this._rowElements.length;L<=C;L++){let x=document.createElement("div");this._rowContainer.appendChild(x),this._rowElements.push(x)}for(;this._rowElements.length>C;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(S,C){this._refreshRowElements(S,C),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(y)}handleFocus(){this._rowContainer.classList.add(y)}handleSelectionChanged(S,C,L){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(S,C,L),this.renderRows(0,this._bufferService.rows-1),!S||!C)return;let x=S[1]-this._bufferService.buffer.ydisp,R=C[1]-this._bufferService.buffer.ydisp,O=Math.max(x,0),I=Math.min(R,this._bufferService.rows-1);if(O>=this._bufferService.rows||I<0)return;let N=document.createDocumentFragment();if(L){let F=S[0]>C[0];N.appendChild(this._createSelectionElement(O,F?C[0]:S[0],F?S[0]:C[0],I-O+1))}else{let F=x===O?S[0]:0,E=O===R?C[0]:this._bufferService.cols;N.appendChild(this._createSelectionElement(O,F,E));let k=I-O-1;if(N.appendChild(this._createSelectionElement(O+1,0,this._bufferService.cols,k)),O!==I){let T=R===I?C[0]:this._bufferService.cols;N.appendChild(this._createSelectionElement(I,0,T))}}this._selectionContainer.appendChild(N)}_createSelectionElement(S,C,L,x=1){let R=document.createElement("div");return R.style.height=x*this.dimensions.css.cell.height+"px",R.style.top=S*this.dimensions.css.cell.height+"px",R.style.left=C*this.dimensions.css.cell.width+"px",R.style.width=this.dimensions.css.cell.width*(L-C)+"px",R}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions()}clear(){for(let S of this._rowElements)S.replaceChildren()}renderRows(S,C){let L=this._bufferService.buffer.ybase+this._bufferService.buffer.y,x=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),R=this._optionsService.rawOptions.cursorBlink;for(let O=S;O<=C;O++){let I=this._rowElements[O],N=O+this._bufferService.buffer.ydisp,F=this._bufferService.buffer.lines.get(N),E=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[O]&&this._cellToRowElements[O].length===this._bufferService.cols||(this._cellToRowElements[O]=new Int16Array(this._bufferService.cols)),I.replaceChildren(this._rowFactory.createRow(F,N,N===L,E,x,R,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[O]))}}get _terminalSelector(){return`.${v}${this._terminalClass}`}_handleLinkHover(S){this._setCellUnderline(S.x1,S.x2,S.y1,S.y2,S.cols,!0)}_handleLinkLeave(S){this._setCellUnderline(S.x1,S.x2,S.y1,S.y2,S.cols,!1)}_setCellUnderline(S,C,L,x,R,O){if(S=this._cellToRowElements[L][S],C=this._cellToRowElements[x][C],S!==-1&&C!==-1)for(;S!==C||L!==x;){let I=this._rowElements[L];if(!I)return;let N=I.children[S];N&&(N.style.textDecoration=O?"underline":"none"),++S>=R&&(S=0,L++)}}};w=c([d(4,h.IInstantiationService),d(5,_.ICharSizeService),d(6,h.IOptionsService),d(7,h.IBufferService),d(8,_.ICoreBrowserService),d(9,_.IThemeService)],w),e.DomRenderer=w},3787:function(o,e,r){var c=this&&this.__decorate||function(b,w,S,C){var L,x=arguments.length,R=x<3?w:C===null?C=Object.getOwnPropertyDescriptor(w,S):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(b,w,S,C);else for(var O=b.length-1;O>=0;O--)(L=b[O])&&(R=(x<3?L(R):x>3?L(w,S,R):L(w,S))||R);return x>3&&R&&Object.defineProperty(w,S,R),R},d=this&&this.__param||function(b,w){return function(S,C){w(S,C,b)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomRendererRowFactory=e.CURSOR_STYLE_UNDERLINE_CLASS=e.CURSOR_STYLE_BAR_CLASS=e.CURSOR_STYLE_BLOCK_CLASS=e.CURSOR_BLINK_CLASS=e.CURSOR_CLASS=e.STRIKETHROUGH_CLASS=e.UNDERLINE_CLASS=e.ITALIC_CLASS=e.DIM_CLASS=e.BOLD_CLASS=void 0;let g=r(2223),a=r(643),f=r(511),m=r(2585),_=r(8055),i=r(4725),u=r(4269),p=r(6171),h=r(3734);e.BOLD_CLASS="xterm-bold",e.DIM_CLASS="xterm-dim",e.ITALIC_CLASS="xterm-italic",e.UNDERLINE_CLASS="xterm-underline",e.STRIKETHROUGH_CLASS="xterm-strikethrough",e.CURSOR_CLASS="xterm-cursor",e.CURSOR_BLINK_CLASS="xterm-cursor-blink",e.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",e.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",e.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let v=class{constructor(b,w,S,C,L,x,R){this._document=b,this._characterJoinerService=w,this._optionsService=S,this._coreBrowserService=C,this._coreService=L,this._decorationService=x,this._themeService=R,this._workCell=new f.CellData,this._columnSelectMode=!1}handleSelectionChanged(b,w,S){this._selectionStart=b,this._selectionEnd=w,this._columnSelectMode=S}createRow(b,w,S,C,L,x,R,O,I){let N=this._document.createDocumentFragment(),F=this._characterJoinerService.getJoinedCharacters(w),E=0;for(let H=Math.min(b.length,O)-1;H>=0;H--)if(b.loadCell(H,this._workCell).getCode()!==a.NULL_CELL_CODE||S&&H===L){E=H+1;break}let k=this._themeService.colors,T=-1,P=0;for(;P<E;P++){b.loadCell(P,this._workCell);let H=this._workCell.getWidth();if(H===0){I[P]=T;continue}let W=!1,K=P,j=this._workCell;if(F.length>0&&P===F[0][0]){W=!0;let G=F.shift();j=new u.JoinedCellData(this._workCell,b.translateToString(!0,G[0],G[1]),G[1]-G[0]),K=G[1]-1,H=j.getWidth()}let $=this._document.createElement("span");if(H>1&&($.style.width=R*H+"px"),W&&($.style.display="inline",L>=P&&L<=K&&(L=P)),!this._coreService.isCursorHidden&&S&&P===L)switch($.classList.add(e.CURSOR_CLASS),x&&$.classList.add(e.CURSOR_BLINK_CLASS),C){case"bar":$.classList.add(e.CURSOR_STYLE_BAR_CLASS);break;case"underline":$.classList.add(e.CURSOR_STYLE_UNDERLINE_CLASS);break;default:$.classList.add(e.CURSOR_STYLE_BLOCK_CLASS)}if(j.isBold()&&$.classList.add(e.BOLD_CLASS),j.isItalic()&&$.classList.add(e.ITALIC_CLASS),j.isDim()&&$.classList.add(e.DIM_CLASS),j.isInvisible()?$.textContent=a.WHITESPACE_CELL_CHAR:$.textContent=j.getChars()||a.WHITESPACE_CELL_CHAR,j.isUnderline()&&($.classList.add(`${e.UNDERLINE_CLASS}-${j.extended.underlineStyle}`),$.textContent===" "&&($.textContent="\xA0"),!j.isUnderlineColorDefault()))if(j.isUnderlineColorRGB())$.style.textDecorationColor=`rgb(${h.AttributeData.toColorRGB(j.getUnderlineColor()).join(",")})`;else{let G=j.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&j.isBold()&&G<8&&(G+=8),$.style.textDecorationColor=k.ansi[G].css}j.isStrikethrough()&&$.classList.add(e.STRIKETHROUGH_CLASS);let D=j.getFgColor(),A=j.getFgColorMode(),B=j.getBgColor(),M=j.getBgColorMode(),U=!!j.isInverse();if(U){let G=D;D=B,B=G;let Un=A;A=M,M=Un}let X,z,J=!1;this._decorationService.forEachDecorationAtCell(P,w,void 0,G=>{G.options.layer!=="top"&&J||(G.backgroundColorRGB&&(M=50331648,B=G.backgroundColorRGB.rgba>>8&16777215,X=G.backgroundColorRGB),G.foregroundColorRGB&&(A=50331648,D=G.foregroundColorRGB.rgba>>8&16777215,z=G.foregroundColorRGB),J=G.options.layer==="top")});let re=this._isCellInSelection(P,w),ee;switch(J||k.selectionForeground&&re&&(A=50331648,D=k.selectionForeground.rgba>>8&16777215,z=k.selectionForeground),re&&(X=this._coreBrowserService.isFocused?k.selectionBackgroundOpaque:k.selectionInactiveBackgroundOpaque,J=!0),J&&$.classList.add("xterm-decoration-top"),M){case 16777216:case 33554432:ee=k.ansi[B],$.classList.add(`xterm-bg-${B}`);break;case 50331648:ee=_.rgba.toColor(B>>16,B>>8&255,255&B),this._addStyle($,`background-color:#${y((B>>>0).toString(16),"0",6)}`);break;default:U?(ee=k.foreground,$.classList.add(`xterm-bg-${g.INVERTED_DEFAULT_COLOR}`)):ee=k.background}switch(X||j.isDim()&&(X=_.color.multiplyOpacity(ee,.5)),A){case 16777216:case 33554432:j.isBold()&&D<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(D+=8),this._applyMinimumContrast($,ee,k.ansi[D],j,X,void 0)||$.classList.add(`xterm-fg-${D}`);break;case 50331648:let G=_.rgba.toColor(D>>16&255,D>>8&255,255&D);this._applyMinimumContrast($,ee,G,j,X,z)||this._addStyle($,`color:#${y(D.toString(16),"0",6)}`);break;default:this._applyMinimumContrast($,ee,k.foreground,j,X,void 0)||U&&$.classList.add(`xterm-fg-${g.INVERTED_DEFAULT_COLOR}`)}N.appendChild($),I[P]=++T,P=K}return P<O-1&&I.subarray(P).fill(++T),N}_applyMinimumContrast(b,w,S,C,L,x){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,p.excludeFromContrastRatioDemands)(C.getCode()))return!1;let R;return L||x||(R=this._themeService.colors.contrastCache.getColor(w.rgba,S.rgba)),R===void 0&&(R=_.color.ensureContrastRatio(L||w,x||S,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((L||w).rgba,(x||S).rgba,R!=null?R:null)),!!R&&(this._addStyle(b,`color:${R.css}`),!0)}_addStyle(b,w){b.setAttribute("style",`${b.getAttribute("style")||""}${w};`)}_isCellInSelection(b,w){let S=this._selectionStart,C=this._selectionEnd;return!(!S||!C)&&(this._columnSelectMode?S[0]<=C[0]?b>=S[0]&&w>=S[1]&&b<C[0]&&w<=C[1]:b<S[0]&&w>=S[1]&&b>=C[0]&&w<=C[1]:w>S[1]&&w<C[1]||S[1]===C[1]&&w===S[1]&&b>=S[0]&&b<C[0]||S[1]<C[1]&&w===C[1]&&b<C[0]||S[1]<C[1]&&w===S[1]&&b>=S[0])}};function y(b,w,S){for(;b.length<S;)b=w+b;return b}v=c([d(1,i.ICharacterJoinerService),d(2,m.IOptionsService),d(3,i.ICoreBrowserService),d(4,m.ICoreService),d(5,m.IDecorationService),d(6,i.IThemeService)],v),e.DomRendererRowFactory=v},2223:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TEXT_BASELINE=e.DIM_OPACITY=e.INVERTED_DEFAULT_COLOR=void 0;let c=r(6114);e.INVERTED_DEFAULT_COLOR=257,e.DIM_OPACITY=.5,e.TEXT_BASELINE=c.isFirefox||c.isLegacyEdge?"bottom":"ideographic"},6171:(o,e)=>{function r(c){return 57508<=c&&c<=57558}Object.defineProperty(e,"__esModule",{value:!0}),e.createRenderDimensions=e.excludeFromContrastRatioDemands=e.isRestrictedPowerlineGlyph=e.isPowerlineGlyph=e.throwIfFalsy=void 0,e.throwIfFalsy=function(c){if(!c)throw new Error("value must not be falsy");return c},e.isPowerlineGlyph=r,e.isRestrictedPowerlineGlyph=function(c){return 57520<=c&&c<=57527},e.excludeFromContrastRatioDemands=function(c){return r(c)||function(d){return 9472<=d&&d<=9631}(c)},e.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionModel=void 0,e.SelectionModel=class{constructor(r){this._bufferService=r,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let r=this.selectionStart[0]+this.selectionStartLength;return r>this._bufferService.cols?r%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(r/this._bufferService.cols)-1]:[r%this._bufferService.cols,this.selectionStart[1]+Math.floor(r/this._bufferService.cols)]:[r,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let r=this.selectionStart[0]+this.selectionStartLength;return r>this._bufferService.cols?[r%this._bufferService.cols,this.selectionStart[1]+Math.floor(r/this._bufferService.cols)]:[Math.max(r,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let r=this.selectionStart,c=this.selectionEnd;return!(!r||!c)&&(r[1]>c[1]||r[1]===c[1]&&r[0]>c[0])}handleTrim(r){return this.selectionStart&&(this.selectionStart[1]-=r),this.selectionEnd&&(this.selectionEnd[1]-=r),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(o,e,r){var c=this&&this.__decorate||function(i,u,p,h){var v,y=arguments.length,b=y<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,p):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(i,u,p,h);else for(var w=i.length-1;w>=0;w--)(v=i[w])&&(b=(y<3?v(b):y>3?v(u,p,b):v(u,p))||b);return y>3&&b&&Object.defineProperty(u,p,b),b},d=this&&this.__param||function(i,u){return function(p,h){u(p,h,i)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CharSizeService=void 0;let g=r(2585),a=r(8460),f=r(844),m=class extends f.Disposable{constructor(i,u,p){super(),this._optionsService=p,this.width=0,this.height=0,this._onCharSizeChange=this.register(new a.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new _(i,u,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){let i=this._measureStrategy.measure();i.width===this.width&&i.height===this.height||(this.width=i.width,this.height=i.height,this._onCharSizeChange.fire())}};m=c([d(2,g.IOptionsService)],m),e.CharSizeService=m;class _{constructor(u,p,h){this._document=u,this._parentElement=p,this._optionsService=h,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;let u=this._measureElement.getBoundingClientRect();return u.width!==0&&u.height!==0&&(this._result.width=u.width,this._result.height=Math.ceil(u.height)),this._result}}},4269:function(o,e,r){var c=this&&this.__decorate||function(u,p,h,v){var y,b=arguments.length,w=b<3?p:v===null?v=Object.getOwnPropertyDescriptor(p,h):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(u,p,h,v);else for(var S=u.length-1;S>=0;S--)(y=u[S])&&(w=(b<3?y(w):b>3?y(p,h,w):y(p,h))||w);return b>3&&w&&Object.defineProperty(p,h,w),w},d=this&&this.__param||function(u,p){return function(h,v){p(h,v,u)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CharacterJoinerService=e.JoinedCellData=void 0;let g=r(3734),a=r(643),f=r(511),m=r(2585);class _ extends g.AttributeData{constructor(p,h,v){super(),this.content=0,this.combinedData="",this.fg=p.fg,this.bg=p.bg,this.combinedData=h,this._width=v}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(p){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.JoinedCellData=_;let i=class Pn{constructor(p){this._bufferService=p,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new f.CellData}register(p){let h={id:this._nextCharacterJoinerId++,handler:p};return this._characterJoiners.push(h),h.id}deregister(p){for(let h=0;h<this._characterJoiners.length;h++)if(this._characterJoiners[h].id===p)return this._characterJoiners.splice(h,1),!0;return!1}getJoinedCharacters(p){if(this._characterJoiners.length===0)return[];let h=this._bufferService.buffer.lines.get(p);if(!h||h.length===0)return[];let v=[],y=h.translateToString(!0),b=0,w=0,S=0,C=h.getFg(0),L=h.getBg(0);for(let x=0;x<h.getTrimmedLength();x++)if(h.loadCell(x,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==C||this._workCell.bg!==L){if(x-b>1){let R=this._getJoinedRanges(y,S,w,h,b);for(let O=0;O<R.length;O++)v.push(R[O])}b=x,S=w,C=this._workCell.fg,L=this._workCell.bg}w+=this._workCell.getChars().length||a.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-b>1){let x=this._getJoinedRanges(y,S,w,h,b);for(let R=0;R<x.length;R++)v.push(x[R])}return v}_getJoinedRanges(p,h,v,y,b){let w=p.substring(h,v),S=[];try{S=this._characterJoiners[0].handler(w)}catch(C){console.error(C)}for(let C=1;C<this._characterJoiners.length;C++)try{let L=this._characterJoiners[C].handler(w);for(let x=0;x<L.length;x++)Pn._mergeRanges(S,L[x])}catch(L){console.error(L)}return this._stringRangesToCellRanges(S,y,b),S}_stringRangesToCellRanges(p,h,v){let y=0,b=!1,w=0,S=p[y];if(S){for(let C=v;C<this._bufferService.cols;C++){let L=h.getWidth(C),x=h.getString(C).length||a.WHITESPACE_CELL_CHAR.length;if(L!==0){if(!b&&S[0]<=w&&(S[0]=C,b=!0),S[1]<=w){if(S[1]=C,S=p[++y],!S)break;S[0]<=w?(S[0]=C,b=!0):b=!1}w+=x}}S&&(S[1]=this._bufferService.cols)}}static _mergeRanges(p,h){let v=!1;for(let y=0;y<p.length;y++){let b=p[y];if(v){if(h[1]<=b[0])return p[y-1][1]=h[1],p;if(h[1]<=b[1])return p[y-1][1]=Math.max(h[1],b[1]),p.splice(y,1),p;p.splice(y,1),y--}else{if(h[1]<=b[0])return p.splice(y,0,h),p;if(h[1]<=b[1])return b[0]=Math.min(h[0],b[0]),p;h[0]<b[1]&&(b[0]=Math.min(h[0],b[0]),v=!0)}}return v?p[p.length-1][1]=h[1]:p.push(h),p}};i=c([d(0,m.IBufferService)],i),e.CharacterJoinerService=i},5114:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoreBrowserService=void 0,e.CoreBrowserService=class{constructor(r,c){this._textarea=r,this.window=c,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(o,e,r){var c=this&&this.__decorate||function(m,_,i,u){var p,h=arguments.length,v=h<3?_:u===null?u=Object.getOwnPropertyDescriptor(_,i):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(m,_,i,u);else for(var y=m.length-1;y>=0;y--)(p=m[y])&&(v=(h<3?p(v):h>3?p(_,i,v):p(_,i))||v);return h>3&&v&&Object.defineProperty(_,i,v),v},d=this&&this.__param||function(m,_){return function(i,u){_(i,u,m)}};Object.defineProperty(e,"__esModule",{value:!0}),e.MouseService=void 0;let g=r(4725),a=r(9806),f=class{constructor(m,_){this._renderService=m,this._charSizeService=_}getCoords(m,_,i,u,p){return(0,a.getCoords)(window,m,_,i,u,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,p)}getMouseReportCoords(m,_){let i=(0,a.getCoordsRelativeToElement)(window,m,_);if(!(!this._charSizeService.hasValidSize||i[0]<0||i[1]<0||i[0]>=this._renderService.dimensions.css.canvas.width||i[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(i[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(i[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(i[0]),y:Math.floor(i[1])}}};f=c([d(0,g.IRenderService),d(1,g.ICharSizeService)],f),e.MouseService=f},3230:function(o,e,r){var c=this&&this.__decorate||function(v,y,b,w){var S,C=arguments.length,L=C<3?y:w===null?w=Object.getOwnPropertyDescriptor(y,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(v,y,b,w);else for(var x=v.length-1;x>=0;x--)(S=v[x])&&(L=(C<3?S(L):C>3?S(y,b,L):S(y,b))||L);return C>3&&L&&Object.defineProperty(y,b,L),L},d=this&&this.__param||function(v,y){return function(b,w){y(b,w,v)}};Object.defineProperty(e,"__esModule",{value:!0}),e.RenderService=void 0;let g=r(6193),a=r(8460),f=r(844),m=r(5596),_=r(3656),i=r(2585),u=r(4725),p=r(7226),h=class extends f.Disposable{constructor(v,y,b,w,S,C,L,x){if(super(),this._rowCount=v,this._charSizeService=w,this._pausedResizeTask=new p.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new a.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new a.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new a.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new a.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var R;return(R=this._renderer)===null||R===void 0?void 0:R.dispose()}}),this._renderDebouncer=new g.RenderDebouncer(L.window,(R,O)=>this._renderRows(R,O)),this.register(this._renderDebouncer),this._screenDprMonitor=new m.ScreenDprMonitor(L.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(C.onResize(()=>this._fullRefresh())),this.register(C.buffers.onBufferActivate(()=>{var R;return(R=this._renderer)===null||R===void 0?void 0:R.clear()})),this.register(b.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(S.onDecorationRegistered(()=>this._fullRefresh())),this.register(S.onDecorationRemoved(()=>this._fullRefresh())),this.register(b.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(C.cols,C.rows),this._fullRefresh()})),this.register(b.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(C.buffer.y,C.buffer.y,!0))),this.register((0,_.addDisposableDomListener)(L.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(x.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in L.window){let R=new L.window.IntersectionObserver(O=>this._handleIntersectionChange(O[O.length-1]),{threshold:0});R.observe(y),this.register({dispose:()=>R.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(v){this._isPaused=v.isIntersecting===void 0?v.intersectionRatio===0:!v.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(v,y,b=!1){this._isPaused?this._needsFullRefresh=!0:(b||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(v,y,this._rowCount))}_renderRows(v,y){this._renderer&&(this._renderer.renderRows(v,y),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:v,end:y}),this._onRender.fire({start:v,end:y}),this._isNextRenderRedrawOnly=!0)}resize(v,y){this._rowCount=y,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(v){var y;(y=this._renderer)===null||y===void 0||y.dispose(),this._renderer=v,this._renderer.onRequestRedraw(b=>this.refreshRows(b.start,b.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(v){return this._renderDebouncer.addRefreshCallback(v)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var v,y;this._renderer&&((y=(v=this._renderer).clearTextureAtlas)===null||y===void 0||y.call(v),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(v,y){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(v,y)):this._renderer.handleResize(v,y),this._fullRefresh())}handleCharSizeChanged(){var v;(v=this._renderer)===null||v===void 0||v.handleCharSizeChanged()}handleBlur(){var v;(v=this._renderer)===null||v===void 0||v.handleBlur()}handleFocus(){var v;(v=this._renderer)===null||v===void 0||v.handleFocus()}handleSelectionChanged(v,y,b){var w;this._selectionState.start=v,this._selectionState.end=y,this._selectionState.columnSelectMode=b,(w=this._renderer)===null||w===void 0||w.handleSelectionChanged(v,y,b)}handleCursorMove(){var v;(v=this._renderer)===null||v===void 0||v.handleCursorMove()}clear(){var v;(v=this._renderer)===null||v===void 0||v.clear()}};h=c([d(2,i.IOptionsService),d(3,u.ICharSizeService),d(4,i.IDecorationService),d(5,i.IBufferService),d(6,u.ICoreBrowserService),d(7,u.IThemeService)],h),e.RenderService=h},9312:function(o,e,r){var c=this&&this.__decorate||function(S,C,L,x){var R,O=arguments.length,I=O<3?C:x===null?x=Object.getOwnPropertyDescriptor(C,L):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(S,C,L,x);else for(var N=S.length-1;N>=0;N--)(R=S[N])&&(I=(O<3?R(I):O>3?R(C,L,I):R(C,L))||I);return O>3&&I&&Object.defineProperty(C,L,I),I},d=this&&this.__param||function(S,C){return function(L,x){C(L,x,S)}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionService=void 0;let g=r(6114),a=r(456),f=r(511),m=r(8460),_=r(4725),i=r(2585),u=r(9806),p=r(9504),h=r(844),v=r(4841),y=String.fromCharCode(160),b=new RegExp(y,"g"),w=class extends h.Disposable{constructor(S,C,L,x,R,O,I,N,F){super(),this._element=S,this._screenElement=C,this._linkifier=L,this._bufferService=x,this._coreService=R,this._mouseService=O,this._optionsService=I,this._renderService=N,this._coreBrowserService=F,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new f.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new m.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new m.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new m.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new m.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=E=>this._handleMouseMove(E),this._mouseUpListener=E=>this._handleMouseUp(E),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(E=>this._handleTrim(E)),this.register(this._bufferService.buffers.onBufferActivate(E=>this._handleBufferActivate(E))),this.enable(),this._model=new a.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,h.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let S=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;return!(!S||!C||S[0]===C[0]&&S[1]===C[1])}get selectionText(){let S=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;if(!S||!C)return"";let L=this._bufferService.buffer,x=[];if(this._activeSelectionMode===3){if(S[0]===C[0])return"";let R=S[0]<C[0]?S[0]:C[0],O=S[0]<C[0]?C[0]:S[0];for(let I=S[1];I<=C[1];I++){let N=L.translateBufferLineToString(I,!0,R,O);x.push(N)}}else{let R=S[1]===C[1]?C[0]:void 0;x.push(L.translateBufferLineToString(S[1],!0,S[0],R));for(let O=S[1]+1;O<=C[1]-1;O++){let I=L.lines.get(O),N=L.translateBufferLineToString(O,!0);I!=null&&I.isWrapped?x[x.length-1]+=N:x.push(N)}if(S[1]!==C[1]){let O=L.lines.get(C[1]),I=L.translateBufferLineToString(C[1],!0,0,C[0]);O&&O.isWrapped?x[x.length-1]+=I:x.push(I)}}return x.map(R=>R.replace(b," ")).join(g.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(S){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),g.isLinux&&S&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(S){let C=this._getMouseBufferCoords(S),L=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;return!!(L&&x&&C)&&this._areCoordsInSelection(C,L,x)}isCellInSelection(S,C){let L=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;return!(!L||!x)&&this._areCoordsInSelection([S,C],L,x)}_areCoordsInSelection(S,C,L){return S[1]>C[1]&&S[1]<L[1]||C[1]===L[1]&&S[1]===C[1]&&S[0]>=C[0]&&S[0]<L[0]||C[1]<L[1]&&S[1]===L[1]&&S[0]<L[0]||C[1]<L[1]&&S[1]===C[1]&&S[0]>=C[0]}_selectWordAtCursor(S,C){var L,x;let R=(x=(L=this._linkifier.currentLink)===null||L===void 0?void 0:L.link)===null||x===void 0?void 0:x.range;if(R)return this._model.selectionStart=[R.start.x-1,R.start.y-1],this._model.selectionStartLength=(0,v.getRangeLength)(R,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let O=this._getMouseBufferCoords(S);return!!O&&(this._selectWordAt(O,C),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(S,C){this._model.clearSelection(),S=Math.max(S,0),C=Math.min(C,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,S],this._model.selectionEnd=[this._bufferService.cols,C],this.refresh(),this._onSelectionChange.fire()}_handleTrim(S){this._model.handleTrim(S)&&this.refresh()}_getMouseBufferCoords(S){let C=this._mouseService.getCoords(S,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(C)return C[0]--,C[1]--,C[1]+=this._bufferService.buffer.ydisp,C}_getMouseEventScrollAmount(S){let C=(0,u.getCoordsRelativeToElement)(this._coreBrowserService.window,S,this._screenElement)[1],L=this._renderService.dimensions.css.canvas.height;return C>=0&&C<=L?0:(C>L&&(C-=L),C=Math.min(Math.max(C,-50),50),C/=50,C/Math.abs(C)+Math.round(14*C))}shouldForceSelection(S){return g.isMac?S.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:S.shiftKey}handleMouseDown(S){if(this._mouseDownTimeStamp=S.timeStamp,(S.button!==2||!this.hasSelection)&&S.button===0){if(!this._enabled){if(!this.shouldForceSelection(S))return;S.stopPropagation()}S.preventDefault(),this._dragScrollAmount=0,this._enabled&&S.shiftKey?this._handleIncrementalClick(S):S.detail===1?this._handleSingleClick(S):S.detail===2?this._handleDoubleClick(S):S.detail===3&&this._handleTripleClick(S),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(S){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(S))}_handleSingleClick(S){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(S)?3:0,this._model.selectionStart=this._getMouseBufferCoords(S),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let C=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);C&&C.length!==this._model.selectionStart[0]&&C.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(S){this._selectWordAtCursor(S,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(S){let C=this._getMouseBufferCoords(S);C&&(this._activeSelectionMode=2,this._selectLineAt(C[1]))}shouldColumnSelect(S){return S.altKey&&!(g.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(S){if(S.stopImmediatePropagation(),!this._model.selectionStart)return;let C=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(S),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(S),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let L=this._bufferService.buffer;if(this._model.selectionEnd[1]<L.lines.length){let x=L.lines.get(this._model.selectionEnd[1]);x&&x.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}C&&C[0]===this._model.selectionEnd[0]&&C[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let S=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(S.ydisp+this._bufferService.rows,S.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=S.ydisp),this.refresh()}}_handleMouseUp(S){let C=S.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&C<500&&S.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let L=this._mouseService.getCoords(S,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(L&&L[0]!==void 0&&L[1]!==void 0){let x=(0,p.moveToCellSequence)(L[0]-1,L[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(x,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let S=this._model.finalSelectionStart,C=this._model.finalSelectionEnd,L=!(!S||!C||S[0]===C[0]&&S[1]===C[1]);L?S&&C&&(this._oldSelectionStart&&this._oldSelectionEnd&&S[0]===this._oldSelectionStart[0]&&S[1]===this._oldSelectionStart[1]&&C[0]===this._oldSelectionEnd[0]&&C[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(S,C,L)):this._oldHasSelection&&this._fireOnSelectionChange(S,C,L)}_fireOnSelectionChange(S,C,L){this._oldSelectionStart=S,this._oldSelectionEnd=C,this._oldHasSelection=L,this._onSelectionChange.fire()}_handleBufferActivate(S){this.clearSelection(),this._trimListener.dispose(),this._trimListener=S.activeBuffer.lines.onTrim(C=>this._handleTrim(C))}_convertViewportColToCharacterIndex(S,C){let L=C;for(let x=0;C>=x;x++){let R=S.loadCell(x,this._workCell).getChars().length;this._workCell.getWidth()===0?L--:R>1&&C!==x&&(L+=R-1)}return L}setSelection(S,C,L){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[S,C],this._model.selectionStartLength=L,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(S){this._isClickInSelection(S)||(this._selectWordAtCursor(S,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(S,C,L=!0,x=!0){if(S[0]>=this._bufferService.cols)return;let R=this._bufferService.buffer,O=R.lines.get(S[1]);if(!O)return;let I=R.translateBufferLineToString(S[1],!1),N=this._convertViewportColToCharacterIndex(O,S[0]),F=N,E=S[0]-N,k=0,T=0,P=0,H=0;if(I.charAt(N)===" "){for(;N>0&&I.charAt(N-1)===" ";)N--;for(;F<I.length&&I.charAt(F+1)===" ";)F++}else{let j=S[0],$=S[0];O.getWidth(j)===0&&(k++,j--),O.getWidth($)===2&&(T++,$++);let D=O.getString($).length;for(D>1&&(H+=D-1,F+=D-1);j>0&&N>0&&!this._isCharWordSeparator(O.loadCell(j-1,this._workCell));){O.loadCell(j-1,this._workCell);let A=this._workCell.getChars().length;this._workCell.getWidth()===0?(k++,j--):A>1&&(P+=A-1,N-=A-1),N--,j--}for(;$<O.length&&F+1<I.length&&!this._isCharWordSeparator(O.loadCell($+1,this._workCell));){O.loadCell($+1,this._workCell);let A=this._workCell.getChars().length;this._workCell.getWidth()===2?(T++,$++):A>1&&(H+=A-1,F+=A-1),F++,$++}}F++;let W=N+E-k+P,K=Math.min(this._bufferService.cols,F-N+k+T-P-H);if(C||I.slice(N,F).trim()!==""){if(L&&W===0&&O.getCodePoint(0)!==32){let j=R.lines.get(S[1]-1);if(j&&O.isWrapped&&j.getCodePoint(this._bufferService.cols-1)!==32){let $=this._getWordAt([this._bufferService.cols-1,S[1]-1],!1,!0,!1);if($){let D=this._bufferService.cols-$.start;W-=D,K+=D}}}if(x&&W+K===this._bufferService.cols&&O.getCodePoint(this._bufferService.cols-1)!==32){let j=R.lines.get(S[1]+1);if(j!=null&&j.isWrapped&&j.getCodePoint(0)!==32){let $=this._getWordAt([0,S[1]+1],!1,!1,!0);$&&(K+=$.length)}}return{start:W,length:K}}}_selectWordAt(S,C){let L=this._getWordAt(S,C);if(L){for(;L.start<0;)L.start+=this._bufferService.cols,S[1]--;this._model.selectionStart=[L.start,S[1]],this._model.selectionStartLength=L.length}}_selectToWordAt(S){let C=this._getWordAt(S,!0);if(C){let L=S[1];for(;C.start<0;)C.start+=this._bufferService.cols,L--;if(!this._model.areSelectionValuesReversed())for(;C.start+C.length>this._bufferService.cols;)C.length-=this._bufferService.cols,L++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?C.start:C.start+C.length,L]}}_isCharWordSeparator(S){return S.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(S.getChars())>=0}_selectLineAt(S){let C=this._bufferService.buffer.getWrappedRangeForLine(S),L={start:{x:0,y:C.first},end:{x:this._bufferService.cols-1,y:C.last}};this._model.selectionStart=[0,C.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,v.getRangeLength)(L,this._bufferService.cols)}};w=c([d(3,i.IBufferService),d(4,i.ICoreService),d(5,_.IMouseService),d(6,i.IOptionsService),d(7,_.IRenderService),d(8,_.ICoreBrowserService)],w),e.SelectionService=w},4725:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IThemeService=e.ICharacterJoinerService=e.ISelectionService=e.IRenderService=e.IMouseService=e.ICoreBrowserService=e.ICharSizeService=void 0;let c=r(8343);e.ICharSizeService=(0,c.createDecorator)("CharSizeService"),e.ICoreBrowserService=(0,c.createDecorator)("CoreBrowserService"),e.IMouseService=(0,c.createDecorator)("MouseService"),e.IRenderService=(0,c.createDecorator)("RenderService"),e.ISelectionService=(0,c.createDecorator)("SelectionService"),e.ICharacterJoinerService=(0,c.createDecorator)("CharacterJoinerService"),e.IThemeService=(0,c.createDecorator)("ThemeService")},6731:function(o,e,r){var c=this&&this.__decorate||function(w,S,C,L){var x,R=arguments.length,O=R<3?S:L===null?L=Object.getOwnPropertyDescriptor(S,C):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(w,S,C,L);else for(var I=w.length-1;I>=0;I--)(x=w[I])&&(O=(R<3?x(O):R>3?x(S,C,O):x(S,C))||O);return R>3&&O&&Object.defineProperty(S,C,O),O},d=this&&this.__param||function(w,S){return function(C,L){S(C,L,w)}};Object.defineProperty(e,"__esModule",{value:!0}),e.ThemeService=e.DEFAULT_ANSI_COLORS=void 0;let g=r(7239),a=r(8055),f=r(8460),m=r(844),_=r(2585),i=a.css.toColor("#ffffff"),u=a.css.toColor("#000000"),p=a.css.toColor("#ffffff"),h=a.css.toColor("#000000"),v={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};e.DEFAULT_ANSI_COLORS=Object.freeze((()=>{let w=[a.css.toColor("#2e3436"),a.css.toColor("#cc0000"),a.css.toColor("#4e9a06"),a.css.toColor("#c4a000"),a.css.toColor("#3465a4"),a.css.toColor("#75507b"),a.css.toColor("#06989a"),a.css.toColor("#d3d7cf"),a.css.toColor("#555753"),a.css.toColor("#ef2929"),a.css.toColor("#8ae234"),a.css.toColor("#fce94f"),a.css.toColor("#729fcf"),a.css.toColor("#ad7fa8"),a.css.toColor("#34e2e2"),a.css.toColor("#eeeeec")],S=[0,95,135,175,215,255];for(let C=0;C<216;C++){let L=S[C/36%6|0],x=S[C/6%6|0],R=S[C%6];w.push({css:a.channels.toCss(L,x,R),rgba:a.channels.toRgba(L,x,R)})}for(let C=0;C<24;C++){let L=8+10*C;w.push({css:a.channels.toCss(L,L,L),rgba:a.channels.toRgba(L,L,L)})}return w})());let y=class extends m.Disposable{constructor(w){super(),this._optionsService=w,this._onChangeColors=this.register(new f.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new g.ColorContrastCache,this._colors={foreground:i,background:u,cursor:p,cursorAccent:h,selectionForeground:void 0,selectionBackgroundTransparent:v,selectionBackgroundOpaque:a.color.blend(u,v),selectionInactiveBackgroundTransparent:v,selectionInactiveBackgroundOpaque:a.color.blend(u,v),ansi:e.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(w={}){let S=this._colors;if(S.foreground=b(w.foreground,i),S.background=b(w.background,u),S.cursor=b(w.cursor,p),S.cursorAccent=b(w.cursorAccent,h),S.selectionBackgroundTransparent=b(w.selectionBackground,v),S.selectionBackgroundOpaque=a.color.blend(S.background,S.selectionBackgroundTransparent),S.selectionInactiveBackgroundTransparent=b(w.selectionInactiveBackground,S.selectionBackgroundTransparent),S.selectionInactiveBackgroundOpaque=a.color.blend(S.background,S.selectionInactiveBackgroundTransparent),S.selectionForeground=w.selectionForeground?b(w.selectionForeground,a.NULL_COLOR):void 0,S.selectionForeground===a.NULL_COLOR&&(S.selectionForeground=void 0),a.color.isOpaque(S.selectionBackgroundTransparent)&&(S.selectionBackgroundTransparent=a.color.opacity(S.selectionBackgroundTransparent,.3)),a.color.isOpaque(S.selectionInactiveBackgroundTransparent)&&(S.selectionInactiveBackgroundTransparent=a.color.opacity(S.selectionInactiveBackgroundTransparent,.3)),S.ansi=e.DEFAULT_ANSI_COLORS.slice(),S.ansi[0]=b(w.black,e.DEFAULT_ANSI_COLORS[0]),S.ansi[1]=b(w.red,e.DEFAULT_ANSI_COLORS[1]),S.ansi[2]=b(w.green,e.DEFAULT_ANSI_COLORS[2]),S.ansi[3]=b(w.yellow,e.DEFAULT_ANSI_COLORS[3]),S.ansi[4]=b(w.blue,e.DEFAULT_ANSI_COLORS[4]),S.ansi[5]=b(w.magenta,e.DEFAULT_ANSI_COLORS[5]),S.ansi[6]=b(w.cyan,e.DEFAULT_ANSI_COLORS[6]),S.ansi[7]=b(w.white,e.DEFAULT_ANSI_COLORS[7]),S.ansi[8]=b(w.brightBlack,e.DEFAULT_ANSI_COLORS[8]),S.ansi[9]=b(w.brightRed,e.DEFAULT_ANSI_COLORS[9]),S.ansi[10]=b(w.brightGreen,e.DEFAULT_ANSI_COLORS[10]),S.ansi[11]=b(w.brightYellow,e.DEFAULT_ANSI_COLORS[11]),S.ansi[12]=b(w.brightBlue,e.DEFAULT_ANSI_COLORS[12]),S.ansi[13]=b(w.brightMagenta,e.DEFAULT_ANSI_COLORS[13]),S.ansi[14]=b(w.brightCyan,e.DEFAULT_ANSI_COLORS[14]),S.ansi[15]=b(w.brightWhite,e.DEFAULT_ANSI_COLORS[15]),w.extendedAnsi){let C=Math.min(S.ansi.length-16,w.extendedAnsi.length);for(let L=0;L<C;L++)S.ansi[L+16]=b(w.extendedAnsi[L],e.DEFAULT_ANSI_COLORS[L+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(w){this._restoreColor(w),this._onChangeColors.fire(this.colors)}_restoreColor(w){if(w!==void 0)switch(w){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[w]=this._restoreColors.ansi[w]}else for(let S=0;S<this._restoreColors.ansi.length;++S)this._colors.ansi[S]=this._restoreColors.ansi[S]}modifyColors(w){w(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function b(w,S){if(w!==void 0)try{return a.css.toColor(w)}catch(C){}return S}y=c([d(0,_.IOptionsService)],y),e.ThemeService=y},6349:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CircularList=void 0;let c=r(8460),d=r(844);class g extends d.Disposable{constructor(f){super(),this._maxLength=f,this.onDeleteEmitter=this.register(new c.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new c.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new c.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(f){if(this._maxLength===f)return;let m=new Array(f);for(let _=0;_<Math.min(f,this.length);_++)m[_]=this._array[this._getCyclicIndex(_)];this._array=m,this._maxLength=f,this._startIndex=0}get length(){return this._length}set length(f){if(f>this._length)for(let m=this._length;m<f;m++)this._array[m]=void 0;this._length=f}get(f){return this._array[this._getCyclicIndex(f)]}set(f,m){this._array[this._getCyclicIndex(f)]=m}push(f){this._array[this._getCyclicIndex(this._length)]=f,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(f,m,..._){if(m){for(let i=f;i<this._length-m;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+m)];this._length-=m,this.onDeleteEmitter.fire({index:f,amount:m})}for(let i=this._length-1;i>=f;i--)this._array[this._getCyclicIndex(i+_.length)]=this._array[this._getCyclicIndex(i)];for(let i=0;i<_.length;i++)this._array[this._getCyclicIndex(f+i)]=_[i];if(_.length&&this.onInsertEmitter.fire({index:f,amount:_.length}),this._length+_.length>this._maxLength){let i=this._length+_.length-this._maxLength;this._startIndex+=i,this._length=this._maxLength,this.onTrimEmitter.fire(i)}else this._length+=_.length}trimStart(f){f>this._length&&(f=this._length),this._startIndex+=f,this._length-=f,this.onTrimEmitter.fire(f)}shiftElements(f,m,_){if(!(m<=0)){if(f<0||f>=this._length)throw new Error("start argument out of range");if(f+_<0)throw new Error("Cannot shift elements in list beyond index 0");if(_>0){for(let u=m-1;u>=0;u--)this.set(f+u+_,this.get(f+u));let i=f+m+_-this._length;if(i>0)for(this._length+=i;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let i=0;i<m;i++)this.set(f+i+_,this.get(f+i))}}_getCyclicIndex(f){return(this._startIndex+f)%this._maxLength}}e.CircularList=g},1439:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.clone=void 0,e.clone=function r(c,d=5){if(typeof c!="object")return c;let g=Array.isArray(c)?[]:{};for(let a in c)g[a]=d<=1?c[a]:c[a]&&r(c[a],d-1);return g}},8055:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.contrastRatio=e.toPaddedHex=e.rgba=e.rgb=e.css=e.color=e.channels=e.NULL_COLOR=void 0;let c=r(6114),d=0,g=0,a=0,f=0;var m,_,i;function u(h){let v=h.toString(16);return v.length<2?"0"+v:v}function p(h,v){return h<v?(v+.05)/(h+.05):(h+.05)/(v+.05)}e.NULL_COLOR={css:"#00000000",rgba:0},function(h){h.toCss=function(v,y,b,w){return w!==void 0?`#${u(v)}${u(y)}${u(b)}${u(w)}`:`#${u(v)}${u(y)}${u(b)}`},h.toRgba=function(v,y,b,w=255){return(v<<24|y<<16|b<<8|w)>>>0}}(m=e.channels||(e.channels={})),function(h){function v(y,b){return f=Math.round(255*b),[d,g,a]=i.toChannels(y.rgba),{css:m.toCss(d,g,a,f),rgba:m.toRgba(d,g,a,f)}}h.blend=function(y,b){if(f=(255&b.rgba)/255,f===1)return{css:b.css,rgba:b.rgba};let w=b.rgba>>24&255,S=b.rgba>>16&255,C=b.rgba>>8&255,L=y.rgba>>24&255,x=y.rgba>>16&255,R=y.rgba>>8&255;return d=L+Math.round((w-L)*f),g=x+Math.round((S-x)*f),a=R+Math.round((C-R)*f),{css:m.toCss(d,g,a),rgba:m.toRgba(d,g,a)}},h.isOpaque=function(y){return(255&y.rgba)==255},h.ensureContrastRatio=function(y,b,w){let S=i.ensureContrastRatio(y.rgba,b.rgba,w);if(S)return i.toColor(S>>24&255,S>>16&255,S>>8&255)},h.opaque=function(y){let b=(255|y.rgba)>>>0;return[d,g,a]=i.toChannels(b),{css:m.toCss(d,g,a),rgba:b}},h.opacity=v,h.multiplyOpacity=function(y,b){return f=255&y.rgba,v(y,f*b/255)},h.toColorRGB=function(y){return[y.rgba>>24&255,y.rgba>>16&255,y.rgba>>8&255]}}(e.color||(e.color={})),function(h){let v,y;if(!c.isNode){let b=document.createElement("canvas");b.width=1,b.height=1;let w=b.getContext("2d",{willReadFrequently:!0});w&&(v=w,v.globalCompositeOperation="copy",y=v.createLinearGradient(0,0,1,1))}h.toColor=function(b){if(b.match(/#[\da-f]{3,8}/i))switch(b.length){case 4:return d=parseInt(b.slice(1,2).repeat(2),16),g=parseInt(b.slice(2,3).repeat(2),16),a=parseInt(b.slice(3,4).repeat(2),16),i.toColor(d,g,a);case 5:return d=parseInt(b.slice(1,2).repeat(2),16),g=parseInt(b.slice(2,3).repeat(2),16),a=parseInt(b.slice(3,4).repeat(2),16),f=parseInt(b.slice(4,5).repeat(2),16),i.toColor(d,g,a,f);case 7:return{css:b,rgba:(parseInt(b.slice(1),16)<<8|255)>>>0};case 9:return{css:b,rgba:parseInt(b.slice(1),16)>>>0}}let w=b.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(w)return d=parseInt(w[1]),g=parseInt(w[2]),a=parseInt(w[3]),f=Math.round(255*(w[5]===void 0?1:parseFloat(w[5]))),i.toColor(d,g,a,f);if(!v||!y)throw new Error("css.toColor: Unsupported css format");if(v.fillStyle=y,v.fillStyle=b,typeof v.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(v.fillRect(0,0,1,1),[d,g,a,f]=v.getImageData(0,0,1,1).data,f!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:m.toRgba(d,g,a,f),css:b}}}(e.css||(e.css={})),function(h){function v(y,b,w){let S=y/255,C=b/255,L=w/255;return .2126*(S<=.03928?S/12.92:Math.pow((S+.055)/1.055,2.4))+.7152*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))+.0722*(L<=.03928?L/12.92:Math.pow((L+.055)/1.055,2.4))}h.relativeLuminance=function(y){return v(y>>16&255,y>>8&255,255&y)},h.relativeLuminance2=v}(_=e.rgb||(e.rgb={})),function(h){function v(b,w,S){let C=b>>24&255,L=b>>16&255,x=b>>8&255,R=w>>24&255,O=w>>16&255,I=w>>8&255,N=p(_.relativeLuminance2(R,O,I),_.relativeLuminance2(C,L,x));for(;N<S&&(R>0||O>0||I>0);)R-=Math.max(0,Math.ceil(.1*R)),O-=Math.max(0,Math.ceil(.1*O)),I-=Math.max(0,Math.ceil(.1*I)),N=p(_.relativeLuminance2(R,O,I),_.relativeLuminance2(C,L,x));return(R<<24|O<<16|I<<8|255)>>>0}function y(b,w,S){let C=b>>24&255,L=b>>16&255,x=b>>8&255,R=w>>24&255,O=w>>16&255,I=w>>8&255,N=p(_.relativeLuminance2(R,O,I),_.relativeLuminance2(C,L,x));for(;N<S&&(R<255||O<255||I<255);)R=Math.min(255,R+Math.ceil(.1*(255-R))),O=Math.min(255,O+Math.ceil(.1*(255-O))),I=Math.min(255,I+Math.ceil(.1*(255-I))),N=p(_.relativeLuminance2(R,O,I),_.relativeLuminance2(C,L,x));return(R<<24|O<<16|I<<8|255)>>>0}h.ensureContrastRatio=function(b,w,S){let C=_.relativeLuminance(b>>8),L=_.relativeLuminance(w>>8);if(p(C,L)<S){if(L<C){let O=v(b,w,S),I=p(C,_.relativeLuminance(O>>8));if(I<S){let N=y(b,w,S);return I>p(C,_.relativeLuminance(N>>8))?O:N}return O}let x=y(b,w,S),R=p(C,_.relativeLuminance(x>>8));if(R<S){let O=v(b,w,S);return R>p(C,_.relativeLuminance(O>>8))?x:O}return x}},h.reduceLuminance=v,h.increaseLuminance=y,h.toChannels=function(b){return[b>>24&255,b>>16&255,b>>8&255,255&b]},h.toColor=function(b,w,S,C){return{css:m.toCss(b,w,S,C),rgba:m.toRgba(b,w,S,C)}}}(i=e.rgba||(e.rgba={})),e.toPaddedHex=u,e.contrastRatio=p},8969:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoreTerminal=void 0;let c=r(844),d=r(2585),g=r(4348),a=r(7866),f=r(744),m=r(7302),_=r(6975),i=r(8460),u=r(1753),p=r(1480),h=r(7994),v=r(9282),y=r(5435),b=r(5981),w=r(2660),S=!1;class C extends c.Disposable{constructor(x){super(),this._onBinary=this.register(new i.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new i.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new i.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new i.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new i.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new i.EventEmitter),this._instantiationService=new g.InstantiationService,this.optionsService=this.register(new m.OptionsService(x)),this._instantiationService.setService(d.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(f.BufferService)),this._instantiationService.setService(d.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(a.LogService)),this._instantiationService.setService(d.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(_.CoreService)),this._instantiationService.setService(d.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(u.CoreMouseService)),this._instantiationService.setService(d.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(p.UnicodeService)),this._instantiationService.setService(d.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(h.CharsetService),this._instantiationService.setService(d.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(w.OscLinkService),this._instantiationService.setService(d.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new y.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,i.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,i.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,i.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,i.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onSpecificOptionChange("windowsMode",R=>this._handleWindowsModeOptionChange(R))),this.register(this._bufferService.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new b.WriteBuffer((R,O)=>this._inputHandler.parse(R,O))),this.register((0,i.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,c.toDisposable)(()=>{var R;(R=this._windowsMode)===null||R===void 0||R.dispose(),this._windowsMode=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new i.EventEmitter),this._onScroll.event(x=>{var R;(R=this._onScrollApi)===null||R===void 0||R.fire(x.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(x){for(let R in x)this.optionsService.options[R]=x[R]}write(x,R){this._writeBuffer.write(x,R)}writeSync(x,R){this._logService.logLevel<=d.LogLevelEnum.WARN&&!S&&(this._logService.warn("writeSync is unreliable and will be removed soon."),S=!0),this._writeBuffer.writeSync(x,R)}resize(x,R){isNaN(x)||isNaN(R)||(x=Math.max(x,f.MINIMUM_COLS),R=Math.max(R,f.MINIMUM_ROWS),this._bufferService.resize(x,R))}scroll(x,R=!1){this._bufferService.scroll(x,R)}scrollLines(x,R,O){this._bufferService.scrollLines(x,R,O)}scrollPages(x){this._bufferService.scrollPages(x)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(x){this._bufferService.scrollToLine(x)}registerEscHandler(x,R){return this._inputHandler.registerEscHandler(x,R)}registerDcsHandler(x,R){return this._inputHandler.registerDcsHandler(x,R)}registerCsiHandler(x,R){return this._inputHandler.registerCsiHandler(x,R)}registerOscHandler(x,R){return this._inputHandler.registerOscHandler(x,R)}_setup(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsModeOptionChange(x){var R;x?this._enableWindowsMode():((R=this._windowsMode)===null||R===void 0||R.dispose(),this._windowsMode=void 0)}_enableWindowsMode(){if(!this._windowsMode){let x=[];x.push(this.onLineFeed(v.updateWindowsModeWrappedState.bind(null,this._bufferService))),x.push(this.registerCsiHandler({final:"H"},()=>((0,v.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsMode={dispose:()=>{for(let R of x)R.dispose()}}}}}e.CoreTerminal=C},8460:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.forwardEvent=e.EventEmitter=void 0,e.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=r=>(this._listeners.push(r),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===r)return void this._listeners.splice(c,1)}}})),this._event}fire(r,c){let d=[];for(let g=0;g<this._listeners.length;g++)d.push(this._listeners[g]);for(let g=0;g<d.length;g++)d[g].call(void 0,r,c)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},e.forwardEvent=function(r,c){return r(d=>c.fire(d))}},5435:function(o,e,r){var c=this&&this.__decorate||function(F,E,k,T){var P,H=arguments.length,W=H<3?E:T===null?T=Object.getOwnPropertyDescriptor(E,k):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")W=Reflect.decorate(F,E,k,T);else for(var K=F.length-1;K>=0;K--)(P=F[K])&&(W=(H<3?P(W):H>3?P(E,k,W):P(E,k))||W);return H>3&&W&&Object.defineProperty(E,k,W),W},d=this&&this.__param||function(F,E){return function(k,T){E(k,T,F)}};Object.defineProperty(e,"__esModule",{value:!0}),e.InputHandler=e.WindowsOptionsReportType=void 0;let g=r(2584),a=r(7116),f=r(2015),m=r(844),_=r(482),i=r(8437),u=r(8460),p=r(643),h=r(511),v=r(3734),y=r(2585),b=r(6242),w=r(6351),S=r(5941),C={"(":0,")":1,"*":2,"+":3,"-":1,".":2},L=131072;function x(F,E){if(F>24)return E.setWinLines||!1;switch(F){case 1:return!!E.restoreWin;case 2:return!!E.minimizeWin;case 3:return!!E.setWinPosition;case 4:return!!E.setWinSizePixels;case 5:return!!E.raiseWin;case 6:return!!E.lowerWin;case 7:return!!E.refreshWin;case 8:return!!E.setWinSizeChars;case 9:return!!E.maximizeWin;case 10:return!!E.fullscreenWin;case 11:return!!E.getWinState;case 13:return!!E.getWinPosition;case 14:return!!E.getWinSizePixels;case 15:return!!E.getScreenSizePixels;case 16:return!!E.getCellSizePixels;case 18:return!!E.getWinSizeChars;case 19:return!!E.getScreenSizeChars;case 20:return!!E.getIconTitle;case 21:return!!E.getWinTitle;case 22:return!!E.pushTitle;case 23:return!!E.popTitle;case 24:return!!E.setWinLines}return!1}var R;(function(F){F[F.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",F[F.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(R=e.WindowsOptionsReportType||(e.WindowsOptionsReportType={}));let O=0;class I extends m.Disposable{constructor(E,k,T,P,H,W,K,j,$=new f.EscapeSequenceParser){super(),this._bufferService=E,this._charsetService=k,this._coreService=T,this._logService=P,this._optionsService=H,this._oscLinkService=W,this._coreMouseService=K,this._unicodeService=j,this._parser=$,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new _.StringToUtf32,this._utf8Decoder=new _.Utf8ToUtf32,this._workCell=new h.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=i.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new u.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new u.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new u.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new u.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new u.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new u.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new u.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new u.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new u.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new u.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new u.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new u.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new u.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new N(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(D=>this._activeBuffer=D.activeBuffer)),this._parser.setCsiHandlerFallback((D,A)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(D),params:A.toArray()})}),this._parser.setEscHandlerFallback(D=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(D)})}),this._parser.setExecuteHandlerFallback(D=>{this._logService.debug("Unknown EXECUTE code: ",{code:D})}),this._parser.setOscHandlerFallback((D,A,B)=>{this._logService.debug("Unknown OSC code: ",{identifier:D,action:A,data:B})}),this._parser.setDcsHandlerFallback((D,A,B)=>{A==="HOOK"&&(B=B.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(D),action:A,payload:B})}),this._parser.setPrintHandler((D,A,B)=>this.print(D,A,B)),this._parser.registerCsiHandler({final:"@"},D=>this.insertChars(D)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},D=>this.scrollLeft(D)),this._parser.registerCsiHandler({final:"A"},D=>this.cursorUp(D)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},D=>this.scrollRight(D)),this._parser.registerCsiHandler({final:"B"},D=>this.cursorDown(D)),this._parser.registerCsiHandler({final:"C"},D=>this.cursorForward(D)),this._parser.registerCsiHandler({final:"D"},D=>this.cursorBackward(D)),this._parser.registerCsiHandler({final:"E"},D=>this.cursorNextLine(D)),this._parser.registerCsiHandler({final:"F"},D=>this.cursorPrecedingLine(D)),this._parser.registerCsiHandler({final:"G"},D=>this.cursorCharAbsolute(D)),this._parser.registerCsiHandler({final:"H"},D=>this.cursorPosition(D)),this._parser.registerCsiHandler({final:"I"},D=>this.cursorForwardTab(D)),this._parser.registerCsiHandler({final:"J"},D=>this.eraseInDisplay(D,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},D=>this.eraseInDisplay(D,!0)),this._parser.registerCsiHandler({final:"K"},D=>this.eraseInLine(D,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},D=>this.eraseInLine(D,!0)),this._parser.registerCsiHandler({final:"L"},D=>this.insertLines(D)),this._parser.registerCsiHandler({final:"M"},D=>this.deleteLines(D)),this._parser.registerCsiHandler({final:"P"},D=>this.deleteChars(D)),this._parser.registerCsiHandler({final:"S"},D=>this.scrollUp(D)),this._parser.registerCsiHandler({final:"T"},D=>this.scrollDown(D)),this._parser.registerCsiHandler({final:"X"},D=>this.eraseChars(D)),this._parser.registerCsiHandler({final:"Z"},D=>this.cursorBackwardTab(D)),this._parser.registerCsiHandler({final:"`"},D=>this.charPosAbsolute(D)),this._parser.registerCsiHandler({final:"a"},D=>this.hPositionRelative(D)),this._parser.registerCsiHandler({final:"b"},D=>this.repeatPrecedingCharacter(D)),this._parser.registerCsiHandler({final:"c"},D=>this.sendDeviceAttributesPrimary(D)),this._parser.registerCsiHandler({prefix:">",final:"c"},D=>this.sendDeviceAttributesSecondary(D)),this._parser.registerCsiHandler({final:"d"},D=>this.linePosAbsolute(D)),this._parser.registerCsiHandler({final:"e"},D=>this.vPositionRelative(D)),this._parser.registerCsiHandler({final:"f"},D=>this.hVPosition(D)),this._parser.registerCsiHandler({final:"g"},D=>this.tabClear(D)),this._parser.registerCsiHandler({final:"h"},D=>this.setMode(D)),this._parser.registerCsiHandler({prefix:"?",final:"h"},D=>this.setModePrivate(D)),this._parser.registerCsiHandler({final:"l"},D=>this.resetMode(D)),this._parser.registerCsiHandler({prefix:"?",final:"l"},D=>this.resetModePrivate(D)),this._parser.registerCsiHandler({final:"m"},D=>this.charAttributes(D)),this._parser.registerCsiHandler({final:"n"},D=>this.deviceStatus(D)),this._parser.registerCsiHandler({prefix:"?",final:"n"},D=>this.deviceStatusPrivate(D)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},D=>this.softReset(D)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},D=>this.setCursorStyle(D)),this._parser.registerCsiHandler({final:"r"},D=>this.setScrollRegion(D)),this._parser.registerCsiHandler({final:"s"},D=>this.saveCursor(D)),this._parser.registerCsiHandler({final:"t"},D=>this.windowOptions(D)),this._parser.registerCsiHandler({final:"u"},D=>this.restoreCursor(D)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},D=>this.insertColumns(D)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},D=>this.deleteColumns(D)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},D=>this.selectProtected(D)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},D=>this.requestMode(D,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},D=>this.requestMode(D,!1)),this._parser.setExecuteHandler(g.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(g.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(g.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(g.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(g.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(g.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(g.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(g.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(g.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(g.C1.IND,()=>this.index()),this._parser.setExecuteHandler(g.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(g.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new b.OscHandler(D=>(this.setTitle(D),this.setIconName(D),!0))),this._parser.registerOscHandler(1,new b.OscHandler(D=>this.setIconName(D))),this._parser.registerOscHandler(2,new b.OscHandler(D=>this.setTitle(D))),this._parser.registerOscHandler(4,new b.OscHandler(D=>this.setOrReportIndexedColor(D))),this._parser.registerOscHandler(8,new b.OscHandler(D=>this.setHyperlink(D))),this._parser.registerOscHandler(10,new b.OscHandler(D=>this.setOrReportFgColor(D))),this._parser.registerOscHandler(11,new b.OscHandler(D=>this.setOrReportBgColor(D))),this._parser.registerOscHandler(12,new b.OscHandler(D=>this.setOrReportCursorColor(D))),this._parser.registerOscHandler(104,new b.OscHandler(D=>this.restoreIndexedColor(D))),this._parser.registerOscHandler(110,new b.OscHandler(D=>this.restoreFgColor(D))),this._parser.registerOscHandler(111,new b.OscHandler(D=>this.restoreBgColor(D))),this._parser.registerOscHandler(112,new b.OscHandler(D=>this.restoreCursorColor(D))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let D in a.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:D},()=>this.selectCharset("("+D)),this._parser.registerEscHandler({intermediates:")",final:D},()=>this.selectCharset(")"+D)),this._parser.registerEscHandler({intermediates:"*",final:D},()=>this.selectCharset("*"+D)),this._parser.registerEscHandler({intermediates:"+",final:D},()=>this.selectCharset("+"+D)),this._parser.registerEscHandler({intermediates:"-",final:D},()=>this.selectCharset("-"+D)),this._parser.registerEscHandler({intermediates:".",final:D},()=>this.selectCharset("."+D)),this._parser.registerEscHandler({intermediates:"/",final:D},()=>this.selectCharset("/"+D));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(D=>(this._logService.error("Parsing error: ",D),D)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new w.DcsHandler((D,A)=>this.requestStatusString(D,A)))}getAttrData(){return this._curAttrData}_preserveStack(E,k,T,P){this._parseStack.paused=!0,this._parseStack.cursorStartX=E,this._parseStack.cursorStartY=k,this._parseStack.decodedLength=T,this._parseStack.position=P}_logSlowResolvingAsync(E){this._logService.logLevel<=y.LogLevelEnum.WARN&&Promise.race([E,new Promise((k,T)=>setTimeout(()=>T("#SLOW_TIMEOUT"),5e3))]).catch(k=>{if(k!=="#SLOW_TIMEOUT")throw k;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(E,k){let T,P=this._activeBuffer.x,H=this._activeBuffer.y,W=0,K=this._parseStack.paused;if(K){if(T=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,k))return this._logSlowResolvingAsync(T),T;P=this._parseStack.cursorStartX,H=this._parseStack.cursorStartY,this._parseStack.paused=!1,E.length>L&&(W=this._parseStack.position+L)}if(this._logService.logLevel<=y.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof E=="string"?` "${E}"`:` "${Array.prototype.map.call(E,j=>String.fromCharCode(j)).join("")}"`),typeof E=="string"?E.split("").map(j=>j.charCodeAt(0)):E),this._parseBuffer.length<E.length&&this._parseBuffer.length<L&&(this._parseBuffer=new Uint32Array(Math.min(E.length,L))),K||this._dirtyRowTracker.clearRange(),E.length>L)for(let j=W;j<E.length;j+=L){let $=j+L<E.length?j+L:E.length,D=typeof E=="string"?this._stringDecoder.decode(E.substring(j,$),this._parseBuffer):this._utf8Decoder.decode(E.subarray(j,$),this._parseBuffer);if(T=this._parser.parse(this._parseBuffer,D))return this._preserveStack(P,H,D,j),this._logSlowResolvingAsync(T),T}else if(!K){let j=typeof E=="string"?this._stringDecoder.decode(E,this._parseBuffer):this._utf8Decoder.decode(E,this._parseBuffer);if(T=this._parser.parse(this._parseBuffer,j))return this._preserveStack(P,H,j,0),this._logSlowResolvingAsync(T),T}this._activeBuffer.x===P&&this._activeBuffer.y===H||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(E,k,T){let P,H,W=this._charsetService.charset,K=this._optionsService.rawOptions.screenReaderMode,j=this._bufferService.cols,$=this._coreService.decPrivateModes.wraparound,D=this._coreService.modes.insertMode,A=this._curAttrData,B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&T-k>0&&B.getWidth(this._activeBuffer.x-1)===2&&B.setCellFromCodePoint(this._activeBuffer.x-1,0,1,A.fg,A.bg,A.extended);for(let M=k;M<T;++M){if(P=E[M],H=this._unicodeService.wcwidth(P),P<127&&W){let U=W[String.fromCharCode(P)];U&&(P=U.charCodeAt(0))}if(K&&this._onA11yChar.fire((0,_.stringFromCodePoint)(P)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),H||!this._activeBuffer.x){if(this._activeBuffer.x+H-1>=j){if($){for(;this._activeBuffer.x<j;)B.setCellFromCodePoint(this._activeBuffer.x++,0,1,A.fg,A.bg,A.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=j-1,H===2)continue}if(D&&(B.insertCells(this._activeBuffer.x,H,this._activeBuffer.getNullCell(A),A),B.getWidth(j-1)===2&&B.setCellFromCodePoint(j-1,p.NULL_CELL_CODE,p.NULL_CELL_WIDTH,A.fg,A.bg,A.extended)),B.setCellFromCodePoint(this._activeBuffer.x++,P,H,A.fg,A.bg,A.extended),H>0)for(;--H;)B.setCellFromCodePoint(this._activeBuffer.x++,0,0,A.fg,A.bg,A.extended)}else B.getWidth(this._activeBuffer.x-1)?B.addCodepointToCell(this._activeBuffer.x-1,P):B.addCodepointToCell(this._activeBuffer.x-2,P)}T-k>0&&(B.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<j&&T-k>0&&B.getWidth(this._activeBuffer.x)===0&&!B.hasContent(this._activeBuffer.x)&&B.setCellFromCodePoint(this._activeBuffer.x,0,1,A.fg,A.bg,A.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(E,k){return E.final!=="t"||E.prefix||E.intermediates?this._parser.registerCsiHandler(E,k):this._parser.registerCsiHandler(E,T=>!x(T.params[0],this._optionsService.rawOptions.windowOptions)||k(T))}registerDcsHandler(E,k){return this._parser.registerDcsHandler(E,new w.DcsHandler(k))}registerEscHandler(E,k){return this._parser.registerEscHandler(E,k)}registerOscHandler(E,k){return this._parser.registerOscHandler(E,new b.OscHandler(k))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var E;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||E===void 0)&&E.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);k.hasWidth(this._activeBuffer.x)&&!k.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-E),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(E=this._bufferService.cols-1){this._activeBuffer.x=Math.min(E,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(E,k){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=E,this._activeBuffer.y=this._activeBuffer.scrollTop+k):(this._activeBuffer.x=E,this._activeBuffer.y=k),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(E,k){this._restrictCursor(),this._setCursor(this._activeBuffer.x+E,this._activeBuffer.y+k)}cursorUp(E){let k=this._activeBuffer.y-this._activeBuffer.scrollTop;return k>=0?this._moveCursor(0,-Math.min(k,E.params[0]||1)):this._moveCursor(0,-(E.params[0]||1)),!0}cursorDown(E){let k=this._activeBuffer.scrollBottom-this._activeBuffer.y;return k>=0?this._moveCursor(0,Math.min(k,E.params[0]||1)):this._moveCursor(0,E.params[0]||1),!0}cursorForward(E){return this._moveCursor(E.params[0]||1,0),!0}cursorBackward(E){return this._moveCursor(-(E.params[0]||1),0),!0}cursorNextLine(E){return this.cursorDown(E),this._activeBuffer.x=0,!0}cursorPrecedingLine(E){return this.cursorUp(E),this._activeBuffer.x=0,!0}cursorCharAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(E){return this._setCursor(E.length>=2?(E.params[1]||1)-1:0,(E.params[0]||1)-1),!0}charPosAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(E){return this._moveCursor(E.params[0]||1,0),!0}linePosAbsolute(E){return this._setCursor(this._activeBuffer.x,(E.params[0]||1)-1),!0}vPositionRelative(E){return this._moveCursor(0,E.params[0]||1),!0}hVPosition(E){return this.cursorPosition(E),!0}tabClear(E){let k=E.params[0];return k===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:k===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let k=E.params[0]||1;for(;k--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let k=E.params[0]||1;for(;k--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(E){let k=E.params[0];return k===1&&(this._curAttrData.bg|=536870912),k!==2&&k!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(E,k,T,P=!1,H=!1){let W=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);W.replaceCells(k,T,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),H),P&&(W.isWrapped=!1)}_resetBufferLine(E,k=!1){let T=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);T.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),k),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+E),T.isWrapped=!1}eraseInDisplay(E,k=!1){let T;switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:for(T=this._activeBuffer.y,this._dirtyRowTracker.markDirty(T),this._eraseInBufferLine(T++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,k);T<this._bufferService.rows;T++)this._resetBufferLine(T,k);this._dirtyRowTracker.markDirty(T);break;case 1:for(T=this._activeBuffer.y,this._dirtyRowTracker.markDirty(T),this._eraseInBufferLine(T,0,this._activeBuffer.x+1,!0,k),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(T+1).isWrapped=!1);T--;)this._resetBufferLine(T,k);this._dirtyRowTracker.markDirty(0);break;case 2:for(T=this._bufferService.rows,this._dirtyRowTracker.markDirty(T-1);T--;)this._resetBufferLine(T,k);this._dirtyRowTracker.markDirty(0);break;case 3:let P=this._activeBuffer.lines.length-this._bufferService.rows;P>0&&(this._activeBuffer.lines.trimStart(P),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-P,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-P,0),this._onScroll.fire(0))}return!0}eraseInLine(E,k=!1){switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,k);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,k);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,k)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(E){this._restrictCursor();let k=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let T=this._activeBuffer.ybase+this._activeBuffer.y,P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,H=this._bufferService.rows-1+this._activeBuffer.ybase-P+1;for(;k--;)this._activeBuffer.lines.splice(H-1,1),this._activeBuffer.lines.splice(T,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(E){this._restrictCursor();let k=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let T=this._activeBuffer.ybase+this._activeBuffer.y,P;for(P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,P=this._bufferService.rows-1+this._activeBuffer.ybase-P;k--;)this._activeBuffer.lines.splice(T,1),this._activeBuffer.lines.splice(P,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(E){this._restrictCursor();let k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return k&&(k.insertCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(E){this._restrictCursor();let k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return k&&(k.deleteCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(E){let k=E.params[0]||1;for(;k--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(E){let k=E.params[0]||1;for(;k--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(i.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let k=E.params[0]||1;for(let T=this._activeBuffer.scrollTop;T<=this._activeBuffer.scrollBottom;++T){let P=this._activeBuffer.lines.get(this._activeBuffer.ybase+T);P.deleteCells(0,k,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let k=E.params[0]||1;for(let T=this._activeBuffer.scrollTop;T<=this._activeBuffer.scrollBottom;++T){let P=this._activeBuffer.lines.get(this._activeBuffer.ybase+T);P.insertCells(0,k,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let k=E.params[0]||1;for(let T=this._activeBuffer.scrollTop;T<=this._activeBuffer.scrollBottom;++T){let P=this._activeBuffer.lines.get(this._activeBuffer.ybase+T);P.insertCells(this._activeBuffer.x,k,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let k=E.params[0]||1;for(let T=this._activeBuffer.scrollTop;T<=this._activeBuffer.scrollBottom;++T){let P=this._activeBuffer.lines.get(this._activeBuffer.ybase+T);P.deleteCells(this._activeBuffer.x,k,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(E){this._restrictCursor();let k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return k&&(k.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(E.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(E){if(!this._parser.precedingCodepoint)return!0;let k=E.params[0]||1,T=new Uint32Array(k);for(let P=0;P<k;++P)T[P]=this._parser.precedingCodepoint;return this.print(T,0,T.length),!0}sendDeviceAttributesPrimary(E){return E.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(g.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(g.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(E){return E.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(g.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(g.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(E.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(g.C0.ESC+"[>83;40003;0c")),!0}_is(E){return(this._optionsService.rawOptions.termName+"").indexOf(E)===0}setMode(E){for(let k=0;k<E.length;k++)switch(E.params[k]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(E){for(let k=0;k<E.length;k++)switch(E.params[k]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,a.DEFAULT_CHARSET),this._charsetService.setgCharset(1,a.DEFAULT_CHARSET),this._charsetService.setgCharset(2,a.DEFAULT_CHARSET),this._charsetService.setgCharset(3,a.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(E){for(let k=0;k<E.length;k++)switch(E.params[k]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(E){for(let k=0;k<E.length;k++)switch(E.params[k]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),E.params[k]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(E,k){let T=this._coreService.decPrivateModes,{activeProtocol:P,activeEncoding:H}=this._coreMouseService,W=this._coreService,{buffers:K,cols:j}=this._bufferService,{active:$,alt:D}=K,A=this._optionsService.rawOptions,B=z=>z?1:2,M=E.params[0];return U=M,X=k?M===2?3:M===4?B(W.modes.insertMode):M===12?4:M===20?B(A.convertEol):0:M===1?B(T.applicationCursorKeys):M===3?A.windowOptions.setWinLines?j===80?2:j===132?1:0:0:M===6?B(T.origin):M===7?B(T.wraparound):M===8?3:M===9?B(P==="X10"):M===12?B(A.cursorBlink):M===25?B(!W.isCursorHidden):M===45?B(T.reverseWraparound):M===66?B(T.applicationKeypad):M===1e3?B(P==="VT200"):M===1002?B(P==="DRAG"):M===1003?B(P==="ANY"):M===1004?B(T.sendFocus):M===1005?4:M===1006?B(H==="SGR"):M===1015?4:M===1016?B(H==="SGR_PIXELS"):M===1048?1:M===47||M===1047||M===1049?B($===D):M===2004?B(T.bracketedPasteMode):0,W.triggerDataEvent(`${g.C0.ESC}[${k?"":"?"}${U};${X}$y`),!0;var U,X}_updateAttrColor(E,k,T,P,H){return k===2?(E|=50331648,E&=-16777216,E|=v.AttributeData.fromColorRGB([T,P,H])):k===5&&(E&=-50331904,E|=33554432|255&T),E}_extractColor(E,k,T){let P=[0,0,-1,0,0,0],H=0,W=0;do{if(P[W+H]=E.params[k+W],E.hasSubParams(k+W)){let K=E.getSubParams(k+W),j=0;do P[1]===5&&(H=1),P[W+j+1+H]=K[j];while(++j<K.length&&j+W+1+H<P.length);break}if(P[1]===5&&W+H>=2||P[1]===2&&W+H>=5)break;P[1]&&(H=1)}while(++W+k<E.length&&W+H<P.length);for(let K=2;K<P.length;++K)P[K]===-1&&(P[K]=0);switch(P[0]){case 38:T.fg=this._updateAttrColor(T.fg,P[1],P[3],P[4],P[5]);break;case 48:T.bg=this._updateAttrColor(T.bg,P[1],P[3],P[4],P[5]);break;case 58:T.extended=T.extended.clone(),T.extended.underlineColor=this._updateAttrColor(T.extended.underlineColor,P[1],P[3],P[4],P[5])}return W}_processUnderline(E,k){k.extended=k.extended.clone(),(!~E||E>5)&&(E=1),k.extended.underlineStyle=E,k.fg|=268435456,E===0&&(k.fg&=-268435457),k.updateExtended()}_processSGR0(E){E.fg=i.DEFAULT_ATTR_DATA.fg,E.bg=i.DEFAULT_ATTR_DATA.bg,E.extended=E.extended.clone(),E.extended.underlineStyle=0,E.extended.underlineColor&=-67108864,E.updateExtended()}charAttributes(E){if(E.length===1&&E.params[0]===0)return this._processSGR0(this._curAttrData),!0;let k=E.length,T,P=this._curAttrData;for(let H=0;H<k;H++)T=E.params[H],T>=30&&T<=37?(P.fg&=-50331904,P.fg|=16777216|T-30):T>=40&&T<=47?(P.bg&=-50331904,P.bg|=16777216|T-40):T>=90&&T<=97?(P.fg&=-50331904,P.fg|=16777224|T-90):T>=100&&T<=107?(P.bg&=-50331904,P.bg|=16777224|T-100):T===0?this._processSGR0(P):T===1?P.fg|=134217728:T===3?P.bg|=67108864:T===4?(P.fg|=268435456,this._processUnderline(E.hasSubParams(H)?E.getSubParams(H)[0]:1,P)):T===5?P.fg|=536870912:T===7?P.fg|=67108864:T===8?P.fg|=1073741824:T===9?P.fg|=2147483648:T===2?P.bg|=134217728:T===21?this._processUnderline(2,P):T===22?(P.fg&=-134217729,P.bg&=-134217729):T===23?P.bg&=-67108865:T===24?(P.fg&=-268435457,this._processUnderline(0,P)):T===25?P.fg&=-536870913:T===27?P.fg&=-67108865:T===28?P.fg&=-1073741825:T===29?P.fg&=2147483647:T===39?(P.fg&=-67108864,P.fg|=16777215&i.DEFAULT_ATTR_DATA.fg):T===49?(P.bg&=-67108864,P.bg|=16777215&i.DEFAULT_ATTR_DATA.bg):T===38||T===48||T===58?H+=this._extractColor(E,H,P):T===59?(P.extended=P.extended.clone(),P.extended.underlineColor=-1,P.updateExtended()):T===100?(P.fg&=-67108864,P.fg|=16777215&i.DEFAULT_ATTR_DATA.fg,P.bg&=-67108864,P.bg|=16777215&i.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",T);return!0}deviceStatus(E){switch(E.params[0]){case 5:this._coreService.triggerDataEvent(`${g.C0.ESC}[0n`);break;case 6:let k=this._activeBuffer.y+1,T=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${g.C0.ESC}[${k};${T}R`)}return!0}deviceStatusPrivate(E){if(E.params[0]===6){let k=this._activeBuffer.y+1,T=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${g.C0.ESC}[?${k};${T}R`)}return!0}softReset(E){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(E){let k=E.params[0]||1;switch(k){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}let T=k%2==1;return this._optionsService.options.cursorBlink=T,!0}setScrollRegion(E){let k=E.params[0]||1,T;return(E.length<2||(T=E.params[1])>this._bufferService.rows||T===0)&&(T=this._bufferService.rows),T>k&&(this._activeBuffer.scrollTop=k-1,this._activeBuffer.scrollBottom=T-1,this._setCursor(0,0)),!0}windowOptions(E){if(!x(E.params[0],this._optionsService.rawOptions.windowOptions))return!0;let k=E.length>1?E.params[1]:0;switch(E.params[0]){case 14:k!==2&&this._onRequestWindowsOptionsReport.fire(R.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(R.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${g.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:k!==0&&k!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),k!==0&&k!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:k!==0&&k!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),k!==0&&k!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(E){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(E){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(E){return this._windowTitle=E,this._onTitleChange.fire(E),!0}setIconName(E){return this._iconName=E,!0}setOrReportIndexedColor(E){let k=[],T=E.split(";");for(;T.length>1;){let P=T.shift(),H=T.shift();if(/^\d+$/.exec(P)){let W=parseInt(P);if(0<=W&&W<256)if(H==="?")k.push({type:0,index:W});else{let K=(0,S.parseColor)(H);K&&k.push({type:1,index:W,color:K})}}}return k.length&&this._onColor.fire(k),!0}setHyperlink(E){let k=E.split(";");return!(k.length<2)&&(k[1]?this._createHyperlink(k[0],k[1]):!k[0]&&this._finishHyperlink())}_createHyperlink(E,k){this._getCurrentLinkId()&&this._finishHyperlink();let T=E.split(":"),P,H=T.findIndex(W=>W.startsWith("id="));return H!==-1&&(P=T[H].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:P,uri:k}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(E,k){let T=E.split(";");for(let P=0;P<T.length&&!(k>=this._specialColors.length);++P,++k)if(T[P]==="?")this._onColor.fire([{type:0,index:this._specialColors[k]}]);else{let H=(0,S.parseColor)(T[P]);H&&this._onColor.fire([{type:1,index:this._specialColors[k],color:H}])}return!0}setOrReportFgColor(E){return this._setOrReportSpecialColor(E,0)}setOrReportBgColor(E){return this._setOrReportSpecialColor(E,1)}setOrReportCursorColor(E){return this._setOrReportSpecialColor(E,2)}restoreIndexedColor(E){if(!E)return this._onColor.fire([{type:2}]),!0;let k=[],T=E.split(";");for(let P=0;P<T.length;++P)if(/^\d+$/.exec(T[P])){let H=parseInt(T[P]);0<=H&&H<256&&k.push({type:2,index:H})}return k.length&&this._onColor.fire(k),!0}restoreFgColor(E){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(E){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(E){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,a.DEFAULT_CHARSET),!0}selectCharset(E){return E.length!==2?(this.selectDefaultCharset(),!0):(E[0]==="/"||this._charsetService.setgCharset(C[E[0]],a.CHARSETS[E[1]]||a.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let E=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,E,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=i.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(E){return this._charsetService.setgLevel(E),!0}screenAlignmentPattern(){let E=new h.CellData;E.content=4194304|"E".charCodeAt(0),E.fg=this._curAttrData.fg,E.bg=this._curAttrData.bg,this._setCursor(0,0);for(let k=0;k<this._bufferService.rows;++k){let T=this._activeBuffer.ybase+this._activeBuffer.y+k,P=this._activeBuffer.lines.get(T);P&&(P.fill(E),P.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(E,k){let T=this._bufferService.buffer,P=this._optionsService.rawOptions;return(H=>(this._coreService.triggerDataEvent(`${g.C0.ESC}${H}${g.C0.ESC}\\`),!0))(E==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:E==='"p'?'P1$r61;1"p':E==="r"?`P1$r${T.scrollTop+1};${T.scrollBottom+1}r`:E==="m"?"P1$r0m":E===" q"?`P1$r${{block:2,underline:4,bar:6}[P.cursorStyle]-(P.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(E,k){this._dirtyRowTracker.markRangeDirty(E,k)}}e.InputHandler=I;let N=class{constructor(F){this._bufferService=F,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(F){F<this.start?this.start=F:F>this.end&&(this.end=F)}markRangeDirty(F,E){F>E&&(O=F,F=E,E=O),F<this.start&&(this.start=F),E>this.end&&(this.end=E)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};N=c([d(0,y.IBufferService)],N)},844:(o,e)=>{function r(c){for(let d of c)d.dispose();c.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.toDisposable=e.Disposable=void 0,e.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){let d=this._disposables.indexOf(c);d!==-1&&this._disposables.splice(d,1)}},e.toDisposable=function(c){return{dispose:c}},e.disposeArray=r,e.getDisposeArrayDisposable=function(c){return{dispose:()=>r(c)}}},1505:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FourKeyMap=e.TwoKeyMap=void 0;class r{constructor(){this._data={}}set(d,g,a){this._data[d]||(this._data[d]={}),this._data[d][g]=a}get(d,g){return this._data[d]?this._data[d][g]:void 0}clear(){this._data={}}}e.TwoKeyMap=r,e.FourKeyMap=class{constructor(){this._data=new r}set(c,d,g,a,f){this._data.get(c,d)||this._data.set(c,d,new r),this._data.get(c,d).set(g,a,f)}get(c,d,g,a){var f;return(f=this._data.get(c,d))===null||f===void 0?void 0:f.get(g,a)}clear(){this._data.clear()}}},6114:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isChromeOS=e.isLinux=e.isWindows=e.isIphone=e.isIpad=e.isMac=e.getSafariVersion=e.isSafari=e.isLegacyEdge=e.isFirefox=e.isNode=void 0,e.isNode=typeof navigator=="undefined";let r=e.isNode?"node":navigator.userAgent,c=e.isNode?"node":navigator.platform;e.isFirefox=r.includes("Firefox"),e.isLegacyEdge=r.includes("Edge"),e.isSafari=/^((?!chrome|android).)*safari/i.test(r),e.getSafariVersion=function(){if(!e.isSafari)return 0;let d=r.match(/Version\/(\d+)/);return d===null||d.length<2?0:parseInt(d[1])},e.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(c),e.isIpad=c==="iPad",e.isIphone=c==="iPhone",e.isWindows=["Windows","Win16","Win32","WinCE"].includes(c),e.isLinux=c.indexOf("Linux")>=0,e.isChromeOS=/\bCrOS\b/.test(r)},6106:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SortedList=void 0;let r=0;e.SortedList=class{constructor(c){this._getKey=c,this._array=[]}clear(){this._array.length=0}insert(c){this._array.length!==0?(r=this._search(this._getKey(c),0,this._array.length-1),this._array.splice(r,0,c)):this._array.push(c)}delete(c){if(this._array.length===0)return!1;let d=this._getKey(c);if(d===void 0||(r=this._search(d,0,this._array.length-1),r===-1)||this._getKey(this._array[r])!==d)return!1;do if(this._array[r]===c)return this._array.splice(r,1),!0;while(++r<this._array.length&&this._getKey(this._array[r])===d);return!1}*getKeyIterator(c){if(this._array.length!==0&&(r=this._search(c,0,this._array.length-1),!(r<0||r>=this._array.length)&&this._getKey(this._array[r])===c))do yield this._array[r];while(++r<this._array.length&&this._getKey(this._array[r])===c)}forEachByKey(c,d){if(this._array.length!==0&&(r=this._search(c,0,this._array.length-1),!(r<0||r>=this._array.length)&&this._getKey(this._array[r])===c))do d(this._array[r]);while(++r<this._array.length&&this._getKey(this._array[r])===c)}values(){return this._array.values()}_search(c,d,g){if(g<d)return d;let a=Math.floor((d+g)/2),f=this._getKey(this._array[a]);if(f>c)return this._search(c,d,a-1);if(f<c)return this._search(c,a+1,g);for(;a>0&&this._getKey(this._array[a-1])===c;)a--;return a}}},7226:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DebouncedIdleTask=e.IdleTaskQueue=e.PriorityTaskQueue=void 0;let c=r(6114);class d{constructor(){this._tasks=[],this._i=0}enqueue(f){this._tasks.push(f),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(f){this._idleCallback=void 0;let m=0,_=0,i=f.timeRemaining(),u=0;for(;this._i<this._tasks.length;){if(m=Date.now(),this._tasks[this._i]()||this._i++,m=Math.max(1,Date.now()-m),_=Math.max(m,_),u=f.timeRemaining(),1.5*_>u)return i-m<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(i-m))}ms`),void this._start();i=u}this.clear()}}class g extends d{_requestCallback(f){return setTimeout(()=>f(this._createDeadline(16)))}_cancelCallback(f){clearTimeout(f)}_createDeadline(f){let m=Date.now()+f;return{timeRemaining:()=>Math.max(0,m-Date.now())}}}e.PriorityTaskQueue=g,e.IdleTaskQueue=!c.isNode&&"requestIdleCallback"in window?class extends d{_requestCallback(a){return requestIdleCallback(a)}_cancelCallback(a){cancelIdleCallback(a)}}:g,e.DebouncedIdleTask=class{constructor(){this._queue=new e.IdleTaskQueue}set(a){this._queue.clear(),this._queue.enqueue(a)}flush(){this._queue.flush()}}},9282:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.updateWindowsModeWrappedState=void 0;let c=r(643);e.updateWindowsModeWrappedState=function(d){let g=d.buffer.lines.get(d.buffer.ybase+d.buffer.y-1),a=g==null?void 0:g.get(d.cols-1),f=d.buffer.lines.get(d.buffer.ybase+d.buffer.y);f&&a&&(f.isWrapped=a[c.CHAR_DATA_CODE_INDEX]!==c.NULL_CELL_CODE&&a[c.CHAR_DATA_CODE_INDEX]!==c.WHITESPACE_CELL_CODE)}},3734:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedAttrs=e.AttributeData=void 0;class r{constructor(){this.fg=0,this.bg=0,this.extended=new c}static toColorRGB(g){return[g>>>16&255,g>>>8&255,255&g]}static fromColorRGB(g){return(255&g[0])<<16|(255&g[1])<<8|255&g[2]}clone(){let g=new r;return g.fg=this.fg,g.bg=this.bg,g.extended=this.extended.clone(),g}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}e.AttributeData=r;class c{constructor(g=0,a=0){this._ext=0,this._urlId=0,this._ext=g,this._urlId=a}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(g){this._ext=g}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(g){this._ext&=-469762049,this._ext|=g<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(g){this._ext&=-67108864,this._ext|=67108863&g}get urlId(){return this._urlId}set urlId(g){this._urlId=g}clone(){return new c(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}e.ExtendedAttrs=c},9092:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferStringIterator=e.Buffer=e.MAX_BUFFER_SIZE=void 0;let c=r(6349),d=r(8437),g=r(511),a=r(643),f=r(4634),m=r(4863),_=r(7116),i=r(3734),u=r(7226);e.MAX_BUFFER_SIZE=4294967295,e.Buffer=class{constructor(h,v,y){this._hasScrollback=h,this._optionsService=v,this._bufferService=y,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=d.DEFAULT_ATTR_DATA.clone(),this.savedCharset=_.DEFAULT_CHARSET,this.markers=[],this._nullCell=g.CellData.fromCharData([0,a.NULL_CELL_CHAR,a.NULL_CELL_WIDTH,a.NULL_CELL_CODE]),this._whitespaceCell=g.CellData.fromCharData([0,a.WHITESPACE_CELL_CHAR,a.WHITESPACE_CELL_WIDTH,a.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new u.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(h){return h?(this._nullCell.fg=h.fg,this._nullCell.bg=h.bg,this._nullCell.extended=h.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new i.ExtendedAttrs),this._nullCell}getWhitespaceCell(h){return h?(this._whitespaceCell.fg=h.fg,this._whitespaceCell.bg=h.bg,this._whitespaceCell.extended=h.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new i.ExtendedAttrs),this._whitespaceCell}getBlankLine(h,v){return new d.BufferLine(this._bufferService.cols,this.getNullCell(h),v)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let h=this.ybase+this.y-this.ydisp;return h>=0&&h<this._rows}_getCorrectBufferLength(h){if(!this._hasScrollback)return h;let v=h+this._optionsService.rawOptions.scrollback;return v>e.MAX_BUFFER_SIZE?e.MAX_BUFFER_SIZE:v}fillViewportRows(h){if(this.lines.length===0){h===void 0&&(h=d.DEFAULT_ATTR_DATA);let v=this._rows;for(;v--;)this.lines.push(this.getBlankLine(h))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(h,v){let y=this.getNullCell(d.DEFAULT_ATTR_DATA),b=0,w=this._getCorrectBufferLength(v);if(w>this.lines.maxLength&&(this.lines.maxLength=w),this.lines.length>0){if(this._cols<h)for(let C=0;C<this.lines.length;C++)b+=+this.lines.get(C).resize(h,y);let S=0;if(this._rows<v)for(let C=this._rows;C<v;C++)this.lines.length<v+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new d.BufferLine(h,y)):this.ybase>0&&this.lines.length<=this.ybase+this.y+S+1?(this.ybase--,S++,this.ydisp>0&&this.ydisp--):this.lines.push(new d.BufferLine(h,y)));else for(let C=this._rows;C>v;C--)this.lines.length>v+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(w<this.lines.maxLength){let C=this.lines.length-w;C>0&&(this.lines.trimStart(C),this.ybase=Math.max(this.ybase-C,0),this.ydisp=Math.max(this.ydisp-C,0),this.savedY=Math.max(this.savedY-C,0)),this.lines.maxLength=w}this.x=Math.min(this.x,h-1),this.y=Math.min(this.y,v-1),S&&(this.y+=S),this.savedX=Math.min(this.savedX,h-1),this.scrollTop=0}if(this.scrollBottom=v-1,this._isReflowEnabled&&(this._reflow(h,v),this._cols>h))for(let S=0;S<this.lines.length;S++)b+=+this.lines.get(S).resize(h,y);this._cols=h,this._rows=v,this._memoryCleanupQueue.clear(),b>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let h=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,h=!1);let v=0;for(;this._memoryCleanupPosition<this.lines.length;)if(v+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),v>100)return!0;return h}get _isReflowEnabled(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(h,v){this._cols!==h&&(h>this._cols?this._reflowLarger(h,v):this._reflowSmaller(h,v))}_reflowLarger(h,v){let y=(0,f.reflowLargerGetLinesToRemove)(this.lines,this._cols,h,this.ybase+this.y,this.getNullCell(d.DEFAULT_ATTR_DATA));if(y.length>0){let b=(0,f.reflowLargerCreateNewLayout)(this.lines,y);(0,f.reflowLargerApplyNewLayout)(this.lines,b.layout),this._reflowLargerAdjustViewport(h,v,b.countRemoved)}}_reflowLargerAdjustViewport(h,v,y){let b=this.getNullCell(d.DEFAULT_ATTR_DATA),w=y;for(;w-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<v&&this.lines.push(new d.BufferLine(h,b))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-y,0)}_reflowSmaller(h,v){let y=this.getNullCell(d.DEFAULT_ATTR_DATA),b=[],w=0;for(let S=this.lines.length-1;S>=0;S--){let C=this.lines.get(S);if(!C||!C.isWrapped&&C.getTrimmedLength()<=h)continue;let L=[C];for(;C.isWrapped&&S>0;)C=this.lines.get(--S),L.unshift(C);let x=this.ybase+this.y;if(x>=S&&x<S+L.length)continue;let R=L[L.length-1].getTrimmedLength(),O=(0,f.reflowSmallerGetNewLineLengths)(L,this._cols,h),I=O.length-L.length,N;N=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+I):Math.max(0,this.lines.length-this.lines.maxLength+I);let F=[];for(let W=0;W<I;W++){let K=this.getBlankLine(d.DEFAULT_ATTR_DATA,!0);F.push(K)}F.length>0&&(b.push({start:S+L.length+w,newLines:F}),w+=F.length),L.push(...F);let E=O.length-1,k=O[E];k===0&&(E--,k=O[E]);let T=L.length-I-1,P=R;for(;T>=0;){let W=Math.min(P,k);if(L[E]===void 0)break;if(L[E].copyCellsFrom(L[T],P-W,k-W,W,!0),k-=W,k===0&&(E--,k=O[E]),P-=W,P===0){T--;let K=Math.max(T,0);P=(0,f.getWrappedLineTrimmedLength)(L,K,this._cols)}}for(let W=0;W<L.length;W++)O[W]<h&&L[W].setCell(O[W],y);let H=I-N;for(;H-- >0;)this.ybase===0?this.y<v-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+w)-v&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+I,this.ybase+v-1)}if(b.length>0){let S=[],C=[];for(let E=0;E<this.lines.length;E++)C.push(this.lines.get(E));let L=this.lines.length,x=L-1,R=0,O=b[R];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+w);let I=0;for(let E=Math.min(this.lines.maxLength-1,L+w-1);E>=0;E--)if(O&&O.start>x+I){for(let k=O.newLines.length-1;k>=0;k--)this.lines.set(E--,O.newLines[k]);E++,S.push({index:x+1,amount:O.newLines.length}),I+=O.newLines.length,O=b[++R]}else this.lines.set(E,C[x--]);let N=0;for(let E=S.length-1;E>=0;E--)S[E].index+=N,this.lines.onInsertEmitter.fire(S[E]),N+=S[E].amount;let F=Math.max(0,L+w-this.lines.maxLength);F>0&&this.lines.onTrimEmitter.fire(F)}}stringIndexToBufferIndex(h,v,y=!1){for(;v;){let b=this.lines.get(h);if(!b)return[-1,-1];let w=y?b.getTrimmedLength():b.length;for(let S=0;S<w;++S)if(b.get(S)[a.CHAR_DATA_WIDTH_INDEX]&&(v-=b.get(S)[a.CHAR_DATA_CHAR_INDEX].length||1),v<0)return[h,S];h++}return[h,0]}translateBufferLineToString(h,v,y=0,b){let w=this.lines.get(h);return w?w.translateToString(v,y,b):""}getWrappedRangeForLine(h){let v=h,y=h;for(;v>0&&this.lines.get(v).isWrapped;)v--;for(;y+1<this.lines.length&&this.lines.get(y+1).isWrapped;)y++;return{first:v,last:y}}setupTabStops(h){for(h!=null?this.tabs[h]||(h=this.prevStop(h)):(this.tabs={},h=0);h<this._cols;h+=this._optionsService.rawOptions.tabStopWidth)this.tabs[h]=!0}prevStop(h){for(h==null&&(h=this.x);!this.tabs[--h]&&h>0;);return h>=this._cols?this._cols-1:h<0?0:h}nextStop(h){for(h==null&&(h=this.x);!this.tabs[++h]&&h<this._cols;);return h>=this._cols?this._cols-1:h<0?0:h}clearMarkers(h){this._isClearing=!0;for(let v=0;v<this.markers.length;v++)this.markers[v].line===h&&(this.markers[v].dispose(),this.markers.splice(v--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let h=0;h<this.markers.length;h++)this.markers[h].dispose(),this.markers.splice(h--,1);this._isClearing=!1}addMarker(h){let v=new m.Marker(h);return this.markers.push(v),v.register(this.lines.onTrim(y=>{v.line-=y,v.line<0&&v.dispose()})),v.register(this.lines.onInsert(y=>{v.line>=y.index&&(v.line+=y.amount)})),v.register(this.lines.onDelete(y=>{v.line>=y.index&&v.line<y.index+y.amount&&v.dispose(),v.line>y.index&&(v.line-=y.amount)})),v.register(v.onDispose(()=>this._removeMarker(v))),v}_removeMarker(h){this._isClearing||this.markers.splice(this.markers.indexOf(h),1)}iterator(h,v,y,b,w){return new p(this,h,v,y,b,w)}};class p{constructor(v,y,b=0,w=v.lines.length,S=0,C=0){this._buffer=v,this._trimRight=y,this._startIndex=b,this._endIndex=w,this._startOverscan=S,this._endOverscan=C,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}hasNext(){return this._current<this._endIndex}next(){let v=this._buffer.getWrappedRangeForLine(this._current);v.first<this._startIndex-this._startOverscan&&(v.first=this._startIndex-this._startOverscan),v.last>this._endIndex+this._endOverscan&&(v.last=this._endIndex+this._endOverscan),v.first=Math.max(v.first,0),v.last=Math.min(v.last,this._buffer.lines.length);let y="";for(let b=v.first;b<=v.last;++b)y+=this._buffer.translateBufferLineToString(b,this._trimRight);return this._current=v.last+1,{range:v,content:y}}}e.BufferStringIterator=p},8437:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferLine=e.DEFAULT_ATTR_DATA=void 0;let c=r(482),d=r(643),g=r(511),a=r(3734);e.DEFAULT_ATTR_DATA=Object.freeze(new a.AttributeData);let f=0;class m{constructor(i,u,p=!1){this.isWrapped=p,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*i);let h=u||g.CellData.fromCharData([0,d.NULL_CELL_CHAR,d.NULL_CELL_WIDTH,d.NULL_CELL_CODE]);for(let v=0;v<i;++v)this.setCell(v,h);this.length=i}get(i){let u=this._data[3*i+0],p=2097151&u;return[this._data[3*i+1],2097152&u?this._combined[i]:p?(0,c.stringFromCodePoint)(p):"",u>>22,2097152&u?this._combined[i].charCodeAt(this._combined[i].length-1):p]}set(i,u){this._data[3*i+1]=u[d.CHAR_DATA_ATTR_INDEX],u[d.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[i]=u[1],this._data[3*i+0]=2097152|i|u[d.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*i+0]=u[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|u[d.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(i){return this._data[3*i+0]>>22}hasWidth(i){return 12582912&this._data[3*i+0]}getFg(i){return this._data[3*i+1]}getBg(i){return this._data[3*i+2]}hasContent(i){return 4194303&this._data[3*i+0]}getCodePoint(i){let u=this._data[3*i+0];return 2097152&u?this._combined[i].charCodeAt(this._combined[i].length-1):2097151&u}isCombined(i){return 2097152&this._data[3*i+0]}getString(i){let u=this._data[3*i+0];return 2097152&u?this._combined[i]:2097151&u?(0,c.stringFromCodePoint)(2097151&u):""}isProtected(i){return 536870912&this._data[3*i+2]}loadCell(i,u){return f=3*i,u.content=this._data[f+0],u.fg=this._data[f+1],u.bg=this._data[f+2],2097152&u.content&&(u.combinedData=this._combined[i]),268435456&u.bg&&(u.extended=this._extendedAttrs[i]),u}setCell(i,u){2097152&u.content&&(this._combined[i]=u.combinedData),268435456&u.bg&&(this._extendedAttrs[i]=u.extended),this._data[3*i+0]=u.content,this._data[3*i+1]=u.fg,this._data[3*i+2]=u.bg}setCellFromCodePoint(i,u,p,h,v,y){268435456&v&&(this._extendedAttrs[i]=y),this._data[3*i+0]=u|p<<22,this._data[3*i+1]=h,this._data[3*i+2]=v}addCodepointToCell(i,u){let p=this._data[3*i+0];2097152&p?this._combined[i]+=(0,c.stringFromCodePoint)(u):(2097151&p?(this._combined[i]=(0,c.stringFromCodePoint)(2097151&p)+(0,c.stringFromCodePoint)(u),p&=-2097152,p|=2097152):p=u|4194304,this._data[3*i+0]=p)}insertCells(i,u,p,h){if((i%=this.length)&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs),u<this.length-i){let v=new g.CellData;for(let y=this.length-i-u-1;y>=0;--y)this.setCell(i+u+y,this.loadCell(i+y,v));for(let y=0;y<u;++y)this.setCell(i+y,p)}else for(let v=i;v<this.length;++v)this.setCell(v,p);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs)}deleteCells(i,u,p,h){if(i%=this.length,u<this.length-i){let v=new g.CellData;for(let y=0;y<this.length-i-u;++y)this.setCell(i+y,this.loadCell(i+u+y,v));for(let y=this.length-u;y<this.length;++y)this.setCell(y,p)}else for(let v=i;v<this.length;++v)this.setCell(v,p);i&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs),this.getWidth(i)!==0||this.hasContent(i)||this.setCellFromCodePoint(i,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs)}replaceCells(i,u,p,h,v=!1){if(v)for(i&&this.getWidth(i-1)===2&&!this.isProtected(i-1)&&this.setCellFromCodePoint(i-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs),u<this.length&&this.getWidth(u-1)===2&&!this.isProtected(u)&&this.setCellFromCodePoint(u,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs);i<u&&i<this.length;)this.isProtected(i)||this.setCell(i,p),i++;else for(i&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs),u<this.length&&this.getWidth(u-1)===2&&this.setCellFromCodePoint(u,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs);i<u&&i<this.length;)this.setCell(i++,p)}resize(i,u){if(i===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;let p=3*i;if(i>this.length){if(this._data.buffer.byteLength>=4*p)this._data=new Uint32Array(this._data.buffer,0,p);else{let h=new Uint32Array(p);h.set(this._data),this._data=h}for(let h=this.length;h<i;++h)this.setCell(h,u)}else{this._data=this._data.subarray(0,p);let h=Object.keys(this._combined);for(let y=0;y<h.length;y++){let b=parseInt(h[y],10);b>=i&&delete this._combined[b]}let v=Object.keys(this._extendedAttrs);for(let y=0;y<v.length;y++){let b=parseInt(v[y],10);b>=i&&delete this._extendedAttrs[b]}}return this.length=i,4*p*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){let i=new Uint32Array(this._data.length);return i.set(this._data),this._data=i,1}return 0}fill(i,u=!1){if(u)for(let p=0;p<this.length;++p)this.isProtected(p)||this.setCell(p,i);else{this._combined={},this._extendedAttrs={};for(let p=0;p<this.length;++p)this.setCell(p,i)}}copyFrom(i){this.length!==i.length?this._data=new Uint32Array(i._data):this._data.set(i._data),this.length=i.length,this._combined={};for(let u in i._combined)this._combined[u]=i._combined[u];this._extendedAttrs={};for(let u in i._extendedAttrs)this._extendedAttrs[u]=i._extendedAttrs[u];this.isWrapped=i.isWrapped}clone(){let i=new m(0);i._data=new Uint32Array(this._data),i.length=this.length;for(let u in this._combined)i._combined[u]=this._combined[u];for(let u in this._extendedAttrs)i._extendedAttrs[u]=this._extendedAttrs[u];return i.isWrapped=this.isWrapped,i}getTrimmedLength(){for(let i=this.length-1;i>=0;--i)if(4194303&this._data[3*i+0])return i+(this._data[3*i+0]>>22);return 0}copyCellsFrom(i,u,p,h,v){let y=i._data;if(v)for(let w=h-1;w>=0;w--){for(let S=0;S<3;S++)this._data[3*(p+w)+S]=y[3*(u+w)+S];268435456&y[3*(u+w)+2]&&(this._extendedAttrs[p+w]=i._extendedAttrs[u+w])}else for(let w=0;w<h;w++){for(let S=0;S<3;S++)this._data[3*(p+w)+S]=y[3*(u+w)+S];268435456&y[3*(u+w)+2]&&(this._extendedAttrs[p+w]=i._extendedAttrs[u+w])}let b=Object.keys(i._combined);for(let w=0;w<b.length;w++){let S=parseInt(b[w],10);S>=u&&(this._combined[S-u+p]=i._combined[S])}}translateToString(i=!1,u=0,p=this.length){i&&(p=Math.min(p,this.getTrimmedLength()));let h="";for(;u<p;){let v=this._data[3*u+0],y=2097151&v;h+=2097152&v?this._combined[u]:y?(0,c.stringFromCodePoint)(y):d.WHITESPACE_CELL_CHAR,u+=v>>22||1}return h}}e.BufferLine=m},4841:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getRangeLength=void 0,e.getRangeLength=function(r,c){if(r.start.y>r.end.y)throw new Error(`Buffer range end (${r.end.x}, ${r.end.y}) cannot be before start (${r.start.x}, ${r.start.y})`);return c*(r.end.y-r.start.y)+(r.end.x-r.start.x+1)}},4634:(o,e)=>{function r(c,d,g){if(d===c.length-1)return c[d].getTrimmedLength();let a=!c[d].hasContent(g-1)&&c[d].getWidth(g-1)===1,f=c[d+1].getWidth(0)===2;return a&&f?g-1:g}Object.defineProperty(e,"__esModule",{value:!0}),e.getWrappedLineTrimmedLength=e.reflowSmallerGetNewLineLengths=e.reflowLargerApplyNewLayout=e.reflowLargerCreateNewLayout=e.reflowLargerGetLinesToRemove=void 0,e.reflowLargerGetLinesToRemove=function(c,d,g,a,f){let m=[];for(let _=0;_<c.length-1;_++){let i=_,u=c.get(++i);if(!u.isWrapped)continue;let p=[c.get(_)];for(;i<c.length&&u.isWrapped;)p.push(u),u=c.get(++i);if(a>=_&&a<i){_+=p.length-1;continue}let h=0,v=r(p,h,d),y=1,b=0;for(;y<p.length;){let S=r(p,y,d),C=S-b,L=g-v,x=Math.min(C,L);p[h].copyCellsFrom(p[y],b,v,x,!1),v+=x,v===g&&(h++,v=0),b+=x,b===S&&(y++,b=0),v===0&&h!==0&&p[h-1].getWidth(g-1)===2&&(p[h].copyCellsFrom(p[h-1],g-1,v++,1,!1),p[h-1].setCell(g-1,f))}p[h].replaceCells(v,g,f);let w=0;for(let S=p.length-1;S>0&&(S>h||p[S].getTrimmedLength()===0);S--)w++;w>0&&(m.push(_+p.length-w),m.push(w)),_+=p.length-1}return m},e.reflowLargerCreateNewLayout=function(c,d){let g=[],a=0,f=d[a],m=0;for(let _=0;_<c.length;_++)if(f===_){let i=d[++a];c.onDeleteEmitter.fire({index:_-m,amount:i}),_+=i-1,m+=i,f=d[++a]}else g.push(_);return{layout:g,countRemoved:m}},e.reflowLargerApplyNewLayout=function(c,d){let g=[];for(let a=0;a<d.length;a++)g.push(c.get(d[a]));for(let a=0;a<g.length;a++)c.set(a,g[a]);c.length=d.length},e.reflowSmallerGetNewLineLengths=function(c,d,g){let a=[],f=c.map((u,p)=>r(c,p,d)).reduce((u,p)=>u+p),m=0,_=0,i=0;for(;i<f;){if(f-i<g){a.push(f-i);break}m+=g;let u=r(c,_,d);m>u&&(m-=u,_++);let p=c[_].getWidth(m-1)===2;p&&m--;let h=p?g-1:g;a.push(h),i+=h}return a},e.getWrappedLineTrimmedLength=r},5295:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferSet=void 0;let c=r(9092),d=r(8460),g=r(844);class a extends g.Disposable{constructor(m,_){super(),this._optionsService=m,this._bufferService=_,this._onBufferActivate=this.register(new d.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new c.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new c.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(m){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(m),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(m,_){this._normal.resize(m,_),this._alt.resize(m,_),this.setupTabStops(m)}setupTabStops(m){this._normal.setupTabStops(m),this._alt.setupTabStops(m)}}e.BufferSet=a},511:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CellData=void 0;let c=r(482),d=r(643),g=r(3734);class a extends g.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new g.ExtendedAttrs,this.combinedData=""}static fromCharData(m){let _=new a;return _.setFromCharData(m),_}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,c.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(m){this.fg=m[d.CHAR_DATA_ATTR_INDEX],this.bg=0;let _=!1;if(m[d.CHAR_DATA_CHAR_INDEX].length>2)_=!0;else if(m[d.CHAR_DATA_CHAR_INDEX].length===2){let i=m[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){let u=m[d.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=u&&u<=57343?this.content=1024*(i-55296)+u-56320+65536|m[d.CHAR_DATA_WIDTH_INDEX]<<22:_=!0}else _=!0}else this.content=m[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|m[d.CHAR_DATA_WIDTH_INDEX]<<22;_&&(this.combinedData=m[d.CHAR_DATA_CHAR_INDEX],this.content=2097152|m[d.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.CellData=a},643:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WHITESPACE_CELL_CODE=e.WHITESPACE_CELL_WIDTH=e.WHITESPACE_CELL_CHAR=e.NULL_CELL_CODE=e.NULL_CELL_WIDTH=e.NULL_CELL_CHAR=e.CHAR_DATA_CODE_INDEX=e.CHAR_DATA_WIDTH_INDEX=e.CHAR_DATA_CHAR_INDEX=e.CHAR_DATA_ATTR_INDEX=e.DEFAULT_EXT=e.DEFAULT_ATTR=e.DEFAULT_COLOR=void 0,e.DEFAULT_COLOR=0,e.DEFAULT_ATTR=256|e.DEFAULT_COLOR<<9,e.DEFAULT_EXT=0,e.CHAR_DATA_ATTR_INDEX=0,e.CHAR_DATA_CHAR_INDEX=1,e.CHAR_DATA_WIDTH_INDEX=2,e.CHAR_DATA_CODE_INDEX=3,e.NULL_CELL_CHAR="",e.NULL_CELL_WIDTH=1,e.NULL_CELL_CODE=0,e.WHITESPACE_CELL_CHAR=" ",e.WHITESPACE_CELL_WIDTH=1,e.WHITESPACE_CELL_CODE=32},4863:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Marker=void 0;let c=r(8460),d=r(844);class g{constructor(f){this.line=f,this.isDisposed=!1,this._disposables=[],this._id=g._nextId++,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,d.disposeArray)(this._disposables),this._disposables.length=0)}register(f){return this._disposables.push(f),f}}e.Marker=g,g._nextId=1},7116:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_CHARSET=e.CHARSETS=void 0,e.CHARSETS={},e.DEFAULT_CHARSET=e.CHARSETS.B,e.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},e.CHARSETS.A={"#":"\xA3"},e.CHARSETS.B=void 0,e.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},e.CHARSETS.C=e.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},e.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},e.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},e.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},e.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},e.CHARSETS.E=e.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},e.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},e.CHARSETS.H=e.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},e.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:(o,e)=>{var r,c;Object.defineProperty(e,"__esModule",{value:!0}),e.C1_ESCAPED=e.C1=e.C0=void 0,function(d){d.NUL="\0",d.SOH="",d.STX="",d.ETX="",d.EOT="",d.ENQ="",d.ACK="",d.BEL="\x07",d.BS="\b",d.HT="	",d.LF=`
`,d.VT="\v",d.FF="\f",d.CR="\r",d.SO="",d.SI="",d.DLE="",d.DC1="",d.DC2="",d.DC3="",d.DC4="",d.NAK="",d.SYN="",d.ETB="",d.CAN="",d.EM="",d.SUB="",d.ESC="\x1B",d.FS="",d.GS="",d.RS="",d.US="",d.SP=" ",d.DEL="\x7F"}(r=e.C0||(e.C0={})),(c=e.C1||(e.C1={})).PAD="\x80",c.HOP="\x81",c.BPH="\x82",c.NBH="\x83",c.IND="\x84",c.NEL="\x85",c.SSA="\x86",c.ESA="\x87",c.HTS="\x88",c.HTJ="\x89",c.VTS="\x8A",c.PLD="\x8B",c.PLU="\x8C",c.RI="\x8D",c.SS2="\x8E",c.SS3="\x8F",c.DCS="\x90",c.PU1="\x91",c.PU2="\x92",c.STS="\x93",c.CCH="\x94",c.MW="\x95",c.SPA="\x96",c.EPA="\x97",c.SOS="\x98",c.SGCI="\x99",c.SCI="\x9A",c.CSI="\x9B",c.ST="\x9C",c.OSC="\x9D",c.PM="\x9E",c.APC="\x9F",(e.C1_ESCAPED||(e.C1_ESCAPED={})).ST=`${r.ESC}\\`},7399:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.evaluateKeyboardEvent=void 0;let c=r(2584),d={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};e.evaluateKeyboardEvent=function(g,a,f,m){let _={type:0,cancel:!1,key:void 0},i=(g.shiftKey?1:0)|(g.altKey?2:0)|(g.ctrlKey?4:0)|(g.metaKey?8:0);switch(g.keyCode){case 0:g.key==="UIKeyInputUpArrow"?_.key=a?c.C0.ESC+"OA":c.C0.ESC+"[A":g.key==="UIKeyInputLeftArrow"?_.key=a?c.C0.ESC+"OD":c.C0.ESC+"[D":g.key==="UIKeyInputRightArrow"?_.key=a?c.C0.ESC+"OC":c.C0.ESC+"[C":g.key==="UIKeyInputDownArrow"&&(_.key=a?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:if(g.altKey){_.key=c.C0.ESC+c.C0.DEL;break}_.key=c.C0.DEL;break;case 9:if(g.shiftKey){_.key=c.C0.ESC+"[Z";break}_.key=c.C0.HT,_.cancel=!0;break;case 13:_.key=g.altKey?c.C0.ESC+c.C0.CR:c.C0.CR,_.cancel=!0;break;case 27:_.key=c.C0.ESC,g.altKey&&(_.key=c.C0.ESC+c.C0.ESC),_.cancel=!0;break;case 37:if(g.metaKey)break;i?(_.key=c.C0.ESC+"[1;"+(i+1)+"D",_.key===c.C0.ESC+"[1;3D"&&(_.key=c.C0.ESC+(f?"b":"[1;5D"))):_.key=a?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:if(g.metaKey)break;i?(_.key=c.C0.ESC+"[1;"+(i+1)+"C",_.key===c.C0.ESC+"[1;3C"&&(_.key=c.C0.ESC+(f?"f":"[1;5C"))):_.key=a?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:if(g.metaKey)break;i?(_.key=c.C0.ESC+"[1;"+(i+1)+"A",f||_.key!==c.C0.ESC+"[1;3A"||(_.key=c.C0.ESC+"[1;5A")):_.key=a?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:if(g.metaKey)break;i?(_.key=c.C0.ESC+"[1;"+(i+1)+"B",f||_.key!==c.C0.ESC+"[1;3B"||(_.key=c.C0.ESC+"[1;5B")):_.key=a?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:g.shiftKey||g.ctrlKey||(_.key=c.C0.ESC+"[2~");break;case 46:_.key=i?c.C0.ESC+"[3;"+(i+1)+"~":c.C0.ESC+"[3~";break;case 36:_.key=i?c.C0.ESC+"[1;"+(i+1)+"H":a?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:_.key=i?c.C0.ESC+"[1;"+(i+1)+"F":a?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:g.shiftKey?_.type=2:g.ctrlKey?_.key=c.C0.ESC+"[5;"+(i+1)+"~":_.key=c.C0.ESC+"[5~";break;case 34:g.shiftKey?_.type=3:g.ctrlKey?_.key=c.C0.ESC+"[6;"+(i+1)+"~":_.key=c.C0.ESC+"[6~";break;case 112:_.key=i?c.C0.ESC+"[1;"+(i+1)+"P":c.C0.ESC+"OP";break;case 113:_.key=i?c.C0.ESC+"[1;"+(i+1)+"Q":c.C0.ESC+"OQ";break;case 114:_.key=i?c.C0.ESC+"[1;"+(i+1)+"R":c.C0.ESC+"OR";break;case 115:_.key=i?c.C0.ESC+"[1;"+(i+1)+"S":c.C0.ESC+"OS";break;case 116:_.key=i?c.C0.ESC+"[15;"+(i+1)+"~":c.C0.ESC+"[15~";break;case 117:_.key=i?c.C0.ESC+"[17;"+(i+1)+"~":c.C0.ESC+"[17~";break;case 118:_.key=i?c.C0.ESC+"[18;"+(i+1)+"~":c.C0.ESC+"[18~";break;case 119:_.key=i?c.C0.ESC+"[19;"+(i+1)+"~":c.C0.ESC+"[19~";break;case 120:_.key=i?c.C0.ESC+"[20;"+(i+1)+"~":c.C0.ESC+"[20~";break;case 121:_.key=i?c.C0.ESC+"[21;"+(i+1)+"~":c.C0.ESC+"[21~";break;case 122:_.key=i?c.C0.ESC+"[23;"+(i+1)+"~":c.C0.ESC+"[23~";break;case 123:_.key=i?c.C0.ESC+"[24;"+(i+1)+"~":c.C0.ESC+"[24~";break;default:if(!g.ctrlKey||g.shiftKey||g.altKey||g.metaKey)if(f&&!m||!g.altKey||g.metaKey)!f||g.altKey||g.ctrlKey||g.shiftKey||!g.metaKey?g.key&&!g.ctrlKey&&!g.altKey&&!g.metaKey&&g.keyCode>=48&&g.key.length===1?_.key=g.key:g.key&&g.ctrlKey&&(g.key==="_"&&(_.key=c.C0.US),g.key==="@"&&(_.key=c.C0.NUL)):g.keyCode===65&&(_.type=1);else{let u=d[g.keyCode],p=u==null?void 0:u[g.shiftKey?1:0];if(p)_.key=c.C0.ESC+p;else if(g.keyCode>=65&&g.keyCode<=90){let h=g.ctrlKey?g.keyCode-64:g.keyCode+32,v=String.fromCharCode(h);g.shiftKey&&(v=v.toUpperCase()),_.key=c.C0.ESC+v}else if(g.keyCode===32)_.key=c.C0.ESC+(g.ctrlKey?c.C0.NUL:" ");else if(g.key==="Dead"&&g.code.startsWith("Key")){let h=g.code.slice(3,4);g.shiftKey||(h=h.toLowerCase()),_.key=c.C0.ESC+h,_.cancel=!0}}else g.keyCode>=65&&g.keyCode<=90?_.key=String.fromCharCode(g.keyCode-64):g.keyCode===32?_.key=c.C0.NUL:g.keyCode>=51&&g.keyCode<=55?_.key=String.fromCharCode(g.keyCode-51+27):g.keyCode===56?_.key=c.C0.DEL:g.keyCode===219?_.key=c.C0.ESC:g.keyCode===220?_.key=c.C0.FS:g.keyCode===221&&(_.key=c.C0.GS)}return _}},482:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Utf8ToUtf32=e.StringToUtf32=e.utf32ToString=e.stringFromCodePoint=void 0,e.stringFromCodePoint=function(r){return r>65535?(r-=65536,String.fromCharCode(55296+(r>>10))+String.fromCharCode(r%1024+56320)):String.fromCharCode(r)},e.utf32ToString=function(r,c=0,d=r.length){let g="";for(let a=c;a<d;++a){let f=r[a];f>65535?(f-=65536,g+=String.fromCharCode(55296+(f>>10))+String.fromCharCode(f%1024+56320)):g+=String.fromCharCode(f)}return g},e.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(r,c){let d=r.length;if(!d)return 0;let g=0,a=0;if(this._interim){let f=r.charCodeAt(a++);56320<=f&&f<=57343?c[g++]=1024*(this._interim-55296)+f-56320+65536:(c[g++]=this._interim,c[g++]=f),this._interim=0}for(let f=a;f<d;++f){let m=r.charCodeAt(f);if(55296<=m&&m<=56319){if(++f>=d)return this._interim=m,g;let _=r.charCodeAt(f);56320<=_&&_<=57343?c[g++]=1024*(m-55296)+_-56320+65536:(c[g++]=m,c[g++]=_)}else m!==65279&&(c[g++]=m)}return g}},e.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(r,c){let d=r.length;if(!d)return 0;let g,a,f,m,_=0,i=0,u=0;if(this.interim[0]){let v=!1,y=this.interim[0];y&=(224&y)==192?31:(240&y)==224?15:7;let b,w=0;for(;(b=63&this.interim[++w])&&w<4;)y<<=6,y|=b;let S=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,C=S-w;for(;u<C;){if(u>=d)return 0;if(b=r[u++],(192&b)!=128){u--,v=!0;break}this.interim[w++]=b,y<<=6,y|=63&b}v||(S===2?y<128?u--:c[_++]=y:S===3?y<2048||y>=55296&&y<=57343||y===65279||(c[_++]=y):y<65536||y>1114111||(c[_++]=y)),this.interim.fill(0)}let p=d-4,h=u;for(;h<d;){for(;!(!(h<p)||128&(g=r[h])||128&(a=r[h+1])||128&(f=r[h+2])||128&(m=r[h+3]));)c[_++]=g,c[_++]=a,c[_++]=f,c[_++]=m,h+=4;if(g=r[h++],g<128)c[_++]=g;else if((224&g)==192){if(h>=d)return this.interim[0]=g,_;if(a=r[h++],(192&a)!=128){h--;continue}if(i=(31&g)<<6|63&a,i<128){h--;continue}c[_++]=i}else if((240&g)==224){if(h>=d)return this.interim[0]=g,_;if(a=r[h++],(192&a)!=128){h--;continue}if(h>=d)return this.interim[0]=g,this.interim[1]=a,_;if(f=r[h++],(192&f)!=128){h--;continue}if(i=(15&g)<<12|(63&a)<<6|63&f,i<2048||i>=55296&&i<=57343||i===65279)continue;c[_++]=i}else if((248&g)==240){if(h>=d)return this.interim[0]=g,_;if(a=r[h++],(192&a)!=128){h--;continue}if(h>=d)return this.interim[0]=g,this.interim[1]=a,_;if(f=r[h++],(192&f)!=128){h--;continue}if(h>=d)return this.interim[0]=g,this.interim[1]=a,this.interim[2]=f,_;if(m=r[h++],(192&m)!=128){h--;continue}if(i=(7&g)<<18|(63&a)<<12|(63&f)<<6|63&m,i<65536||i>1114111)continue;c[_++]=i}}return _}}},225:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeV6=void 0;let r=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],c=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],d;e.UnicodeV6=class{constructor(){if(this.version="6",!d){d=new Uint8Array(65536),d.fill(1),d[0]=0,d.fill(0,1,32),d.fill(0,127,160),d.fill(2,4352,4448),d[9001]=2,d[9002]=2,d.fill(2,11904,42192),d[12351]=1,d.fill(2,44032,55204),d.fill(2,63744,64256),d.fill(2,65040,65050),d.fill(2,65072,65136),d.fill(2,65280,65377),d.fill(2,65504,65511);for(let g=0;g<r.length;++g)d.fill(0,r[g][0],r[g][1]+1)}}wcwidth(g){return g<32?0:g<127?1:g<65536?d[g]:function(a,f){let m,_=0,i=f.length-1;if(a<f[0][0]||a>f[i][1])return!1;for(;i>=_;)if(m=_+i>>1,a>f[m][1])_=m+1;else{if(!(a<f[m][0]))return!0;i=m-1}return!1}(g,c)?0:g>=131072&&g<=196605||g>=196608&&g<=262141?2:1}}},5981:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WriteBuffer=void 0;let c=r(8460),d=r(844);class g extends d.Disposable{constructor(f){super(),this._action=f,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(f,m){if(m!==void 0&&this._syncCalls>m)return void(this._syncCalls=0);if(this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let _;for(this._isSyncWriting=!0;_=this._writeBuffer.shift();){this._action(_);let i=this._callbacks.shift();i&&i()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(f,m){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(m),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(m)}_innerWrite(f=0,m=!0){let _=f||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){let i=this._writeBuffer[this._bufferOffset],u=this._action(i,m);if(u){let h=v=>Date.now()-_>=12?setTimeout(()=>this._innerWrite(0,v)):this._innerWrite(_,v);return void u.catch(v=>(queueMicrotask(()=>{throw v}),Promise.resolve(!1))).then(h)}let p=this._callbacks[this._bufferOffset];if(p&&p(),this._bufferOffset++,this._pendingData-=i.length,Date.now()-_>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}e.WriteBuffer=g},5941:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.toRgbString=e.parseColor=void 0;let r=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,c=/^[\da-f]+$/;function d(g,a){let f=g.toString(16),m=f.length<2?"0"+f:f;switch(a){case 4:return f[0];case 8:return m;case 12:return(m+m).slice(0,3);default:return m+m}}e.parseColor=function(g){if(!g)return;let a=g.toLowerCase();if(a.indexOf("rgb:")===0){a=a.slice(4);let f=r.exec(a);if(f){let m=f[1]?15:f[4]?255:f[7]?4095:65535;return[Math.round(parseInt(f[1]||f[4]||f[7]||f[10],16)/m*255),Math.round(parseInt(f[2]||f[5]||f[8]||f[11],16)/m*255),Math.round(parseInt(f[3]||f[6]||f[9]||f[12],16)/m*255)]}}else if(a.indexOf("#")===0&&(a=a.slice(1),c.exec(a)&&[3,6,9,12].includes(a.length))){let f=a.length/3,m=[0,0,0];for(let _=0;_<3;++_){let i=parseInt(a.slice(f*_,f*_+f),16);m[_]=f===1?i<<4:f===2?i:f===3?i>>4:i>>8}return m}},e.toRgbString=function(g,a=16){let[f,m,_]=g;return`rgb:${d(f,a)}/${d(m,a)}/${d(_,a)}`}},5770:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PAYLOAD_LIMIT=void 0,e.PAYLOAD_LIMIT=1e7},6351:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DcsHandler=e.DcsParser=void 0;let c=r(482),d=r(8742),g=r(5770),a=[];e.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=a,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=a}registerHandler(m,_){this._handlers[m]===void 0&&(this._handlers[m]=[]);let i=this._handlers[m];return i.push(_),{dispose:()=>{let u=i.indexOf(_);u!==-1&&i.splice(u,1)}}}clearHandler(m){this._handlers[m]&&delete this._handlers[m]}setHandlerFallback(m){this._handlerFb=m}reset(){if(this._active.length)for(let m=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;m>=0;--m)this._active[m].unhook(!1);this._stack.paused=!1,this._active=a,this._ident=0}hook(m,_){if(this.reset(),this._ident=m,this._active=this._handlers[m]||a,this._active.length)for(let i=this._active.length-1;i>=0;i--)this._active[i].hook(_);else this._handlerFb(this._ident,"HOOK",_)}put(m,_,i){if(this._active.length)for(let u=this._active.length-1;u>=0;u--)this._active[u].put(m,_,i);else this._handlerFb(this._ident,"PUT",(0,c.utf32ToString)(m,_,i))}unhook(m,_=!0){if(this._active.length){let i=!1,u=this._active.length-1,p=!1;if(this._stack.paused&&(u=this._stack.loopPosition-1,i=_,p=this._stack.fallThrough,this._stack.paused=!1),!p&&i===!1){for(;u>=0&&(i=this._active[u].unhook(m),i!==!0);u--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=u,this._stack.fallThrough=!1,i;u--}for(;u>=0;u--)if(i=this._active[u].unhook(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=u,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",m);this._active=a,this._ident=0}};let f=new d.Params;f.addParam(0),e.DcsHandler=class{constructor(m){this._handler=m,this._data="",this._params=f,this._hitLimit=!1}hook(m){this._params=m.length>1||m.params[0]?m.clone():f,this._data="",this._hitLimit=!1}put(m,_,i){this._hitLimit||(this._data+=(0,c.utf32ToString)(m,_,i),this._data.length>g.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(m){let _=!1;if(this._hitLimit)_=!1;else if(m&&(_=this._handler(this._data,this._params),_ instanceof Promise))return _.then(i=>(this._params=f,this._data="",this._hitLimit=!1,i));return this._params=f,this._data="",this._hitLimit=!1,_}}},2015:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EscapeSequenceParser=e.VT500_TRANSITION_TABLE=e.TransitionTable=void 0;let c=r(844),d=r(8742),g=r(6242),a=r(6351);class f{constructor(u){this.table=new Uint8Array(u)}setDefault(u,p){this.table.fill(u<<4|p)}add(u,p,h,v){this.table[p<<8|u]=h<<4|v}addMany(u,p,h,v){for(let y=0;y<u.length;y++)this.table[p<<8|u[y]]=h<<4|v}}e.TransitionTable=f;let m=160;e.VT500_TRANSITION_TABLE=function(){let i=new f(4095),u=Array.apply(null,Array(256)).map((w,S)=>S),p=(w,S)=>u.slice(w,S),h=p(32,127),v=p(0,24);v.push(25),v.push.apply(v,p(28,32));let y=p(0,14),b;for(b in i.setDefault(1,0),i.addMany(h,0,2,0),y)i.addMany([24,26,153,154],b,3,0),i.addMany(p(128,144),b,3,0),i.addMany(p(144,152),b,3,0),i.add(156,b,0,0),i.add(27,b,11,1),i.add(157,b,4,8),i.addMany([152,158,159],b,0,7),i.add(155,b,11,3),i.add(144,b,11,9);return i.addMany(v,0,3,0),i.addMany(v,1,3,1),i.add(127,1,0,1),i.addMany(v,8,0,8),i.addMany(v,3,3,3),i.add(127,3,0,3),i.addMany(v,4,3,4),i.add(127,4,0,4),i.addMany(v,6,3,6),i.addMany(v,5,3,5),i.add(127,5,0,5),i.addMany(v,2,3,2),i.add(127,2,0,2),i.add(93,1,4,8),i.addMany(h,8,5,8),i.add(127,8,5,8),i.addMany([156,27,24,26,7],8,6,0),i.addMany(p(28,32),8,0,8),i.addMany([88,94,95],1,0,7),i.addMany(h,7,0,7),i.addMany(v,7,0,7),i.add(156,7,0,0),i.add(127,7,0,7),i.add(91,1,11,3),i.addMany(p(64,127),3,7,0),i.addMany(p(48,60),3,8,4),i.addMany([60,61,62,63],3,9,4),i.addMany(p(48,60),4,8,4),i.addMany(p(64,127),4,7,0),i.addMany([60,61,62,63],4,0,6),i.addMany(p(32,64),6,0,6),i.add(127,6,0,6),i.addMany(p(64,127),6,0,0),i.addMany(p(32,48),3,9,5),i.addMany(p(32,48),5,9,5),i.addMany(p(48,64),5,0,6),i.addMany(p(64,127),5,7,0),i.addMany(p(32,48),4,9,5),i.addMany(p(32,48),1,9,2),i.addMany(p(32,48),2,9,2),i.addMany(p(48,127),2,10,0),i.addMany(p(48,80),1,10,0),i.addMany(p(81,88),1,10,0),i.addMany([89,90,92],1,10,0),i.addMany(p(96,127),1,10,0),i.add(80,1,11,9),i.addMany(v,9,0,9),i.add(127,9,0,9),i.addMany(p(28,32),9,0,9),i.addMany(p(32,48),9,9,12),i.addMany(p(48,60),9,8,10),i.addMany([60,61,62,63],9,9,10),i.addMany(v,11,0,11),i.addMany(p(32,128),11,0,11),i.addMany(p(28,32),11,0,11),i.addMany(v,10,0,10),i.add(127,10,0,10),i.addMany(p(28,32),10,0,10),i.addMany(p(48,60),10,8,10),i.addMany([60,61,62,63],10,0,11),i.addMany(p(32,48),10,9,12),i.addMany(v,12,0,12),i.add(127,12,0,12),i.addMany(p(28,32),12,0,12),i.addMany(p(32,48),12,9,12),i.addMany(p(48,64),12,0,11),i.addMany(p(64,127),12,12,13),i.addMany(p(64,127),10,12,13),i.addMany(p(64,127),9,12,13),i.addMany(v,13,13,13),i.addMany(h,13,13,13),i.add(127,13,0,13),i.addMany([27,156,24,26],13,14,0),i.add(m,0,2,0),i.add(m,8,5,8),i.add(m,6,0,6),i.add(m,11,0,11),i.add(m,13,13,13),i}();class _ extends c.Disposable{constructor(u=e.VT500_TRANSITION_TABLE){super(),this._transitions=u,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new d.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(p,h,v)=>{},this._executeHandlerFb=p=>{},this._csiHandlerFb=(p,h)=>{},this._escHandlerFb=p=>{},this._errorHandlerFb=p=>p,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,c.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new g.OscParser),this._dcsParser=this.register(new a.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(u,p=[64,126]){let h=0;if(u.prefix){if(u.prefix.length>1)throw new Error("only one byte as prefix supported");if(h=u.prefix.charCodeAt(0),h&&60>h||h>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(u.intermediates){if(u.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let y=0;y<u.intermediates.length;++y){let b=u.intermediates.charCodeAt(y);if(32>b||b>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");h<<=8,h|=b}}if(u.final.length!==1)throw new Error("final must be a single byte");let v=u.final.charCodeAt(0);if(p[0]>v||v>p[1])throw new Error(`final must be in range ${p[0]} .. ${p[1]}`);return h<<=8,h|=v,h}identToString(u){let p=[];for(;u;)p.push(String.fromCharCode(255&u)),u>>=8;return p.reverse().join("")}setPrintHandler(u){this._printHandler=u}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(u,p){let h=this._identifier(u,[48,126]);this._escHandlers[h]===void 0&&(this._escHandlers[h]=[]);let v=this._escHandlers[h];return v.push(p),{dispose:()=>{let y=v.indexOf(p);y!==-1&&v.splice(y,1)}}}clearEscHandler(u){this._escHandlers[this._identifier(u,[48,126])]&&delete this._escHandlers[this._identifier(u,[48,126])]}setEscHandlerFallback(u){this._escHandlerFb=u}setExecuteHandler(u,p){this._executeHandlers[u.charCodeAt(0)]=p}clearExecuteHandler(u){this._executeHandlers[u.charCodeAt(0)]&&delete this._executeHandlers[u.charCodeAt(0)]}setExecuteHandlerFallback(u){this._executeHandlerFb=u}registerCsiHandler(u,p){let h=this._identifier(u);this._csiHandlers[h]===void 0&&(this._csiHandlers[h]=[]);let v=this._csiHandlers[h];return v.push(p),{dispose:()=>{let y=v.indexOf(p);y!==-1&&v.splice(y,1)}}}clearCsiHandler(u){this._csiHandlers[this._identifier(u)]&&delete this._csiHandlers[this._identifier(u)]}setCsiHandlerFallback(u){this._csiHandlerFb=u}registerDcsHandler(u,p){return this._dcsParser.registerHandler(this._identifier(u),p)}clearDcsHandler(u){this._dcsParser.clearHandler(this._identifier(u))}setDcsHandlerFallback(u){this._dcsParser.setHandlerFallback(u)}registerOscHandler(u,p){return this._oscParser.registerHandler(u,p)}clearOscHandler(u){this._oscParser.clearHandler(u)}setOscHandlerFallback(u){this._oscParser.setHandlerFallback(u)}setErrorHandler(u){this._errorHandler=u}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(u,p,h,v,y){this._parseStack.state=u,this._parseStack.handlers=p,this._parseStack.handlerPos=h,this._parseStack.transition=v,this._parseStack.chunkPos=y}parse(u,p,h){let v,y=0,b=0,w=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,w=this._parseStack.chunkPos+1;else{if(h===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let S=this._parseStack.handlers,C=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(h===!1&&C>-1){for(;C>=0&&(v=S[C](this._params),v!==!0);C--)if(v instanceof Promise)return this._parseStack.handlerPos=C,v}this._parseStack.handlers=[];break;case 4:if(h===!1&&C>-1){for(;C>=0&&(v=S[C](),v!==!0);C--)if(v instanceof Promise)return this._parseStack.handlerPos=C,v}this._parseStack.handlers=[];break;case 6:if(y=u[this._parseStack.chunkPos],v=this._dcsParser.unhook(y!==24&&y!==26,h),v)return v;y===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(y=u[this._parseStack.chunkPos],v=this._oscParser.end(y!==24&&y!==26,h),v)return v;y===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,w=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let S=w;S<p;++S){switch(y=u[S],b=this._transitions.table[this.currentState<<8|(y<160?y:m)],b>>4){case 2:for(let O=S+1;;++O){if(O>=p||(y=u[O])<32||y>126&&y<m){this._printHandler(u,S,O),S=O-1;break}if(++O>=p||(y=u[O])<32||y>126&&y<m){this._printHandler(u,S,O),S=O-1;break}if(++O>=p||(y=u[O])<32||y>126&&y<m){this._printHandler(u,S,O),S=O-1;break}if(++O>=p||(y=u[O])<32||y>126&&y<m){this._printHandler(u,S,O),S=O-1;break}}break;case 3:this._executeHandlers[y]?this._executeHandlers[y]():this._executeHandlerFb(y),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:S,code:y,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let C=this._csiHandlers[this._collect<<8|y],L=C?C.length-1:-1;for(;L>=0&&(v=C[L](this._params),v!==!0);L--)if(v instanceof Promise)return this._preserveStack(3,C,L,b,S),v;L<0&&this._csiHandlerFb(this._collect<<8|y,this._params),this.precedingCodepoint=0;break;case 8:do switch(y){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(y-48)}while(++S<p&&(y=u[S])>47&&y<60);S--;break;case 9:this._collect<<=8,this._collect|=y;break;case 10:let x=this._escHandlers[this._collect<<8|y],R=x?x.length-1:-1;for(;R>=0&&(v=x[R](),v!==!0);R--)if(v instanceof Promise)return this._preserveStack(4,x,R,b,S),v;R<0&&this._escHandlerFb(this._collect<<8|y),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|y,this._params);break;case 13:for(let O=S+1;;++O)if(O>=p||(y=u[O])===24||y===26||y===27||y>127&&y<m){this._dcsParser.put(u,S,O),S=O-1;break}break;case 14:if(v=this._dcsParser.unhook(y!==24&&y!==26),v)return this._preserveStack(6,[],0,b,S),v;y===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let O=S+1;;O++)if(O>=p||(y=u[O])<32||y>127&&y<m){this._oscParser.put(u,S,O),S=O-1;break}break;case 6:if(v=this._oscParser.end(y!==24&&y!==26),v)return this._preserveStack(5,[],0,b,S),v;y===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&b}}}e.EscapeSequenceParser=_},6242:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OscHandler=e.OscParser=void 0;let c=r(5770),d=r(482),g=[];e.OscParser=class{constructor(){this._state=0,this._active=g,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(a,f){this._handlers[a]===void 0&&(this._handlers[a]=[]);let m=this._handlers[a];return m.push(f),{dispose:()=>{let _=m.indexOf(f);_!==-1&&m.splice(_,1)}}}clearHandler(a){this._handlers[a]&&delete this._handlers[a]}setHandlerFallback(a){this._handlerFb=a}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=g}reset(){if(this._state===2)for(let a=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;a>=0;--a)this._active[a].end(!1);this._stack.paused=!1,this._active=g,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||g,this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].start();else this._handlerFb(this._id,"START")}_put(a,f,m){if(this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].put(a,f,m);else this._handlerFb(this._id,"PUT",(0,d.utf32ToString)(a,f,m))}start(){this.reset(),this._state=1}put(a,f,m){if(this._state!==3){if(this._state===1)for(;f<m;){let _=a[f++];if(_===59){this._state=2,this._start();break}if(_<48||57<_)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+_-48}this._state===2&&m-f>0&&this._put(a,f,m)}}end(a,f=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let m=!1,_=this._active.length-1,i=!1;if(this._stack.paused&&(_=this._stack.loopPosition-1,m=f,i=this._stack.fallThrough,this._stack.paused=!1),!i&&m===!1){for(;_>=0&&(m=this._active[_].end(a),m!==!0);_--)if(m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!1,m;_--}for(;_>=0;_--)if(m=this._active[_].end(!1),m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!0,m}else this._handlerFb(this._id,"END",a);this._active=g,this._id=-1,this._state=0}}},e.OscHandler=class{constructor(a){this._handler=a,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(a,f,m){this._hitLimit||(this._data+=(0,d.utf32ToString)(a,f,m),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(a){let f=!1;if(this._hitLimit)f=!1;else if(a&&(f=this._handler(this._data),f instanceof Promise))return f.then(m=>(this._data="",this._hitLimit=!1,m));return this._data="",this._hitLimit=!1,f}}},8742:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Params=void 0;let r=2147483647;class c{constructor(g=32,a=32){if(this.maxLength=g,this.maxSubParamsLength=a,a>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(g),this.length=0,this._subParams=new Int32Array(a),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(g),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(g){let a=new c;if(!g.length)return a;for(let f=Array.isArray(g[0])?1:0;f<g.length;++f){let m=g[f];if(Array.isArray(m))for(let _=0;_<m.length;++_)a.addSubParam(m[_]);else a.addParam(m)}return a}clone(){let g=new c(this.maxLength,this.maxSubParamsLength);return g.params.set(this.params),g.length=this.length,g._subParams.set(this._subParams),g._subParamsLength=this._subParamsLength,g._subParamsIdx.set(this._subParamsIdx),g._rejectDigits=this._rejectDigits,g._rejectSubDigits=this._rejectSubDigits,g._digitIsSub=this._digitIsSub,g}toArray(){let g=[];for(let a=0;a<this.length;++a){g.push(this.params[a]);let f=this._subParamsIdx[a]>>8,m=255&this._subParamsIdx[a];m-f>0&&g.push(Array.prototype.slice.call(this._subParams,f,m))}return g}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(g){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(g<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=g>r?r:g}}addSubParam(g){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(g<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=g>r?r:g,this._subParamsIdx[this.length-1]++}}hasSubParams(g){return(255&this._subParamsIdx[g])-(this._subParamsIdx[g]>>8)>0}getSubParams(g){let a=this._subParamsIdx[g]>>8,f=255&this._subParamsIdx[g];return f-a>0?this._subParams.subarray(a,f):null}getSubParamsAll(){let g={};for(let a=0;a<this.length;++a){let f=this._subParamsIdx[a]>>8,m=255&this._subParamsIdx[a];m-f>0&&(g[a]=this._subParams.slice(f,m))}return g}addDigit(g){let a;if(this._rejectDigits||!(a=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let f=this._digitIsSub?this._subParams:this.params,m=f[a-1];f[a-1]=~m?Math.min(10*m+g,r):g}}e.Params=c},5741:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AddonManager=void 0,e.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let r=this._addons.length-1;r>=0;r--)this._addons[r].instance.dispose()}loadAddon(r,c){let d={instance:c,dispose:c.dispose,isDisposed:!1};this._addons.push(d),c.dispose=()=>this._wrappedAddonDispose(d),c.activate(r)}_wrappedAddonDispose(r){if(r.isDisposed)return;let c=-1;for(let d=0;d<this._addons.length;d++)if(this._addons[d]===r){c=d;break}if(c===-1)throw new Error("Could not dispose an addon that has not been loaded");r.isDisposed=!0,r.dispose.apply(r.instance),this._addons.splice(c,1)}}},8771:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferApiView=void 0;let c=r(3785),d=r(511);e.BufferApiView=class{constructor(g,a){this._buffer=g,this.type=a}init(g){return this._buffer=g,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(g){let a=this._buffer.lines.get(g);if(a)return new c.BufferLineApiView(a)}getNullCell(){return new d.CellData}}},3785:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferLineApiView=void 0;let c=r(511);e.BufferLineApiView=class{constructor(d){this._line=d}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(d,g){if(!(d<0||d>=this._line.length))return g?(this._line.loadCell(d,g),g):this._line.loadCell(d,new c.CellData)}translateToString(d,g,a){return this._line.translateToString(d,g,a)}}},8285:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferNamespaceApi=void 0;let c=r(8771),d=r(8460);e.BufferNamespaceApi=class{constructor(g){this._core=g,this._onBufferChange=new d.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new c.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new c.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ParserApi=void 0,e.ParserApi=class{constructor(r){this._core=r}registerCsiHandler(r,c){return this._core.registerCsiHandler(r,d=>c(d.toArray()))}addCsiHandler(r,c){return this.registerCsiHandler(r,c)}registerDcsHandler(r,c){return this._core.registerDcsHandler(r,(d,g)=>c(d,g.toArray()))}addDcsHandler(r,c){return this.registerDcsHandler(r,c)}registerEscHandler(r,c){return this._core.registerEscHandler(r,c)}addEscHandler(r,c){return this.registerEscHandler(r,c)}registerOscHandler(r,c){return this._core.registerOscHandler(r,c)}addOscHandler(r,c){return this.registerOscHandler(r,c)}}},7090:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeApi=void 0,e.UnicodeApi=class{constructor(r){this._core=r}register(r){this._core.unicodeService.register(r)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(r){this._core.unicodeService.activeVersion=r}}},744:function(o,e,r){var c=this&&this.__decorate||function(i,u,p,h){var v,y=arguments.length,b=y<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,p):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(i,u,p,h);else for(var w=i.length-1;w>=0;w--)(v=i[w])&&(b=(y<3?v(b):y>3?v(u,p,b):v(u,p))||b);return y>3&&b&&Object.defineProperty(u,p,b),b},d=this&&this.__param||function(i,u){return function(p,h){u(p,h,i)}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferService=e.MINIMUM_ROWS=e.MINIMUM_COLS=void 0;let g=r(2585),a=r(5295),f=r(8460),m=r(844);e.MINIMUM_COLS=2,e.MINIMUM_ROWS=1;let _=class extends m.Disposable{constructor(i){super(),this.isUserScrolling=!1,this._onResize=this.register(new f.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new f.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(i.rawOptions.cols||0,e.MINIMUM_COLS),this.rows=Math.max(i.rawOptions.rows||0,e.MINIMUM_ROWS),this.buffers=this.register(new a.BufferSet(i,this))}get buffer(){return this.buffers.active}resize(i,u){this.cols=i,this.rows=u,this.buffers.resize(i,u),this._onResize.fire({cols:i,rows:u})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(i,u=!1){let p=this.buffer,h;h=this._cachedBlankLine,h&&h.length===this.cols&&h.getFg(0)===i.fg&&h.getBg(0)===i.bg||(h=p.getBlankLine(i,u),this._cachedBlankLine=h),h.isWrapped=u;let v=p.ybase+p.scrollTop,y=p.ybase+p.scrollBottom;if(p.scrollTop===0){let b=p.lines.isFull;y===p.lines.length-1?b?p.lines.recycle().copyFrom(h):p.lines.push(h.clone()):p.lines.splice(y+1,0,h.clone()),b?this.isUserScrolling&&(p.ydisp=Math.max(p.ydisp-1,0)):(p.ybase++,this.isUserScrolling||p.ydisp++)}else{let b=y-v+1;p.lines.shiftElements(v+1,b-1,-1),p.lines.set(y,h.clone())}this.isUserScrolling||(p.ydisp=p.ybase),this._onScroll.fire(p.ydisp)}scrollLines(i,u,p){let h=this.buffer;if(i<0){if(h.ydisp===0)return;this.isUserScrolling=!0}else i+h.ydisp>=h.ybase&&(this.isUserScrolling=!1);let v=h.ydisp;h.ydisp=Math.max(Math.min(h.ydisp+i,h.ybase),0),v!==h.ydisp&&(u||this._onScroll.fire(h.ydisp))}scrollPages(i){this.scrollLines(i*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(i){let u=i-this.buffer.ydisp;u!==0&&this.scrollLines(u)}};_=c([d(0,g.IOptionsService)],_),e.BufferService=_},7994:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CharsetService=void 0,e.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(r){this.glevel=r,this.charset=this._charsets[r]}setgCharset(r,c){this._charsets[r]=c,this.glevel===r&&(this.charset=c)}}},1753:function(o,e,r){var c=this&&this.__decorate||function(h,v,y,b){var w,S=arguments.length,C=S<3?v:b===null?b=Object.getOwnPropertyDescriptor(v,y):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(h,v,y,b);else for(var L=h.length-1;L>=0;L--)(w=h[L])&&(C=(S<3?w(C):S>3?w(v,y,C):w(v,y))||C);return S>3&&C&&Object.defineProperty(v,y,C),C},d=this&&this.__param||function(h,v){return function(y,b){v(y,b,h)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreMouseService=void 0;let g=r(2585),a=r(8460),f=r(844),m={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:h=>h.button!==4&&h.action===1&&(h.ctrl=!1,h.alt=!1,h.shift=!1,!0)},VT200:{events:19,restrict:h=>h.action!==32},DRAG:{events:23,restrict:h=>h.action!==32||h.button!==3},ANY:{events:31,restrict:h=>!0}};function _(h,v){let y=(h.ctrl?16:0)|(h.shift?4:0)|(h.alt?8:0);return h.button===4?(y|=64,y|=h.action):(y|=3&h.button,4&h.button&&(y|=64),8&h.button&&(y|=128),h.action===32?y|=32:h.action!==0||v||(y|=3)),y}let i=String.fromCharCode,u={DEFAULT:h=>{let v=[_(h,!1)+32,h.col+32,h.row+32];return v[0]>255||v[1]>255||v[2]>255?"":`\x1B[M${i(v[0])}${i(v[1])}${i(v[2])}`},SGR:h=>{let v=h.action===0&&h.button!==4?"m":"M";return`\x1B[<${_(h,!0)};${h.col};${h.row}${v}`},SGR_PIXELS:h=>{let v=h.action===0&&h.button!==4?"m":"M";return`\x1B[<${_(h,!0)};${h.x};${h.y}${v}`}},p=class extends f.Disposable{constructor(h,v){super(),this._bufferService=h,this._coreService=v,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new a.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(let y of Object.keys(m))this.addProtocol(y,m[y]);for(let y of Object.keys(u))this.addEncoding(y,u[y]);this.reset()}addProtocol(h,v){this._protocols[h]=v}addEncoding(h,v){this._encodings[h]=v}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(h){if(!this._protocols[h])throw new Error(`unknown protocol "${h}"`);this._activeProtocol=h,this._onProtocolChange.fire(this._protocols[h].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(h){if(!this._encodings[h])throw new Error(`unknown encoding "${h}"`);this._activeEncoding=h}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(h){if(h.col<0||h.col>=this._bufferService.cols||h.row<0||h.row>=this._bufferService.rows||h.button===4&&h.action===32||h.button===3&&h.action!==32||h.button!==4&&(h.action===2||h.action===3)||(h.col++,h.row++,h.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,h,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(h))return!1;let v=this._encodings[this._activeEncoding](h);return v&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(v):this._coreService.triggerDataEvent(v,!0)),this._lastEvent=h,!0}explainEvents(h){return{down:!!(1&h),up:!!(2&h),drag:!!(4&h),move:!!(8&h),wheel:!!(16&h)}}_equalEvents(h,v,y){if(y){if(h.x!==v.x||h.y!==v.y)return!1}else if(h.col!==v.col||h.row!==v.row)return!1;return h.button===v.button&&h.action===v.action&&h.ctrl===v.ctrl&&h.alt===v.alt&&h.shift===v.shift}};p=c([d(0,g.IBufferService),d(1,g.ICoreService)],p),e.CoreMouseService=p},6975:function(o,e,r){var c=this&&this.__decorate||function(p,h,v,y){var b,w=arguments.length,S=w<3?h:y===null?y=Object.getOwnPropertyDescriptor(h,v):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,h,v,y);else for(var C=p.length-1;C>=0;C--)(b=p[C])&&(S=(w<3?b(S):w>3?b(h,v,S):b(h,v))||S);return w>3&&S&&Object.defineProperty(h,v,S),S},d=this&&this.__param||function(p,h){return function(v,y){h(v,y,p)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreService=void 0;let g=r(2585),a=r(8460),f=r(1439),m=r(844),_=Object.freeze({insertMode:!1}),i=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),u=class extends m.Disposable{constructor(p,h,v){super(),this._bufferService=p,this._logService=h,this._optionsService=v,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new a.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new a.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new a.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new a.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,f.clone)(_),this.decPrivateModes=(0,f.clone)(i)}reset(){this.modes=(0,f.clone)(_),this.decPrivateModes=(0,f.clone)(i)}triggerDataEvent(p,h=!1){if(this._optionsService.rawOptions.disableStdin)return;let v=this._bufferService.buffer;h&&this._optionsService.rawOptions.scrollOnUserInput&&v.ybase!==v.ydisp&&this._onRequestScrollToBottom.fire(),h&&this._onUserInput.fire(),this._logService.debug(`sending data "${p}"`,()=>p.split("").map(y=>y.charCodeAt(0))),this._onData.fire(p)}triggerBinaryEvent(p){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${p}"`,()=>p.split("").map(h=>h.charCodeAt(0))),this._onBinary.fire(p))}};u=c([d(0,g.IBufferService),d(1,g.ILogService),d(2,g.IOptionsService)],u),e.CoreService=u},9074:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DecorationService=void 0;let c=r(8055),d=r(8460),g=r(844),a=r(6106),f=0,m=0;class _ extends g.Disposable{constructor(){super(),this._decorations=new a.SortedList(p=>p==null?void 0:p.marker.line),this._onDecorationRegistered=this.register(new d.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new d.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,g.toDisposable)(()=>{for(let p of this._decorations.values())this._onDecorationRemoved.fire(p);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(p){if(p.marker.isDisposed)return;let h=new i(p);if(h){let v=h.marker.onDispose(()=>h.dispose());h.onDispose(()=>{h&&(this._decorations.delete(h)&&this._onDecorationRemoved.fire(h),v.dispose())}),this._decorations.insert(h),this._onDecorationRegistered.fire(h)}return h}reset(){for(let p of this._decorations.values())p.dispose();this._decorations.clear()}*getDecorationsAtCell(p,h,v){var y,b,w;let S=0,C=0;for(let L of this._decorations.getKeyIterator(h))S=(y=L.options.x)!==null&&y!==void 0?y:0,C=S+((b=L.options.width)!==null&&b!==void 0?b:1),p>=S&&p<C&&(!v||((w=L.options.layer)!==null&&w!==void 0?w:"bottom")===v)&&(yield L)}forEachDecorationAtCell(p,h,v,y){this._decorations.forEachByKey(h,b=>{var w,S,C;f=(w=b.options.x)!==null&&w!==void 0?w:0,m=f+((S=b.options.width)!==null&&S!==void 0?S:1),p>=f&&p<m&&(!v||((C=b.options.layer)!==null&&C!==void 0?C:"bottom")===v)&&y(b)})}dispose(){for(let p of this._decorations.values())this._onDecorationRemoved.fire(p);this.reset()}}e.DecorationService=_;class i extends g.Disposable{constructor(p){super(),this.options=p,this.isDisposed=!1,this.onRenderEmitter=this.register(new d.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new d.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=p.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=c.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=c.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InstantiationService=e.ServiceCollection=void 0;let c=r(2585),d=r(8343);class g{constructor(...f){this._entries=new Map;for(let[m,_]of f)this.set(m,_)}set(f,m){let _=this._entries.get(f);return this._entries.set(f,m),_}forEach(f){for(let[m,_]of this._entries.entries())f(m,_)}has(f){return this._entries.has(f)}get(f){return this._entries.get(f)}}e.ServiceCollection=g,e.InstantiationService=class{constructor(){this._services=new g,this._services.set(c.IInstantiationService,this)}setService(a,f){this._services.set(a,f)}getService(a){return this._services.get(a)}createInstance(a,...f){let m=(0,d.getServiceDependencies)(a).sort((u,p)=>u.index-p.index),_=[];for(let u of m){let p=this._services.get(u.id);if(!p)throw new Error(`[createInstance] ${a.name} depends on UNKNOWN service ${u.id}.`);_.push(p)}let i=m.length>0?m[0].index:f.length;if(f.length!==i)throw new Error(`[createInstance] First service dependency of ${a.name} at position ${i+1} conflicts with ${f.length} static arguments`);return new a(...f,..._)}}},7866:function(o,e,r){var c=this&&this.__decorate||function(_,i,u,p){var h,v=arguments.length,y=v<3?i:p===null?p=Object.getOwnPropertyDescriptor(i,u):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(_,i,u,p);else for(var b=_.length-1;b>=0;b--)(h=_[b])&&(y=(v<3?h(y):v>3?h(i,u,y):h(i,u))||y);return v>3&&y&&Object.defineProperty(i,u,y),y},d=this&&this.__param||function(_,i){return function(u,p){i(u,p,_)}};Object.defineProperty(e,"__esModule",{value:!0}),e.LogService=void 0;let g=r(844),a=r(2585),f={debug:a.LogLevelEnum.DEBUG,info:a.LogLevelEnum.INFO,warn:a.LogLevelEnum.WARN,error:a.LogLevelEnum.ERROR,off:a.LogLevelEnum.OFF},m=class extends g.Disposable{constructor(_){super(),this._optionsService=_,this.logLevel=a.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=f[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(_){for(let i=0;i<_.length;i++)typeof _[i]=="function"&&(_[i]=_[i]())}_log(_,i,u){this._evalLazyOptionalParams(u),_.call(console,"xterm.js: "+i,...u)}debug(_,...i){this.logLevel<=a.LogLevelEnum.DEBUG&&this._log(console.log,_,i)}info(_,...i){this.logLevel<=a.LogLevelEnum.INFO&&this._log(console.info,_,i)}warn(_,...i){this.logLevel<=a.LogLevelEnum.WARN&&this._log(console.warn,_,i)}error(_,...i){this.logLevel<=a.LogLevelEnum.ERROR&&this._log(console.error,_,i)}};m=c([d(0,a.IOptionsService)],m),e.LogService=m},7302:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionsService=e.DEFAULT_OPTIONS=void 0;let c=r(8460),d=r(6114),g=r(844);e.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:d.isMac,windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};let a=["normal","bold","100","200","300","400","500","600","700","800","900"];class f extends g.Disposable{constructor(_){super(),this._onOptionChange=this.register(new c.EventEmitter),this.onOptionChange=this._onOptionChange.event;let i=Object.assign({},e.DEFAULT_OPTIONS);for(let u in _)if(u in i)try{let p=_[u];i[u]=this._sanitizeAndValidateOption(u,p)}catch(p){console.error(p)}this.rawOptions=i,this.options=Object.assign({},i),this._setupOptions()}onSpecificOptionChange(_,i){return this.onOptionChange(u=>{u===_&&i(this.rawOptions[_])})}onMultipleOptionChange(_,i){return this.onOptionChange(u=>{_.indexOf(u)!==-1&&i()})}_setupOptions(){let _=u=>{if(!(u in e.DEFAULT_OPTIONS))throw new Error(`No option with key "${u}"`);return this.rawOptions[u]},i=(u,p)=>{if(!(u in e.DEFAULT_OPTIONS))throw new Error(`No option with key "${u}"`);p=this._sanitizeAndValidateOption(u,p),this.rawOptions[u]!==p&&(this.rawOptions[u]=p,this._onOptionChange.fire(u))};for(let u in this.rawOptions){let p={get:_.bind(this,u),set:i.bind(this,u)};Object.defineProperty(this.options,u,p)}}_sanitizeAndValidateOption(_,i){switch(_){case"cursorStyle":if(i||(i=e.DEFAULT_OPTIONS[_]),!function(u){return u==="block"||u==="underline"||u==="bar"}(i))throw new Error(`"${i}" is not a valid value for ${_}`);break;case"wordSeparator":i||(i=e.DEFAULT_OPTIONS[_]);break;case"fontWeight":case"fontWeightBold":if(typeof i=="number"&&1<=i&&i<=1e3)break;i=a.includes(i)?i:e.DEFAULT_OPTIONS[_];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(`${_} cannot be less than 1, value: ${i}`);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error(`${_} cannot be less than 0, value: ${i}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(`${_} cannot be less than or equal to 0, value: ${i}`);case"rows":case"cols":if(!i&&i!==0)throw new Error(`${_} must be numeric, value: ${i}`)}return i}}e.OptionsService=f},2660:function(o,e,r){var c=this&&this.__decorate||function(f,m,_,i){var u,p=arguments.length,h=p<3?m:i===null?i=Object.getOwnPropertyDescriptor(m,_):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(f,m,_,i);else for(var v=f.length-1;v>=0;v--)(u=f[v])&&(h=(p<3?u(h):p>3?u(m,_,h):u(m,_))||h);return p>3&&h&&Object.defineProperty(m,_,h),h},d=this&&this.__param||function(f,m){return function(_,i){m(_,i,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OscLinkService=void 0;let g=r(2585),a=class{constructor(f){this._bufferService=f,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(f){let m=this._bufferService.buffer;if(f.id===void 0){let v=m.addMarker(m.ybase+m.y),y={data:f,id:this._nextId++,lines:[v]};return v.onDispose(()=>this._removeMarkerFromLink(y,v)),this._dataByLinkId.set(y.id,y),y.id}let _=f,i=this._getEntryIdKey(_),u=this._entriesWithId.get(i);if(u)return this.addLineToLink(u.id,m.ybase+m.y),u.id;let p=m.addMarker(m.ybase+m.y),h={id:this._nextId++,key:this._getEntryIdKey(_),data:_,lines:[p]};return p.onDispose(()=>this._removeMarkerFromLink(h,p)),this._entriesWithId.set(h.key,h),this._dataByLinkId.set(h.id,h),h.id}addLineToLink(f,m){let _=this._dataByLinkId.get(f);if(_&&_.lines.every(i=>i.line!==m)){let i=this._bufferService.buffer.addMarker(m);_.lines.push(i),i.onDispose(()=>this._removeMarkerFromLink(_,i))}}getLinkData(f){var m;return(m=this._dataByLinkId.get(f))===null||m===void 0?void 0:m.data}_getEntryIdKey(f){return`${f.id};;${f.uri}`}_removeMarkerFromLink(f,m){let _=f.lines.indexOf(m);_!==-1&&(f.lines.splice(_,1),f.lines.length===0&&(f.data.id!==void 0&&this._entriesWithId.delete(f.key),this._dataByLinkId.delete(f.id)))}};a=c([d(0,g.IBufferService)],a),e.OscLinkService=a},8343:(o,e)=>{function r(c,d,g){d.di$target===d?d.di$dependencies.push({id:c,index:g}):(d.di$dependencies=[{id:c,index:g}],d.di$target=d)}Object.defineProperty(e,"__esModule",{value:!0}),e.createDecorator=e.getServiceDependencies=e.serviceRegistry=void 0,e.serviceRegistry=new Map,e.getServiceDependencies=function(c){return c.di$dependencies||[]},e.createDecorator=function(c){if(e.serviceRegistry.has(c))return e.serviceRegistry.get(c);let d=function(g,a,f){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");r(d,g,f)};return d.toString=()=>c,e.serviceRegistry.set(c,d),d}},2585:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IDecorationService=e.IUnicodeService=e.IOscLinkService=e.IOptionsService=e.ILogService=e.LogLevelEnum=e.IInstantiationService=e.ICharsetService=e.ICoreService=e.ICoreMouseService=e.IBufferService=void 0;let c=r(8343);var d;e.IBufferService=(0,c.createDecorator)("BufferService"),e.ICoreMouseService=(0,c.createDecorator)("CoreMouseService"),e.ICoreService=(0,c.createDecorator)("CoreService"),e.ICharsetService=(0,c.createDecorator)("CharsetService"),e.IInstantiationService=(0,c.createDecorator)("InstantiationService"),(d=e.LogLevelEnum||(e.LogLevelEnum={}))[d.DEBUG=0]="DEBUG",d[d.INFO=1]="INFO",d[d.WARN=2]="WARN",d[d.ERROR=3]="ERROR",d[d.OFF=4]="OFF",e.ILogService=(0,c.createDecorator)("LogService"),e.IOptionsService=(0,c.createDecorator)("OptionsService"),e.IOscLinkService=(0,c.createDecorator)("OscLinkService"),e.IUnicodeService=(0,c.createDecorator)("UnicodeService"),e.IDecorationService=(0,c.createDecorator)("DecorationService")},1480:(o,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeService=void 0;let c=r(8460),d=r(225);e.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new c.EventEmitter,this.onChange=this._onChange.event;let g=new d.UnicodeV6;this.register(g),this._active=g.version,this._activeProvider=g}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(g){if(!this._providers[g])throw new Error(`unknown Unicode version "${g}"`);this._active=g,this._activeProvider=this._providers[g],this._onChange.fire(g)}register(g){this._providers[g.version]=g}wcwidth(g){return this._activeProvider.wcwidth(g)}getStringCellWidth(g){let a=0,f=g.length;for(let m=0;m<f;++m){let _=g.charCodeAt(m);if(55296<=_&&_<=56319){if(++m>=f)return a+this.wcwidth(_);let i=g.charCodeAt(m);56320<=i&&i<=57343?_=1024*(_-55296)+i-56320+65536:a+=this.wcwidth(i)}a+=this.wcwidth(_)}return a}}}},s={};function n(o){var e=s[o];if(e!==void 0)return e.exports;var r=s[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}var l={};return(()=>{var o=l;Object.defineProperty(o,"__esModule",{value:!0}),o.Terminal=void 0;let e=n(3236),r=n(9042),c=n(7975),d=n(7090),g=n(5741),a=n(8285),f=["cols","rows"];o.Terminal=class{constructor(m){this._core=new e.Terminal(m),this._addonManager=new g.AddonManager,this._publicOptions=Object.assign({},this._core.options);let _=u=>this._core.options[u],i=(u,p)=>{this._checkReadonlyOptions(u),this._core.options[u]=p};for(let u in this._core.options){let p={get:_.bind(this,u),set:i.bind(this,u)};Object.defineProperty(this._publicOptions,u,p)}}_checkReadonlyOptions(m){if(f.includes(m))throw new Error(`Option "${m}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new c.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new d.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new a.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let m=this._core.coreService.decPrivateModes,_="none";switch(this._core.coreMouseService.activeProtocol){case"X10":_="x10";break;case"VT200":_="vt200";break;case"DRAG":_="drag";break;case"ANY":_="any"}return{applicationCursorKeysMode:m.applicationCursorKeys,applicationKeypadMode:m.applicationKeypad,bracketedPasteMode:m.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:_,originMode:m.origin,reverseWraparoundMode:m.reverseWraparound,sendFocusMode:m.sendFocus,wraparoundMode:m.wraparound}}get options(){return this._publicOptions}set options(m){for(let _ in m)this._publicOptions[_]=m[_]}blur(){this._core.blur()}focus(){this._core.focus()}resize(m,_){this._verifyIntegers(m,_),this._core.resize(m,_)}open(m){this._core.open(m)}attachCustomKeyEventHandler(m){this._core.attachCustomKeyEventHandler(m)}registerLinkProvider(m){return this._core.registerLinkProvider(m)}registerCharacterJoiner(m){return this._checkProposedApi(),this._core.registerCharacterJoiner(m)}deregisterCharacterJoiner(m){this._checkProposedApi(),this._core.deregisterCharacterJoiner(m)}registerMarker(m=0){return this._verifyIntegers(m),this._core.addMarker(m)}registerDecoration(m){var _,i,u;return this._checkProposedApi(),this._verifyPositiveIntegers((_=m.x)!==null&&_!==void 0?_:0,(i=m.width)!==null&&i!==void 0?i:0,(u=m.height)!==null&&u!==void 0?u:0),this._core.registerDecoration(m)}hasSelection(){return this._core.hasSelection()}select(m,_,i){this._verifyIntegers(m,_,i),this._core.select(m,_,i)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(m,_){this._verifyIntegers(m,_),this._core.selectLines(m,_)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(m){this._verifyIntegers(m),this._core.scrollLines(m)}scrollPages(m){this._verifyIntegers(m),this._core.scrollPages(m)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(m){this._verifyIntegers(m),this._core.scrollToLine(m)}clear(){this._core.clear()}write(m,_){this._core.write(m,_)}writeln(m,_){this._core.write(m),this._core.write(`\r
`,_)}paste(m){this._core.paste(m)}refresh(m,_){this._verifyIntegers(m,_),this._core.refresh(m,_)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(m){return this._addonManager.loadAddon(this,m)}static get strings(){return r}_verifyIntegers(...m){for(let _ of m)if(_===1/0||isNaN(_)||_%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...m){for(let _ of m)if(_&&(_===1/0||isNaN(_)||_%1!=0||_<0))throw new Error("This API only accepts positive integers")}}})(),l})()})});var In=te((gr,bi)=>{(function(t,s){typeof gr=="object"&&typeof bi=="object"?bi.exports=s():typeof define=="function"&&define.amd?define([],s):typeof gr=="object"?gr.WebLinksAddon=s():t.WebLinksAddon=s()})(self,function(){return(()=>{"use strict";var t={6:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LinkComputer=e.WebLinkProvider=void 0,e.WebLinkProvider=class{constructor(c,d,g,a={}){this._terminal=c,this._regex=d,this._handler=g,this._options=a}provideLinks(c,d){let g=r.computeLink(c,this._regex,this._terminal,this._handler);d(this._addCallbacks(g))}_addCallbacks(c){return c.map(d=>(d.leave=this._options.leave,d.hover=(g,a)=>{if(this._options.hover){let{range:f}=d;this._options.hover(g,a,f)}},d))}};class r{static computeLink(d,g,a,f){let m=new RegExp(g.source,(g.flags||"")+"g"),[_,i]=r._getWindowedLineStrings(d-1,a),u=_.join(""),p,h=[];for(;p=m.exec(u);){let v=p[0];try{let L=new URL(v),x=decodeURI(L.toString());if(v!==x&&v+"/"!==x)continue}catch(L){continue}let[y,b]=r._mapStrIdx(a,i,0,p.index),[w,S]=r._mapStrIdx(a,y,b,v.length);if(y===-1||b===-1||w===-1||S===-1)continue;let C={start:{x:b+1,y:y+1},end:{x:S,y:w+1}};h.push({range:C,text:v,activate:f})}return h}static _getWindowedLineStrings(d,g){let a,f=d,m=d,_=0,i="",u=[];if(a=g.buffer.active.getLine(d)){let p=a.translateToString(!0);if(a.isWrapped&&p[0]!==" "){for(_=0;(a=g.buffer.active.getLine(--f))&&_<2048&&(i=a.translateToString(!0),_+=i.length,u.push(i),a.isWrapped&&i.indexOf(" ")===-1););u.reverse()}for(u.push(p),_=0;(a=g.buffer.active.getLine(++m))&&a.isWrapped&&_<2048&&(i=a.translateToString(!0),_+=i.length,u.push(i),i.indexOf(" ")===-1););}return[u,f]}static _mapStrIdx(d,g,a,f){let m=d.buffer.active,_=m.getNullCell(),i=a;for(;f;){let u=m.getLine(g);if(!u)return[-1,-1];for(let p=i;p<u.length;++p){u.getCell(p,_);let h=_.getChars();if(_.getWidth()&&(f-=h.length||1,p===u.length-1&&h==="")){let v=m.getLine(g+1);v&&v.isWrapped&&(v.getCell(0,_),_.getWidth()===2&&(f+=1))}if(f<0)return[g,p]}g++,i=0}return[g,i]}}e.LinkComputer=r}},s={};function n(o){var e=s[o];if(e!==void 0)return e.exports;var r=s[o]={exports:{}};return t[o](r,r.exports,n),r.exports}var l={};return(()=>{var o=l;Object.defineProperty(o,"__esModule",{value:!0}),o.WebLinksAddon=void 0;let e=n(6),r=/https?:[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function c(d,g){let a=window.open();if(a){try{a.opener=null}catch(f){}a.location.href=g}else console.warn("Opening link blocked as opener could not be cleared")}o.WebLinksAddon=class{constructor(d=c,g={}){this._handler=d,this._options=g}activate(d){this._terminal=d;let g=this._options,a=g.urlRegex||r;this._linkProvider=this._terminal.registerLinkProvider(new e.WebLinkProvider(this._terminal,a,this._handler,g))}dispose(){var d;(d=this._linkProvider)===null||d===void 0||d.dispose()}}})(),l})()})});var Cl={};tt(Cl,{TerminalPlugin:()=>Te,default:()=>bl});module.exports=Gn(Cl);var ke=require("obsidian");var be=require("obsidian");var Cr={};tt(Cr,{default:()=>Zn,menus:()=>Yn,settings:()=>Jn,views:()=>Xn});var Yn={"open-terminal-external-icon":"terminal-square","open-terminal-integrated-icon":"terminal","save-as-HTML-icon":"save"},Xn={"terminal-icon":"terminal"},Jn={"add-to-commands-icon":"terminal","add-to-context-menus-icon":"menu","executable-list-icon":"terminal-square","language-icon":"languages","notice-timeout-icon":"timer","python-executable-icon":"scaling","reset-icon":"reset"},Zn={menus:Yn,views:Xn,settings:Jn};var wr={};tt(wr,{commands:()=>Qn,default:()=>oo,errors:()=>eo,menus:()=>to,name:()=>ro,notices:()=>io,settings:()=>so,views:()=>no});var Qn={"open-terminal-external-root":"Open root in external terminal","open-terminal-external-current":"Open current folder in external terminal","open-terminal-integrated-root":"Open root in integrated terminal","open-terminal-integrated-current":"Open current folder in integrated terminal"},eo={"error-spawning-terminal":"Error spawning terminal","error-spawning-resizer":"Error spawning terminal resizer","resizer-disabled":"Terminal resizer disabled","unsupported-platform":"Unsupported platform"},to={"open-terminal-external":"Open in external terminal","open-terminal-integrated":"Open in integrated terminal","save-as-HTML":"Save as HTML"},ro="Terminal",io={"spawning-terminal":"Spawning terminal: {{executable}}","terminal-exited":"Terminal exited: {{code}}"},so={"add-to-commands":"Add to commands","add-to-context-menus":"Add to context menus",executables:"Executables","executable-list":{darwin:"macOS",linux:"Linux",win32:"Microsoft Windows"},language:"Language","language-default":"Use app setting","language-description":"Applies to this plugin only.","notice-timeout":"Notice timeout (s)","notice-timeout-description":"Set to 0 s for no timeout.","python-executable":"Python executable","python-executable-description":"Clear field to disable terminal resizer.","python-executable-placeholder":"(Disabled)",reset:"Reset","reset-all":"Reset all"},no={terminal:{"display-name":"Terminal: {{executable}}"}},oo={commands:Qn,errors:eo,menus:to,name:ro,notices:io,settings:so,views:no};var Er={};tt(Er,{default:()=>ho,en:()=>ao,"zh-Hans":()=>lo,"zh-Hant":()=>co});var ao="English",lo="\u7B80\u4F53\u4E2D\u6587",co="\u7E41\u9AD4\u4E2D\u6587",ho={en:ao,"zh-Hans":lo,"zh-Hant":co};var Lr={};tt(Lr,{commands:()=>uo,default:()=>So,errors:()=>fo,menus:()=>_o,name:()=>po,notices:()=>go,settings:()=>vo,views:()=>mo});var uo={"open-terminal-external-root":"\u5728\u5916\u90E8\u7EC8\u7AEF\u673A\u5F00\u555F\u6839\u76EE\u9332","open-terminal-external-current":"\u5728\u5916\u90E8\u7EC8\u7AEF\u673A\u5F00\u555F\u76EE\u524D\u76EE\u9332","open-terminal-integrated-root":"\u5728\u6574\u5408\u5F0F\u7EC8\u7AEF\u673A\u5F00\u555F\u6839\u76EE\u9332","open-terminal-integrated-current":"\u5728\u6574\u5408\u5F0F\u7EC8\u7AEF\u673A\u5F00\u555F\u76EE\u524D\u76EE\u9332"},fo={"error-spawning-terminal":"\u555F\u52A8\u7EC8\u7AEF\u673A\u65F6\u51FA\u9519","error-spawning-resizer":"\u555F\u52A8\u7EC8\u7AEF\u673A\u7F29\u653E\u8FF8\u7A0B\u65F6\u51FA\u9519","resizer-disabled":"\u7EC8\u7AEF\u673A\u7F29\u653E\u8FF8\u7A0B\u5DF2\u7981\u7528","unsupported-platform":"\u4E0D\u652F\u6301\u6B64\u5E73\u53F0"},_o={"open-terminal-external":"\u5728\u5916\u90E8\u7EC8\u7AEF\u673A\u5F00\u555F","open-terminal-integrated":"\u5728\u6574\u5408\u5F0F\u7EC8\u7AEF\u673A\u5F00\u555F","save-as-HTML":"\u50A8\u5B58\u4E3A HTML"},po="\u7EC8\u7AEF\u673A",go={"spawning-terminal":"\u7EC8\u7AEF\u673A\u555F\u52A8\u4E2D\uFF1A{{executable}}","terminal-exited":"\u7EC8\u7AEF\u673A\u5DF2\u9000\u51FA\uFF1A{{code}}"},vo={"add-to-commands":"\u52A0\u5165\u81F3\u547D\u4EE4","add-to-context-menus":"\u52A0\u5165\u81F3\u53F3\u952E\u9009\u5355",executables:"\u53EF\u6267\u884C\u6587\u4EF6","executable-list":{darwin:"macOS",linux:"Linux",win32:"Microsoft Windows"},language:"\u8BED\u8A00","language-default":"\u4F7F\u7528\u5E94\u7528\u8BBE\u5B9A","language-description":"\u4EC5\u9002\u7528\u65BC\u6B64\u63D2\u4EF6\u3002","notice-timeout":"\u901A\u77E5\u8D85\u65F6\uFF08\u79D2\uFF09","notice-timeout-description":"\u8BBE\u4E3A 0 \u79D2\u662F\u65E0\u8D85\u65F6\u3002","python-executable":"Python \u53EF\u6267\u884C\u6587\u4EF6","python-executable-description":"\u6E05\u9664\u6587\u672C\u6846\u4EE5\u7981\u7528\u7EC8\u7AEF\u673A\u7F29\u653E\u8FF8\u7A0B\u3002","python-executable-placeholder":"\uFF08\u5DF2\u7981\u7528\uFF09",reset:"\u91CD\u8BBE","reset-all":"\u91CD\u8BBE\u5168\u90E8"},mo={terminal:{"display-name":"\u7EC8\u7AEF\u673A\uFF1A{{executable}}"}},So={commands:uo,errors:fo,menus:_o,name:po,notices:go,settings:vo,views:mo};var xr={};tt(xr,{commands:()=>yo,default:()=>ko,errors:()=>bo,menus:()=>Co,name:()=>wo,notices:()=>Eo,settings:()=>Lo,views:()=>xo});var yo={"open-terminal-external-root":"\u5728\u5916\u90E8\u7D42\u7AEF\u6A5F\u958B\u555F\u6839\u76EE\u9304","open-terminal-external-current":"\u5728\u5916\u90E8\u7D42\u7AEF\u6A5F\u958B\u555F\u76EE\u524D\u76EE\u9304","open-terminal-integrated-root":"\u5728\u6574\u5408\u5F0F\u7D42\u7AEF\u6A5F\u958B\u555F\u6839\u76EE\u9304","open-terminal-integrated-current":"\u5728\u6574\u5408\u5F0F\u7D42\u7AEF\u6A5F\u958B\u555F\u76EE\u524D\u76EE\u9304"},bo={"error-spawning-terminal":"\u555F\u52D5\u7D42\u7AEF\u6A5F\u6642\u51FA\u932F","error-spawning-resizer":"\u555F\u52D5\u7D42\u7AEF\u6A5F\u7E2E\u653E\u7A0B\u5F0F\u6642\u51FA\u932F","resizer-disabled":"\u7D42\u7AEF\u6A5F\u7E2E\u653E\u7A0B\u5F0F\u5DF2\u7981\u7528","unsupported-platform":"\u4E0D\u652F\u6301\u6B64\u5E73\u53F0"},Co={"open-terminal-external":"\u5728\u5916\u90E8\u7D42\u7AEF\u6A5F\u958B\u555F","open-terminal-integrated":"\u5728\u6574\u5408\u5F0F\u7D42\u7AEF\u6A5F\u958B\u555F","save-as-HTML":"\u5132\u5B58\u70BA HTML"},wo="\u7D42\u7AEF\u6A5F",Eo={"spawning-terminal":"\u7D42\u7AEF\u6A5F\u555F\u52D5\u4E2D\uFF1A{{executable}}","terminal-exited":"\u7D42\u7AEF\u6A5F\u5DF2\u9000\u51FA\uFF1A{{code}}"},Lo={"add-to-commands":"\u52A0\u5165\u81F3\u547D\u4EE4","add-to-context-menus":"\u52A0\u5165\u81F3\u53F3\u9375\u9078\u55AE",executables:"\u57F7\u884C\u6A94","executable-list":{darwin:"macOS",linux:"Linux",win32:"Microsoft Windows"},language:"\u8A9E\u8A00","language-default":"\u4F7F\u7528\u61C9\u7528\u7A0B\u5F0F\u8A2D\u5B9A","language-description":"\u50C5\u9069\u7528\u65BC\u6B64\u5916\u639B\u7A0B\u5F0F\u3002","notice-timeout":"\u901A\u77E5\u8D85\u6642\uFF08\u79D2\uFF09","notice-timeout-description":"\u8A2D\u70BA 0 \u79D2\u662F\u7121\u8D85\u6642\u3002","python-executable":"Python \u57F7\u884C\u6A94","python-executable-description":"\u6E05\u9664\u6587\u5B57\u57DF\u4EE5\u7981\u7528\u7D42\u7AEF\u6A5F\u7E2E\u653E\u7A0B\u5F0F\u3002","python-executable-placeholder":"\uFF08\u5DF2\u7981\u7528\uFF09",reset:"\u91CD\u8A2D","reset-all":"\u91CD\u8A2D\u5168\u90E8"},xo={terminal:{"display-name":"\u7D42\u7AEF\u6A5F\uFF1A{{executable}}"}},ko={commands:yo,errors:bo,menus:Co,name:wo,notices:Eo,settings:Lo,views:xo};var Ei=!1,St="translation",it="en",Li={default:[it],zh:["zh-Hans",it],"zh-CN":["zh-Hans","zh",it],"zh-TW":["zh-Hant","zh",it]},Nt={en:{[St]:wr,asset:Cr,language:Er},"zh-Hans":{[St]:Lr},"zh-Hant":{[St]:xr}};var Re={command:!0,contextMenu:!0,executables:{darwin:{args:[],name:"Terminal.app"},linux:{args:[],name:"xterm-256color"},win32:{args:[],name:"C:\\Windows\\System32\\cmd.exe"}},language:"",noticeTimeout:5,pythonExecutable:"python"},Oe,Ke,jt,xi,Ce,He,Ft=class extends be.PluginSettingTab{constructor(n){super(n.app,n);this.plugin=n;Q(this,Oe);Q(this,jt);Q(this,Ce)}display(){let{containerEl:n,plugin:l}=this,{i18n:o}=l;n.empty(),n.createEl("h1",{text:l.i18n.t("name")}),new be.Setting(n).setName(o.t("settings.language")).setDesc(o.t("settings.language-description")).addDropdown(Z(this,Oe,Ke).call(this,()=>l.settings.language,e=>void(l.settings.language=e),{post:(e,r)=>void e.onChange(async c=>{await r(c),await l.language.changeLanguage(c),this.display()}),pre:e=>void e.addOption("",o.t("settings.language-default")).addOptions(Object.fromEntries(Object.entries(Nt.en.language).filter(r=>r.every(c=>typeof c=="string"))))})).addExtraButton(Z(this,Ce,He).call(this,()=>void(l.settings.language=Re.language),o.t("asset:settings.language-icon"),{post:(e,r)=>void e.onClick(async()=>{await r(),await l.language.changeLanguage(l.settings.language),this.display()})})),new be.Setting(n).setName(o.t("settings.reset-all")).addButton(Z(this,Ce,He).call(this,async()=>{Object.assign(l.settings,Re),await l.language.changeLanguage(l.settings.language)})),new be.Setting(n).setName(o.t("settings.add-to-commands")).addToggle(Z(this,Oe,Ke).call(this,()=>l.settings.command,e=>void(l.settings.command=e))).addExtraButton(Z(this,Ce,He).call(this,()=>void(l.settings.command=Re.command),o.t("asset:settings.add-to-commands-icon"))),new be.Setting(n).setName(o.t("settings.add-to-context-menus")).addToggle(Z(this,Oe,Ke).call(this,()=>l.settings.contextMenu,e=>void(l.settings.contextMenu=e))).addExtraButton(Z(this,Ce,He).call(this,()=>void(l.settings.contextMenu=Re.contextMenu),o.t("asset:settings.add-to-context-menus-icon"))),new be.Setting(n).setName(o.t("settings.notice-timeout")).setDesc(o.t("settings.notice-timeout-description")).addText(Z(this,Oe,Ke).call(this,()=>l.settings.noticeTimeout.toString(),Z(this,jt,xi).call(this,e=>void(l.settings.noticeTimeout=e)))).addExtraButton(Z(this,Ce,He).call(this,()=>void(l.settings.noticeTimeout=Re.noticeTimeout),o.t("asset:settings.notice-timeout-icon"))),new be.Setting(n).setName(o.t("settings.python-executable")).setDesc(o.t("settings.python-executable-description")).addText(Z(this,Oe,Ke).call(this,()=>l.settings.pythonExecutable,e=>void(l.settings.pythonExecutable=e),{post:e=>void e.setPlaceholder(o.t("settings.python-executable-placeholder"))})).addExtraButton(Z(this,Ce,He).call(this,()=>void(l.settings.pythonExecutable=Re.pythonExecutable),o.t("asset:settings.python-executable-icon"))),n.createEl("h2",{text:o.t("settings.executables")});for(let e of Te.PLATFORMS)new be.Setting(n).setName(o.t(`settings.executable-list.${e}`)).addText(Z(this,Oe,Ke).call(this,()=>l.settings.executables[e].name,r=>void(l.settings.executables[e].name=r))).addExtraButton(Z(this,Ce,He).call(this,()=>void(l.settings.executables[e].name=Re.executables[e].name),o.t("asset:settings.executable-list-icon")))}};Oe=new WeakSet,Ke=function(n,l,o={}){return e=>{var c,d;((c=o.pre)!=null?c:()=>{})(e);let r=async g=>{let a=await l(g,e,n);typeof a=="boolean"&&!a||await this.plugin.saveSettings()};e.setValue(n()).onChange(r),((d=o.post)!=null?d:()=>{})(e,r)}},jt=new WeakSet,xi=function(n,l=!1){return async(o,e,r)=>{let c=Number(o);if(!(l?Number.isSafeInteger(c):isFinite(c)))return e.setValue(r()),!1;let d=await n(c,e,r);return!(typeof d=="boolean"&&!d)}},Ce=new WeakSet,He=function(n,l=this.plugin.i18n.t("asset:settings.reset-icon"),o={}){return e=>{var c,d;((c=o.pre)!=null?c:()=>{})(e);let r=async()=>{let g=await n(e);if(typeof g=="boolean"&&!g)return;let a=this.plugin.saveSettings();this.display(),await a};e.setTooltip(this.plugin.i18n.t("settings.reset")).setIcon(l).onClick(r),((d=o.post)!=null?d:()=>{})(e,r)}};var nr=require("child_process");var ki=[0,"SIGINT","SIGTERM"],Ri=500,Oi=500;var zt=require("obsidian");var Ut=class{constructor(s){this.id=s}namespaced(s){return`${(s instanceof zt.Plugin?s.manifest:s).id}:${this.id}`}};function Ti(t,s,n,l){let o=t();return()=>l.replace(o,t()).replace(n,s())}function Ai(t){return structuredClone(t)}function Di(t,s="text/plain;charset=UTF-8;",n=""){let l=document.createElement("a");l.target="_blank",l.download=n;let o=URL.createObjectURL(new Blob([t],{type:s}));try{l.href=o,l.click()}finally{URL.revokeObjectURL(o)}}function $t(t,s){return t.some(n=>s===n)}function Pi(t,s){return"__type"in s?s.__type===t:!1}function Bi(t){let s=document.querySelector("div.status-bar");return s!==null&&(t!=null?t:()=>{})(s),s}function yt(t,s=0,n){let l=1e3*s,o=new zt.Notice(t(),l);if(typeof n=="undefined")return o;let e=n.language.registerUse(()=>o.setMessage(t()));try{l===0?n.register(e):window.setTimeout(e,l)}catch(r){e()}return o}function Ii(t,s,n=!1){let l=new IntersectionObserver((o,e)=>{var r;(n?o.reverse():[(r=o.last())!=null?r:{isIntersecting:!1}]).some(c=>c.isIntersecting?(s(e,t,c),!0):!1)});return l.observe(t),l}function Mi(t){return window.open(t,"_blank","noreferrer")}function Ae(t,s=()=>"",n){console.error(`${s()}
`,t),yt(t instanceof Error?()=>`${s()}
${t.name}: ${t.message}`:()=>`${s()}
${String(t)}`,0,n)}function Hi(t){let s=t.getViewType(),n=t.getDisplayText(),l=document.querySelector(`.workspace-tab-header[data-type="${s}"]`);if(l===null)return!1;let o=l.querySelector(".workspace-tab-header-inner-title");if(o===null)return!1;let e=o.textContent;return e===null?!1:(o.textContent=n,l.ariaLabel=n,document.title=document.title.replace(e,n),!0)}var tn=require("util"),rn=require("fs");var Ni=`# -*- coding: UTF-8 -*-\r
# pip install psutil pywinctl\r
import contextlib as _contextlib\r
import os as _os\r
import psutil as _psutil\r
import pywinctl as _pywinctl  # type: ignore\r
import sys as _sys\r
import types as _types\r
import typing as _typing\r
\r
\r
def main() -> None:\r
    pid = int(input("PID: "))\r
    print(f"received: {pid}")\r
    proc = _psutil.Process(pid)\r
    procs = (proc,) + tuple(proc.children(recursive=True))\r
    print(f"Process(es): {procs}")\r
    pids: _typing.Mapping[int, _psutil.Process] = _types.MappingProxyType(\r
        {proc.pid: proc for proc in procs}\r
    )\r
\r
    windows: _typing.Collection[_pywinctl.Window] = _pywinctl.getAllWindows()\r
    print(f"windows: {windows}")\r
    for win in windows:\r
        win_pid = win_to_pid(win)\r
        if win_pid in pids:\r
            resizer(pids[_typing.cast(int, win_pid)], win)\r
            break\r
    resizer(proc, None)\r
\r
\r
def win_to_pid(window: _pywinctl.Window) -> int | None:\r
    if _sys.platform == "darwin":\r
        return window._app.processIdentifier()\r
    elif _sys.platform == "linux":\r
        import ewmh as _ewmh\r
\r
        return _ewmh.getWmPid(window.getHandle())\r
    elif _sys.platform == "win32":\r
        import win32process as _win32process\r
\r
        return _win32process.GetWindowThreadProcessId(window.getHandle())[1]\r
    return None\r
\r
\r
def resizer(process: _psutil.Process, window: _pywinctl.BaseWindow | None) -> None:\r
    print(f"window: {window}")\r
    r_in = resizer_in(process)\r
    r_out = resizer_out(process, window)\r
    next(r_out)\r
    for size in r_in:\r
        r_out.send(size)\r
\r
\r
def resizer_in(process: _psutil.Process) -> _typing.Iterator[tuple[int, int]]:\r
    while True:\r
        size0 = ""\r
        while not size0:  # stdin watchdog triggers this loop\r
            if not process.is_running():\r
                return\r
            size0 = input("size: ")\r
        size = _typing.cast(\r
            tuple[int, int],\r
            tuple(int(s.strip()) for s in size0.split("x", 2)),\r
        )\r
        print(f"received: {'x'.join(map(str, size))}")\r
        yield size\r
\r
\r
def resizer_out(\r
    process: _psutil.Process, window: _pywinctl.BaseWindow | None\r
) -> _typing.Generator[None, tuple[int, int], None]:\r
    if window is None:\r
        while True:\r
            yield\r
    window.hide()\r
    if _sys.platform == "win32":\r
        import pywintypes as _pywintypes\r
        import win32con as _win32con\r
        import win32console as _win32console\r
        import win32file as _win32file\r
        import win32gui as _win32gui\r
\r
        @_typing.final\r
        class ConsoleScreenBufferInfo(_typing.TypedDict):\r
            Size: _win32console.PyCOORDType\r
            CursorPosition: _win32console.PyCOORDType\r
            Attributes: int\r
            Window: _win32console.PySMALL_RECTType\r
            MaximumWindowSize: _win32console.PyCOORDType\r
\r
        def ignore_error(func: _typing.Callable[[], None]) -> bool:\r
            try:\r
                func()\r
                return True\r
            except _pywintypes.error:\r
                return False\r
\r
        @_contextlib.contextmanager\r
        def attach_console(\r
            pid: int,\r
        ) -> _typing.Iterator[_win32console.PyConsoleScreenBufferType]:\r
            try:\r
                _win32console.AttachConsole(pid)  # type: ignore\r
                yield (_win32console.PyConsoleScreenBufferType)(  # type: ignore\r
                    _win32file.CreateFile(\r
                        "CONOUT$",\r
                        _win32file.GENERIC_READ | _win32file.GENERIC_WRITE,\r
                        _win32file.FILE_SHARE_WRITE,\r
                        None,\r
                        _win32file.OPEN_EXISTING,\r
                        0,\r
                        None,\r
                    )  # GetStdHandle gives the piped handle instead of the console handle\r
                )\r
            finally:\r
                _win32console.FreeConsole()\r
\r
        _win32console.FreeConsole()\r
        with attach_console(process.pid) as console:\r
            while True:\r
                columns: int\r
                rows: int\r
                columns, rows = yield\r
                info: ConsoleScreenBufferInfo = (\r
                    console.GetConsoleScreenBufferInfo()  # type: ignore\r
                )\r
                old_rect = window.getClientFrame()\r
                old_actual_rect = window.size\r
                old_cols: int = (\r
                    info["Window"].Right - info["Window"].Left + 1  # type: ignore\r
                )\r
                old_rows: int = (\r
                    info["Window"].Bottom - info["Window"].Top + 1  # type: ignore\r
                )\r
                old_width = old_rect.right - old_rect.left\r
                old_height = old_rect.bottom - old_rect.top\r
                size = (\r
                    int(old_width * columns / old_cols)\r
                    + old_actual_rect.width\r
                    - old_width,\r
                    int(old_height * rows / old_rows)\r
                    + old_actual_rect.height\r
                    - old_height,\r
                )\r
                print(f"pixel size: {size}")\r
                setters = [\r
                    # almost accurate, works for alternate screen buffer\r
                    lambda: _win32gui.SetWindowPos(\r
                        _typing.cast(int, window.getHandle()),\r
                        None,\r
                        0,\r
                        0,\r
                        *size,\r
                        _win32con.SWP_NOACTIVATE\r
                        | _win32con.SWP_NOREDRAW\r
                        | _win32con.SWP_NOZORDER,\r
                    ),\r
                    # accurate, SetConsoleWindowInfo does not work for alternate screen buffer\r
                    lambda: console.SetConsoleWindowInfo(  # type: ignore\r
                        True,\r
                        _win32console.PySMALL_RECTType(0, 0, columns - 1, old_rows - 1),  # type: ignore\r
                    ),\r
                    lambda: console.SetConsoleScreenBufferSize(\r
                        _win32console.PyCOORDType(columns, old_rows)  # type: ignore\r
                    ),\r
                    lambda: console.SetConsoleWindowInfo(  # type: ignore\r
                        True,\r
                        _win32console.PySMALL_RECTType(0, 0, columns - 1, rows - 1),  # type: ignore\r
                    ),\r
                    lambda: console.SetConsoleScreenBufferSize(\r
                        _win32console.PyCOORDType(columns, rows)  # type: ignore\r
                    ),\r
                ]\r
                if old_cols < columns:\r
                    setters[1], setters[2] = setters[2], setters[1]\r
                if old_rows < rows:\r
                    setters[3], setters[4] = setters[4], setters[3]\r
                for setter in setters:\r
                    ignore_error(setter)\r
                print(f"resized")  # used by the plugin\r
    else:\r
        import termios as _termios\r
\r
        @_contextlib.contextmanager\r
        def open_tty(pid: int) -> _typing.Iterator[int]:\r
            fd = _os.open(f"/proc/{pid}/fd/0", _os.O_RDONLY)\r
            try:\r
                yield fd\r
            finally:\r
                _os.close(fd)\r
\r
        with open_tty(process.pid) as tty:\r
            while True:\r
                columns: int\r
                rows: int\r
                columns, rows = yield\r
                _termios.tcsetwinsize(tty, (rows, columns))\r
                print(f"resized")  # used by the plugin\r
\r
\r
if __name__ == "__main__":\r
    main()\r
`;var sn=rt(en());var li=class{constructor(s){this.plugin=s}},Xe,ht,ut,tr=class extends li{constructor(n,l){super(n);this.spawnShell=l;ve(this,"shell");Q(this,Xe,!1);Q(this,ht,(()=>{let{pythonExecutable:n}=this.plugin.settings;if(n==="")return null;let l=(0,nr.spawn)(n,["-c",Ni],{stdio:["pipe","pipe","pipe"],windowsHide:!0});return l.once("spawn",()=>{ye(this,Xe,!0);let o=this.plugin.registerInterval(window.setInterval(()=>void q(this,ut).call(this,`
`).catch(()=>{}),Oi)),e=()=>{window.clearInterval(o)};try{l.once("exit",e).once("error",e)}catch(r){throw e(),r}}).once("exit",()=>void ye(this,Xe,!1)).once("error",o=>{ye(this,Xe,!1),Ae(o,()=>this.plugin.i18n.t("errors.error-spawning-resizer"),this.plugin)}),l})());Q(this,ut,(0,tn.promisify)((n,l)=>{let o=q(this,ht);if(o===null)return l(new Error(this.plugin.i18n.t("errors.resizer-disabled"))),!1;try{return o.stdin.write(n,l)}catch(e){e instanceof Error?l(e):l(new Error(String(e)))}return!1}));this.shell=new Promise((o,e)=>{let r=q(this,ht);if(r===null){try{o(l(!1))}catch(f){e(f)}return}let c=f=>f.once("spawn",()=>{let{pid:m}=f;if(typeof m=="undefined"){r.kill();return}q(this,ut).call(this,`${m}
`).catch(_=>{r.kill(),Ae(_,()=>this.plugin.i18n.t("errors.error-spawning-resizer"),this.plugin)})}).once("exit",()=>r.kill()).once("error",()=>r.kill()),d=()=>{try{o(c(l(!0)))}catch(f){e(f)}finally{r.removeListener("error",a)}},g=r;function a(){try{c(l(!1))}catch(f){e(f)}finally{g.removeListener("spawn",d)}}r.once("spawn",d).once("error",a)})}get resizable(){return q(this,Xe)}async resize(n,l){return new Promise((o,e)=>{let r=q(this,ht);if(r===null){e(new Error(this.plugin.i18n.t("errors.resizer-disabled")));return}let c=r,{stdout:d}=r,g=m=>{if(m.toString().includes("resized"))try{o()}finally{d.removeListener("data",g),r.removeListener("exit",a).removeListener("error",f)}};function a(...m){try{e(new Error(m.toString()))}catch(_){e(_)}finally{d.removeListener("data",g),c.removeListener("error",f)}}function f(m){try{e(m)}finally{d.removeListener("data",g),c.removeListener("exit",a)}}r.once("exit",a).once("error",f),d.on("data",g),q(this,ut).call(this,`${n}x${l}
`).catch(m=>{try{e(m)}finally{d.removeListener("data",g),r.removeListener("exit",a).removeListener("error",f)}})})}};Xe=new WeakMap,ht=new WeakMap,ut=new WeakMap;var kt,ir,nn,sr=class extends tr{constructor(n,l,o,e){let r=Z(sr,ir,nn).bind(sr),c=e!=null?e:[],d=(0,sn.fileSync)({discardDescriptor:!0});super(n,g=>(0,nr.spawn)("C:\\Windows\\System32\\conhost.exe",["C:\\Windows\\System32\\cmd.exe","/C",`${r(l)} ${c.map(r).join(" ")} & call echo %^ERRORLEVEL% >${r(d.name)}`],{cwd:o,stdio:["pipe","pipe","pipe"],windowsHide:!g,windowsVerbatimArguments:!0}));Q(this,kt,void 0);ye(this,kt,this.shell.then(async g=>new Promise((a,f)=>{g.once("exit",(m,_)=>{var i;try{let u=parseInt((0,rn.readFileSync)(d.name,{encoding:"utf-8",flag:"r"}).trim(),10);a(isNaN(u)?(i=m!=null?m:_)!=null?i:NaN:u)}catch(u){f(u)}finally{d.removeCallback()}}).once("error",m=>{try{f(m)}finally{d.removeCallback()}})})))}async once(n,l){return q(this,kt).then(l).catch(()=>{}),Promise.resolve(this)}},Je=sr;kt=new WeakMap,ir=new WeakSet,nn=function(n){return`"${n.replace('"','\\"')}"`.replace(/(?<meta>[()%!^"<>&|])/gu,"^$<meta>")},Q(Je,ir);var rr=class extends tr{constructor(s,n,l,o){super(s,e=>(0,nr.spawn)(n,o,{cwd:l,stdio:["pipe","pipe","pipe"],windowsHide:!e}))}async once(s,n){return(await this.shell).once(s,(l,o)=>{var e;return void n((e=l!=null?l:o)!=null?e:NaN)}),this}};function le(t){return le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},le(t)}function _e(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function ci(t,s){if(le(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,s||"default");if(le(l)!=="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function Rt(t){var s=ci(t,"string");return le(s)==="symbol"?s:String(s)}function on(t,s){for(var n=0;n<s.length;n++){var l=s[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,Rt(l.key),l)}}function pe(t,s,n){return s&&on(t.prototype,s),n&&on(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function me(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ot(t,s){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,o){return l.__proto__=o,l},Ot(t,s)}function dt(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&Ot(t,s)}function Ze(t,s){if(s&&(le(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return me(t)}function ge(t){return ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ge(t)}function Ee(t,s,n){return s=Rt(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function hi(t){if(Array.isArray(t))return t}function ui(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function or(t,s){(s==null||s>t.length)&&(s=t.length);for(var n=0,l=new Array(s);n<s;n++)l[n]=t[n];return l}function di(t,s){if(t){if(typeof t=="string")return or(t,s);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return or(t,s)}}function fi(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _i(t){return hi(t)||ui(t)||di(t)||fi()}function an(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);s&&(l=l.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,l)}return n}function ln(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?an(Object(n),!0).forEach(function(l){Ee(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):an(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}var Va={type:"logger",log:function(s){this.output("log",s)},warn:function(s){this.output("warn",s)},error:function(s){this.output("error",s)},output:function(s,n){console&&console[s]&&console[s].apply(console,n)}},Ga=function(){function t(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_e(this,t),this.init(s,n)}return pe(t,[{key:"init",value:function(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=l.prefix||"i18next:",this.logger=n||Va,this.options=l,this.debug=l.debug}},{key:"setDebug",value:function(n){this.debug=n}},{key:"log",value:function(){for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return this.forward(l,"log","",!0)}},{key:"warn",value:function(){for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return this.forward(l,"warn","",!0)}},{key:"error",value:function(){for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return this.forward(l,"error","")}},{key:"deprecate",value:function(){for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return this.forward(l,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(n,l,o,e){return e&&!this.debug?null:(typeof n[0]=="string"&&(n[0]="".concat(o).concat(this.prefix," ").concat(n[0])),this.logger[l](n))}},{key:"create",value:function(n){return new t(this.logger,ln(ln({},{prefix:"".concat(this.prefix,":").concat(n,":")}),this.options))}},{key:"clone",value:function(n){return n=n||this.options,n.prefix=n.prefix||this.prefix,new t(this.logger,n)}}]),t}(),xe=new Ga,$e=function(){function t(){_e(this,t),this.observers={}}return pe(t,[{key:"on",value:function(n,l){var o=this;return n.split(" ").forEach(function(e){o.observers[e]=o.observers[e]||[],o.observers[e].push(l)}),this}},{key:"off",value:function(n,l){if(this.observers[n]){if(!l){delete this.observers[n];return}this.observers[n]=this.observers[n].filter(function(o){return o!==l})}}},{key:"emit",value:function(n){for(var l=arguments.length,o=new Array(l>1?l-1:0),e=1;e<l;e++)o[e-1]=arguments[e];if(this.observers[n]){var r=[].concat(this.observers[n]);r.forEach(function(d){d.apply(void 0,o)})}if(this.observers["*"]){var c=[].concat(this.observers["*"]);c.forEach(function(d){d.apply(d,[n].concat(o))})}}}]),t}();function Tt(){var t,s,n=new Promise(function(l,o){t=l,s=o});return n.resolve=t,n.reject=s,n}function cn(t){return t==null?"":""+t}function Ya(t,s,n){t.forEach(function(l){s[l]&&(n[l]=s[l])})}function gi(t,s,n){function l(c){return c&&c.indexOf("###")>-1?c.replace(/###/g,"."):c}function o(){return!t||typeof t=="string"}for(var e=typeof s!="string"?[].concat(s):s.split(".");e.length>1;){if(o())return{};var r=l(e.shift());!t[r]&&n&&(t[r]=new n),Object.prototype.hasOwnProperty.call(t,r)?t=t[r]:t={}}return o()?{}:{obj:t,k:l(e.shift())}}function hn(t,s,n){var l=gi(t,s,Object),o=l.obj,e=l.k;o[e]=n}function Xa(t,s,n,l){var o=gi(t,s,Object),e=o.obj,r=o.k;e[r]=e[r]||[],l&&(e[r]=e[r].concat(n)),l||e[r].push(n)}function cr(t,s){var n=gi(t,s),l=n.obj,o=n.k;if(l)return l[o]}function un(t,s,n){var l=cr(t,n);return l!==void 0?l:cr(s,n)}function Ln(t,s,n){for(var l in s)l!=="__proto__"&&l!=="constructor"&&(l in t?typeof t[l]=="string"||t[l]instanceof String||typeof s[l]=="string"||s[l]instanceof String?n&&(t[l]=s[l]):Ln(t[l],s[l],n):t[l]=s[l]);return t}function ft(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var Ja={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Za(t){return typeof t=="string"?t.replace(/[&<>"'\/]/g,function(s){return Ja[s]}):t}var ur=typeof window!="undefined"&&window.navigator&&typeof window.navigator.userAgentData=="undefined"&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,Qa=[" ",",","?","!",";"];function el(t,s,n){s=s||"",n=n||"";var l=Qa.filter(function(c){return s.indexOf(c)<0&&n.indexOf(c)<0});if(l.length===0)return!0;var o=new RegExp("(".concat(l.map(function(c){return c==="?"?"\\?":c}).join("|"),")")),e=!o.test(t);if(!e){var r=t.indexOf(n);r>0&&!o.test(t.substring(0,r))&&(e=!0)}return e}function dn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);s&&(l=l.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,l)}return n}function ar(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?dn(Object(n),!0).forEach(function(l){Ee(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function tl(t){var s=rl();return function(){var l=ge(t),o;if(s){var e=ge(this).constructor;o=Reflect.construct(l,arguments,e)}else o=l.apply(this,arguments);return Ze(this,o)}}function rl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function xn(t,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(t){if(t[s])return t[s];for(var l=s.split(n),o=t,e=0;e<l.length;++e){if(!o||typeof o[l[e]]=="string"&&e+1<l.length)return;if(o[l[e]]===void 0){for(var r=2,c=l.slice(e,e+r).join(n),d=o[c];d===void 0&&l.length>e+r;)r++,c=l.slice(e,e+r).join(n),d=o[c];if(d===void 0)return;if(d===null)return null;if(s.endsWith(c)){if(typeof d=="string")return d;if(c&&typeof d[c]=="string")return d[c]}var g=l.slice(e+r).join(n);return g?xn(d,g,n):void 0}o=o[l[e]]}return o}}var il=function(t){dt(n,t);var s=tl(n);function n(l){var o,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};return _e(this,n),o=s.call(this),ur&&$e.call(me(o)),o.data=l||{},o.options=e,o.options.keySeparator===void 0&&(o.options.keySeparator="."),o.options.ignoreJSONStructure===void 0&&(o.options.ignoreJSONStructure=!0),o}return pe(n,[{key:"addNamespaces",value:function(o){this.options.ns.indexOf(o)<0&&this.options.ns.push(o)}},{key:"removeNamespaces",value:function(o){var e=this.options.ns.indexOf(o);e>-1&&this.options.ns.splice(e,1)}},{key:"getResource",value:function(o,e,r){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},d=c.keySeparator!==void 0?c.keySeparator:this.options.keySeparator,g=c.ignoreJSONStructure!==void 0?c.ignoreJSONStructure:this.options.ignoreJSONStructure,a=[o,e];r&&typeof r!="string"&&(a=a.concat(r)),r&&typeof r=="string"&&(a=a.concat(d?r.split(d):r)),o.indexOf(".")>-1&&(a=o.split("."));var f=cr(this.data,a);return f||!g||typeof r!="string"?f:xn(this.data&&this.data[o]&&this.data[o][e],r,d)}},{key:"addResource",value:function(o,e,r,c){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},g=this.options.keySeparator;g===void 0&&(g=".");var a=[o,e];r&&(a=a.concat(g?r.split(g):r)),o.indexOf(".")>-1&&(a=o.split("."),c=e,e=a[1]),this.addNamespaces(e),hn(this.data,a,c),d.silent||this.emit("added",o,e,r,c)}},{key:"addResources",value:function(o,e,r){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(var d in r)(typeof r[d]=="string"||Object.prototype.toString.apply(r[d])==="[object Array]")&&this.addResource(o,e,d,r[d],{silent:!0});c.silent||this.emit("added",o,e,r)}},{key:"addResourceBundle",value:function(o,e,r,c,d){var g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},a=[o,e];o.indexOf(".")>-1&&(a=o.split("."),c=r,r=e,e=a[1]),this.addNamespaces(e);var f=cr(this.data,a)||{};c?Ln(f,r,d):f=ar(ar({},f),r),hn(this.data,a,f),g.silent||this.emit("added",o,e,r)}},{key:"removeResourceBundle",value:function(o,e){this.hasResourceBundle(o,e)&&delete this.data[o][e],this.removeNamespaces(e),this.emit("removed",o,e)}},{key:"hasResourceBundle",value:function(o,e){return this.getResource(o,e)!==void 0}},{key:"getResourceBundle",value:function(o,e){return e||(e=this.options.defaultNS),this.options.compatibilityAPI==="v1"?ar(ar({},{}),this.getResource(o,e)):this.getResource(o,e)}},{key:"getDataByLanguage",value:function(o){return this.data[o]}},{key:"hasLanguageSomeTranslations",value:function(o){var e=this.getDataByLanguage(o),r=e&&Object.keys(e)||[];return!!r.find(function(c){return e[c]&&Object.keys(e[c]).length>0})}},{key:"toJSON",value:function(){return this.data}}]),n}($e),kn={processors:{},addPostProcessor:function(s){this.processors[s.name]=s},handle:function(s,n,l,o,e){var r=this;return s.forEach(function(c){r.processors[c]&&(n=r.processors[c].process(n,l,o,e))}),n}};function fn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);s&&(l=l.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,l)}return n}function ce(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?fn(Object(n),!0).forEach(function(l){Ee(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fn(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function sl(t){var s=nl();return function(){var l=ge(t),o;if(s){var e=ge(this).constructor;o=Reflect.construct(l,arguments,e)}else o=l.apply(this,arguments);return Ze(this,o)}}function nl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var _n={},pn=function(t){dt(n,t);var s=sl(n);function n(l){var o,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _e(this,n),o=s.call(this),ur&&$e.call(me(o)),Ya(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],l,me(o)),o.options=e,o.options.keySeparator===void 0&&(o.options.keySeparator="."),o.logger=xe.create("translator"),o}return pe(n,[{key:"changeLanguage",value:function(o){o&&(this.language=o)}},{key:"exists",value:function(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(o==null)return!1;var r=this.resolve(o,e);return r&&r.res!==void 0}},{key:"extractFromKey",value:function(o,e){var r=e.nsSeparator!==void 0?e.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");var c=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator,d=e.ns||this.options.defaultNS||[],g=r&&o.indexOf(r)>-1,a=!this.options.userDefinedKeySeparator&&!e.keySeparator&&!this.options.userDefinedNsSeparator&&!e.nsSeparator&&!el(o,r,c);if(g&&!a){var f=o.match(this.interpolator.nestingRegexp);if(f&&f.length>0)return{key:o,namespaces:d};var m=o.split(r);(r!==c||r===c&&this.options.ns.indexOf(m[0])>-1)&&(d=m.shift()),o=m.join(c)}return typeof d=="string"&&(d=[d]),{key:o,namespaces:d}}},{key:"translate",value:function(o,e,r){var c=this;if(le(e)!=="object"&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),e||(e={}),o==null)return"";Array.isArray(o)||(o=[String(o)]);var d=e.returnDetails!==void 0?e.returnDetails:this.options.returnDetails,g=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator,a=this.extractFromKey(o[o.length-1],e),f=a.key,m=a.namespaces,_=m[m.length-1],i=e.lng||this.language,u=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(i&&i.toLowerCase()==="cimode"){if(u){var p=e.nsSeparator||this.options.nsSeparator;return d?(h.res="".concat(_).concat(p).concat(f),h):"".concat(_).concat(p).concat(f)}return d?(h.res=f,h):f}var h=this.resolve(o,e),v=h&&h.res,y=h&&h.usedKey||f,b=h&&h.exactUsedKey||f,w=Object.prototype.toString.apply(v),S=["[object Number]","[object Function]","[object RegExp]"],C=e.joinArrays!==void 0?e.joinArrays:this.options.joinArrays,L=!this.i18nFormat||this.i18nFormat.handleAsObject,x=typeof v!="string"&&typeof v!="boolean"&&typeof v!="number";if(L&&v&&x&&S.indexOf(w)<0&&!(typeof C=="string"&&w==="[object Array]")){if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var R=this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,v,ce(ce({},e),{},{ns:m})):"key '".concat(f," (").concat(this.language,")' returned an object instead of string.");return d?(h.res=R,h):R}if(g){var O=w==="[object Array]",I=O?[]:{},N=O?b:y;for(var F in v)if(Object.prototype.hasOwnProperty.call(v,F)){var E="".concat(N).concat(g).concat(F);I[F]=this.translate(E,ce(ce({},e),{joinArrays:!1,ns:m})),I[F]===E&&(I[F]=v[F])}v=I}}else if(L&&typeof C=="string"&&w==="[object Array]")v=v.join(C),v&&(v=this.extendTranslation(v,o,e,r));else{var k=!1,T=!1,P=e.count!==void 0&&typeof e.count!="string",H=n.hasDefaultValue(e),W=P?this.pluralResolver.getSuffix(i,e.count,e):"",K=e["defaultValue".concat(W)]||e.defaultValue;!this.isValidLookup(v)&&H&&(k=!0,v=K),this.isValidLookup(v)||(T=!0,v=f);var j=e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,$=j&&T?void 0:v,D=H&&K!==v&&this.options.updateMissing;if(T||k||D){if(this.logger.log(D?"updateKey":"missingKey",i,_,f,D?K:v),g){var A=this.resolve(f,ce(ce({},e),{},{keySeparator:!1}));A&&A.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var B=[],M=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if(this.options.saveMissingTo==="fallback"&&M&&M[0])for(var U=0;U<M.length;U++)B.push(M[U]);else this.options.saveMissingTo==="all"?B=this.languageUtils.toResolveHierarchy(e.lng||this.language):B.push(e.lng||this.language);var X=function(J,re,ee){var G=H&&ee!==v?ee:$;c.options.missingKeyHandler?c.options.missingKeyHandler(J,_,re,G,D,e):c.backendConnector&&c.backendConnector.saveMissing&&c.backendConnector.saveMissing(J,_,re,G,D,e),c.emit("missingKey",J,_,re,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&P?B.forEach(function(z){c.pluralResolver.getSuffixes(z,e).forEach(function(J){X([z],f+J,e["defaultValue".concat(J)]||K)})}):X(B,f,K))}v=this.extendTranslation(v,o,e,h,r),T&&v===f&&this.options.appendNamespaceToMissingKey&&(v="".concat(_,":").concat(f)),(T||k)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?v=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(_,":").concat(f):f,k?v:void 0):v=this.options.parseMissingKeyHandler(v))}return d?(h.res=v,h):v}},{key:"extendTranslation",value:function(o,e,r,c,d){var g=this;if(this.i18nFormat&&this.i18nFormat.parse)o=this.i18nFormat.parse(o,ce(ce({},this.options.interpolation.defaultVariables),r),c.usedLng,c.usedNS,c.usedKey,{resolved:c});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init(ce(ce({},r),{interpolation:ce(ce({},this.options.interpolation),r.interpolation)}));var a=typeof o=="string"&&(r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),f;if(a){var m=o.match(this.interpolator.nestingRegexp);f=m&&m.length}var _=r.replace&&typeof r.replace!="string"?r.replace:r;if(this.options.interpolation.defaultVariables&&(_=ce(ce({},this.options.interpolation.defaultVariables),_)),o=this.interpolator.interpolate(o,_,r.lng||this.language,r),a){var i=o.match(this.interpolator.nestingRegexp),u=i&&i.length;f<u&&(r.nest=!1)}r.nest!==!1&&(o=this.interpolator.nest(o,function(){for(var v=arguments.length,y=new Array(v),b=0;b<v;b++)y[b]=arguments[b];return d&&d[0]===y[0]&&!r.context?(g.logger.warn("It seems you are nesting recursively key: ".concat(y[0]," in key: ").concat(e[0])),null):g.translate.apply(g,y.concat([e]))},r)),r.interpolation&&this.interpolator.reset()}var p=r.postProcess||this.options.postProcess,h=typeof p=="string"?[p]:p;return o!=null&&h&&h.length&&r.applyPostProcessor!==!1&&(o=kn.handle(h,o,e,this.options&&this.options.postProcessPassResolved?ce({i18nResolved:c},r):r,this)),o}},{key:"resolve",value:function(o){var e=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c,d,g,a,f;return typeof o=="string"&&(o=[o]),o.forEach(function(m){if(!e.isValidLookup(c)){var _=e.extractFromKey(m,r),i=_.key;d=i;var u=_.namespaces;e.options.fallbackNS&&(u=u.concat(e.options.fallbackNS));var p=r.count!==void 0&&typeof r.count!="string",h=p&&!r.ordinal&&r.count===0&&e.pluralResolver.shouldUseIntlApi(),v=r.context!==void 0&&(typeof r.context=="string"||typeof r.context=="number")&&r.context!=="",y=r.lngs?r.lngs:e.languageUtils.toResolveHierarchy(r.lng||e.language,r.fallbackLng);u.forEach(function(b){e.isValidLookup(c)||(f=b,!_n["".concat(y[0],"-").concat(b)]&&e.utils&&e.utils.hasLoadedNamespace&&!e.utils.hasLoadedNamespace(f)&&(_n["".concat(y[0],"-").concat(b)]=!0,e.logger.warn('key "'.concat(d,'" for languages "').concat(y.join(", "),`" won't get resolved as namespace "`).concat(f,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(function(w){if(!e.isValidLookup(c)){a=w;var S=[i];if(e.i18nFormat&&e.i18nFormat.addLookupKeys)e.i18nFormat.addLookupKeys(S,i,w,b,r);else{var C;p&&(C=e.pluralResolver.getSuffix(w,r.count,r));var L="".concat(e.options.pluralSeparator,"zero");if(p&&(S.push(i+C),h&&S.push(i+L)),v){var x="".concat(i).concat(e.options.contextSeparator).concat(r.context);S.push(x),p&&(S.push(x+C),h&&S.push(x+L))}}for(var R;R=S.pop();)e.isValidLookup(c)||(g=R,c=e.getResource(w,b,R,r))}}))})}}),{res:c,usedKey:d,exactUsedKey:g,usedLng:a,usedNS:f}}},{key:"isValidLookup",value:function(o){return o!==void 0&&!(!this.options.returnNull&&o===null)&&!(!this.options.returnEmptyString&&o==="")}},{key:"getResource",value:function(o,e,r){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(o,e,r,c):this.resourceStore.getResource(o,e,r,c)}}],[{key:"hasDefaultValue",value:function(o){var e="defaultValue";for(var r in o)if(Object.prototype.hasOwnProperty.call(o,r)&&e===r.substring(0,e.length)&&o[r]!==void 0)return!0;return!1}}]),n}($e);function pi(t){return t.charAt(0).toUpperCase()+t.slice(1)}var gn=function(){function t(s){_e(this,t),this.options=s,this.supportedLngs=this.options.supportedLngs||!1,this.logger=xe.create("languageUtils")}return pe(t,[{key:"getScriptPartFromCode",value:function(n){if(!n||n.indexOf("-")<0)return null;var l=n.split("-");return l.length===2||(l.pop(),l[l.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(l.join("-"))}},{key:"getLanguagePartFromCode",value:function(n){if(!n||n.indexOf("-")<0)return n;var l=n.split("-");return this.formatLanguageCode(l[0])}},{key:"formatLanguageCode",value:function(n){if(typeof n=="string"&&n.indexOf("-")>-1){var l=["hans","hant","latn","cyrl","cans","mong","arab"],o=n.split("-");return this.options.lowerCaseLng?o=o.map(function(e){return e.toLowerCase()}):o.length===2?(o[0]=o[0].toLowerCase(),o[1]=o[1].toUpperCase(),l.indexOf(o[1].toLowerCase())>-1&&(o[1]=pi(o[1].toLowerCase()))):o.length===3&&(o[0]=o[0].toLowerCase(),o[1].length===2&&(o[1]=o[1].toUpperCase()),o[0]!=="sgn"&&o[2].length===2&&(o[2]=o[2].toUpperCase()),l.indexOf(o[1].toLowerCase())>-1&&(o[1]=pi(o[1].toLowerCase())),l.indexOf(o[2].toLowerCase())>-1&&(o[2]=pi(o[2].toLowerCase()))),o.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?n.toLowerCase():n}},{key:"isSupportedCode",value:function(n){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(n=this.getLanguagePartFromCode(n)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(n)>-1}},{key:"getBestMatchFromCodes",value:function(n){var l=this;if(!n)return null;var o;return n.forEach(function(e){if(!o){var r=l.formatLanguageCode(e);(!l.options.supportedLngs||l.isSupportedCode(r))&&(o=r)}}),!o&&this.options.supportedLngs&&n.forEach(function(e){if(!o){var r=l.getLanguagePartFromCode(e);if(l.isSupportedCode(r))return o=r;o=l.options.supportedLngs.find(function(c){if(c.indexOf(r)===0)return c})}}),o||(o=this.getFallbackCodes(this.options.fallbackLng)[0]),o}},{key:"getFallbackCodes",value:function(n,l){if(!n)return[];if(typeof n=="function"&&(n=n(l)),typeof n=="string"&&(n=[n]),Object.prototype.toString.apply(n)==="[object Array]")return n;if(!l)return n.default||[];var o=n[l];return o||(o=n[this.getScriptPartFromCode(l)]),o||(o=n[this.formatLanguageCode(l)]),o||(o=n[this.getLanguagePartFromCode(l)]),o||(o=n.default),o||[]}},{key:"toResolveHierarchy",value:function(n,l){var o=this,e=this.getFallbackCodes(l||this.options.fallbackLng||[],n),r=[],c=function(g){g&&(o.isSupportedCode(g)?r.push(g):o.logger.warn("rejecting language code not found in supportedLngs: ".concat(g)))};return typeof n=="string"&&n.indexOf("-")>-1?(this.options.load!=="languageOnly"&&c(this.formatLanguageCode(n)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&c(this.getScriptPartFromCode(n)),this.options.load!=="currentOnly"&&c(this.getLanguagePartFromCode(n))):typeof n=="string"&&c(this.formatLanguageCode(n)),e.forEach(function(d){r.indexOf(d)<0&&c(o.formatLanguageCode(d))}),r}}]),t}(),ol=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],al={1:function(s){return Number(s>1)},2:function(s){return Number(s!=1)},3:function(s){return 0},4:function(s){return Number(s%10==1&&s%100!=11?0:s%10>=2&&s%10<=4&&(s%100<10||s%100>=20)?1:2)},5:function(s){return Number(s==0?0:s==1?1:s==2?2:s%100>=3&&s%100<=10?3:s%100>=11?4:5)},6:function(s){return Number(s==1?0:s>=2&&s<=4?1:2)},7:function(s){return Number(s==1?0:s%10>=2&&s%10<=4&&(s%100<10||s%100>=20)?1:2)},8:function(s){return Number(s==1?0:s==2?1:s!=8&&s!=11?2:3)},9:function(s){return Number(s>=2)},10:function(s){return Number(s==1?0:s==2?1:s<7?2:s<11?3:4)},11:function(s){return Number(s==1||s==11?0:s==2||s==12?1:s>2&&s<20?2:3)},12:function(s){return Number(s%10!=1||s%100==11)},13:function(s){return Number(s!==0)},14:function(s){return Number(s==1?0:s==2?1:s==3?2:3)},15:function(s){return Number(s%10==1&&s%100!=11?0:s%10>=2&&(s%100<10||s%100>=20)?1:2)},16:function(s){return Number(s%10==1&&s%100!=11?0:s!==0?1:2)},17:function(s){return Number(s==1||s%10==1&&s%100!=11?0:1)},18:function(s){return Number(s==0?0:s==1?1:2)},19:function(s){return Number(s==1?0:s==0||s%100>1&&s%100<11?1:s%100>10&&s%100<20?2:3)},20:function(s){return Number(s==1?0:s==0||s%100>0&&s%100<20?1:2)},21:function(s){return Number(s%100==1?1:s%100==2?2:s%100==3||s%100==4?3:0)},22:function(s){return Number(s==1?0:s==2?1:(s<0||s>10)&&s%10==0?2:3)}},ll=["v1","v2","v3"],vn={zero:0,one:1,two:2,few:3,many:4,other:5};function cl(){var t={};return ol.forEach(function(s){s.lngs.forEach(function(n){t[n]={numbers:s.nr,plurals:al[s.fc]}})}),t}var hl=function(){function t(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_e(this,t),this.languageUtils=s,this.options=n,this.logger=xe.create("pluralResolver"),(!this.options.compatibilityJSON||this.options.compatibilityJSON==="v4")&&(typeof Intl=="undefined"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=cl()}return pe(t,[{key:"addRule",value:function(n,l){this.rules[n]=l}},{key:"getRule",value:function(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(n,{type:l.ordinal?"ordinal":"cardinal"})}catch(o){return}return this.rules[n]||this.rules[this.languageUtils.getLanguagePartFromCode(n)]}},{key:"needsPlural",value:function(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.getRule(n,l);return this.shouldUseIntlApi()?o&&o.resolvedOptions().pluralCategories.length>1:o&&o.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(n,l){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(n,o).map(function(e){return"".concat(l).concat(e)})}},{key:"getSuffixes",value:function(n){var l=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=this.getRule(n,o);return e?this.shouldUseIntlApi()?e.resolvedOptions().pluralCategories.sort(function(r,c){return vn[r]-vn[c]}).map(function(r){return"".concat(l.options.prepend).concat(r)}):e.numbers.map(function(r){return l.getSuffix(n,r,o)}):[]}},{key:"getSuffix",value:function(n,l){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},e=this.getRule(n,o);return e?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(e.select(l)):this.getSuffixRetroCompatible(e,l):(this.logger.warn("no plural rule found for: ".concat(n)),"")}},{key:"getSuffixRetroCompatible",value:function(n,l){var o=this,e=n.noAbs?n.plurals(l):n.plurals(Math.abs(l)),r=n.numbers[e];this.options.simplifyPluralSuffix&&n.numbers.length===2&&n.numbers[0]===1&&(r===2?r="plural":r===1&&(r=""));var c=function(){return o.options.prepend&&r.toString()?o.options.prepend+r.toString():r.toString()};return this.options.compatibilityJSON==="v1"?r===1?"":typeof r=="number"?"_plural_".concat(r.toString()):c():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&n.numbers.length===2&&n.numbers[0]===1?c():this.options.prepend&&e.toString()?this.options.prepend+e.toString():e.toString()}},{key:"shouldUseIntlApi",value:function(){return!ll.includes(this.options.compatibilityJSON)}}]),t}();function mn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);s&&(l=l.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,l)}return n}function Se(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?mn(Object(n),!0).forEach(function(l){Ee(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mn(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}var ul=function(){function t(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_e(this,t),this.logger=xe.create("interpolator"),this.options=s,this.format=s.interpolation&&s.interpolation.format||function(n){return n},this.init(s)}return pe(t,[{key:"init",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};n.interpolation||(n.interpolation={escapeValue:!0});var l=n.interpolation;this.escape=l.escape!==void 0?l.escape:Za,this.escapeValue=l.escapeValue!==void 0?l.escapeValue:!0,this.useRawValueToEscape=l.useRawValueToEscape!==void 0?l.useRawValueToEscape:!1,this.prefix=l.prefix?ft(l.prefix):l.prefixEscaped||"{{",this.suffix=l.suffix?ft(l.suffix):l.suffixEscaped||"}}",this.formatSeparator=l.formatSeparator?l.formatSeparator:l.formatSeparator||",",this.unescapePrefix=l.unescapeSuffix?"":l.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":l.unescapeSuffix||"",this.nestingPrefix=l.nestingPrefix?ft(l.nestingPrefix):l.nestingPrefixEscaped||ft("$t("),this.nestingSuffix=l.nestingSuffix?ft(l.nestingSuffix):l.nestingSuffixEscaped||ft(")"),this.nestingOptionsSeparator=l.nestingOptionsSeparator?l.nestingOptionsSeparator:l.nestingOptionsSeparator||",",this.maxReplaces=l.maxReplaces?l.maxReplaces:1e3,this.alwaysFormat=l.alwaysFormat!==void 0?l.alwaysFormat:!1,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var n="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(n,"g");var l="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(l,"g");var o="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(o,"g")}},{key:"interpolate",value:function(n,l,o,e){var r=this,c,d,g,a=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function f(p){return p.replace(/\$/g,"$$$$")}var m=function(h){if(h.indexOf(r.formatSeparator)<0){var v=un(l,a,h);return r.alwaysFormat?r.format(v,void 0,o,Se(Se(Se({},e),l),{},{interpolationkey:h})):v}var y=h.split(r.formatSeparator),b=y.shift().trim(),w=y.join(r.formatSeparator).trim();return r.format(un(l,a,b),w,o,Se(Se(Se({},e),l),{},{interpolationkey:b}))};this.resetRegExp();var _=e&&e.missingInterpolationHandler||this.options.missingInterpolationHandler,i=e&&e.interpolation&&e.interpolation.skipOnVariables!==void 0?e.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables,u=[{regex:this.regexpUnescape,safeValue:function(h){return f(h)}},{regex:this.regexp,safeValue:function(h){return r.escapeValue?f(r.escape(h)):f(h)}}];return u.forEach(function(p){for(g=0;c=p.regex.exec(n);){var h=c[1].trim();if(d=m(h),d===void 0)if(typeof _=="function"){var v=_(n,c,e);d=typeof v=="string"?v:""}else if(e&&e.hasOwnProperty(h))d="";else if(i){d=c[0];continue}else r.logger.warn("missed to pass in variable ".concat(h," for interpolating ").concat(n)),d="";else typeof d!="string"&&!r.useRawValueToEscape&&(d=cn(d));var y=p.safeValue(d);if(n=n.replace(c[0],y),i?(p.regex.lastIndex+=d.length,p.regex.lastIndex-=c[0].length):p.regex.lastIndex=0,g++,g>=r.maxReplaces)break}}),n}},{key:"nest",value:function(n,l){var o=this,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r,c,d;function g(_,i){var u=this.nestingOptionsSeparator;if(_.indexOf(u)<0)return _;var p=_.split(new RegExp("".concat(u,"[ ]*{"))),h="{".concat(p[1]);_=p[0],h=this.interpolate(h,d);var v=h.match(/'/g),y=h.match(/"/g);(v&&v.length%2===0&&!y||y.length%2!==0)&&(h=h.replace(/'/g,'"'));try{d=JSON.parse(h),i&&(d=Se(Se({},i),d))}catch(b){return this.logger.warn("failed parsing options string in nesting for key ".concat(_),b),"".concat(_).concat(u).concat(h)}return delete d.defaultValue,_}for(;r=this.nestingRegexp.exec(n);){var a=[];d=Se({},e),d.applyPostProcessor=!1,delete d.defaultValue;var f=!1;if(r[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(r[1])){var m=r[1].split(this.formatSeparator).map(function(_){return _.trim()});r[1]=m.shift(),a=m,f=!0}if(c=l(g.call(this,r[1].trim(),d),d),c&&r[0]===n&&typeof c!="string")return c;typeof c!="string"&&(c=cn(c)),c||(this.logger.warn("missed to resolve ".concat(r[1]," for nesting ").concat(n)),c=""),f&&(c=a.reduce(function(_,i){return o.format(_,i,e.lng,Se(Se({},e),{},{interpolationkey:r[1].trim()}))},c.trim())),n=n.replace(r[0],c),this.regexp.lastIndex=0}return n}}]),t}();function Sn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);s&&(l=l.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,l)}return n}function ze(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Sn(Object(n),!0).forEach(function(l){Ee(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function dl(t){var s=t.toLowerCase().trim(),n={};if(t.indexOf("(")>-1){var l=t.split("(");s=l[0].toLowerCase().trim();var o=l[1].substring(0,l[1].length-1);if(s==="currency"&&o.indexOf(":")<0)n.currency||(n.currency=o.trim());else if(s==="relativetime"&&o.indexOf(":")<0)n.range||(n.range=o.trim());else{var e=o.split(";");e.forEach(function(r){if(r){var c=r.split(":"),d=_i(c),g=d[0],a=d.slice(1),f=a.join(":").trim().replace(/^'+|'+$/g,"");n[g.trim()]||(n[g.trim()]=f),f==="false"&&(n[g.trim()]=!1),f==="true"&&(n[g.trim()]=!0),isNaN(f)||(n[g.trim()]=parseInt(f,10))}})}}return{formatName:s,formatOptions:n}}function _t(t){var s={};return function(l,o,e){var r=o+JSON.stringify(e),c=s[r];return c||(c=t(o,e),s[r]=c),c(l)}}var fl=function(){function t(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_e(this,t),this.logger=xe.create("formatter"),this.options=s,this.formats={number:_t(function(n,l){var o=new Intl.NumberFormat(n,l);return function(e){return o.format(e)}}),currency:_t(function(n,l){var o=new Intl.NumberFormat(n,ze(ze({},l),{},{style:"currency"}));return function(e){return o.format(e)}}),datetime:_t(function(n,l){var o=new Intl.DateTimeFormat(n,ze({},l));return function(e){return o.format(e)}}),relativetime:_t(function(n,l){var o=new Intl.RelativeTimeFormat(n,ze({},l));return function(e){return o.format(e,l.range||"day")}}),list:_t(function(n,l){var o=new Intl.ListFormat(n,ze({},l));return function(e){return o.format(e)}})},this.init(s)}return pe(t,[{key:"init",value:function(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}},o=l.interpolation;this.formatSeparator=o.formatSeparator?o.formatSeparator:o.formatSeparator||","}},{key:"add",value:function(n,l){this.formats[n.toLowerCase().trim()]=l}},{key:"addCached",value:function(n,l){this.formats[n.toLowerCase().trim()]=_t(l)}},{key:"format",value:function(n,l,o,e){var r=this,c=l.split(this.formatSeparator),d=c.reduce(function(g,a){var f=dl(a),m=f.formatName,_=f.formatOptions;if(r.formats[m]){var i=g;try{var u=e&&e.formatParams&&e.formatParams[e.interpolationkey]||{},p=u.locale||u.lng||e.locale||e.lng||o;i=r.formats[m](g,p,ze(ze(ze({},_),e),u))}catch(h){r.logger.warn(h)}return i}else r.logger.warn("there was no format function for ".concat(m));return g},n);return d}}]),t}();function yn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);s&&(l=l.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,l)}return n}function bn(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?yn(Object(n),!0).forEach(function(l){Ee(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yn(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function _l(t){var s=pl();return function(){var l=ge(t),o;if(s){var e=ge(this).constructor;o=Reflect.construct(l,arguments,e)}else o=l.apply(this,arguments);return Ze(this,o)}}function pl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function gl(t,s){t.pending[s]!==void 0&&(delete t.pending[s],t.pendingCount--)}var vl=function(t){dt(n,t);var s=_l(n);function n(l,o,e){var r,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return _e(this,n),r=s.call(this),ur&&$e.call(me(r)),r.backend=l,r.store=o,r.services=e,r.languageUtils=e.languageUtils,r.options=c,r.logger=xe.create("backendConnector"),r.waitingReads=[],r.maxParallelReads=c.maxParallelReads||10,r.readingCalls=0,r.maxRetries=c.maxRetries>=0?c.maxRetries:5,r.retryTimeout=c.retryTimeout>=1?c.retryTimeout:350,r.state={},r.queue=[],r.backend&&r.backend.init&&r.backend.init(e,c.backend,c),r}return pe(n,[{key:"queueLoad",value:function(o,e,r,c){var d=this,g={},a={},f={},m={};return o.forEach(function(_){var i=!0;e.forEach(function(u){var p="".concat(_,"|").concat(u);!r.reload&&d.store.hasResourceBundle(_,u)?d.state[p]=2:d.state[p]<0||(d.state[p]===1?a[p]===void 0&&(a[p]=!0):(d.state[p]=1,i=!1,a[p]===void 0&&(a[p]=!0),g[p]===void 0&&(g[p]=!0),m[u]===void 0&&(m[u]=!0)))}),i||(f[_]=!0)}),(Object.keys(g).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:c}),{toLoad:Object.keys(g),pending:Object.keys(a),toLoadLanguages:Object.keys(f),toLoadNamespaces:Object.keys(m)}}},{key:"loaded",value:function(o,e,r){var c=o.split("|"),d=c[0],g=c[1];e&&this.emit("failedLoading",d,g,e),r&&this.store.addResourceBundle(d,g,r),this.state[o]=e?-1:2;var a={};this.queue.forEach(function(f){Xa(f.loaded,[d],g),gl(f,o),e&&f.errors.push(e),f.pendingCount===0&&!f.done&&(Object.keys(f.loaded).forEach(function(m){a[m]||(a[m]={});var _=f.loaded[m];_.length&&_.forEach(function(i){a[m][i]===void 0&&(a[m][i]=!0)})}),f.done=!0,f.errors.length?f.callback(f.errors):f.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(function(f){return!f.done})}},{key:"read",value:function(o,e,r){var c=this,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,a=arguments.length>5?arguments[5]:void 0;if(!o.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:o,ns:e,fcName:r,tried:d,wait:g,callback:a});return}this.readingCalls++;var f=function(u,p){if(c.readingCalls--,c.waitingReads.length>0){var h=c.waitingReads.shift();c.read(h.lng,h.ns,h.fcName,h.tried,h.wait,h.callback)}if(u&&p&&d<c.maxRetries){setTimeout(function(){c.read.call(c,o,e,r,d+1,g*2,a)},g);return}a(u,p)},m=this.backend[r].bind(this.backend);if(m.length===2){try{var _=m(o,e);_&&typeof _.then=="function"?_.then(function(i){return f(null,i)}).catch(f):f(null,_)}catch(i){f(i)}return}return m(o,e,f)}},{key:"prepareLoading",value:function(o,e){var r=this,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),d&&d();typeof o=="string"&&(o=this.languageUtils.toResolveHierarchy(o)),typeof e=="string"&&(e=[e]);var g=this.queueLoad(o,e,c,d);if(!g.toLoad.length)return g.pending.length||d(),null;g.toLoad.forEach(function(a){r.loadOne(a)})}},{key:"load",value:function(o,e,r){this.prepareLoading(o,e,{},r)}},{key:"reload",value:function(o,e,r){this.prepareLoading(o,e,{reload:!0},r)}},{key:"loadOne",value:function(o){var e=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",c=o.split("|"),d=c[0],g=c[1];this.read(d,g,"read",void 0,void 0,function(a,f){a&&e.logger.warn("".concat(r,"loading namespace ").concat(g," for language ").concat(d," failed"),a),!a&&f&&e.logger.log("".concat(r,"loaded namespace ").concat(g," for language ").concat(d),f),e.loaded(o,a,f)})}},{key:"saveMissing",value:function(o,e,r,c,d){var g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:function(){};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)){this.logger.warn('did not save key "'.concat(r,'" as the namespace "').concat(e,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend&&this.backend.create){var f=bn(bn({},g),{},{isUpdate:d}),m=this.backend.create.bind(this.backend);if(m.length<6)try{var _;m.length===5?_=m(o,e,r,c,f):_=m(o,e,r,c),_&&typeof _.then=="function"?_.then(function(i){return a(null,i)}).catch(a):a(null,_)}catch(i){a(i)}else m(o,e,r,c,a,f)}!o||!o[0]||this.store.addResource(o[0],e,r,c)}}}]),n}($e);function Cn(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(s){var n={};if(le(s[1])==="object"&&(n=s[1]),typeof s[1]=="string"&&(n.defaultValue=s[1]),typeof s[2]=="string"&&(n.tDescription=s[2]),le(s[2])==="object"||le(s[3])==="object"){var l=s[3]||s[2];Object.keys(l).forEach(function(o){n[o]=l[o]})}return n},interpolation:{escapeValue:!0,format:function(s,n,l,o){return s},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function wn(t){return typeof t.ns=="string"&&(t.ns=[t.ns]),typeof t.fallbackLng=="string"&&(t.fallbackLng=[t.fallbackLng]),typeof t.fallbackNS=="string"&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function En(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);s&&(l=l.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,l)}return n}function Le(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?En(Object(n),!0).forEach(function(l){Ee(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):En(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function ml(t){var s=Sl();return function(){var l=ge(t),o;if(s){var e=ge(this).constructor;o=Reflect.construct(l,arguments,e)}else o=l.apply(this,arguments);return Ze(this,o)}}function Sl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function lr(){}function yl(t){var s=Object.getOwnPropertyNames(Object.getPrototypeOf(t));s.forEach(function(n){typeof t[n]=="function"&&(t[n]=t[n].bind(t))})}var hr=function(t){dt(n,t);var s=ml(n);function n(){var l,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;if(_e(this,n),l=s.call(this),ur&&$e.call(me(l)),l.options=wn(o),l.services={},l.logger=xe,l.modules={external:[]},yl(me(l)),e&&!l.isInitialized&&!o.isClone){if(!l.options.initImmediate)return l.init(o,e),Ze(l,me(l));setTimeout(function(){l.init(o,e)},0)}return l}return pe(n,[{key:"init",value:function(){var o=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;typeof e=="function"&&(r=e,e={}),!e.defaultNS&&e.defaultNS!==!1&&e.ns&&(typeof e.ns=="string"?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));var c=Cn();this.options=Le(Le(Le({},c),this.options),wn(e)),this.options.compatibilityAPI!=="v1"&&(this.options.interpolation=Le(Le({},c.interpolation),this.options.interpolation)),e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);function d(h){return h?typeof h=="function"?new h:h:null}if(!this.options.isClone){this.modules.logger?xe.init(d(this.modules.logger),this.options):xe.init(null,this.options);var g;this.modules.formatter?g=this.modules.formatter:typeof Intl!="undefined"&&(g=fl);var a=new gn(this.options);this.store=new il(this.options.resources,this.options);var f=this.services;f.logger=xe,f.resourceStore=this.store,f.languageUtils=a,f.pluralResolver=new hl(a,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),g&&(!this.options.interpolation.format||this.options.interpolation.format===c.interpolation.format)&&(f.formatter=d(g),f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new ul(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new vl(d(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",function(h){for(var v=arguments.length,y=new Array(v>1?v-1:0),b=1;b<v;b++)y[b-1]=arguments[b];o.emit.apply(o,[h].concat(y))}),this.modules.languageDetector&&(f.languageDetector=d(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=d(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new pn(this.services,this.options),this.translator.on("*",function(h){for(var v=arguments.length,y=new Array(v>1?v-1:0),b=1;b<v;b++)y[b-1]=arguments[b];o.emit.apply(o,[h].concat(y))}),this.modules.external.forEach(function(h){h.init&&h.init(o)})}if(this.format=this.options.interpolation.format,r||(r=lr),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var m=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);m.length>0&&m[0]!=="dev"&&(this.options.lng=m[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined");var _=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];_.forEach(function(h){o[h]=function(){var v;return(v=o.store)[h].apply(v,arguments)}});var i=["addResource","addResources","addResourceBundle","removeResourceBundle"];i.forEach(function(h){o[h]=function(){var v;return(v=o.store)[h].apply(v,arguments),o}});var u=Tt(),p=function(){var v=function(b,w){o.isInitialized&&!o.initializedStoreOnce&&o.logger.warn("init: i18next is already initialized. You should call init just once!"),o.isInitialized=!0,o.options.isClone||o.logger.log("initialized",o.options),o.emit("initialized",o.options),u.resolve(w),r(b,w)};if(o.languages&&o.options.compatibilityAPI!=="v1"&&!o.isInitialized)return v(null,o.t.bind(o));o.changeLanguage(o.options.lng,v)};return this.options.resources||!this.options.initImmediate?p():setTimeout(p,0),u}},{key:"loadResources",value:function(o){var e=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lr,c=r,d=typeof o=="string"?o:this.language;if(typeof o=="function"&&(c=o),!this.options.resources||this.options.partialBundledLanguages){if(d&&d.toLowerCase()==="cimode")return c();var g=[],a=function(_){if(_){var i=e.services.languageUtils.toResolveHierarchy(_);i.forEach(function(u){g.indexOf(u)<0&&g.push(u)})}};if(d)a(d);else{var f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.forEach(function(m){return a(m)})}this.options.preload&&this.options.preload.forEach(function(m){return a(m)}),this.services.backendConnector.load(g,this.options.ns,function(m){!m&&!e.resolvedLanguage&&e.language&&e.setResolvedLanguage(e.language),c(m)})}else c(null)}},{key:"reloadResources",value:function(o,e,r){var c=Tt();return o||(o=this.languages),e||(e=this.options.ns),r||(r=lr),this.services.backendConnector.reload(o,e,function(d){c.resolve(),r(d)}),c}},{key:"use",value:function(o){if(!o)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!o.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return o.type==="backend"&&(this.modules.backend=o),(o.type==="logger"||o.log&&o.warn&&o.error)&&(this.modules.logger=o),o.type==="languageDetector"&&(this.modules.languageDetector=o),o.type==="i18nFormat"&&(this.modules.i18nFormat=o),o.type==="postProcessor"&&kn.addPostProcessor(o),o.type==="formatter"&&(this.modules.formatter=o),o.type==="3rdParty"&&this.modules.external.push(o),this}},{key:"setResolvedLanguage",value:function(o){if(!(!o||!this.languages)&&!(["cimode","dev"].indexOf(o)>-1))for(var e=0;e<this.languages.length;e++){var r=this.languages[e];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}}},{key:"changeLanguage",value:function(o,e){var r=this;this.isLanguageChangingTo=o;var c=Tt();this.emit("languageChanging",o);var d=function(m){r.language=m,r.languages=r.services.languageUtils.toResolveHierarchy(m),r.resolvedLanguage=void 0,r.setResolvedLanguage(m)},g=function(m,_){_?(d(_),r.translator.changeLanguage(_),r.isLanguageChangingTo=void 0,r.emit("languageChanged",_),r.logger.log("languageChanged",_)):r.isLanguageChangingTo=void 0,c.resolve(function(){return r.t.apply(r,arguments)}),e&&e(m,function(){return r.t.apply(r,arguments)})},a=function(m){!o&&!m&&r.services.languageDetector&&(m=[]);var _=typeof m=="string"?m:r.services.languageUtils.getBestMatchFromCodes(m);_&&(r.language||d(_),r.translator.language||r.translator.changeLanguage(_),r.services.languageDetector&&r.services.languageDetector.cacheUserLanguage&&r.services.languageDetector.cacheUserLanguage(_)),r.loadResources(_,function(i){g(i,_)})};return!o&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!o&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(o),c}},{key:"getFixedT",value:function(o,e,r){var c=this,d=function g(a,f){var m;if(le(f)!=="object"){for(var _=arguments.length,i=new Array(_>2?_-2:0),u=2;u<_;u++)i[u-2]=arguments[u];m=c.options.overloadTranslationOptionHandler([a,f].concat(i))}else m=Le({},f);m.lng=m.lng||g.lng,m.lngs=m.lngs||g.lngs,m.ns=m.ns||g.ns,m.keyPrefix=m.keyPrefix||r||g.keyPrefix;var p=c.options.keySeparator||".",h=m.keyPrefix?"".concat(m.keyPrefix).concat(p).concat(a):a;return c.t(h,m)};return typeof o=="string"?d.lng=o:d.lngs=o,d.ns=e,d.keyPrefix=r,d}},{key:"t",value:function(){var o;return this.translator&&(o=this.translator).translate.apply(o,arguments)}},{key:"exists",value:function(){var o;return this.translator&&(o=this.translator).exists.apply(o,arguments)}},{key:"setDefaultNamespace",value:function(o){this.options.defaultNS=o}},{key:"hasLoadedNamespace",value:function(o){var e=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var c=this.resolvedLanguage||this.languages[0],d=this.options?this.options.fallbackLng:!1,g=this.languages[this.languages.length-1];if(c.toLowerCase()==="cimode")return!0;var a=function(_,i){var u=e.services.backendConnector.state["".concat(_,"|").concat(i)];return u===-1||u===2};if(r.precheck){var f=r.precheck(this,a);if(f!==void 0)return f}return!!(this.hasResourceBundle(c,o)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(c,o)&&(!d||a(g,o)))}},{key:"loadNamespaces",value:function(o,e){var r=this,c=Tt();return this.options.ns?(typeof o=="string"&&(o=[o]),o.forEach(function(d){r.options.ns.indexOf(d)<0&&r.options.ns.push(d)}),this.loadResources(function(d){c.resolve(),e&&e(d)}),c):(e&&e(),Promise.resolve())}},{key:"loadLanguages",value:function(o,e){var r=Tt();typeof o=="string"&&(o=[o]);var c=this.options.preload||[],d=o.filter(function(g){return c.indexOf(g)<0});return d.length?(this.options.preload=c.concat(d),this.loadResources(function(g){r.resolve(),e&&e(g)}),r):(e&&e(),Promise.resolve())}},{key:"dir",value:function(o){if(o||(o=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!o)return"rtl";var e=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services&&this.services.languageUtils||new gn(Cn());return e.indexOf(r.getLanguagePartFromCode(o))>-1||o.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}},{key:"cloneInstance",value:function(){var o=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lr,c=Le(Le(Le({},this.options),e),{isClone:!0}),d=new n(c);(e.debug!==void 0||e.prefix!==void 0)&&(d.logger=d.logger.clone(e));var g=["store","services","language"];return g.forEach(function(a){d[a]=o[a]}),d.services=Le({},this.services),d.services.utils={hasLoadedNamespace:d.hasLoadedNamespace.bind(d)},d.translator=new pn(d.services,d.options),d.translator.on("*",function(a){for(var f=arguments.length,m=new Array(f>1?f-1:0),_=1;_<f;_++)m[_-1]=arguments[_];d.emit.apply(d,[a].concat(m))}),d.init(c,r),d.translator.options=d.options,d.translator.backendConnector.services.utils={hasLoadedNamespace:d.hasLoadedNamespace.bind(d)},d}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),n}($e);Ee(hr,"createInstance",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;return new hr(t,s)});var se=hr.createInstance();se.createInstance=hr.createInstance;var Kc=se.createInstance,qc=se.dir,Vc=se.init,Gc=se.loadResources,Yc=se.reloadResources,Xc=se.use,Jc=se.changeLanguage,Zc=se.getFixedT,Qc=se.t,eh=se.exists,th=se.setDefaultNamespace,rh=se.hasLoadedNamespace,ih=se.loadNamespaces,sh=se.loadLanguages;var Rn=Promise.resolve(se.createInstance({cleanCode:!0,defaultNS:St,fallbackLng:Li,initImmediate:!0,nonExplicitSupportedLngs:!0,resources:Nt,returnNull:Ei})).then(async t=>(await t.init(),t)).catch(t=>{throw Ae(t,()=>"i18n error"),t});var Sr=require("obsidian");var Tn=rt(On());var dr=class{constructor(s){this.terminal=s;ve(this,"serializer",new Tn.SerializeAddon);this.terminal.loadAddon(this.serializer)}unserialize(s){this.terminal.resize(s.columns,s.rows),this.terminal.write(s.data)}serialize(){return{columns:this.terminal.cols,data:this.serializer.serialize({excludeAltBuffer:!0,excludeModes:!0}),rows:this.terminal.rows}}};var yr=require("path"),Mn=rt(An()),Hn=rt(Dn()),Nn=rt(Bn()),Fn=rt(In());var et,ae,Dt,pt,gt,mr,Pt,Ci,vt,vr,Qe=class extends Sr.ItemView{constructor(n,l){super(l);this.plugin=n;Q(this,Pt);Q(this,vt);Q(this,et,{__type:Qe.State.TYPE,args:[],cwd:"",executable:""});Q(this,ae,new Nn.Terminal({allowProposedApi:!0}));Q(this,Dt,{fit:new Mn.FitAddon,search:new Hn.SearchAddon,webLinks:new Fn.WebLinksAddon((n,l)=>Mi(l))});Q(this,pt,void 0);Q(this,gt,new dr(q(this,ae)));Q(this,mr,(0,Sr.debounce)(async(n,l)=>{var o;try{await((o=q(this,pt))==null?void 0:o.resize(n,l)),q(this,ae).resize(n,l),this.plugin.app.workspace.requestSaveLayout()}catch(e){}},Ri,!1));for(let o of Object.values(q(this,Dt)))q(this,ae).loadAddon(o)}async setState(n,l){if(await super.setState(n,l),!Pi(Qe.State.TYPE,n)||typeof q(this,pt)!="undefined")return;ye(this,et,n);let{plugin:o}=this,{i18n:e}=o,r=new o.platform.terminalPty(o,n.executable,n.cwd,n.args);this.register(async()=>(await r.shell).kill()),ye(this,pt,r);let c=await(await r.once("exit",f=>{this.leaf.detach(),yt(()=>e.t("notices.terminal-exited",{code:f}),$t(ki,f)?o.settings.noticeTimeout:0,o)})).shell;c.once("error",f=>{this.leaf.detach(),Ae(f,()=>e.t("errors.error-spawning-terminal"),o)});let{serial:d}=n,g;(_=>(_[_.conhost=1]="conhost",_[_.clear=2]="clear"))(g||(g={}));let a=(r instanceof Je?0:1)|2;typeof d!="undefined"&&(a&=-3,q(this,gt).unserialize(d),q(this,ae).resize(d.columns,d.rows),q(this,ae).write(d.data)),c.stdout.on("data",f=>{if(!(a&1)){a|=1;return}a&2||(a|=2,Z(this,vt,vr).call(this,`
\x1B[K`.repeat(q(this,ae).rows)),Z(this,vt,vr).call(this,"\x1B[H")),Z(this,vt,vr).call(this,f)}),c.stderr.on("data",f=>{q(this,ae).write(f)}),q(this,ae).onData(f=>c.stdin.write(f))}getState(){return q(this,et).serial=q(this,gt).serialize(),Object.assign(super.getState(),q(this,et))}onResize(){super.onResize();let{containerEl:n}=this;if(n.offsetWidth<=0||n.offsetHeight<=0)return;let{fit:l}=q(this,Dt),o=l.proposeDimensions();typeof o!="undefined"&&(l.fit(),q(this,mr).call(this,o.cols,o.rows))}getDisplayText(){return this.plugin.i18n.t(`views.${Qe.type.id}.display-name`,{executable:Z(this,Pt,Ci).call(this)})}getIcon(){return this.plugin.i18n.t(`asset:views.${Qe.type.id}-icon`)}getViewType(){return Qe.namespacedViewType}onPaneMenu(n,l){super.onPaneMenu(n,l);let{leaf:o,plugin:e}=this,{i18n:r}=e;n.addSeparator().addItem(c=>c.setTitle(r.t("menus.save-as-HTML")).setIcon(r.t("asset:menus.save-as-HTML-icon")).onClick(()=>{let d=q(this,ae),g=()=>{Di(q(this,gt).serializer.serializeAsHTML({includeGlobalBackground:!1,onlySelection:!1}),"text/html; charset=UTF-8;",`${Z(this,Pt,Ci).call(this)}.html`)};if(typeof d.element=="undefined"){let{workspace:a}=e.app,f=a.getMostRecentLeaf(),m=d.onRender(()=>{try{g()}finally{try{f!==null&&a.setActiveLeaf(f)}finally{m.dispose()}}});try{a.setActiveLeaf(o)}catch(_){m.dispose()}return}g()}))}async onOpen(){await super.onOpen();let{containerEl:n,plugin:l}=this;n.empty(),n.createDiv({},o=>{let e=Ii(o,r=>{try{this.register(()=>{q(this,ae).dispose()}),q(this,ae).open(o)}finally{r.disconnect()}});this.register(()=>{e.disconnect()})}),this.registerEvent(l.app.workspace.on("active-leaf-change",o=>{if(o===this.leaf){q(this,ae).focus();return}q(this,ae).blur()})),Bi(o=>{let e=new MutationObserver(()=>void(o.style.visibility="hidden"));this.register(()=>{e.disconnect(),o.style.visibility=""}),this.registerEvent(l.app.workspace.on("active-leaf-change",r=>{if(e.disconnect(),r===this.leaf){o.style.visibility="hidden",e.observe(o,{attributeFilter:["style"]});return}o.style.visibility=""}))}),this.register(this.plugin.language.registerUse(()=>Hi(this)))}},he=Qe;et=new WeakMap,ae=new WeakMap,Dt=new WeakMap,pt=new WeakMap,gt=new WeakMap,mr=new WeakMap,Pt=new WeakSet,Ci=function(){let{executable:n}=q(this,et);return(0,yr.basename)(n,(0,yr.extname)(n))},vt=new WeakSet,vr=function(n){q(this,ae).write(n),this.plugin.app.workspace.requestSaveLayout()},ve(he,"type",new Ut("terminal")),ve(he,"namespacedViewType");(s=>{let t;(l=>l.TYPE="8d54e44a-32e7-4297-8ae2-cff88e92ce28")(t=s.State||(s.State={}))})(he||(he={}));var jn=require("child_process");var It,Bt=class extends ke.Plugin{constructor(n,l){super(n,l);ve(this,"settings",Ai(Re));ve(this,"platform",(()=>{let n=$t(Bt.PLATFORMS,process.platform)?process.platform:null;return{spawnTerminal:(()=>n===null?l=>{throw Error(l.i18n.t("errors.unsupported-platform"))}:async(l,o,e)=>{let r=l.settings.executables[n];switch(yt(()=>l.i18n.t("notices.spawning-terminal",{executable:r.name}),l.settings.noticeTimeout,l),e){case"external":{let c=(0,jn.spawn)(r.name,r.args,{cwd:o,detached:!0,shell:!0,stdio:"ignore"}).once("error",d=>{Ae(d,()=>l.i18n.t("errors.error-spawning-terminal"),l)});return c.unref(),new Promise((d,g)=>{c.once("spawn",d).once("error",g)})}case"integrated":{let{workspace:c}=l.app,d=c.getLeavesOfType(he.type.namespaced(l)),g={__type:he.State.TYPE,args:r.args,cwd:o,executable:r.name};return(()=>{let a=d.last();return typeof a=="undefined"?c.getLeaf("split","horizontal"):(c.setActiveLeaf(a,{focus:!1}),c.getLeaf("tab"))})().setViewState({active:!0,state:g,type:he.type.namespaced(l)})}default:throw new TypeError(e)}})(),terminalPty:n==="win32"?Je:rr}})());ve(this,"language",new Bt.LanguageManager(this));Q(this,It,se);he.namespacedViewType=he.type.namespaced(l)}get i18n(){return q(this,It)}async onload(){if(super.onload(),!ke.Platform.isDesktopApp)return;let[n]=await Promise.all([Rn,this.loadSettings()]);ye(this,It,n);let{settings:l,language:o}=this;await o.changeLanguage(l.language),this.addSettingTab(new Ft(this)),this.registerView(he.type.namespaced(this),g=>new he(this,g));let e=this.app.vault.adapter,r=["root","current"],c=(g,a)=>f=>{if(!l.command)return!1;switch(a){case"root":return f||this.platform.spawnTerminal(this,e.getBasePath(),g),!0;case"current":{let m=this.app.workspace.getActiveFile();return m===null?!1:(f||this.platform.spawnTerminal(this,e.getFullPath(m.parent.path),g),!0)}default:throw new TypeError(a)}};for(let g of Bt.TERMINAL_TYPES)for(let a of r){let f=`open-terminal-${g}-${a}`,m=()=>n.t(`commands.${f}`);this.addCommand({checkCallback:c(g,a),id:f,get name(){return m()},set name(_){m=Ti(()=>n.t(`commands.${f}`),()=>n.t("name"),n.t("name",{lng:it}),_)}})}let d=(g,a)=>{g.addSeparator().addItem(f=>f.setTitle(n.t("menus.open-terminal-external")).setIcon(n.t("asset:menus.open-terminal-external-icon")).onClick(async()=>this.platform.spawnTerminal(this,e.getFullPath(a.path),"external"))).addItem(f=>f.setTitle(n.t("menus.open-terminal-integrated")).setIcon(n.t("asset:menus.open-terminal-integrated-icon")).onClick(async()=>this.platform.spawnTerminal(this,e.getFullPath(a.path),"integrated")))};this.registerEvent(this.app.workspace.on("file-menu",(g,a)=>{l.contextMenu&&d(g,a instanceof ke.TFolder?a:a.parent)})),this.registerEvent(this.app.workspace.on("editor-menu",(g,a,f)=>{!l.contextMenu||f instanceof ke.MarkdownView||f.file===null||d(g,f.file.parent)}))}async loadSettings(){Object.assign(this.settings,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}},Te=Bt;It=new WeakMap;(l=>{var o;l.PLATFORMS=["darwin","linux","win32"],l.TERMINAL_TYPES=["external","integrated"];class n{constructor(r){this.plugin=r;Q(this,o,[])}async changeLanguage(r){await this.plugin.i18n.changeLanguage(r===""?ke.moment.locale():r),await Promise.all(q(this,o).map(c=>c()))}registerUse(r){return q(this,o).push(r),()=>{q(this,o).remove(r)}}}o=new WeakMap,l.LanguageManager=n})(Te||(Te={}));var bl=Te;
/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD.
If you want to view the source, please visit the repository of this plugin.
*/
