/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD.
If you want to view the source, please visit the repository of this plugin.
*/
"use strict";var eo=Object.create;var Et=Object.defineProperty;var to=Object.getOwnPropertyDescriptor;var ro=Object.getOwnPropertyNames;var io=Object.getPrototypeOf,so=Object.prototype.hasOwnProperty;var no=(t,s,n)=>s in t?Et(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var te=(t,s)=>()=>(s||t((s={exports:{}}).exports,s),s.exports),st=(t,s)=>{for(var n in s)Et(t,n,{get:s[n],enumerable:!0})},Bi=(t,s,n,c)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of ro(s))!so.call(t,o)&&o!==n&&Et(t,o,{get:()=>s[o],enumerable:!(c=to(s,o))||c.enumerable});return t};var nt=(t,s,n)=>(n=t!=null?eo(io(t)):{},Bi(s||!t||!t.__esModule?Et(n,"default",{value:t,enumerable:!0}):n,t)),oo=t=>Bi(Et({},"__esModule",{value:!0}),t);var ye=(t,s,n)=>(no(t,typeof s!="symbol"?s+"":s,n),n),Tr=(t,s,n)=>{if(!s.has(t))throw TypeError("Cannot "+n)};var q=(t,s,n)=>(Tr(t,s,"read from private field"),n?n.call(t):s.get(t)),X=(t,s,n)=>{if(s.has(t))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(t):s.set(t,n)},xe=(t,s,n,c)=>(Tr(t,s,"write to private field"),c?c.call(t,n):s.set(t,n),n);var V=(t,s,n)=>(Tr(t,s,"access private method"),n);var Yi=te(Mr=>{var Xe=require("path"),Ue=process.platform==="win32",We=require("fs"),Wo=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function Uo(){var t;if(Wo){var s=new Error;t=n}else t=c;return t;function n(o){o&&(s.message=o.message,o=s,c(o))}function c(o){if(o){if(process.throwDeprecation)throw o;if(!process.noDeprecation){var e="fs: missing callback "+(o.stack||o.message);process.traceDeprecation?console.trace(e):console.error(e)}}}}function zo(t){return typeof t=="function"?t:Uo()}var Vl=Xe.normalize;Ue?Be=/(.*?)(?:[\/\\]+|$)/g:Be=/(.*?)(?:[\/]+|$)/g;var Be;Ue?Lt=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/:Lt=/^[\/]*/;var Lt;Mr.realpathSync=function(s,n){if(s=Xe.resolve(s),n&&Object.prototype.hasOwnProperty.call(n,s))return n[s];var c=s,o={},e={},i,l,u,d;a();function a(){var g=Lt.exec(s);i=g[0].length,l=g[0],u=g[0],d="",Ue&&!e[u]&&(We.lstatSync(u),e[u]=!0)}for(;i<s.length;){Be.lastIndex=i;var f=Be.exec(s);if(d=l,l+=f[0],u=d+f[1],i=Be.lastIndex,!(e[u]||n&&n[u]===u)){var v;if(n&&Object.prototype.hasOwnProperty.call(n,u))v=n[u];else{var p=We.lstatSync(u);if(!p.isSymbolicLink()){e[u]=!0,n&&(n[u]=u);continue}var r=null;if(!Ue){var _=p.dev.toString(32)+":"+p.ino.toString(32);o.hasOwnProperty(_)&&(r=o[_])}r===null&&(We.statSync(u),r=We.readlinkSync(u)),v=Xe.resolve(d,r),n&&(n[u]=v),Ue||(o[_]=r)}s=Xe.resolve(v,s.slice(i)),a()}}return n&&(n[c]=s),s};Mr.realpath=function(s,n,c){if(typeof c!="function"&&(c=zo(n),n=null),s=Xe.resolve(s),n&&Object.prototype.hasOwnProperty.call(n,s))return process.nextTick(c.bind(null,null,n[s]));var o=s,e={},i={},l,u,d,a;f();function f(){var g=Lt.exec(s);l=g[0].length,u=g[0],d=g[0],a="",Ue&&!i[d]?We.lstat(d,function(h){if(h)return c(h);i[d]=!0,v()}):process.nextTick(v)}function v(){if(l>=s.length)return n&&(n[o]=s),c(null,s);Be.lastIndex=l;var g=Be.exec(s);return a=u,u+=g[0],d=a+g[1],l=Be.lastIndex,i[d]||n&&n[d]===d?process.nextTick(v):n&&Object.prototype.hasOwnProperty.call(n,d)?_(n[d]):We.lstat(d,p)}function p(g,h){if(g)return c(g);if(!h.isSymbolicLink())return i[d]=!0,n&&(n[d]=d),process.nextTick(v);if(!Ue){var m=h.dev.toString(32)+":"+h.ino.toString(32);if(e.hasOwnProperty(m))return r(null,e[m],d)}We.stat(d,function(y){if(y)return c(y);We.readlink(d,function(b,w){Ue||(e[m]=w),r(b,w)})})}function r(g,h,m){if(g)return c(g);var y=Xe.resolve(a,h);n&&(n[m]=y),_(y)}function _(g){s=Xe.resolve(g,s.slice(l)),f()}}});var jr=te((Yl,Qi)=>{Qi.exports=ze;ze.realpath=ze;ze.sync=Fr;ze.realpathSync=Fr;ze.monkeypatch=Ko;ze.unmonkeypatch=qo;var lt=require("fs"),Hr=lt.realpath,Nr=lt.realpathSync,$o=process.version,Xi=/^v[0-5]\./.test($o),Ji=Yi();function Zi(t){return t&&t.syscall==="realpath"&&(t.code==="ELOOP"||t.code==="ENOMEM"||t.code==="ENAMETOOLONG")}function ze(t,s,n){if(Xi)return Hr(t,s,n);typeof s=="function"&&(n=s,s=null),Hr(t,s,function(c,o){Zi(c)?Ji.realpath(t,s,n):n(c,o)})}function Fr(t,s){if(Xi)return Nr(t,s);try{return Nr(t,s)}catch(n){if(Zi(n))return Ji.realpathSync(t,s);throw n}}function Ko(){lt.realpath=ze,lt.realpathSync=Fr}function qo(){lt.realpath=Hr,lt.realpathSync=Nr}});var ts=te((Xl,es)=>{es.exports=function(t,s){for(var n=[],c=0;c<t.length;c++){var o=s(t[c],c);Vo(o)?n.push.apply(n,o):n.push(o)}return n};var Vo=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"}});var os=te((Jl,ns)=>{"use strict";ns.exports=is;function is(t,s,n){t instanceof RegExp&&(t=rs(t,n)),s instanceof RegExp&&(s=rs(s,n));var c=ss(t,s,n);return c&&{start:c[0],end:c[1],pre:n.slice(0,c[0]),body:n.slice(c[0]+t.length,c[1]),post:n.slice(c[1]+s.length)}}function rs(t,s){var n=s.match(t);return n?n[0]:null}is.range=ss;function ss(t,s,n){var c,o,e,i,l,u=n.indexOf(t),d=n.indexOf(s,u+1),a=u;if(u>=0&&d>0){if(t===s)return[u,d];for(c=[],e=n.length;a>=0&&!l;)a==u?(c.push(a),u=n.indexOf(t,a+1)):c.length==1?l=[c.pop(),d]:(o=c.pop(),o<e&&(e=o,i=d),d=n.indexOf(s,a+1)),a=u<d&&u>=0?u:d;c.length&&(l=[e,i])}return l}});var _s=te((Zl,fs)=>{var Go=ts(),as=os();fs.exports=Jo;var ls="\0SLASH"+Math.random()+"\0",cs="\0OPEN"+Math.random()+"\0",Ur="\0CLOSE"+Math.random()+"\0",hs="\0COMMA"+Math.random()+"\0",us="\0PERIOD"+Math.random()+"\0";function Wr(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function Yo(t){return t.split("\\\\").join(ls).split("\\{").join(cs).split("\\}").join(Ur).split("\\,").join(hs).split("\\.").join(us)}function Xo(t){return t.split(ls).join("\\").split(cs).join("{").split(Ur).join("}").split(hs).join(",").split(us).join(".")}function ds(t){if(!t)return[""];var s=[],n=as("{","}",t);if(!n)return t.split(",");var c=n.pre,o=n.body,e=n.post,i=c.split(",");i[i.length-1]+="{"+o+"}";var l=ds(e);return e.length&&(i[i.length-1]+=l.shift(),i.push.apply(i,l)),s.push.apply(s,i),s}function Jo(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),ct(Yo(t),!0).map(Xo)):[]}function Zo(t){return"{"+t+"}"}function Qo(t){return/^-?0\d/.test(t)}function ea(t,s){return t<=s}function ta(t,s){return t>=s}function ct(t,s){var n=[],c=as("{","}",t);if(!c||/\$$/.test(c.pre))return[t];var o=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(c.body),e=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(c.body),i=o||e,l=c.body.indexOf(",")>=0;if(!i&&!l)return c.post.match(/,.*\}/)?(t=c.pre+"{"+c.body+Ur+c.post,ct(t)):[t];var u;if(i)u=c.body.split(/\.\./);else if(u=ds(c.body),u.length===1&&(u=ct(u[0],!1).map(Zo),u.length===1)){var a=c.post.length?ct(c.post,!1):[""];return a.map(function(T){return c.pre+u[0]+T})}var d=c.pre,a=c.post.length?ct(c.post,!1):[""],f;if(i){var v=Wr(u[0]),p=Wr(u[1]),r=Math.max(u[0].length,u[1].length),_=u.length==3?Math.abs(Wr(u[2])):1,g=ea,h=p<v;h&&(_*=-1,g=ta);var m=u.some(Qo);f=[];for(var y=v;g(y,p);y+=_){var b;if(e)b=String.fromCharCode(y),b==="\\"&&(b="");else if(b=String(y),m){var w=r-b.length;if(w>0){var S=new Array(w+1).join("0");y<0?b="-"+S+b.slice(1):b=S+b}}f.push(b)}}else f=Go(u,function(R){return ct(R,!1)});for(var C=0;C<f.length;C++)for(var x=0;x<a.length;x++){var L=d+f[C]+a[x];(!s||i||L)&&n.push(L)}return n}});var Zt=te((Ql,Ss)=>{Ss.exports=de;de.Minimatch=oe;var kt=function(){try{return require("path")}catch(t){}}()||{sep:"/"};de.sep=kt.sep;var Kr=de.GLOBSTAR=oe.GLOBSTAR={},ra=_s(),ps={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},zr="[^/]",$r=zr+"*?",ia="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",sa="(?:(?!(?:\\/|^)\\.).)*?",gs=na("().*{}+?[]^$\\!");function na(t){return t.split("").reduce(function(s,n){return s[n]=!0,s},{})}var vs=/\/+/;de.filter=oa;function oa(t,s){return s=s||{},function(n,c,o){return de(n,t,s)}}function $e(t,s){s=s||{};var n={};return Object.keys(t).forEach(function(c){n[c]=t[c]}),Object.keys(s).forEach(function(c){n[c]=s[c]}),n}de.defaults=function(t){if(!t||typeof t!="object"||!Object.keys(t).length)return de;var s=de,n=function(o,e,i){return s(o,e,$e(t,i))};return n.Minimatch=function(o,e){return new s.Minimatch(o,$e(t,e))},n.Minimatch.defaults=function(o){return s.defaults($e(t,o)).Minimatch},n.filter=function(o,e){return s.filter(o,$e(t,e))},n.defaults=function(o){return s.defaults($e(t,o))},n.makeRe=function(o,e){return s.makeRe(o,$e(t,e))},n.braceExpand=function(o,e){return s.braceExpand(o,$e(t,e))},n.match=function(c,o,e){return s.match(c,o,$e(t,e))},n};oe.defaults=function(t){return de.defaults(t).Minimatch};function de(t,s,n){return Jt(s),n||(n={}),!n.nocomment&&s.charAt(0)==="#"?!1:new oe(s,n).match(t)}function oe(t,s){if(!(this instanceof oe))return new oe(t,s);Jt(t),s||(s={}),t=t.trim(),!s.allowWindowsEscape&&kt.sep!=="/"&&(t=t.split(kt.sep).join("/")),this.options=s,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!s.partial,this.make()}oe.prototype.debug=function(){};oe.prototype.make=aa;function aa(){var t=this.pattern,s=this.options;if(!s.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate();var n=this.globSet=this.braceExpand();s.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,n),n=this.globParts=n.map(function(c){return c.split(vs)}),this.debug(this.pattern,n),n=n.map(function(c,o,e){return c.map(this.parse,this)},this),this.debug(this.pattern,n),n=n.filter(function(c){return c.indexOf(!1)===-1}),this.debug(this.pattern,n),this.set=n}oe.prototype.parseNegate=la;function la(){var t=this.pattern,s=!1,n=this.options,c=0;if(!n.nonegate){for(var o=0,e=t.length;o<e&&t.charAt(o)==="!";o++)s=!s,c++;c&&(this.pattern=t.substr(c)),this.negate=s}}de.braceExpand=function(t,s){return ms(t,s)};oe.prototype.braceExpand=ms;function ms(t,s){return s||(this instanceof oe?s=this.options:s={}),t=typeof t=="undefined"?this.pattern:t,Jt(t),s.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:ra(t)}var ca=1024*64,Jt=function(t){if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>ca)throw new TypeError("pattern is too long")};oe.prototype.parse=ha;var Xt={};function ha(t,s){Jt(t);var n=this.options;if(t==="**")if(n.noglobstar)t="*";else return Kr;if(t==="")return"";var c="",o=!!n.nocase,e=!1,i=[],l=[],u,d=!1,a=-1,f=-1,v=t.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",p=this;function r(){if(u){switch(u){case"*":c+=$r,o=!0;break;case"?":c+=zr,o=!0;break;default:c+="\\"+u;break}p.debug("clearStateChar %j %j",u,c),u=!1}}for(var _=0,g=t.length,h;_<g&&(h=t.charAt(_));_++){if(this.debug("%s	%s %s %j",t,_,c,h),e&&gs[h]){c+="\\"+h,e=!1;continue}switch(h){case"/":return!1;case"\\":r(),e=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",t,_,c,h),d){this.debug("  in class"),h==="!"&&_===f+1&&(h="^"),c+=h;continue}p.debug("call clearStateChar %j",u),r(),u=h,n.noext&&r();continue;case"(":if(d){c+="(";continue}if(!u){c+="\\(";continue}i.push({type:u,start:_-1,reStart:c.length,open:ps[u].open,close:ps[u].close}),c+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,c),u=!1;continue;case")":if(d||!i.length){c+="\\)";continue}r(),o=!0;var m=i.pop();c+=m.close,m.type==="!"&&l.push(m),m.reEnd=c.length;continue;case"|":if(d||!i.length||e){c+="\\|",e=!1;continue}r(),c+="|";continue;case"[":if(r(),d){c+="\\"+h;continue}d=!0,f=_,a=c.length,c+=h;continue;case"]":if(_===f+1||!d){c+="\\"+h,e=!1;continue}var y=t.substring(f+1,_);try{RegExp("["+y+"]")}catch(U){var b=this.parse(y,Xt);c=c.substr(0,a)+"\\["+b[0]+"\\]",o=o||b[1],d=!1;continue}o=!0,d=!1,c+=h;continue;default:r(),e?e=!1:gs[h]&&!(h==="^"&&d)&&(c+="\\"),c+=h}}for(d&&(y=t.substr(f+1),b=this.parse(y,Xt),c=c.substr(0,a)+"\\["+b[0],o=o||b[1]),m=i.pop();m;m=i.pop()){var w=c.slice(m.reStart+m.open.length);this.debug("setting tail",c,m),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(U,K,j){return j||(j="\\"),K+K+j+"|"}),this.debug(`tail=%j
   %s`,w,w,m,c);var S=m.type==="*"?$r:m.type==="?"?zr:"\\"+m.type;o=!0,c=c.slice(0,m.reStart)+S+"\\("+w}r(),e&&(c+="\\\\");var C=!1;switch(c.charAt(0)){case"[":case".":case"(":C=!0}for(var x=l.length-1;x>-1;x--){var L=l[x],R=c.slice(0,L.reStart),T=c.slice(L.reStart,L.reEnd-8),I=c.slice(L.reEnd-8,L.reEnd),N=c.slice(L.reEnd);I+=N;var F=R.split("(").length-1,E=N;for(_=0;_<F;_++)E=E.replace(/\)[+*?]?/,"");N=E;var k="";N===""&&s!==Xt&&(k="$");var O=R+T+N+k+I;c=O}if(c!==""&&o&&(c="(?=.)"+c),C&&(c=v+c),s===Xt)return[c,o];if(!o)return da(t);var P=n.nocase?"i":"";try{var H=new RegExp("^"+c+"$",P)}catch(U){return new RegExp("$.")}return H._glob=t,H._src=c,H}de.makeRe=function(t,s){return new oe(t,s||{}).makeRe()};oe.prototype.makeRe=ua;function ua(){if(this.regexp||this.regexp===!1)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var s=this.options,n=s.noglobstar?$r:s.dot?ia:sa,c=s.nocase?"i":"",o=t.map(function(e){return e.map(function(i){return i===Kr?n:typeof i=="string"?fa(i):i._src}).join("\\/")}).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,c)}catch(e){this.regexp=!1}return this.regexp}de.match=function(t,s,n){n=n||{};var c=new oe(s,n);return t=t.filter(function(o){return c.match(o)}),c.options.nonull&&!t.length&&t.push(s),t};oe.prototype.match=function(s,n){if(typeof n=="undefined"&&(n=this.partial),this.debug("match",s,this.pattern),this.comment)return!1;if(this.empty)return s==="";if(s==="/"&&n)return!0;var c=this.options;kt.sep!=="/"&&(s=s.split(kt.sep).join("/")),s=s.split(vs),this.debug(this.pattern,"split",s);var o=this.set;this.debug(this.pattern,"set",o);var e,i;for(i=s.length-1;i>=0&&(e=s[i],!e);i--);for(i=0;i<o.length;i++){var l=o[i],u=s;c.matchBase&&l.length===1&&(u=[e]);var d=this.matchOne(u,l,n);if(d)return c.flipNegate?!0:!this.negate}return c.flipNegate?!1:this.negate};oe.prototype.matchOne=function(t,s,n){var c=this.options;this.debug("matchOne",{this:this,file:t,pattern:s}),this.debug("matchOne",t.length,s.length);for(var o=0,e=0,i=t.length,l=s.length;o<i&&e<l;o++,e++){this.debug("matchOne loop");var u=s[e],d=t[o];if(this.debug(s,u,d),u===!1)return!1;if(u===Kr){this.debug("GLOBSTAR",[s,u,d]);var a=o,f=e+1;if(f===l){for(this.debug("** at the end");o<i;o++)if(t[o]==="."||t[o]===".."||!c.dot&&t[o].charAt(0)===".")return!1;return!0}for(;a<i;){var v=t[a];if(this.debug(`
globstar while`,t,a,s,f,v),this.matchOne(t.slice(a),s.slice(f),n))return this.debug("globstar found match!",a,i,v),!0;if(v==="."||v===".."||!c.dot&&v.charAt(0)==="."){this.debug("dot detected!",t,a,s,f);break}this.debug("globstar swallow a segment, and continue"),a++}return!!(n&&(this.debug(`
>>> no match, partial?`,t,a,s,f),a===i))}var p;if(typeof u=="string"?(p=d===u,this.debug("string match",u,d,p)):(p=d.match(u),this.debug("pattern match",u,d,p)),!p)return!1}if(o===i&&e===l)return!0;if(o===i)return n;if(e===l)return o===i-1&&t[o]==="";throw new Error("wtf?")};function da(t){return t.replace(/\\(.)/g,"$1")}function fa(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var ys=te((ec,qr)=>{typeof Object.create=="function"?qr.exports=function(s,n){n&&(s.super_=n,s.prototype=Object.create(n.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}))}:qr.exports=function(s,n){if(n){s.super_=n;var c=function(){};c.prototype=n.prototype,s.prototype=new c,s.prototype.constructor=s}}});var er=te((tc,Qt)=>{"use strict";function bs(t){return t.charAt(0)==="/"}function Cs(t){var s=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,n=s.exec(t),c=n[1]||"",o=Boolean(c&&c.charAt(1)!==":");return Boolean(n[2]||o)}Qt.exports=process.platform==="win32"?Cs:bs;Qt.exports.posix=bs;Qt.exports.win32=Cs});var Gr=te(Ke=>{Ke.setopts=Sa;Ke.ownProp=ws;Ke.makeAbs=Rt;Ke.finish=ya;Ke.mark=ba;Ke.isIgnored=xs;Ke.childrenIgnored=Ca;function ws(t,s){return Object.prototype.hasOwnProperty.call(t,s)}var _a=require("fs"),ht=require("path"),pa=Zt(),Es=er(),Vr=pa.Minimatch;function ga(t,s){return t.localeCompare(s,"en")}function va(t,s){t.ignore=s.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(ma))}function ma(t){var s=null;if(t.slice(-3)==="/**"){var n=t.replace(/(\/\*\*)+$/,"");s=new Vr(n,{dot:!0})}return{matcher:new Vr(t,{dot:!0}),gmatcher:s}}function Sa(t,s,n){if(n||(n={}),n.matchBase&&s.indexOf("/")===-1){if(n.noglobstar)throw new Error("base matching requires globstar");s="**/"+s}t.silent=!!n.silent,t.pattern=s,t.strict=n.strict!==!1,t.realpath=!!n.realpath,t.realpathCache=n.realpathCache||Object.create(null),t.follow=!!n.follow,t.dot=!!n.dot,t.mark=!!n.mark,t.nodir=!!n.nodir,t.nodir&&(t.mark=!0),t.sync=!!n.sync,t.nounique=!!n.nounique,t.nonull=!!n.nonull,t.nosort=!!n.nosort,t.nocase=!!n.nocase,t.stat=!!n.stat,t.noprocess=!!n.noprocess,t.absolute=!!n.absolute,t.fs=n.fs||_a,t.maxLength=n.maxLength||1/0,t.cache=n.cache||Object.create(null),t.statCache=n.statCache||Object.create(null),t.symlinks=n.symlinks||Object.create(null),va(t,n),t.changedCwd=!1;var c=process.cwd();ws(n,"cwd")?(t.cwd=ht.resolve(n.cwd),t.changedCwd=t.cwd!==c):t.cwd=c,t.root=n.root||ht.resolve(t.cwd,"/"),t.root=ht.resolve(t.root),process.platform==="win32"&&(t.root=t.root.replace(/\\/g,"/")),t.cwdAbs=Es(t.cwd)?t.cwd:Rt(t,t.cwd),process.platform==="win32"&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),t.nomount=!!n.nomount,n.nonegate=!0,n.nocomment=!0,n.allowWindowsEscape=!1,t.minimatch=new Vr(s,n),t.options=t.minimatch.options}function ya(t){for(var s=t.nounique,n=s?[]:Object.create(null),c=0,o=t.matches.length;c<o;c++){var e=t.matches[c];if(!e||Object.keys(e).length===0){if(t.nonull){var i=t.minimatch.globSet[c];s?n.push(i):n[i]=!0}}else{var l=Object.keys(e);s?n.push.apply(n,l):l.forEach(function(u){n[u]=!0})}}if(s||(n=Object.keys(n)),t.nosort||(n=n.sort(ga)),t.mark){for(var c=0;c<n.length;c++)n[c]=t._mark(n[c]);t.nodir&&(n=n.filter(function(u){var d=!/\/$/.test(u),a=t.cache[u]||t.cache[Rt(t,u)];return d&&a&&(d=a!=="DIR"&&!Array.isArray(a)),d}))}t.ignore.length&&(n=n.filter(function(u){return!xs(t,u)})),t.found=n}function ba(t,s){var n=Rt(t,s),c=t.cache[n],o=s;if(c){var e=c==="DIR"||Array.isArray(c),i=s.slice(-1)==="/";if(e&&!i?o+="/":!e&&i&&(o=o.slice(0,-1)),o!==s){var l=Rt(t,o);t.statCache[l]=t.statCache[n],t.cache[l]=t.cache[n]}}return o}function Rt(t,s){var n=s;return s.charAt(0)==="/"?n=ht.join(t.root,s):Es(s)||s===""?n=s:t.changedCwd?n=ht.resolve(t.cwd,s):n=ht.resolve(s),process.platform==="win32"&&(n=n.replace(/\\/g,"/")),n}function xs(t,s){return t.ignore.length?t.ignore.some(function(n){return n.matcher.match(s)||!!(n.gmatcher&&n.gmatcher.match(s))}):!1}function Ca(t,s){return t.ignore.length?t.ignore.some(function(n){return!!(n.gmatcher&&n.gmatcher.match(s))}):!1}});var Os=te((oc,Ts)=>{Ts.exports=Rs;Rs.GlobSync=ie;var wa=jr(),Ls=Zt(),ic=Ls.Minimatch,sc=Jr().Glob,nc=require("util"),Yr=require("path"),ks=require("assert"),tr=er(),Je=Gr(),Ea=Je.setopts,Xr=Je.ownProp,xa=Je.childrenIgnored,La=Je.isIgnored;function Rs(t,s){if(typeof s=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new ie(t,s).found}function ie(t,s){if(!t)throw new Error("must provide pattern");if(typeof s=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof ie))return new ie(t,s);if(Ea(this,t,s),this.noprocess)return this;var n=this.minimatch.set.length;this.matches=new Array(n);for(var c=0;c<n;c++)this._process(this.minimatch.set[c],c,!1);this._finish()}ie.prototype._finish=function(){if(ks.ok(this instanceof ie),this.realpath){var t=this;this.matches.forEach(function(s,n){var c=t.matches[n]=Object.create(null);for(var o in s)try{o=t._makeAbs(o);var e=wa.realpathSync(o,t.realpathCache);c[e]=!0}catch(i){if(i.syscall==="stat")c[t._makeAbs(o)]=!0;else throw i}})}Je.finish(this)};ie.prototype._process=function(t,s,n){ks.ok(this instanceof ie);for(var c=0;typeof t[c]=="string";)c++;var o;switch(c){case t.length:this._processSimple(t.join("/"),s);return;case 0:o=null;break;default:o=t.slice(0,c).join("/");break}var e=t.slice(c),i;o===null?i=".":((tr(o)||tr(t.map(function(d){return typeof d=="string"?d:"[*]"}).join("/")))&&(!o||!tr(o))&&(o="/"+o),i=o);var l=this._makeAbs(i);if(!xa(this,i)){var u=e[0]===Ls.GLOBSTAR;u?this._processGlobStar(o,i,l,e,s,n):this._processReaddir(o,i,l,e,s,n)}};ie.prototype._processReaddir=function(t,s,n,c,o,e){var i=this._readdir(n,e);if(i){for(var l=c[0],u=!!this.minimatch.negate,d=l._glob,a=this.dot||d.charAt(0)===".",f=[],v=0;v<i.length;v++){var p=i[v];if(p.charAt(0)!=="."||a){var r;u&&!t?r=!p.match(l):r=p.match(l),r&&f.push(p)}}var _=f.length;if(_!==0){if(c.length===1&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(var v=0;v<_;v++){var p=f[v];t&&(t.slice(-1)!=="/"?p=t+"/"+p:p=t+p),p.charAt(0)==="/"&&!this.nomount&&(p=Yr.join(this.root,p)),this._emitMatch(o,p)}return}c.shift();for(var v=0;v<_;v++){var p=f[v],g;t?g=[t,p]:g=[p],this._process(g.concat(c),o,e)}}}};ie.prototype._emitMatch=function(t,s){if(!La(this,s)){var n=this._makeAbs(s);if(this.mark&&(s=this._mark(s)),this.absolute&&(s=n),!this.matches[t][s]){if(this.nodir){var c=this.cache[n];if(c==="DIR"||Array.isArray(c))return}this.matches[t][s]=!0,this.stat&&this._stat(s)}}};ie.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var s,n,c;try{n=this.fs.lstatSync(t)}catch(e){if(e.code==="ENOENT")return null}var o=n&&n.isSymbolicLink();return this.symlinks[t]=o,!o&&n&&!n.isDirectory()?this.cache[t]="FILE":s=this._readdir(t,!1),s};ie.prototype._readdir=function(t,s){var n;if(s&&!Xr(this.symlinks,t))return this._readdirInGlobStar(t);if(Xr(this.cache,t)){var c=this.cache[t];if(!c||c==="FILE")return null;if(Array.isArray(c))return c}try{return this._readdirEntries(t,this.fs.readdirSync(t))}catch(o){return this._readdirError(t,o),null}};ie.prototype._readdirEntries=function(t,s){if(!this.mark&&!this.stat)for(var n=0;n<s.length;n++){var c=s[n];t==="/"?c=t+c:c=t+"/"+c,this.cache[c]=!0}return this.cache[t]=s,s};ie.prototype._readdirError=function(t,s){switch(s.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var c=new Error(s.code+" invalid cwd "+this.cwd);throw c.path=this.cwd,c.code=s.code,c}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw s;this.silent||console.error("glob error",s);break}};ie.prototype._processGlobStar=function(t,s,n,c,o,e){var i=this._readdir(n,e);if(i){var l=c.slice(1),u=t?[t]:[],d=u.concat(l);this._process(d,o,!1);var a=i.length,f=this.symlinks[n];if(!(f&&e))for(var v=0;v<a;v++){var p=i[v];if(!(p.charAt(0)==="."&&!this.dot)){var r=u.concat(i[v],l);this._process(r,o,!0);var _=u.concat(i[v],c);this._process(_,o,!0)}}}};ie.prototype._processSimple=function(t,s){var n=this._stat(t);if(this.matches[s]||(this.matches[s]=Object.create(null)),!!n){if(t&&tr(t)&&!this.nomount){var c=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=Yr.join(this.root,t):(t=Yr.resolve(this.root,t),c&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(s,t)}};ie.prototype._stat=function(t){var s=this._makeAbs(t),n=t.slice(-1)==="/";if(t.length>this.maxLength)return!1;if(!this.stat&&Xr(this.cache,s)){var i=this.cache[s];if(Array.isArray(i)&&(i="DIR"),!n||i==="DIR")return i;if(n&&i==="FILE")return!1}var c,o=this.statCache[s];if(!o){var e;try{e=this.fs.lstatSync(s)}catch(l){if(l&&(l.code==="ENOENT"||l.code==="ENOTDIR"))return this.statCache[s]=!1,!1}if(e&&e.isSymbolicLink())try{o=this.fs.statSync(s)}catch(l){o=e}else o=e}this.statCache[s]=o;var i=!0;return o&&(i=o.isDirectory()?"DIR":"FILE"),this.cache[s]=this.cache[s]||i,n&&i==="FILE"?!1:i};ie.prototype._mark=function(t){return Je.mark(this,t)};ie.prototype._makeAbs=function(t){return Je.makeAbs(this,t)}});var Zr=te((ac,Ds)=>{Ds.exports=As;function As(t,s){if(t&&s)return As(t)(s);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(c){n[c]=t[c]}),n;function n(){for(var c=new Array(arguments.length),o=0;o<c.length;o++)c[o]=arguments[o];var e=t.apply(this,c),i=c[c.length-1];return typeof e=="function"&&e!==i&&Object.keys(i).forEach(function(l){e[l]=i[l]}),e}}});var ei=te((lc,Qr)=>{var Ps=Zr();Qr.exports=Ps(rr);Qr.exports.strict=Ps(Bs);rr.proto=rr(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return rr(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Bs(this)},configurable:!0})});function rr(t){var s=function(){return s.called?s.value:(s.called=!0,s.value=t.apply(this,arguments))};return s.called=!1,s}function Bs(t){var s=function(){if(s.called)throw new Error(s.onceError);return s.called=!0,s.value=t.apply(this,arguments)},n=t.name||"Function wrapped with `once`";return s.onceError=n+" shouldn't be called more than once",s.called=!1,s}});var Ms=te((cc,Is)=>{var ka=Zr(),Tt=Object.create(null),Ra=ei();Is.exports=ka(Ta);function Ta(t,s){return Tt[t]?(Tt[t].push(s),null):(Tt[t]=[s],Oa(t))}function Oa(t){return Ra(function s(){var n=Tt[t],c=n.length,o=Aa(arguments);try{for(var e=0;e<c;e++)n[e].apply(null,o)}finally{n.length>c?(n.splice(0,c),process.nextTick(function(){s.apply(null,o)})):delete Tt[t]}})}function Aa(t){for(var s=t.length,n=[],c=0;c<s;c++)n[c]=t[c];return n}});var Jr=te((dc,Ns)=>{Ns.exports=Ze;var Da=jr(),Hs=Zt(),hc=Hs.Minimatch,Pa=ys(),Ba=require("events").EventEmitter,ti=require("path"),ri=require("assert"),Ot=er(),si=Os(),Qe=Gr(),Ia=Qe.setopts,ii=Qe.ownProp,ni=Ms(),uc=require("util"),Ma=Qe.childrenIgnored,Ha=Qe.isIgnored,Na=ei();function Ze(t,s,n){if(typeof s=="function"&&(n=s,s={}),s||(s={}),s.sync){if(n)throw new TypeError("callback provided to sync glob");return si(t,s)}return new G(t,s,n)}Ze.sync=si;var Fa=Ze.GlobSync=si.GlobSync;Ze.glob=Ze;function ja(t,s){if(s===null||typeof s!="object")return t;for(var n=Object.keys(s),c=n.length;c--;)t[n[c]]=s[n[c]];return t}Ze.hasMagic=function(t,s){var n=ja({},s);n.noprocess=!0;var c=new G(t,n),o=c.minimatch.set;if(!t)return!1;if(o.length>1)return!0;for(var e=0;e<o[0].length;e++)if(typeof o[0][e]!="string")return!0;return!1};Ze.Glob=G;Pa(G,Ba);function G(t,s,n){if(typeof s=="function"&&(n=s,s=null),s&&s.sync){if(n)throw new TypeError("callback provided to sync glob");return new Fa(t,s)}if(!(this instanceof G))return new G(t,s,n);Ia(this,t,s),this._didRealPath=!1;var c=this.minimatch.set.length;this.matches=new Array(c),typeof n=="function"&&(n=Na(n),this.on("error",n),this.on("end",function(u){n(null,u)}));var o=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(c===0)return l();for(var e=!0,i=0;i<c;i++)this._process(this.minimatch.set[i],i,!1,l);e=!1;function l(){--o._processing,o._processing<=0&&(e?process.nextTick(function(){o._finish()}):o._finish())}}G.prototype._finish=function(){if(ri(this instanceof G),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Qe.finish(this),this.emit("end",this.found)}};G.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var t=this.matches.length;if(t===0)return this._finish();for(var s=this,n=0;n<this.matches.length;n++)this._realpathSet(n,c);function c(){--t===0&&s._finish()}};G.prototype._realpathSet=function(t,s){var n=this.matches[t];if(!n)return s();var c=Object.keys(n),o=this,e=c.length;if(e===0)return s();var i=this.matches[t]=Object.create(null);c.forEach(function(l,u){l=o._makeAbs(l),Da.realpath(l,o.realpathCache,function(d,a){d?d.syscall==="stat"?i[l]=!0:o.emit("error",d):i[a]=!0,--e===0&&(o.matches[t]=i,s())})})};G.prototype._mark=function(t){return Qe.mark(this,t)};G.prototype._makeAbs=function(t){return Qe.makeAbs(this,t)};G.prototype.abort=function(){this.aborted=!0,this.emit("abort")};G.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))};G.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var s=0;s<t.length;s++){var n=t[s];this._emitMatch(n[0],n[1])}}if(this._processQueue.length){var c=this._processQueue.slice(0);this._processQueue.length=0;for(var s=0;s<c.length;s++){var o=c[s];this._processing--,this._process(o[0],o[1],o[2],o[3])}}}};G.prototype._process=function(t,s,n,c){if(ri(this instanceof G),ri(typeof c=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([t,s,n,c]);return}for(var o=0;typeof t[o]=="string";)o++;var e;switch(o){case t.length:this._processSimple(t.join("/"),s,c);return;case 0:e=null;break;default:e=t.slice(0,o).join("/");break}var i=t.slice(o),l;e===null?l=".":((Ot(e)||Ot(t.map(function(a){return typeof a=="string"?a:"[*]"}).join("/")))&&(!e||!Ot(e))&&(e="/"+e),l=e);var u=this._makeAbs(l);if(Ma(this,l))return c();var d=i[0]===Hs.GLOBSTAR;d?this._processGlobStar(e,l,u,i,s,n,c):this._processReaddir(e,l,u,i,s,n,c)}};G.prototype._processReaddir=function(t,s,n,c,o,e,i){var l=this;this._readdir(n,e,function(u,d){return l._processReaddir2(t,s,n,c,o,e,d,i)})};G.prototype._processReaddir2=function(t,s,n,c,o,e,i,l){if(!i)return l();for(var u=c[0],d=!!this.minimatch.negate,a=u._glob,f=this.dot||a.charAt(0)===".",v=[],p=0;p<i.length;p++){var r=i[p];if(r.charAt(0)!=="."||f){var _;d&&!t?_=!r.match(u):_=r.match(u),_&&v.push(r)}}var g=v.length;if(g===0)return l();if(c.length===1&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(var p=0;p<g;p++){var r=v[p];t&&(t!=="/"?r=t+"/"+r:r=t+r),r.charAt(0)==="/"&&!this.nomount&&(r=ti.join(this.root,r)),this._emitMatch(o,r)}return l()}c.shift();for(var p=0;p<g;p++){var r=v[p],h;t&&(t!=="/"?r=t+"/"+r:r=t+r),this._process([r].concat(c),o,e,l)}l()};G.prototype._emitMatch=function(t,s){if(!this.aborted&&!Ha(this,s)){if(this.paused){this._emitQueue.push([t,s]);return}var n=Ot(s)?s:this._makeAbs(s);if(this.mark&&(s=this._mark(s)),this.absolute&&(s=n),!this.matches[t][s]){if(this.nodir){var c=this.cache[n];if(c==="DIR"||Array.isArray(c))return}this.matches[t][s]=!0;var o=this.statCache[n];o&&this.emit("stat",s,o),this.emit("match",s)}}};G.prototype._readdirInGlobStar=function(t,s){if(this.aborted)return;if(this.follow)return this._readdir(t,!1,s);var n="lstat\0"+t,c=this,o=ni(n,e);o&&c.fs.lstat(t,o);function e(i,l){if(i&&i.code==="ENOENT")return s();var u=l&&l.isSymbolicLink();c.symlinks[t]=u,!u&&l&&!l.isDirectory()?(c.cache[t]="FILE",s()):c._readdir(t,!1,s)}};G.prototype._readdir=function(t,s,n){if(!this.aborted&&(n=ni("readdir\0"+t+"\0"+s,n),!!n)){if(s&&!ii(this.symlinks,t))return this._readdirInGlobStar(t,n);if(ii(this.cache,t)){var c=this.cache[t];if(!c||c==="FILE")return n();if(Array.isArray(c))return n(null,c)}var o=this;o.fs.readdir(t,Wa(this,t,n))}};function Wa(t,s,n){return function(c,o){c?t._readdirError(s,c,n):t._readdirEntries(s,o,n)}}G.prototype._readdirEntries=function(t,s,n){if(!this.aborted){if(!this.mark&&!this.stat)for(var c=0;c<s.length;c++){var o=s[c];t==="/"?o=t+o:o=t+"/"+o,this.cache[o]=!0}return this.cache[t]=s,n(null,s)}};G.prototype._readdirError=function(t,s,n){if(!this.aborted){switch(s.code){case"ENOTSUP":case"ENOTDIR":var c=this._makeAbs(t);if(this.cache[c]="FILE",c===this.cwdAbs){var o=new Error(s.code+" invalid cwd "+this.cwd);o.path=this.cwd,o.code=s.code,this.emit("error",o),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",s),this.abort()),this.silent||console.error("glob error",s);break}return n()}};G.prototype._processGlobStar=function(t,s,n,c,o,e,i){var l=this;this._readdir(n,e,function(u,d){l._processGlobStar2(t,s,n,c,o,e,d,i)})};G.prototype._processGlobStar2=function(t,s,n,c,o,e,i,l){if(!i)return l();var u=c.slice(1),d=t?[t]:[],a=d.concat(u);this._process(a,o,!1,l);var f=this.symlinks[n],v=i.length;if(f&&e)return l();for(var p=0;p<v;p++){var r=i[p];if(!(r.charAt(0)==="."&&!this.dot)){var _=d.concat(i[p],u);this._process(_,o,!0,l);var g=d.concat(i[p],c);this._process(g,o,!0,l)}}l()};G.prototype._processSimple=function(t,s,n){var c=this;this._stat(t,function(o,e){c._processSimple2(t,s,o,e,n)})};G.prototype._processSimple2=function(t,s,n,c,o){if(this.matches[s]||(this.matches[s]=Object.create(null)),!c)return o();if(t&&Ot(t)&&!this.nomount){var e=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=ti.join(this.root,t):(t=ti.resolve(this.root,t),e&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(s,t),o()};G.prototype._stat=function(t,s){var n=this._makeAbs(t),c=t.slice(-1)==="/";if(t.length>this.maxLength)return s();if(!this.stat&&ii(this.cache,n)){var o=this.cache[n];if(Array.isArray(o)&&(o="DIR"),!c||o==="DIR")return s(null,o);if(c&&o==="FILE")return s()}var e,i=this.statCache[n];if(i!==void 0){if(i===!1)return s(null,i);var l=i.isDirectory()?"DIR":"FILE";return c&&l==="FILE"?s():s(null,l,i)}var u=this,d=ni("stat\0"+n,a);d&&u.fs.lstat(n,d);function a(f,v){if(v&&v.isSymbolicLink())return u.fs.stat(n,function(p,r){p?u._stat2(t,n,null,v,s):u._stat2(t,n,p,r,s)});u._stat2(t,n,f,v,s)}};G.prototype._stat2=function(t,s,n,c,o){if(n&&(n.code==="ENOENT"||n.code==="ENOTDIR"))return this.statCache[s]=!1,o();var e=t.slice(-1)==="/";if(this.statCache[s]=c,s.slice(-1)==="/"&&c&&!c.isDirectory())return o(null,!1,c);var i=!0;return c&&(i=c.isDirectory()?"DIR":"FILE"),this.cache[s]=this.cache[s]||i,e&&i==="FILE"?o():o(null,i,c)}});var qs=te((fc,Ks)=>{var J=require("assert"),Us=require("path"),Fs=require("fs"),ut;try{ut=Jr()}catch(t){}var Ua={nosort:!0,silent:!0},oi=0,At=process.platform==="win32",zs=t=>{if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(n=>{t[n]=t[n]||Fs[n],n=n+"Sync",t[n]=t[n]||Fs[n]}),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,t.glob===!1&&(t.disableGlob=!0),t.disableGlob!==!0&&ut===void 0)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");t.disableGlob=t.disableGlob||!1,t.glob=t.glob||Ua},li=(t,s,n)=>{typeof s=="function"&&(n=s,s={}),J(t,"rimraf: missing path"),J.equal(typeof t,"string","rimraf: path should be a string"),J.equal(typeof n,"function","rimraf: callback function required"),J(s,"rimraf: invalid options argument provided"),J.equal(typeof s,"object","rimraf: options should be object"),zs(s);let c=0,o=null,e=0,i=u=>{o=o||u,--e===0&&n(o)},l=(u,d)=>{if(u)return n(u);if(e=d.length,e===0)return n();d.forEach(a=>{let f=v=>{if(v){if((v.code==="EBUSY"||v.code==="ENOTEMPTY"||v.code==="EPERM")&&c<s.maxBusyTries)return c++,setTimeout(()=>ai(a,s,f),c*100);if(v.code==="EMFILE"&&oi<s.emfileWait)return setTimeout(()=>ai(a,s,f),oi++);v.code==="ENOENT"&&(v=null)}oi=0,i(v)};ai(a,s,f)})};if(s.disableGlob||!ut.hasMagic(t))return l(null,[t]);s.lstat(t,(u,d)=>{if(!u)return l(null,[t]);ut(t,s.glob,l)})},ai=(t,s,n)=>{J(t),J(s),J(typeof n=="function"),s.lstat(t,(c,o)=>{if(c&&c.code==="ENOENT")return n(null);if(c&&c.code==="EPERM"&&At&&js(t,s,c,n),o&&o.isDirectory())return ir(t,s,c,n);s.unlink(t,e=>{if(e){if(e.code==="ENOENT")return n(null);if(e.code==="EPERM")return At?js(t,s,e,n):ir(t,s,e,n);if(e.code==="EISDIR")return ir(t,s,e,n)}return n(e)})})},js=(t,s,n,c)=>{J(t),J(s),J(typeof c=="function"),s.chmod(t,438,o=>{o?c(o.code==="ENOENT"?null:n):s.stat(t,(e,i)=>{e?c(e.code==="ENOENT"?null:n):i.isDirectory()?ir(t,s,n,c):s.unlink(t,c)})})},Ws=(t,s,n)=>{J(t),J(s);try{s.chmodSync(t,438)}catch(o){if(o.code==="ENOENT")return;throw n}let c;try{c=s.statSync(t)}catch(o){if(o.code==="ENOENT")return;throw n}c.isDirectory()?sr(t,s,n):s.unlinkSync(t)},ir=(t,s,n,c)=>{J(t),J(s),J(typeof c=="function"),s.rmdir(t,o=>{o&&(o.code==="ENOTEMPTY"||o.code==="EEXIST"||o.code==="EPERM")?za(t,s,c):o&&o.code==="ENOTDIR"?c(n):c(o)})},za=(t,s,n)=>{J(t),J(s),J(typeof n=="function"),s.readdir(t,(c,o)=>{if(c)return n(c);let e=o.length;if(e===0)return s.rmdir(t,n);let i;o.forEach(l=>{li(Us.join(t,l),s,u=>{if(!i){if(u)return n(i=u);--e===0&&s.rmdir(t,n)}})})})},$s=(t,s)=>{s=s||{},zs(s),J(t,"rimraf: missing path"),J.equal(typeof t,"string","rimraf: path should be a string"),J(s,"rimraf: missing options"),J.equal(typeof s,"object","rimraf: options should be object");let n;if(s.disableGlob||!ut.hasMagic(t))n=[t];else try{s.lstatSync(t),n=[t]}catch(c){n=ut.sync(t,s.glob)}if(n.length)for(let c=0;c<n.length;c++){let o=n[c],e;try{e=s.lstatSync(o)}catch(i){if(i.code==="ENOENT")return;i.code==="EPERM"&&At&&Ws(o,s,i)}try{e&&e.isDirectory()?sr(o,s,null):s.unlinkSync(o)}catch(i){if(i.code==="ENOENT")return;if(i.code==="EPERM")return At?Ws(o,s,i):sr(o,s,i);if(i.code!=="EISDIR")throw i;sr(o,s,i)}}},sr=(t,s,n)=>{J(t),J(s);try{s.rmdirSync(t)}catch(c){if(c.code==="ENOENT")return;if(c.code==="ENOTDIR")throw n;(c.code==="ENOTEMPTY"||c.code==="EEXIST"||c.code==="EPERM")&&$a(t,s)}},$a=(t,s)=>{J(t),J(s),s.readdirSync(t).forEach(o=>$s(Us.join(t,o),s));let n=At?100:1,c=0;do{let o=!0;try{let e=s.rmdirSync(t,s);return o=!1,e}finally{if(++c<n&&o)continue}}while(!0)};Ks.exports=li;li.sync=$s});var un=te((_c,Ie)=>{/*!
 * Tmp
 *
 * Copyright (c) 2011-2017 KARASZI Istvan <github@spam.raszi.hu>
 *
 * MIT Licensed
 */var se=require("fs"),fi=require("os"),fe=require("path"),Vs=require("crypto"),ke={fs:se.constants,os:fi.constants},Xs=qs(),Gs="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Js=/XXXXXX/,Ka=3,Zs=(ke.O_CREAT||ke.fs.O_CREAT)|(ke.O_EXCL||ke.fs.O_EXCL)|(ke.O_RDWR||ke.fs.O_RDWR),qa=fi.platform()==="win32",Va=ke.EBADF||ke.os.errno.EBADF,Ga=ke.ENOENT||ke.os.errno.ENOENT,Qs=448,en=384,Ya="exit",dt=[],tn=se.rmdirSync.bind(se),rn=Xs.sync,sn=!1;function _i(t,s){let n=ft(t,s),c=n[0],o=n[1];try{ln(c)}catch(i){return o(i)}let e=c.tries;(function i(){try{let l=an(c);se.stat(l,function(u){if(!u)return e-- >0?i():o(new Error("Could not get a unique tmp filename, max tries reached "+l));o(null,l)})}catch(l){o(l)}})()}function pi(t){let s=ft(t),n=s[0];ln(n);let c=n.tries;do{let o=an(n);try{se.statSync(o)}catch(e){return o}}while(c-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function Xa(t,s){let n=ft(t,s),c=n[0],o=n[1];_i(c,function(i,l){if(i)return o(i);se.open(l,Zs,c.mode||en,function(d,a){if(d)return o(d);if(c.discardDescriptor)return se.close(a,function(v){return o(v,l,void 0,hi(l,-1,c,!1))});{let f=c.discardDescriptor||c.detachDescriptor;o(null,l,a,hi(l,f?-1:a,c,!1))}})})}function Ja(t){let s=ft(t),n=s[0],c=n.discardDescriptor||n.detachDescriptor,o=pi(n);var e=se.openSync(o,Zs,n.mode||en);return n.discardDescriptor&&(se.closeSync(e),e=void 0),{name:o,fd:e,removeCallback:hi(o,c?-1:e,n,!0)}}function Za(t,s){let n=ft(t,s),c=n[0],o=n[1];_i(c,function(i,l){if(i)return o(i);se.mkdir(l,c.mode||Qs,function(d){if(d)return o(d);o(null,l,nn(l,c,!1))})})}function Qa(t){let s=ft(t),n=s[0],c=pi(n);return se.mkdirSync(c,n.mode||Qs),{name:c,removeCallback:nn(c,n,!0)}}function el(t,s){let n=function(c){if(c&&!di(c))return s(c);s()};0<=t[0]?se.close(t[0],function(){se.unlink(t[1],n)}):se.unlink(t[1],n)}function tl(t){let s=null;try{0<=t[0]&&se.closeSync(t[0])}catch(n){if(!il(n)&&!di(n))throw n}finally{try{se.unlinkSync(t[1])}catch(n){di(n)||(s=n)}}if(s!==null)throw s}function hi(t,s,n,c){let o=nr(tl,[s,t],c),e=nr(el,[s,t],c,o);return n.keep||dt.unshift(o),c?o:e}function nn(t,s,n){let c=s.unsafeCleanup?Xs:se.rmdir.bind(se),o=s.unsafeCleanup?rn:tn,e=nr(o,t,n),i=nr(c,t,n,e);return s.keep||dt.unshift(e),n?e:i}function nr(t,s,n,c){let o=!1;return function e(i){if(!o){let l=c||e,u=dt.indexOf(l);return u>=0&&dt.splice(u,1),o=!0,n||t===tn||t===rn?t(s):t(s,i||function(){})}}}function rl(){if(sn)for(;dt.length;)try{dt[0]()}catch(t){}}function Ys(t){let s=[],n=null;try{n=Vs.randomBytes(t)}catch(o){n=Vs.pseudoRandomBytes(t)}for(var c=0;c<t;c++)s.push(Gs[n[c]%Gs.length]);return s.join("")}function on(t){return t===null||ue(t)||!t.trim()}function ue(t){return typeof t=="undefined"}function ft(t,s){if(typeof t=="function")return[{},t];if(ue(t))return[{},s];let n={};for(let c of Object.getOwnPropertyNames(t))n[c]=t[c];return[n,s]}function an(t){let s=t.tmpdir;if(!ue(t.name))return fe.join(s,t.dir,t.name);if(!ue(t.template))return fe.join(s,t.dir,t.template).replace(Js,Ys(6));let n=[t.prefix?t.prefix:"tmp","-",process.pid,"-",Ys(12),t.postfix?"-"+t.postfix:""].join("");return fe.join(s,t.dir,n)}function ln(t){t.tmpdir=hn(t);let s=t.tmpdir;if(ue(t.name)||ci(t.name,"name",s),ue(t.dir)||ci(t.dir,"dir",s),!ue(t.template)&&(ci(t.template,"template",s),!t.template.match(Js)))throw new Error(`Invalid template, found "${t.template}".`);if(!ue(t.tries)&&isNaN(t.tries)||t.tries<0)throw new Error(`Invalid tries, found "${t.tries}".`);t.tries=ue(t.name)?t.tries||Ka:1,t.keep=!!t.keep,t.detachDescriptor=!!t.detachDescriptor,t.discardDescriptor=!!t.discardDescriptor,t.unsafeCleanup=!!t.unsafeCleanup,t.dir=ue(t.dir)?"":fe.relative(s,ui(t.dir,s)),t.template=ue(t.template)?void 0:fe.relative(s,ui(t.template,s)),t.template=on(t.template)?void 0:fe.relative(t.dir,t.template),t.name=ue(t.name)?void 0:gi(t.name),t.prefix=ue(t.prefix)?"":t.prefix,t.postfix=ue(t.postfix)?"":t.postfix}function ui(t,s){let n=gi(t);return n.startsWith(s)?fe.resolve(n):fe.resolve(fe.join(s,n))}function gi(t){return on(t)?t:t.replace(/["']/g,"")}function ci(t,s,n){if(s==="name"){if(fe.isAbsolute(t))throw new Error(`${s} option must not contain an absolute path, found "${t}".`);let c=fe.basename(t);if(c===".."||c==="."||c!==t)throw new Error(`${s} option must not contain a path, found "${t}".`)}else{if(fe.isAbsolute(t)&&!t.startsWith(n))throw new Error(`${s} option must be relative to "${n}", found "${t}".`);let c=ui(t,n);if(!c.startsWith(n))throw new Error(`${s} option must be relative to "${n}", found "${c}".`)}}function il(t){return cn(t,-Va,"EBADF")}function di(t){return cn(t,-Ga,"ENOENT")}function cn(t,s,n){return qa?t.code===n:t.code===n&&t.errno===s}function sl(){sn=!0}function hn(t){return fe.resolve(gi(t&&t.tmpdir||fi.tmpdir()))}process.addListener(Ya,rl);Object.defineProperty(Ie.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return hn()}});Ie.exports.dir=Za;Ie.exports.dirSync=Qa;Ie.exports.file=Xa;Ie.exports.fileSync=Ja;Ie.exports.tmpName=_i;Ie.exports.tmpNameSync=pi;Ie.exports.setGracefulCleanup=sl});var jn=te((Ft,Ri)=>{(function(t,s){typeof Ft=="object"&&typeof Ri=="object"?Ri.exports=s():typeof define=="function"&&define.amd?define([],s):typeof Ft=="object"?Ft.SerializeAddon=s():t.SerializeAddon=s()})(Ft,function(){return(()=>{"use strict";var t={};return(()=>{var s=t;function n(d,a,f){return Math.max(a,Math.min(d,f))}Object.defineProperty(s,"__esModule",{value:!0}),s.HTMLSerializeHandler=s.SerializeAddon=void 0;class c{constructor(a){this._buffer=a}serialize(a){let f=this._buffer.getNullCell(),v=this._buffer.getNullCell(),p=f,r=a.start.x,_=a.end.x,g=a.start.y,h=a.end.y;this._beforeSerialize(_-r,r,_);for(let m=r;m<=_;m++){let y=this._buffer.getLine(m);if(y){let b=m!==a.start.x?0:g,w=m!==a.end.x?y.length:h;for(let S=b;S<w;S++){let C=y.getCell(S,p===f?v:f);C?(this._nextCell(C,p,m,S),p=C):console.warn(`Can't get cell at row=${m}, col=${S}`)}}this._rowEnd(m,m===_)}return this._afterSerialize(),this._serializeString()}_nextCell(a,f,v,p){}_rowEnd(a,f){}_beforeSerialize(a,f,v){}_afterSerialize(){}_serializeString(){return""}}function o(d,a){return d.getFgColorMode()===a.getFgColorMode()&&d.getFgColor()===a.getFgColor()}function e(d,a){return d.getBgColorMode()===a.getBgColorMode()&&d.getBgColor()===a.getBgColor()}function i(d,a){return d.isInverse()===a.isInverse()&&d.isBold()===a.isBold()&&d.isUnderline()===a.isUnderline()&&d.isBlink()===a.isBlink()&&d.isInvisible()===a.isInvisible()&&d.isItalic()===a.isItalic()&&d.isDim()===a.isDim()&&d.isStrikethrough()===a.isStrikethrough()}class l extends c{constructor(a,f){super(a),this._terminal=f,this._rowIndex=0,this._allRows=new Array,this._allRowSeparators=new Array,this._currentRow="",this._nullCellCount=0,this._cursorStyle=this._buffer.getNullCell(),this._cursorStyleRow=0,this._cursorStyleCol=0,this._backgroundCell=this._buffer.getNullCell(),this._firstRow=0,this._lastCursorRow=0,this._lastCursorCol=0,this._lastContentCursorRow=0,this._lastContentCursorCol=0,this._thisRowLastChar=this._buffer.getNullCell(),this._thisRowLastSecondChar=this._buffer.getNullCell(),this._nextRowFirstChar=this._buffer.getNullCell()}_beforeSerialize(a,f,v){this._allRows=new Array(a),this._lastContentCursorRow=f,this._lastCursorRow=f,this._firstRow=f}_rowEnd(a,f){var v;this._nullCellCount>0&&!e(this._cursorStyle,this._backgroundCell)&&(this._currentRow+=`\x1B[${this._nullCellCount}X`);let p="";if(!f){a-this._firstRow>=this._terminal.rows&&((v=this._buffer.getLine(this._cursorStyleRow))===null||v===void 0||v.getCell(this._cursorStyleCol,this._backgroundCell));let r=this._buffer.getLine(a),_=this._buffer.getLine(a+1);if(_.isWrapped){p="";let g=r.getCell(r.length-1,this._thisRowLastChar),h=r.getCell(r.length-2,this._thisRowLastSecondChar),m=_.getCell(0,this._nextRowFirstChar),y=m.getWidth()>1,b=!1;(m.getChars()&&y?this._nullCellCount<=1:this._nullCellCount<=0)&&((g.getChars()||g.getWidth()===0)&&e(g,m)&&(b=!0),y&&(h.getChars()||h.getWidth()===0)&&e(g,m)&&e(h,m)&&(b=!0)),b||(p="-".repeat(this._nullCellCount+1),p+="\x1B[1D\x1B[1X",this._nullCellCount>0&&(p+="\x1B[A",p+=`\x1B[${r.length-this._nullCellCount}C`,p+=`\x1B[${this._nullCellCount}X`,p+=`\x1B[${r.length-this._nullCellCount}D`,p+="\x1B[B"),this._lastContentCursorRow=a+1,this._lastContentCursorCol=0,this._lastCursorRow=a+1,this._lastCursorCol=0)}else p=`\r
`,this._lastCursorRow=a+1,this._lastCursorCol=0}this._allRows[this._rowIndex]=this._currentRow,this._allRowSeparators[this._rowIndex++]=p,this._currentRow="",this._nullCellCount=0}_diffStyle(a,f){let v=[],p=!o(a,f),r=!e(a,f),_=!i(a,f);if(p||r||_)if(a.isAttributeDefault())f.isAttributeDefault()||v.push(0);else{if(p){let g=a.getFgColor();a.isFgRGB()?v.push(38,2,g>>>16&255,g>>>8&255,255&g):a.isFgPalette()?g>=16?v.push(38,5,g):v.push(8&g?90+(7&g):30+(7&g)):v.push(39)}if(r){let g=a.getBgColor();a.isBgRGB()?v.push(48,2,g>>>16&255,g>>>8&255,255&g):a.isBgPalette()?g>=16?v.push(48,5,g):v.push(8&g?100+(7&g):40+(7&g)):v.push(49)}_&&(a.isInverse()!==f.isInverse()&&v.push(a.isInverse()?7:27),a.isBold()!==f.isBold()&&v.push(a.isBold()?1:22),a.isUnderline()!==f.isUnderline()&&v.push(a.isUnderline()?4:24),a.isBlink()!==f.isBlink()&&v.push(a.isBlink()?5:25),a.isInvisible()!==f.isInvisible()&&v.push(a.isInvisible()?8:28),a.isItalic()!==f.isItalic()&&v.push(a.isItalic()?3:23),a.isDim()!==f.isDim()&&v.push(a.isDim()?2:22),a.isStrikethrough()!==f.isStrikethrough()&&v.push(a.isStrikethrough()?9:29))}return v}_nextCell(a,f,v,p){if(a.getWidth()===0)return;let r=a.getChars()==="",_=this._diffStyle(a,this._cursorStyle);if(r?!e(this._cursorStyle,a):_.length>0){this._nullCellCount>0&&(e(this._cursorStyle,this._backgroundCell)||(this._currentRow+=`\x1B[${this._nullCellCount}X`),this._currentRow+=`\x1B[${this._nullCellCount}C`,this._nullCellCount=0),this._lastContentCursorRow=this._lastCursorRow=v,this._lastContentCursorCol=this._lastCursorCol=p,this._currentRow+=`\x1B[${_.join(";")}m`;let g=this._buffer.getLine(v);g!==void 0&&(g.getCell(p,this._cursorStyle),this._cursorStyleRow=v,this._cursorStyleCol=p)}r?this._nullCellCount+=a.getWidth():(this._nullCellCount>0&&(e(this._cursorStyle,this._backgroundCell)||(this._currentRow+=`\x1B[${this._nullCellCount}X`),this._currentRow+=`\x1B[${this._nullCellCount}C`,this._nullCellCount=0),this._currentRow+=a.getChars(),this._lastContentCursorRow=this._lastCursorRow=v,this._lastContentCursorCol=this._lastCursorCol=p+a.getWidth())}_serializeString(){let a=this._allRows.length;this._buffer.length-this._firstRow<=this._terminal.rows&&(a=this._lastContentCursorRow+1-this._firstRow,this._lastCursorCol=this._lastContentCursorCol,this._lastCursorRow=this._lastContentCursorRow);let f="";for(let h=0;h<a;h++)f+=this._allRows[h],h+1<a&&(f+=this._allRowSeparators[h]);let v=this._buffer.baseY+this._buffer.cursorY,p=this._buffer.cursorX;var r;(v!==this._lastCursorRow||p!==this._lastCursorCol)&&((r=v-this._lastCursorRow)>0?f+=`\x1B[${r}B`:r<0&&(f+=`\x1B[${-r}A`),(h=>{h>0?f+=`\x1B[${h}C`:h<0&&(f+=`\x1B[${-h}D`)})(p-this._lastCursorCol));let _=this._terminal._core._inputHandler._curAttrData,g=this._diffStyle(_,this._cursorStyle);return g.length>0&&(f+=`\x1B[${g.join(";")}m`),f}}s.SerializeAddon=class{constructor(){}activate(d){this._terminal=d}_serializeBuffer(d,a,f){let v=a.length,p=new l(a,d),r=f===void 0?v:n(f+d.rows,0,v);return p.serialize({start:{x:v-r,y:0},end:{x:v-1,y:d.cols}})}_serializeBufferAsHTML(d,a){var f,v;let p=d.buffer.active,r=new u(p,d,a);if((f=a.onlySelection)===null||f===void 0||!f){let g=p.length,h=a.scrollback,m=h===void 0?g:n(h+d.rows,0,g);return r.serialize({start:{x:g-m,y:0},end:{x:g-1,y:d.cols}})}let _=(v=this._terminal)===null||v===void 0?void 0:v.getSelectionPosition();return _!==void 0?r.serialize({start:{x:_.start.y,y:_.start.x},end:{x:_.end.y,y:_.end.x}}):""}_serializeModes(d){let a="",f=d.modes;if(f.applicationCursorKeysMode&&(a+="\x1B[?1h"),f.applicationKeypadMode&&(a+="\x1B[?66h"),f.bracketedPasteMode&&(a+="\x1B[?2004h"),f.insertMode&&(a+="\x1B[4h"),f.originMode&&(a+="\x1B[?6h"),f.reverseWraparoundMode&&(a+="\x1B[?45h"),f.sendFocusMode&&(a+="\x1B[?1004h"),f.wraparoundMode===!1&&(a+="\x1B[?7l"),f.mouseTrackingMode!=="none")switch(f.mouseTrackingMode){case"x10":a+="\x1B[?9h";break;case"vt200":a+="\x1B[?1000h";break;case"drag":a+="\x1B[?1002h";break;case"any":a+="\x1B[?1003h"}return a}serialize(d){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let a=this._serializeBuffer(this._terminal,this._terminal.buffer.normal,d==null?void 0:d.scrollback);return d!=null&&d.excludeAltBuffer||this._terminal.buffer.active.type!=="alternate"||(a+=`\x1B[?1049h\x1B[H${this._serializeBuffer(this._terminal,this._terminal.buffer.alternate,void 0)}`),d!=null&&d.excludeModes||(a+=this._serializeModes(this._terminal)),a}serializeAsHTML(d){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._serializeBufferAsHTML(this._terminal,d||{})}dispose(){}};class u extends c{constructor(a,f,v){super(a),this._terminal=f,this._options=v,this._currentRow="",this._htmlContent="",this._colors=f._core._themeService.colors}_padStart(a,f,v){return f>>=0,v=v!=null?v:" ",a.length>f?a:((f-=a.length)>v.length&&(v+=v.repeat(f/v.length)),v.slice(0,f)+a)}_beforeSerialize(a,f,v){var p,r,_,g,h;this._htmlContent+="<html><body><!--StartFragment--><pre>";let m="#000000",y="#ffffff";(p=this._options.includeGlobalBackground)!==null&&p!==void 0&&p&&(m=(_=(r=this._terminal.options.theme)===null||r===void 0?void 0:r.foreground)!==null&&_!==void 0?_:"#ffffff",y=(h=(g=this._terminal.options.theme)===null||g===void 0?void 0:g.background)!==null&&h!==void 0?h:"#000000");let b=[];b.push("color: "+m+";"),b.push("background-color: "+y+";"),b.push("font-family: "+this._terminal.options.fontFamily+";"),b.push("font-size: "+this._terminal.options.fontSize+"px;"),this._htmlContent+="<div style='"+b.join(" ")+"'>"}_afterSerialize(){this._htmlContent+="</div>",this._htmlContent+="</pre><!--EndFragment--></body></html>"}_rowEnd(a,f){this._htmlContent+="<div><span>"+this._currentRow+"</span></div>",this._currentRow=""}_getHexColor(a,f){let v=f?a.getFgColor():a.getBgColor();return(f?a.isFgRGB():a.isBgRGB())?[v>>16&255,v>>8&255,255&v].map(p=>this._padStart(p.toString(16),2,"0")).join(""):(f?a.isFgPalette():a.isBgPalette())?this._colors.ansi[v].css:void 0}_diffStyle(a,f){let v=[],p=!o(a,f),r=!e(a,f),_=!i(a,f);if(p||r||_){let g=this._getHexColor(a,!0);g&&v.push("color: "+g+";");let h=this._getHexColor(a,!1);return h&&v.push("background-color: "+h+";"),a.isInverse()&&v.push("color: #000000; background-color: #BFBFBF;"),a.isBold()&&v.push("font-weight: bold;"),a.isUnderline()&&v.push("text-decoration: underline;"),a.isBlink()&&v.push("text-decoration: blink;"),a.isInvisible()&&v.push("visibility: hidden;"),a.isItalic()&&v.push("font-style: italic;"),a.isDim()&&v.push("opacity: 0.5;"),a.isStrikethrough()&&v.push("text-decoration: line-through;"),v}}_nextCell(a,f,v,p){if(a.getWidth()===0)return;let r=a.getChars()==="",_=this._diffStyle(a,f);_&&(this._currentRow+=_.length===0?"</span><span>":"</span><span style='"+_.join(" ")+"'>"),this._currentRow+=r?" ":a.getChars()}_serializeString(){return this._htmlContent}}s.HTMLSerializeHandler=u})(),t})()})});var Un=te((yr,Ti)=>{(function(t,s){typeof yr=="object"&&typeof Ti=="object"?Ti.exports=s():typeof define=="function"&&define.amd?define([],s):typeof yr=="object"?yr.FitAddon=s():t.FitAddon=s()})(self,function(){return(()=>{"use strict";var t={};return(()=>{var s=t;Object.defineProperty(s,"__esModule",{value:!0}),s.FitAddon=void 0,s.FitAddon=class{constructor(){}activate(n){this._terminal=n}dispose(){}fit(){let n=this.proposeDimensions();if(!n||!this._terminal||isNaN(n.cols)||isNaN(n.rows))return;let c=this._terminal._core;this._terminal.rows===n.rows&&this._terminal.cols===n.cols||(c._renderService.clear(),this._terminal.resize(n.cols,n.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let n=this._terminal._core,c=n._renderService.dimensions;if(c.css.cell.width===0||c.css.cell.height===0)return;let o=this._terminal.options.scrollback===0?0:n.viewport.scrollBarWidth,e=window.getComputedStyle(this._terminal.element.parentElement),i=parseInt(e.getPropertyValue("height")),l=Math.max(0,parseInt(e.getPropertyValue("width"))),u=window.getComputedStyle(this._terminal.element),d=i-(parseInt(u.getPropertyValue("padding-top"))+parseInt(u.getPropertyValue("padding-bottom"))),a=l-(parseInt(u.getPropertyValue("padding-right"))+parseInt(u.getPropertyValue("padding-left")))-o;return{cols:Math.max(2,Math.floor(a/c.css.cell.width)),rows:Math.max(1,Math.floor(d/c.css.cell.height))}}}})(),t})()})});var zn=te((br,Oi)=>{(function(t,s){typeof br=="object"&&typeof Oi=="object"?Oi.exports=s():typeof define=="function"&&define.amd?define([],s):typeof br=="object"?br.SearchAddon=s():t.SearchAddon=s()})(self,function(){return(()=>{"use strict";var t={345:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.forwardEvent=e.EventEmitter=void 0,e.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=i=>(this._listeners.push(i),{dispose:()=>{if(!this._disposed){for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===i)return void this._listeners.splice(l,1)}}})),this._event}fire(i,l){let u=[];for(let d=0;d<this._listeners.length;d++)u.push(this._listeners[d]);for(let d=0;d<u.length;d++)u[d].call(void 0,i,l)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},e.forwardEvent=function(i,l){return i(u=>l.fire(u))}},859:(o,e)=>{function i(l){for(let u of l)u.dispose();l.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.toDisposable=e.Disposable=void 0,e.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let l of this._disposables)l.dispose();this._disposables.length=0}register(l){return this._disposables.push(l),l}unregister(l){let u=this._disposables.indexOf(l);u!==-1&&this._disposables.splice(u,1)}},e.toDisposable=function(l){return{dispose:l}},e.disposeArray=i,e.getDisposeArrayDisposable=function(l){return{dispose:()=>i(l)}}}},s={};function n(o){var e=s[o];if(e!==void 0)return e.exports;var i=s[o]={exports:{}};return t[o](i,i.exports,n),i.exports}var c={};return(()=>{var o=c;Object.defineProperty(o,"__esModule",{value:!0}),o.SearchAddon=void 0;let e=n(345),i=n(859),l=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";class u extends i.Disposable{constructor(){super(...arguments),this._linesCacheTimeoutId=0,this._onDidChangeResults=this.register(new e.EventEmitter),this.onDidChangeResults=this._onDidChangeResults.event}activate(a){this._terminal=a,this._onDataDisposable=this.register(this._terminal.onWriteParsed(()=>this._updateMatches())),this._onResizeDisposable=this.register(this._terminal.onResize(()=>this._updateMatches())),this.register((0,i.toDisposable)(()=>{var f,v;this.clearDecorations(),(f=this._onDataDisposable)===null||f===void 0||f.dispose(),(v=this._onResizeDisposable)===null||v===void 0||v.dispose()}))}_updateMatches(){var a;this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&(!((a=this._lastSearchOptions)===null||a===void 0)&&a.decorations)&&(this._highlightTimeout=setTimeout(()=>{var f,v;this.findPrevious(this._cachedSearchTerm,Object.assign(Object.assign({},this._lastSearchOptions),{incremental:!0,noScroll:!0})),this._resultIndex=this._searchResults?this._searchResults.size-1:-1,this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:(v=(f=this._searchResults)===null||f===void 0?void 0:f.size)!==null&&v!==void 0?v:-1})},200))}clearDecorations(a){var f,v,p,r;(f=this._selectedDecoration)===null||f===void 0||f.dispose(),(v=this._searchResults)===null||v===void 0||v.clear(),(p=this._resultDecorations)===null||p===void 0||p.forEach(_=>{for(let g of _)g.dispose()}),(r=this._resultDecorations)===null||r===void 0||r.clear(),this._searchResults=void 0,this._resultDecorations=void 0,a||(this._cachedSearchTerm=void 0)}clearActiveDecoration(){var a;(a=this._selectedDecoration)===null||a===void 0||a.dispose(),this._selectedDecoration=void 0}findNext(a,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=f,f!=null&&f.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&a===this._cachedSearchTerm||this._highlightAllMatches(a,f)),this._fireResults(a,this._findNextAndSelect(a,f),f)}_highlightAllMatches(a,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!a||a.length===0)return void this.clearDecorations();f=f||{},this.clearDecorations(!0),this._searchResults=new Map,this._resultDecorations=new Map;let v=this._resultDecorations,p=this._find(a,0,0,f);for(;p&&!this._searchResults.get(`${p.row}-${p.col}`);)if(this._searchResults.set(`${p.row}-${p.col}`,p),p=this._find(a,p.col+p.term.length>=this._terminal.cols?p.row+1:p.row,p.col+p.term.length>=this._terminal.cols?0:p.col+1,f),this._searchResults.size>1e3)return this.clearDecorations(),void(this._resultIndex=void 0);this._searchResults.forEach(r=>{let _=this._createResultDecoration(r,f.decorations);if(_){let g=v.get(_.marker.line)||[];g.push(_),v.set(_.marker.line,g)}})}_find(a,f,v,p){var r;if(!this._terminal||!a||a.length===0)return(r=this._terminal)===null||r===void 0||r.clearSelection(),void this.clearDecorations();if(v>this._terminal.cols)throw new Error(`Invalid col: ${v} to search in terminal of ${this._terminal.cols} cols`);let _;this._initLinesCache();let g={startRow:f,startCol:v};if(_=this._findInLine(a,g,p),!_)for(let h=f+1;h<this._terminal.buffer.active.baseY+this._terminal.rows&&(g.startRow=h,g.startCol=0,_=this._findInLine(a,g,p),!_);h++);return _}_findNextAndSelect(a,f){var v;if(!this._terminal||!a||a.length===0)return(v=this._terminal)===null||v===void 0||v.clearSelection(),this.clearDecorations(),this._cachedSearchTerm=void 0,this._resultIndex=-1,!1;this._cachedSearchTerm!==a&&(this._resultIndex=void 0,this._terminal.clearSelection());let p,r=0,_=0;if(this._terminal.hasSelection()){let m=!!f&&f.incremental;p=this._terminal.getSelectionPosition(),_=m?p.start.y:p.end.y,r=m?p.start.x:p.end.x}this._initLinesCache();let g={startRow:_,startCol:r},h=this._findInLine(a,g,f);if(!h)for(let m=_+1;m<this._terminal.buffer.active.baseY+this._terminal.rows&&(g.startRow=m,g.startCol=0,h=this._findInLine(a,g,f),!h);m++);if(!h&&_!==0)for(let m=0;m<_&&(g.startRow=m,g.startCol=0,h=this._findInLine(a,g,f),!h);m++);return!h&&p&&(g.startRow=p.start.y,g.startCol=0,h=this._findInLine(a,g,f)),this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0?this._resultIndex=0:(this._resultIndex++,this._resultIndex>=this._searchResults.size&&(this._resultIndex=0))),this._selectResult(h,f==null?void 0:f.decorations,f==null?void 0:f.noScroll)}findPrevious(a,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=f,f!=null&&f.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&a===this._cachedSearchTerm||this._highlightAllMatches(a,f)),this._fireResults(a,this._findPreviousAndSelect(a,f),f)}_fireResults(a,f,v){var p;return v!=null&&v.decorations&&(this._resultIndex!==void 0&&((p=this._searchResults)===null||p===void 0?void 0:p.size)!==void 0?this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:this._searchResults.size}):this._onDidChangeResults.fire(void 0)),this._cachedSearchTerm=a,f}_findPreviousAndSelect(a,f){var v;if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let p;if(!this._terminal||!a||a.length===0)return p=void 0,(v=this._terminal)===null||v===void 0||v.clearSelection(),this.clearDecorations(),this._resultIndex=-1,!1;this._cachedSearchTerm!==a&&(this._resultIndex=void 0,this._terminal.clearSelection());let r=this._terminal.buffer.active.baseY+this._terminal.rows,_=this._terminal.cols,g=!0,h=!!f&&f.incremental,m;this._terminal.hasSelection()&&(m=this._terminal.getSelectionPosition(),r=m.start.y,_=m.start.x),this._initLinesCache();let y={startRow:r,startCol:_};if(h?(p=this._findInLine(a,y,f,!1),p&&p.row===r&&p.col===_||(m&&(y.startRow=m.end.y,y.startCol=m.end.x),p=this._findInLine(a,y,f,!0))):p=this._findInLine(a,y,f,g),!p){y.startCol=Math.max(y.startCol,this._terminal.cols);for(let b=r-1;b>=0&&(y.startRow=b,p=this._findInLine(a,y,f,g),!p);b--);}if(!p&&r!==this._terminal.buffer.active.baseY+this._terminal.rows)for(let b=this._terminal.buffer.active.baseY+this._terminal.rows;b>=r&&(y.startRow=b,p=this._findInLine(a,y,f,g),!p);b--);return this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0||this._resultIndex<0?this._resultIndex=this._searchResults.size-1:(this._resultIndex--,this._resultIndex===-1&&(this._resultIndex=this._searchResults.size-1))),!(p||!m)||this._selectResult(p,f==null?void 0:f.decorations,f==null?void 0:f.noScroll)}_initLinesCache(){let a=this._terminal;this._linesCache||(this._linesCache=new Array(a.buffer.active.length),this._cursorMoveListener=a.onCursorMove(()=>this._destroyLinesCache()),this._resizeListener=a.onResize(()=>this._destroyLinesCache())),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._cursorMoveListener&&(this._cursorMoveListener.dispose(),this._cursorMoveListener=void 0),this._resizeListener&&(this._resizeListener.dispose(),this._resizeListener=void 0),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(a,f,v){return(a===0||l.includes(f[a-1]))&&(a+v.length===f.length||l.includes(f[a+v.length]))}_findInLine(a,f,v={},p=!1){var r;let _=this._terminal,g=f.startRow,h=f.startCol,m=_.buffer.active.getLine(g);if(m!=null&&m.isWrapped)return p?void(f.startCol+=_.cols):(f.startRow--,f.startCol+=_.cols,this._findInLine(a,f,v));let y=(r=this._linesCache)===null||r===void 0?void 0:r[g];y||(y=this._translateBufferLineToStringWithWrap(g,!0),this._linesCache&&(this._linesCache[g]=y));let[b,w]=y,S=this._bufferColsToStringOffset(g,h),C=v.caseSensitive?a:a.toLowerCase(),x=v.caseSensitive?b:b.toLowerCase(),L=-1;if(v.regex){let R=RegExp(C,"g"),T;if(p)for(;T=R.exec(x.slice(0,S));)L=R.lastIndex-T[0].length,a=T[0],R.lastIndex-=a.length-1;else T=R.exec(x.slice(S)),T&&T[0].length>0&&(L=S+(R.lastIndex-T[0].length),a=T[0])}else p?S-C.length>=0&&(L=x.lastIndexOf(C,S-C.length)):L=x.indexOf(C,S);if(L>=0){if(v.wholeWord&&!this._isWholeWord(L,x,a))return;let R=0;for(;R<w.length-1&&L>=w[R+1];)R++;let T=R;for(;T<w.length-1&&L+a.length>=w[T+1];)T++;let I=L-w[R],N=L+a.length-w[T],F=this._stringLengthToBufferSize(g+R,I);return{term:a,col:F,row:g+R,size:this._stringLengthToBufferSize(g+T,N)-F+_.cols*(T-R)}}}_stringLengthToBufferSize(a,f){let v=this._terminal.buffer.active.getLine(a);if(!v)return 0;for(let p=0;p<f;p++){let r=v.getCell(p);if(!r)break;let _=r.getChars();_.length>1&&(f-=_.length-1);let g=v.getCell(p+1);g&&g.getWidth()===0&&f++}return f}_bufferColsToStringOffset(a,f){let v=this._terminal,p=a,r=0,_=v.buffer.active.getLine(p);for(;f>0&&_;){for(let g=0;g<f&&g<v.cols;g++){let h=_.getCell(g);if(!h)break;h.getWidth()&&(r+=h.getCode()===0?1:h.getChars().length)}if(p++,_=v.buffer.active.getLine(p),_&&!_.isWrapped)break;f-=v.cols}return r}_translateBufferLineToStringWithWrap(a,f){var v;let p=this._terminal,r=[],_=[0],g=p.buffer.active.getLine(a);for(;g;){let h=p.buffer.active.getLine(a+1),m=!!h&&h.isWrapped,y=g.translateToString(!m&&f);if(m&&h){let b=g.getCell(g.length-1);b&&b.getCode()===0&&b.getWidth()===1&&((v=h.getCell(0))===null||v===void 0?void 0:v.getWidth())===2&&(y=y.slice(0,-1))}if(r.push(y),!m)break;_.push(_[_.length-1]+y.length),a++,g=h}return[r.join(""),_]}_selectResult(a,f,v){var p,r;let _=this._terminal;if(this.clearActiveDecoration(),!a)return _.clearSelection(),!1;if(_.select(a.col,a.row,a.size),f){let g=_.registerMarker(-_.buffer.active.baseY-_.buffer.active.cursorY+a.row);g&&(this._selectedDecoration=_.registerDecoration({marker:g,x:a.col,width:a.size,backgroundColor:f.activeMatchBackground,layer:"top",overviewRulerOptions:{color:f.activeMatchColorOverviewRuler}}),(p=this._selectedDecoration)===null||p===void 0||p.onRender(h=>this._applyStyles(h,f.activeMatchBorder,!0)),(r=this._selectedDecoration)===null||r===void 0||r.onDispose(()=>g.dispose()))}if(!v&&(a.row>=_.buffer.active.viewportY+_.rows||a.row<_.buffer.active.viewportY)){let g=a.row-_.buffer.active.viewportY;g-=Math.floor(_.rows/2),_.scrollLines(g)}return!0}_applyStyles(a,f,v){a.clientWidth<=0||(a.classList.contains("xterm-find-result-decoration")||(a.classList.add("xterm-find-result-decoration"),f&&(a.style.outline=`1px solid ${f}`)),v&&a.classList.add("xterm-find-active-result-decoration"))}_createResultDecoration(a,f){var v;let p=this._terminal,r=p.registerMarker(-p.buffer.active.baseY-p.buffer.active.cursorY+a.row);if(!r)return;let _=p.registerDecoration({marker:r,x:a.col,width:a.size,backgroundColor:f.matchBackground,overviewRulerOptions:!((v=this._resultDecorations)===null||v===void 0)&&v.get(r.line)?void 0:{color:f.matchOverviewRuler,position:"center"}});return _==null||_.onRender(g=>this._applyStyles(g,f.matchBorder,!1)),_==null||_.onDispose(()=>r.dispose()),_}}o.SearchAddon=u})(),c})()})});var Kn=te((Cr,Ai)=>{(function(t,s){if(typeof Cr=="object"&&typeof Ai=="object")Ai.exports=s();else if(typeof define=="function"&&define.amd)define([],s);else{var n=s();for(var c in n)(typeof Cr=="object"?Cr:t)[c]=n[c]}})(self,function(){return(()=>{"use strict";var t={4567:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AccessibilityManager=void 0;let l=i(9042),u=i(6114),d=i(9924),a=i(3656),f=i(844),v=i(5596),p=i(9631);class r extends f.Disposable{constructor(g,h){super(),this._terminal=g,this._renderService=h,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityTreeRoot=document.createElement("div"),this._accessibilityTreeRoot.classList.add("xterm-accessibility"),this._accessibilityTreeRoot.tabIndex=0,this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let m=0;m<this._terminal.rows;m++)this._rowElements[m]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[m]);if(this._topBoundaryFocusListener=m=>this._handleBoundaryFocus(m,0),this._bottomBoundaryFocusListener=m=>this._handleBoundaryFocus(m,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityTreeRoot.appendChild(this._rowContainer),this._renderRowsDebouncer=new d.TimeBasedDebouncer(this._renderRows.bind(this)),this._refreshRows(),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityTreeRoot.appendChild(this._liveRegion),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityTreeRoot),this.register(this._renderRowsDebouncer),this.register(this._terminal.onResize(m=>this._handleResize(m.rows))),this.register(this._terminal.onRender(m=>this._refreshRows(m.start,m.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(m=>this._handleChar(m))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(m=>this._handleTab(m))),this.register(this._terminal.onKey(m=>this._handleKey(m.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new v.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,a.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this.register((0,f.toDisposable)(()=>{(0,p.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0}))}_handleBoundaryFocus(g,h){let m=g.target,y=this._rowElements[h===0?1:this._rowElements.length-2];if(m.getAttribute("aria-posinset")===(h===0?"1":`${this._terminal.buffer.lines.length}`)||g.relatedTarget!==y)return;let b,w;if(h===0?(b=m,w=this._rowElements.pop(),this._rowContainer.removeChild(w)):(b=this._rowElements.shift(),w=m,this._rowContainer.removeChild(b)),b.removeEventListener("focus",this._topBoundaryFocusListener),w.removeEventListener("focus",this._bottomBoundaryFocusListener),h===0){let S=this._createAccessibilityTreeNode();this._rowElements.unshift(S),this._rowContainer.insertAdjacentElement("afterbegin",S)}else{let S=this._createAccessibilityTreeNode();this._rowElements.push(S),this._rowContainer.appendChild(S)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(h===0?-1:1),this._rowElements[h===0?1:this._rowElements.length-2].focus(),g.preventDefault(),g.stopImmediatePropagation()}_handleResize(g){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let h=this._rowContainer.children.length;h<this._terminal.rows;h++)this._rowElements[h]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[h]);for(;this._rowElements.length>g;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let g=document.createElement("div");return g.setAttribute("role","listitem"),g.tabIndex=-1,this._refreshRowDimensions(g),g}_handleTab(g){for(let h=0;h<g;h++)this._handleChar(" ")}_handleChar(g){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==g&&(this._charsToAnnounce+=g):this._charsToAnnounce+=g,g===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=l.tooMuchOutput)),u.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityTreeRoot.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,u.isMac&&(0,p.removeElementFromParent)(this._liveRegion)}_handleKey(g){this._clearLiveRegion(),/\p{Control}/u.test(g)||this._charsToConsume.push(g)}_refreshRows(g,h){this._renderRowsDebouncer.refresh(g,h,this._terminal.rows)}_renderRows(g,h){let m=this._terminal.buffer,y=m.lines.length.toString();for(let b=g;b<=h;b++){let w=m.translateBufferLineToString(m.ydisp+b,!0),S=(m.ydisp+b+1).toString(),C=this._rowElements[b];C&&(w.length===0?C.innerText="\xA0":C.textContent=w,C.setAttribute("aria-posinset",S),C.setAttribute("aria-setsize",y))}this._announceCharacters()}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityTreeRoot.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let g=0;g<this._terminal.rows;g++)this._refreshRowDimensions(this._rowElements[g])}}_refreshRowDimensions(g){g.style.height=`${this._renderService.dimensions.css.cell.height}px`}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}}e.AccessibilityManager=r},3614:(o,e)=>{function i(a){return a.replace(/\r?\n/g,"\r")}function l(a,f){return f?"\x1B[200~"+a+"\x1B[201~":a}function u(a,f,v){a=l(a=i(a),v.decPrivateModes.bracketedPasteMode),v.triggerDataEvent(a,!0),f.value=""}function d(a,f,v){let p=v.getBoundingClientRect(),r=a.clientX-p.left-10,_=a.clientY-p.top-10;f.style.width="20px",f.style.height="20px",f.style.left=`${r}px`,f.style.top=`${_}px`,f.style.zIndex="1000",f.focus()}Object.defineProperty(e,"__esModule",{value:!0}),e.rightClickHandler=e.moveTextAreaUnderMouseCursor=e.paste=e.handlePasteEvent=e.copyHandler=e.bracketTextForPaste=e.prepareTextForTerminal=void 0,e.prepareTextForTerminal=i,e.bracketTextForPaste=l,e.copyHandler=function(a,f){a.clipboardData&&a.clipboardData.setData("text/plain",f.selectionText),a.preventDefault()},e.handlePasteEvent=function(a,f,v){a.stopPropagation(),a.clipboardData&&u(a.clipboardData.getData("text/plain"),f,v)},e.paste=u,e.moveTextAreaUnderMouseCursor=d,e.rightClickHandler=function(a,f,v,p,r){d(a,f,v),r&&p.rightClickSelect(a),f.value=p.selectionText,f.select()}},7239:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorContrastCache=void 0;let l=i(1505);e.ColorContrastCache=class{constructor(){this._color=new l.TwoKeyMap,this._css=new l.TwoKeyMap}setCss(u,d,a){this._css.set(u,d,a)}getCss(u,d){return this._css.get(u,d)}setColor(u,d,a){this._color.set(u,d,a)}getColor(u,d){return this._color.get(u,d)}clear(){this._color.clear(),this._css.clear()}}},9631:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.removeElementFromParent=void 0,e.removeElementFromParent=function(...i){var l;for(let u of i)(l=u==null?void 0:u.parentElement)===null||l===void 0||l.removeChild(u)}},3656:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.addDisposableDomListener=void 0,e.addDisposableDomListener=function(i,l,u,d){i.addEventListener(l,u,d);let a=!1;return{dispose:()=>{a||(a=!0,i.removeEventListener(l,u,d))}}}},6465:function(o,e,i){var l=this&&this.__decorate||function(r,_,g,h){var m,y=arguments.length,b=y<3?_:h===null?h=Object.getOwnPropertyDescriptor(_,g):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,_,g,h);else for(var w=r.length-1;w>=0;w--)(m=r[w])&&(b=(y<3?m(b):y>3?m(_,g,b):m(_,g))||b);return y>3&&b&&Object.defineProperty(_,g,b),b},u=this&&this.__param||function(r,_){return function(g,h){_(g,h,r)}};Object.defineProperty(e,"__esModule",{value:!0}),e.Linkifier2=void 0;let d=i(2585),a=i(8460),f=i(844),v=i(3656),p=class extends f.Disposable{constructor(r){super(),this._bufferService=r,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._activeLine=-1,this._onShowLinkUnderline=this.register(new a.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new a.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,f.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,f.toDisposable)(()=>{this._lastMouseEvent=void 0}))}get currentLink(){return this._currentLink}registerLinkProvider(r){return this._linkProviders.push(r),{dispose:()=>{let _=this._linkProviders.indexOf(r);_!==-1&&this._linkProviders.splice(_,1)}}}attachToDom(r,_,g){this._element=r,this._mouseService=_,this._renderService=g,this.register((0,v.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,v.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,v.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,v.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(r){if(this._lastMouseEvent=r,!this._element||!this._mouseService)return;let _=this._positionFromMouseEvent(r,this._element,this._mouseService);if(!_)return;this._isMouseOut=!1;let g=r.composedPath();for(let h=0;h<g.length;h++){let m=g[h];if(m.classList.contains("xterm"))break;if(m.classList.contains("xterm-hover"))return}this._lastBufferCell&&_.x===this._lastBufferCell.x&&_.y===this._lastBufferCell.y||(this._handleHover(_),this._lastBufferCell=_)}_handleHover(r){if(this._activeLine!==r.y)return this._clearCurrentLink(),void this._askForLink(r,!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,r)||(this._clearCurrentLink(),this._askForLink(r,!0))}_askForLink(r,_){var g,h;this._activeProviderReplies&&_||((g=this._activeProviderReplies)===null||g===void 0||g.forEach(y=>{y==null||y.forEach(b=>{b.link.dispose&&b.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=r.y);let m=!1;for(let[y,b]of this._linkProviders.entries())_?!((h=this._activeProviderReplies)===null||h===void 0)&&h.get(y)&&(m=this._checkLinkProviderResult(y,r,m)):b.provideLinks(r.y,w=>{var S,C;if(this._isMouseOut)return;let x=w==null?void 0:w.map(L=>({link:L}));(S=this._activeProviderReplies)===null||S===void 0||S.set(y,x),m=this._checkLinkProviderResult(y,r,m),((C=this._activeProviderReplies)===null||C===void 0?void 0:C.size)===this._linkProviders.length&&this._removeIntersectingLinks(r.y,this._activeProviderReplies)})}_removeIntersectingLinks(r,_){let g=new Set;for(let h=0;h<_.size;h++){let m=_.get(h);if(m)for(let y=0;y<m.length;y++){let b=m[y],w=b.link.range.start.y<r?0:b.link.range.start.x,S=b.link.range.end.y>r?this._bufferService.cols:b.link.range.end.x;for(let C=w;C<=S;C++){if(g.has(C)){m.splice(y--,1);break}g.add(C)}}}}_checkLinkProviderResult(r,_,g){var h;if(!this._activeProviderReplies)return g;let m=this._activeProviderReplies.get(r),y=!1;for(let b=0;b<r;b++)this._activeProviderReplies.has(b)&&!this._activeProviderReplies.get(b)||(y=!0);if(!y&&m){let b=m.find(w=>this._linkAtPosition(w.link,_));b&&(g=!0,this._handleNewLink(b))}if(this._activeProviderReplies.size===this._linkProviders.length&&!g)for(let b=0;b<this._activeProviderReplies.size;b++){let w=(h=this._activeProviderReplies.get(b))===null||h===void 0?void 0:h.find(S=>this._linkAtPosition(S.link,_));if(w){g=!0,this._handleNewLink(w);break}}return g}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(r){if(!this._element||!this._mouseService||!this._currentLink)return;let _=this._positionFromMouseEvent(r,this._element,this._mouseService);_&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,_)&&this._currentLink.link.activate(r,this._currentLink.link.text)}_clearCurrentLink(r,_){this._element&&this._currentLink&&this._lastMouseEvent&&(!r||!_||this._currentLink.link.range.start.y>=r&&this._currentLink.link.range.end.y<=_)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,f.disposeArray)(this._linkCacheDisposables))}_handleNewLink(r){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;let _=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);_&&this._linkAtPosition(r.link,_)&&(this._currentLink=r,this._currentLink.state={decorations:{underline:r.link.decorations===void 0||r.link.decorations.underline,pointerCursor:r.link.decorations===void 0||r.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,r.link,this._lastMouseEvent),r.link.decorations={},Object.defineProperties(r.link.decorations,{pointerCursor:{get:()=>{var g,h;return(h=(g=this._currentLink)===null||g===void 0?void 0:g.state)===null||h===void 0?void 0:h.decorations.pointerCursor},set:g=>{var h,m;!((h=this._currentLink)===null||h===void 0)&&h.state&&this._currentLink.state.decorations.pointerCursor!==g&&(this._currentLink.state.decorations.pointerCursor=g,this._currentLink.state.isHovered&&((m=this._element)===null||m===void 0||m.classList.toggle("xterm-cursor-pointer",g)))}},underline:{get:()=>{var g,h;return(h=(g=this._currentLink)===null||g===void 0?void 0:g.state)===null||h===void 0?void 0:h.decorations.underline},set:g=>{var h,m,y;!((h=this._currentLink)===null||h===void 0)&&h.state&&((y=(m=this._currentLink)===null||m===void 0?void 0:m.state)===null||y===void 0?void 0:y.decorations.underline)!==g&&(this._currentLink.state.decorations.underline=g,this._currentLink.state.isHovered&&this._fireUnderlineEvent(r.link,g))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(g=>{let h=g.start===0?0:g.start+1+this._bufferService.buffer.ydisp,m=this._currentLink?this._lastMouseEvent:void 0;if(this._clearCurrentLink(h,g.end+1+this._bufferService.buffer.ydisp),m&&this._element){let y=this._positionFromMouseEvent(m,this._element,this._mouseService);y&&this._askForLink(y,!1)}})))}_linkHover(r,_,g){var h;!((h=this._currentLink)===null||h===void 0)&&h.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(_,!0),this._currentLink.state.decorations.pointerCursor&&r.classList.add("xterm-cursor-pointer")),_.hover&&_.hover(g,_.text)}_fireUnderlineEvent(r,_){let g=r.range,h=this._bufferService.buffer.ydisp,m=this._createLinkUnderlineEvent(g.start.x-1,g.start.y-h-1,g.end.x,g.end.y-h-1,void 0);(_?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(m)}_linkLeave(r,_,g){var h;!((h=this._currentLink)===null||h===void 0)&&h.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(_,!1),this._currentLink.state.decorations.pointerCursor&&r.classList.remove("xterm-cursor-pointer")),_.leave&&_.leave(g,_.text)}_linkAtPosition(r,_){let g=r.range.start.y*this._bufferService.cols+r.range.start.x,h=r.range.end.y*this._bufferService.cols+r.range.end.x,m=_.y*this._bufferService.cols+_.x;return g<=m&&m<=h}_positionFromMouseEvent(r,_,g){let h=g.getCoords(r,_,this._bufferService.cols,this._bufferService.rows);if(h)return{x:h[0],y:h[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(r,_,g,h,m){return{x1:r,y1:_,x2:g,y2:h,cols:this._bufferService.cols,fg:m}}};p=l([u(0,d.IBufferService)],p),e.Linkifier2=p},9042:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.tooMuchOutput=e.promptLabel=void 0,e.promptLabel="Terminal input",e.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(o,e,i){var l=this&&this.__decorate||function(p,r,_,g){var h,m=arguments.length,y=m<3?r:g===null?g=Object.getOwnPropertyDescriptor(r,_):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(p,r,_,g);else for(var b=p.length-1;b>=0;b--)(h=p[b])&&(y=(m<3?h(y):m>3?h(r,_,y):h(r,_))||y);return m>3&&y&&Object.defineProperty(r,_,y),y},u=this&&this.__param||function(p,r){return function(_,g){r(_,g,p)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OscLinkProvider=void 0;let d=i(511),a=i(2585),f=class{constructor(p,r,_){this._bufferService=p,this._optionsService=r,this._oscLinkService=_}provideLinks(p,r){var _;let g=this._bufferService.buffer.lines.get(p-1);if(!g)return void r(void 0);let h=[],m=this._optionsService.rawOptions.linkHandler,y=new d.CellData,b=g.getTrimmedLength(),w=-1,S=-1,C=!1;for(let x=0;x<b;x++)if(S!==-1||g.hasContent(x)){if(g.loadCell(x,y),y.hasExtendedAttrs()&&y.extended.urlId){if(S===-1){S=x,w=y.extended.urlId;continue}C=y.extended.urlId!==w}else S!==-1&&(C=!0);if(C||S!==-1&&x===b-1){let L=(_=this._oscLinkService.getLinkData(w))===null||_===void 0?void 0:_.uri;if(L){let R={start:{x:S+1,y:p},end:{x:x+(C||x!==b-1?0:1),y:p}},T=!1;if(!(m!=null&&m.allowNonHttpProtocols))try{let I=new URL(L);["http:","https:"].includes(I.protocol)||(T=!0)}catch(I){T=!0}T||h.push({text:L,range:R,activate:(I,N)=>m?m.activate(I,N,R):v(0,N),hover:(I,N)=>{var F;return(F=m==null?void 0:m.hover)===null||F===void 0?void 0:F.call(m,I,N,R)},leave:(I,N)=>{var F;return(F=m==null?void 0:m.leave)===null||F===void 0?void 0:F.call(m,I,N,R)}})}C=!1,y.hasExtendedAttrs()&&y.extended.urlId?(S=x,w=y.extended.urlId):(S=-1,w=-1)}}r(h)}};function v(p,r){if(confirm(`Do you want to navigate to ${r}?

WARNING: This link could potentially be dangerous`)){let _=window.open();if(_){try{_.opener=null}catch(g){}_.location.href=r}else console.warn("Opening link blocked as opener could not be cleared")}}f=l([u(0,a.IBufferService),u(1,a.IOptionsService),u(2,a.IOscLinkService)],f),e.OscLinkProvider=f},6193:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RenderDebouncer=void 0,e.RenderDebouncer=class{constructor(i,l){this._parentWindow=i,this._renderCallback=l,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(i){return this._refreshCallbacks.push(i),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(i,l,u){this._rowCount=u,i=i!==void 0?i:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,i):i,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();let i=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(i,l),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let i of this._refreshCallbacks)i(0);this._refreshCallbacks=[]}}},5596:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ScreenDprMonitor=void 0;let l=i(844);class u extends l.Disposable{constructor(a){super(),this._parentWindow=a,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,l.toDisposable)(()=>{this.clearListener()}))}setListener(a){this._listener&&this.clearListener(),this._listener=a,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var a;this._outerListener&&((a=this._resolutionMediaMatchList)===null||a===void 0||a.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}e.ScreenDprMonitor=u},3236:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;let l=i(2950),u=i(1680),d=i(3614),a=i(2584),f=i(5435),v=i(9312),p=i(6114),r=i(3656),_=i(9042),g=i(4567),h=i(1296),m=i(7399),y=i(8460),b=i(8437),w=i(3230),S=i(4725),C=i(428),x=i(8934),L=i(6465),R=i(5114),T=i(8969),I=i(8055),N=i(4269),F=i(5941),E=i(3107),k=i(5744),O=i(9074),P=i(2585),H=i(3730),U=i(844),K=i(6731),j=typeof window!="undefined"?window.document:null;class $ extends T.CoreTerminal{constructor(A={}){super(A),this.browser=p,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new y.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new y.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new y.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new y.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new y.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new y.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new y.EventEmitter),this._onBlur=this.register(new y.EventEmitter),this._onA11yCharEmitter=this.register(new y.EventEmitter),this._onA11yTabEmitter=this.register(new y.EventEmitter),this._onWillOpen=this.register(new y.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(L.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(H.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(O.DecorationService),this._instantiationService.setService(P.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((B,M)=>this.refresh(B,M))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(B=>this._reportWindowsOptions(B))),this.register(this._inputHandler.onColor(B=>this._handleColorEvent(B))),this.register((0,y.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,y.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,y.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,y.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(B=>this._afterResize(B.cols,B.rows))),this.register((0,U.toDisposable)(()=>{var B,M;this._customKeyEventHandler=void 0,(M=(B=this.element)===null||B===void 0?void 0:B.parentNode)===null||M===void 0||M.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(A){if(this._themeService)for(let B of A){let M,W="";switch(B.index){case 256:M="foreground",W="10";break;case 257:M="background",W="11";break;case 258:M="cursor",W="12";break;default:M="ansi",W="4;"+B.index}switch(B.type){case 0:let Z=I.color.toColorRGB(M==="ansi"?this._themeService.colors.ansi[B.index]:this._themeService.colors[M]);this.coreService.triggerDataEvent(`${a.C0.ESC}]${W};${(0,F.toRgbString)(Z)}${a.C1_ESCAPED.ST}`);break;case 1:if(M==="ansi")this._themeService.modifyColors(z=>z.ansi[B.index]=I.rgba.toColor(...B.color));else{let z=M;this._themeService.modifyColors(Q=>Q[z]=I.rgba.toColor(...B.color))}break;case 2:this._themeService.restoreColor(B.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(A){var B;A?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new g.AccessibilityManager(this,this._renderService)):((B=this._accessibilityManager)===null||B===void 0||B.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(A){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(a.C0.ESC+"[I"),this.updateCursorStyle(A),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var A;return(A=this.textarea)===null||A===void 0?void 0:A.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(a.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let A=this.buffer.ybase+this.buffer.y,B=this.buffer.lines.get(A);if(!B)return;let M=Math.min(this.buffer.x,this.cols-1),W=this._renderService.dimensions.css.cell.height,Z=B.getWidth(M),z=this._renderService.dimensions.css.cell.width*Z,Q=this.buffer.y*this._renderService.dimensions.css.cell.height,re=M*this._renderService.dimensions.css.cell.width;this.textarea.style.left=re+"px",this.textarea.style.top=Q+"px",this.textarea.style.width=z+"px",this.textarea.style.height=W+"px",this.textarea.style.lineHeight=W+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,r.addDisposableDomListener)(this.element,"copy",B=>{this.hasSelection()&&(0,d.copyHandler)(B,this._selectionService)}));let A=B=>(0,d.handlePasteEvent)(B,this.textarea,this.coreService);this.register((0,r.addDisposableDomListener)(this.textarea,"paste",A)),this.register((0,r.addDisposableDomListener)(this.element,"paste",A)),p.isFirefox?this.register((0,r.addDisposableDomListener)(this.element,"mousedown",B=>{B.button===2&&(0,d.rightClickHandler)(B,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,r.addDisposableDomListener)(this.element,"contextmenu",B=>{(0,d.rightClickHandler)(B,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),p.isLinux&&this.register((0,r.addDisposableDomListener)(this.element,"auxclick",B=>{B.button===1&&(0,d.moveTextAreaUnderMouseCursor)(B,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,r.addDisposableDomListener)(this.textarea,"keyup",A=>this._keyUp(A),!0)),this.register((0,r.addDisposableDomListener)(this.textarea,"keydown",A=>this._keyDown(A),!0)),this.register((0,r.addDisposableDomListener)(this.textarea,"keypress",A=>this._keyPress(A),!0)),this.register((0,r.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,r.addDisposableDomListener)(this.textarea,"compositionupdate",A=>this._compositionHelper.compositionupdate(A))),this.register((0,r.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,r.addDisposableDomListener)(this.textarea,"input",A=>this._inputEvent(A),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(A){var B;if(!A)throw new Error("Terminal requires a parent element.");A.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=A.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),A.appendChild(this.element);let M=j.createDocumentFragment();this._viewportElement=j.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),M.appendChild(this._viewportElement),this._viewportScrollArea=j.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=j.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=j.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),M.appendChild(this.screenElement),this.textarea=j.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",_.promptLabel),p.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(R.CoreBrowserService,this.textarea,(B=this._document.defaultView)!==null&&B!==void 0?B:window),this._instantiationService.setService(S.ICoreBrowserService,this._coreBrowserService),this.register((0,r.addDisposableDomListener)(this.textarea,"focus",W=>this._handleTextAreaFocus(W))),this.register((0,r.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(C.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(S.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(K.ThemeService),this._instantiationService.setService(S.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(N.CharacterJoinerService),this._instantiationService.setService(S.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(w.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(S.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(W=>this._onRender.fire(W))),this.onResize(W=>this._renderService.resize(W.cols,W.rows)),this._compositionView=j.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(l.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(M);try{this._onWillOpen.fire(this.element)}catch(W){}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(x.MouseService),this._instantiationService.setService(S.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(u.Viewport,W=>this.scrollLines(W,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(v.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(S.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(W=>this.scrollLines(W.amount,W.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(W=>this._renderService.handleSelectionChanged(W.start,W.end,W.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(W=>{this.textarea.value=W,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(W=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,r.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(E.BufferDecorationRenderer,this.screenElement)),this.register((0,r.addDisposableDomListener)(this.element,"mousedown",W=>this._selectionService.handleMouseDown(W))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new g.AccessibilityManager(this,this._renderService)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",W=>this._handleScreenReaderModeOptionChange(W))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(k.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",W=>{!this._overviewRulerRenderer&&W&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(k.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(h.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){let A=this,B=this.element;function M(z){let Q=A._mouseService.getMouseReportCoords(z,A.screenElement);if(!Q)return!1;let re,ee;switch(z.overrideType||z.type){case"mousemove":ee=32,z.buttons===void 0?(re=3,z.button!==void 0&&(re=z.button<3?z.button:3)):re=1&z.buttons?0:4&z.buttons?1:2&z.buttons?2:3;break;case"mouseup":ee=0,re=z.button<3?z.button:3;break;case"mousedown":ee=1,re=z.button<3?z.button:3;break;case"wheel":if(A.viewport.getLinesScrolled(z)===0)return!1;ee=z.deltaY<0?0:1,re=4;break;default:return!1}return!(ee===void 0||re===void 0||re>4)&&A.coreMouseService.triggerMouseEvent({col:Q.col,row:Q.row,x:Q.x,y:Q.y,button:re,action:ee,ctrl:z.ctrlKey,alt:z.altKey,shift:z.shiftKey})}let W={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Z={mouseup:z=>(M(z),z.buttons||(this._document.removeEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.removeEventListener("mousemove",W.mousedrag)),this.cancel(z)),wheel:z=>(M(z),this.cancel(z,!0)),mousedrag:z=>{z.buttons&&M(z)},mousemove:z=>{z.buttons||M(z)}};this.register(this.coreMouseService.onProtocolChange(z=>{z?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(z)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&z?W.mousemove||(B.addEventListener("mousemove",Z.mousemove),W.mousemove=Z.mousemove):(B.removeEventListener("mousemove",W.mousemove),W.mousemove=null),16&z?W.wheel||(B.addEventListener("wheel",Z.wheel,{passive:!1}),W.wheel=Z.wheel):(B.removeEventListener("wheel",W.wheel),W.wheel=null),2&z?W.mouseup||(W.mouseup=Z.mouseup):(this._document.removeEventListener("mouseup",W.mouseup),W.mouseup=null),4&z?W.mousedrag||(W.mousedrag=Z.mousedrag):(this._document.removeEventListener("mousemove",W.mousedrag),W.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,r.addDisposableDomListener)(B,"mousedown",z=>{if(z.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(z))return M(z),W.mouseup&&this._document.addEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.addEventListener("mousemove",W.mousedrag),this.cancel(z)})),this.register((0,r.addDisposableDomListener)(B,"wheel",z=>{if(!W.wheel){if(!this.buffer.hasScrollback){let Q=this.viewport.getLinesScrolled(z);if(Q===0)return;let re=a.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(z.deltaY<0?"A":"B"),ee="";for(let Y=0;Y<Math.abs(Q);Y++)ee+=re;return this.coreService.triggerDataEvent(ee,!0),this.cancel(z,!0)}return this.viewport.handleWheel(z)?this.cancel(z):void 0}},{passive:!1})),this.register((0,r.addDisposableDomListener)(B,"touchstart",z=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(z),this.cancel(z)},{passive:!0})),this.register((0,r.addDisposableDomListener)(B,"touchmove",z=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(z)?void 0:this.cancel(z)},{passive:!1}))}refresh(A,B){var M;(M=this._renderService)===null||M===void 0||M.refreshRows(A,B)}updateCursorStyle(A){var B;!((B=this._selectionService)===null||B===void 0)&&B.shouldColumnSelect(A)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(A,B,M=0){super.scrollLines(A,B,M),this.refresh(0,this.rows-1)}paste(A){(0,d.paste)(A,this.textarea,this.coreService)}attachCustomKeyEventHandler(A){this._customKeyEventHandler=A}registerLinkProvider(A){return this.linkifier2.registerLinkProvider(A)}registerCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let B=this._characterJoinerService.register(A);return this.refresh(0,this.rows-1),B}deregisterCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(A)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(A){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+A)}registerDecoration(A){return this._decorationService.registerDecoration(A)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(A,B,M){this._selectionService.setSelection(A,B,M)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var A;(A=this._selectionService)===null||A===void 0||A.clearSelection()}selectAll(){var A;(A=this._selectionService)===null||A===void 0||A.selectAll()}selectLines(A,B){var M;(M=this._selectionService)===null||M===void 0||M.selectLines(A,B)}_keyDown(A){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;let B=this.browser.isMac&&this.options.macOptionIsMeta&&A.altKey;if(!B&&!this._compositionHelper.keydown(A))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;B||A.key!=="Dead"&&A.key!=="AltGraph"||(this._unprocessedDeadKey=!0);let M=(0,m.evaluateKeyboardEvent)(A,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(A),M.type===3||M.type===2){let W=this.rows-1;return this.scrollLines(M.type===2?-W:W),this.cancel(A,!0)}return M.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,A)||(M.cancel&&this.cancel(A,!0),!M.key||!!(A.key&&!A.ctrlKey&&!A.altKey&&!A.metaKey&&A.key.length===1&&A.key.charCodeAt(0)>=65&&A.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(M.key!==a.C0.ETX&&M.key!==a.C0.CR||(this.textarea.value=""),this._onKey.fire({key:M.key,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(M.key,!0),!this.optionsService.rawOptions.screenReaderMode||A.altKey||A.ctrlKey?this.cancel(A,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(A,B){let M=A.isMac&&!this.options.macOptionIsMeta&&B.altKey&&!B.ctrlKey&&!B.metaKey||A.isWindows&&B.altKey&&B.ctrlKey&&!B.metaKey||A.isWindows&&B.getModifierState("AltGraph");return B.type==="keypress"?M:M&&(!B.keyCode||B.keyCode>47)}_keyUp(A){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1||(function(B){return B.keyCode===16||B.keyCode===17||B.keyCode===18}(A)||this.focus(),this.updateCursorStyle(A),this._keyPressHandled=!1)}_keyPress(A){let B;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;if(this.cancel(A),A.charCode)B=A.charCode;else if(A.which===null||A.which===void 0)B=A.keyCode;else{if(A.which===0||A.charCode===0)return!1;B=A.which}return!(!B||(A.altKey||A.ctrlKey||A.metaKey)&&!this._isThirdLevelShift(this.browser,A)||(B=String.fromCharCode(B),this._onKey.fire({key:B,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(B,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(A){if(A.data&&A.inputType==="insertText"&&(!A.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let B=A.data;return this.coreService.triggerDataEvent(B,!0),this.cancel(A),!0}return!1}resize(A,B){A!==this.cols||B!==this.rows?super.resize(A,B):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(A,B){var M,W;(M=this._charSizeService)===null||M===void 0||M.measure(),(W=this.viewport)===null||W===void 0||W.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let A=1;A<this.rows;A++)this.buffer.lines.push(this.buffer.getBlankLine(b.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var A,B;this.options.rows=this.rows,this.options.cols=this.cols;let M=this._customKeyEventHandler;this._setup(),super.reset(),(A=this._selectionService)===null||A===void 0||A.reset(),this._decorationService.reset(),this._customKeyEventHandler=M,this.refresh(0,this.rows-1),(B=this.viewport)===null||B===void 0||B.syncScrollArea()}clearTextureAtlas(){var A;(A=this._renderService)===null||A===void 0||A.clearTextureAtlas()}_reportFocus(){var A;!((A=this.element)===null||A===void 0)&&A.classList.contains("focus")?this.coreService.triggerDataEvent(a.C0.ESC+"[I"):this.coreService.triggerDataEvent(a.C0.ESC+"[O")}_reportWindowsOptions(A){if(this._renderService)switch(A){case f.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:let B=this._renderService.dimensions.css.canvas.width.toFixed(0),M=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${a.C0.ESC}[4;${M};${B}t`);break;case f.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:let W=this._renderService.dimensions.css.cell.width.toFixed(0),Z=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${a.C0.ESC}[6;${Z};${W}t`)}}cancel(A,B){if(this.options.cancelEvents||B)return A.preventDefault(),A.stopPropagation(),!1}}e.Terminal=$},9924:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TimeBasedDebouncer=void 0,e.TimeBasedDebouncer=class{constructor(i,l=1e3){this._renderCallback=i,this._debounceThresholdMS=l,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(i,l,u){this._rowCount=u,i=i!==void 0?i:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,i):i,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l;let d=Date.now();if(d-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=d,this._innerRefresh();else if(!this._additionalRefreshRequested){let a=d-this._lastRefreshMs,f=this._debounceThresholdMS-a;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},f)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let i=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(i,l)}}},1680:function(o,e,i){var l=this&&this.__decorate||function(r,_,g,h){var m,y=arguments.length,b=y<3?_:h===null?h=Object.getOwnPropertyDescriptor(_,g):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,_,g,h);else for(var w=r.length-1;w>=0;w--)(m=r[w])&&(b=(y<3?m(b):y>3?m(_,g,b):m(_,g))||b);return y>3&&b&&Object.defineProperty(_,g,b),b},u=this&&this.__param||function(r,_){return function(g,h){_(g,h,r)}};Object.defineProperty(e,"__esModule",{value:!0}),e.Viewport=void 0;let d=i(844),a=i(3656),f=i(4725),v=i(2585),p=class extends d.Disposable{constructor(r,_,g,h,m,y,b,w,S){super(),this._scrollLines=r,this._viewportElement=_,this._scrollArea=g,this._bufferService=h,this._optionsService=m,this._charSizeService=y,this._renderService=b,this._coreBrowserService=w,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,a.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(C=>this._activeBuffer=C.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(C=>this._renderDimensions=C)),this._handleThemeChange(S.colors),this.register(S.onChangeColors(C=>this._handleThemeChange(C))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(r){this._viewportElement.style.backgroundColor=r.background.css}_refresh(r){if(r)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;let _=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==_&&(this._lastRecordedBufferHeight=_,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}let r=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==r&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=r),this._refreshAnimationFrame=null}syncScrollArea(r=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(r);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(r)}_handleScroll(r){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);let _=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(_)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;let r=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(r*(this._smoothScrollState.target-this._smoothScrollState.origin)),r<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(r,_){let g=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(_<0&&this._viewportElement.scrollTop!==0||_>0&&g<this._lastRecordedBufferHeight)||(r.cancelable&&r.preventDefault(),!1)}handleWheel(r){let _=this._getPixelsScrolled(r);return _!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+_:this._smoothScrollState.target+=_,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=_,this._bubbleScroll(r,_))}_getPixelsScrolled(r){if(r.deltaY===0||r.shiftKey)return 0;let _=this._applyScrollModifier(r.deltaY,r);return r.deltaMode===WheelEvent.DOM_DELTA_LINE?_*=this._currentRowHeight:r.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(_*=this._currentRowHeight*this._bufferService.rows),_}getLinesScrolled(r){if(r.deltaY===0||r.shiftKey)return 0;let _=this._applyScrollModifier(r.deltaY,r);return r.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(_/=this._currentRowHeight+0,this._wheelPartialScroll+=_,_=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):r.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(_*=this._bufferService.rows),_}_applyScrollModifier(r,_){let g=this._optionsService.rawOptions.fastScrollModifier;return g==="alt"&&_.altKey||g==="ctrl"&&_.ctrlKey||g==="shift"&&_.shiftKey?r*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:r*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(r){this._lastTouchY=r.touches[0].pageY}handleTouchMove(r){let _=this._lastTouchY-r.touches[0].pageY;return this._lastTouchY=r.touches[0].pageY,_!==0&&(this._viewportElement.scrollTop+=_,this._bubbleScroll(r,_))}};p=l([u(3,v.IBufferService),u(4,v.IOptionsService),u(5,f.ICharSizeService),u(6,f.IRenderService),u(7,f.ICoreBrowserService),u(8,f.IThemeService)],p),e.Viewport=p},3107:function(o,e,i){var l=this&&this.__decorate||function(r,_,g,h){var m,y=arguments.length,b=y<3?_:h===null?h=Object.getOwnPropertyDescriptor(_,g):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,_,g,h);else for(var w=r.length-1;w>=0;w--)(m=r[w])&&(b=(y<3?m(b):y>3?m(_,g,b):m(_,g))||b);return y>3&&b&&Object.defineProperty(_,g,b),b},u=this&&this.__param||function(r,_){return function(g,h){_(g,h,r)}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferDecorationRenderer=void 0;let d=i(3656),a=i(4725),f=i(844),v=i(2585),p=class extends f.Disposable{constructor(r,_,g,h){super(),this._screenElement=r,this._bufferService=_,this._decorationService=g,this._renderService=h,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,d.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(m=>this._removeDecoration(m))),this.register((0,f.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let r of this._decorationService.decorations)this._renderDecoration(r);this._dimensionsChanged=!1}_renderDecoration(r){this._refreshStyle(r),this._dimensionsChanged&&this._refreshXPosition(r)}_createElement(r){var _;let g=document.createElement("div");g.classList.add("xterm-decoration"),g.style.width=`${Math.round((r.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,g.style.height=(r.options.height||1)*this._renderService.dimensions.css.cell.height+"px",g.style.top=(r.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",g.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let h=(_=r.options.x)!==null&&_!==void 0?_:0;return h&&h>this._bufferService.cols&&(g.style.display="none"),this._refreshXPosition(r,g),g}_refreshStyle(r){let _=r.marker.line-this._bufferService.buffers.active.ydisp;if(_<0||_>=this._bufferService.rows)r.element&&(r.element.style.display="none",r.onRenderEmitter.fire(r.element));else{let g=this._decorationElements.get(r);g||(g=this._createElement(r),r.element=g,this._decorationElements.set(r,g),this._container.appendChild(g)),g.style.top=_*this._renderService.dimensions.css.cell.height+"px",g.style.display=this._altBufferIsActive?"none":"block",r.onRenderEmitter.fire(g)}}_refreshXPosition(r,_=r.element){var g;if(!_)return;let h=(g=r.options.x)!==null&&g!==void 0?g:0;(r.options.anchor||"left")==="right"?_.style.right=h?h*this._renderService.dimensions.css.cell.width+"px":"":_.style.left=h?h*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(r){var _;(_=this._decorationElements.get(r))===null||_===void 0||_.remove(),this._decorationElements.delete(r),r.dispose()}};p=l([u(1,v.IBufferService),u(2,v.IDecorationService),u(3,a.IRenderService)],p),e.BufferDecorationRenderer=p},5871:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorZoneStore=void 0,e.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(i){if(i.options.overviewRulerOptions){for(let l of this._zones)if(l.color===i.options.overviewRulerOptions.color&&l.position===i.options.overviewRulerOptions.position){if(this._lineIntersectsZone(l,i.marker.line))return;if(this._lineAdjacentToZone(l,i.marker.line,i.options.overviewRulerOptions.position))return void this._addLineToZone(l,i.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=i.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=i.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=i.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=i.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:i.options.overviewRulerOptions.color,position:i.options.overviewRulerOptions.position,startBufferLine:i.marker.line,endBufferLine:i.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(i){this._linePadding=i}_lineIntersectsZone(i,l){return l>=i.startBufferLine&&l<=i.endBufferLine}_lineAdjacentToZone(i,l,u){return l>=i.startBufferLine-this._linePadding[u||"full"]&&l<=i.endBufferLine+this._linePadding[u||"full"]}_addLineToZone(i,l){i.startBufferLine=Math.min(i.startBufferLine,l),i.endBufferLine=Math.max(i.endBufferLine,l)}}},5744:function(o,e,i){var l=this&&this.__decorate||function(m,y,b,w){var S,C=arguments.length,x=C<3?y:w===null?w=Object.getOwnPropertyDescriptor(y,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(m,y,b,w);else for(var L=m.length-1;L>=0;L--)(S=m[L])&&(x=(C<3?S(x):C>3?S(y,b,x):S(y,b))||x);return C>3&&x&&Object.defineProperty(y,b,x),x},u=this&&this.__param||function(m,y){return function(b,w){y(b,w,m)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OverviewRulerRenderer=void 0;let d=i(5871),a=i(3656),f=i(4725),v=i(844),p=i(2585),r={full:0,left:0,center:0,right:0},_={full:0,left:0,center:0,right:0},g={full:0,left:0,center:0,right:0},h=class extends v.Disposable{constructor(m,y,b,w,S,C,x){var L;super(),this._viewportElement=m,this._screenElement=y,this._bufferService=b,this._decorationService=w,this._renderService=S,this._optionsService=C,this._coreBrowseService=x,this._colorZoneStore=new d.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(L=this._viewportElement.parentElement)===null||L===void 0||L.insertBefore(this._canvas,this._viewportElement);let R=this._canvas.getContext("2d");if(!R)throw new Error("Ctx cannot be null");this._ctx=R,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,v.toDisposable)(()=>{var T;(T=this._canvas)===null||T===void 0||T.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,a.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){let m=Math.floor(this._canvas.width/3),y=Math.ceil(this._canvas.width/3);_.full=this._canvas.width,_.left=m,_.center=y,_.right=m,this._refreshDrawHeightConstants(),g.full=0,g.left=0,g.center=_.left,g.right=_.left+_.center}_refreshDrawHeightConstants(){r.full=Math.round(2*this._coreBrowseService.dpr);let m=this._canvas.height/this._bufferService.buffer.lines.length,y=Math.round(Math.max(Math.min(m,12),6)*this._coreBrowseService.dpr);r.left=y,r.center=y,r.right=y}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let y of this._decorationService.decorations)this._colorZoneStore.addDecoration(y);this._ctx.lineWidth=1;let m=this._colorZoneStore.zones;for(let y of m)y.position!=="full"&&this._renderColorZone(y);for(let y of m)y.position==="full"&&this._renderColorZone(y);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(m){this._ctx.fillStyle=m.color,this._ctx.fillRect(g[m.position||"full"],Math.round((this._canvas.height-1)*(m.startBufferLine/this._bufferService.buffers.active.lines.length)-r[m.position||"full"]/2),_[m.position||"full"],Math.round((this._canvas.height-1)*((m.endBufferLine-m.startBufferLine)/this._bufferService.buffers.active.lines.length)+r[m.position||"full"]))}_queueRefresh(m,y){this._shouldUpdateDimensions=m||this._shouldUpdateDimensions,this._shouldUpdateAnchor=y||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};h=l([u(2,p.IBufferService),u(3,p.IDecorationService),u(4,f.IRenderService),u(5,p.IOptionsService),u(6,f.ICoreBrowserService)],h),e.OverviewRulerRenderer=h},2950:function(o,e,i){var l=this&&this.__decorate||function(p,r,_,g){var h,m=arguments.length,y=m<3?r:g===null?g=Object.getOwnPropertyDescriptor(r,_):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(p,r,_,g);else for(var b=p.length-1;b>=0;b--)(h=p[b])&&(y=(m<3?h(y):m>3?h(r,_,y):h(r,_))||y);return m>3&&y&&Object.defineProperty(r,_,y),y},u=this&&this.__param||function(p,r){return function(_,g){r(_,g,p)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CompositionHelper=void 0;let d=i(4725),a=i(2585),f=i(2584),v=class{constructor(p,r,_,g,h,m){this._textarea=p,this._compositionView=r,this._bufferService=_,this._optionsService=g,this._coreService=h,this._renderService=m,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(p){this._compositionView.textContent=p.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(p){if(this._isComposing||this._isSendingComposition){if(p.keyCode===229||p.keyCode===16||p.keyCode===17||p.keyCode===18)return!1;this._finalizeComposition(!1)}return p.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(p){if(this._compositionView.classList.remove("active"),this._isComposing=!1,p){let r={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let _;this._isSendingComposition=!1,r.start+=this._dataAlreadySent.length,_=this._isComposing?this._textarea.value.substring(r.start,r.end):this._textarea.value.substring(r.start),_.length>0&&this._coreService.triggerDataEvent(_,!0)}},0)}else{this._isSendingComposition=!1;let r=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(r,!0)}}_handleAnyTextareaChanges(){let p=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let r=this._textarea.value,_=r.replace(p,"");this._dataAlreadySent=_,r.length>p.length?this._coreService.triggerDataEvent(_,!0):r.length<p.length?this._coreService.triggerDataEvent(`${f.C0.DEL}`,!0):r.length===p.length&&r!==p&&this._coreService.triggerDataEvent(r,!0)}},0)}updateCompositionElements(p){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),_=this._renderService.dimensions.css.cell.height,g=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,h=r*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=h+"px",this._compositionView.style.top=g+"px",this._compositionView.style.height=_+"px",this._compositionView.style.lineHeight=_+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let m=this._compositionView.getBoundingClientRect();this._textarea.style.left=h+"px",this._textarea.style.top=g+"px",this._textarea.style.width=Math.max(m.width,1)+"px",this._textarea.style.height=Math.max(m.height,1)+"px",this._textarea.style.lineHeight=m.height+"px"}p||setTimeout(()=>this.updateCompositionElements(!0),0)}}};v=l([u(2,a.IBufferService),u(3,a.IOptionsService),u(4,a.ICoreService),u(5,d.IRenderService)],v),e.CompositionHelper=v},9806:(o,e)=>{function i(l,u,d){let a=d.getBoundingClientRect(),f=l.getComputedStyle(d),v=parseInt(f.getPropertyValue("padding-left")),p=parseInt(f.getPropertyValue("padding-top"));return[u.clientX-a.left-v,u.clientY-a.top-p]}Object.defineProperty(e,"__esModule",{value:!0}),e.getCoords=e.getCoordsRelativeToElement=void 0,e.getCoordsRelativeToElement=i,e.getCoords=function(l,u,d,a,f,v,p,r,_){if(!v)return;let g=i(l,u,d);return g?(g[0]=Math.ceil((g[0]+(_?p/2:0))/p),g[1]=Math.ceil(g[1]/r),g[0]=Math.min(Math.max(g[0],1),a+(_?1:0)),g[1]=Math.min(Math.max(g[1],1),f),g):void 0}},9504:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.moveToCellSequence=void 0;let l=i(2584);function u(r,_,g,h){let m=r-d(r,g),y=_-d(_,g),b=Math.abs(m-y)-function(w,S,C){let x=0,L=w-d(w,C),R=S-d(S,C);for(let T=0;T<Math.abs(L-R);T++){let I=a(w,S)==="A"?-1:1,N=C.buffer.lines.get(L+I*T);N!=null&&N.isWrapped&&x++}return x}(r,_,g);return p(b,v(a(r,_),h))}function d(r,_){let g=0,h=_.buffer.lines.get(r),m=h==null?void 0:h.isWrapped;for(;m&&r>=0&&r<_.rows;)g++,h=_.buffer.lines.get(--r),m=h==null?void 0:h.isWrapped;return g}function a(r,_){return r>_?"A":"B"}function f(r,_,g,h,m,y){let b=r,w=_,S="";for(;b!==g||w!==h;)b+=m?1:-1,m&&b>y.cols-1?(S+=y.buffer.translateBufferLineToString(w,!1,r,b),b=0,r=0,w++):!m&&b<0&&(S+=y.buffer.translateBufferLineToString(w,!1,0,r+1),b=y.cols-1,r=b,w--);return S+y.buffer.translateBufferLineToString(w,!1,r,b)}function v(r,_){let g=_?"O":"[";return l.C0.ESC+g+r}function p(r,_){r=Math.floor(r);let g="";for(let h=0;h<r;h++)g+=_;return g}e.moveToCellSequence=function(r,_,g,h){let m=g.buffer.x,y=g.buffer.y;if(!g.buffer.hasScrollback)return function(S,C,x,L,R,T){return u(C,L,R,T).length===0?"":p(f(S,C,S,C-d(C,R),!1,R).length,v("D",T))}(m,y,0,_,g,h)+u(y,_,g,h)+function(S,C,x,L,R,T){let I;I=u(C,L,R,T).length>0?L-d(L,R):C;let N=L,F=function(E,k,O,P,H,U){let K;return K=u(O,P,H,U).length>0?P-d(P,H):k,E<O&&K<=P||E>=O&&K<P?"C":"D"}(S,C,x,L,R,T);return p(f(S,I,x,N,F==="C",R).length,v(F,T))}(m,y,r,_,g,h);let b;if(y===_)return b=m>r?"D":"C",p(Math.abs(m-r),v(b,h));b=y>_?"D":"C";let w=Math.abs(y-_);return p(function(S,C){return C.cols-S}(y>_?r:m,g)+(w-1)*g.cols+1+((y>_?m:r)-1),v(b,h))}},1296:function(o,e,i){var l=this&&this.__decorate||function(S,C,x,L){var R,T=arguments.length,I=T<3?C:L===null?L=Object.getOwnPropertyDescriptor(C,x):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(S,C,x,L);else for(var N=S.length-1;N>=0;N--)(R=S[N])&&(I=(T<3?R(I):T>3?R(C,x,I):R(C,x))||I);return T>3&&I&&Object.defineProperty(C,x,I),I},u=this&&this.__param||function(S,C){return function(x,L){C(x,L,S)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomRenderer=void 0;let d=i(9631),a=i(3787),f=i(2223),v=i(6171),p=i(4725),r=i(8055),_=i(8460),g=i(844),h=i(2585),m="xterm-dom-renderer-owner-",y="xterm-focus",b=1,w=class extends g.Disposable{constructor(S,C,x,L,R,T,I,N,F,E){super(),this._element=S,this._screenElement=C,this._viewportElement=x,this._linkifier2=L,this._charSizeService=T,this._optionsService=I,this._bufferService=N,this._coreBrowserService=F,this._terminalClass=b++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new _.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,v.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(E.onChangeColors(k=>this._injectCss(k))),this._injectCss(E.colors),this._rowFactory=R.createInstance(a.DomRendererRowFactory,document),this._element.classList.add(m+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(k=>this._handleLinkHover(k))),this.register(this._linkifier2.onHideLinkUnderline(k=>this._handleLinkLeave(k))),this.register((0,g.toDisposable)(()=>{this._element.classList.remove(m+this._terminalClass),(0,d.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement)}))}_updateDimensions(){let S=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*S,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*S),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/S),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/S),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let x of this._rowElements)x.style.width=`${this.dimensions.css.canvas.width}px`,x.style.height=`${this.dimensions.css.cell.height}px`,x.style.lineHeight=`${this.dimensions.css.cell.height}px`,x.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let C=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=C,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(S){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let C=`${this._terminalSelector} .xterm-rows { color: ${S.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;C+=`${this._terminalSelector} span:not(.${a.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${a.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${a.ITALIC_CLASS} { font-style: italic;}`,C+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",C+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${S.cursor.css};  color: ${S.cursorAccent.css}; } 50% {  background-color: ${S.cursorAccent.css};  color: ${S.cursor.css}; }}`,C+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_BLOCK_CLASS} { outline: 1px solid ${S.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${a.CURSOR_CLASS}.${a.CURSOR_BLINK_CLASS}:not(.${a.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${a.CURSOR_CLASS}.${a.CURSOR_BLINK_CLASS}.${a.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${S.cursor.css}; color: ${S.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${S.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${S.cursor.css} inset;}`,C+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${S.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${S.selectionInactiveBackgroundOpaque.css};}`;for(let[x,L]of S.ansi.entries())C+=`${this._terminalSelector} .xterm-fg-${x} { color: ${L.css}; }${this._terminalSelector} .xterm-bg-${x} { background-color: ${L.css}; }`;C+=`${this._terminalSelector} .xterm-fg-${f.INVERTED_DEFAULT_COLOR} { color: ${r.color.opaque(S.background).css}; }${this._terminalSelector} .xterm-bg-${f.INVERTED_DEFAULT_COLOR} { background-color: ${S.foreground.css}; }`,this._themeStyleElement.textContent=C}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(S,C){for(let x=this._rowElements.length;x<=C;x++){let L=document.createElement("div");this._rowContainer.appendChild(L),this._rowElements.push(L)}for(;this._rowElements.length>C;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(S,C){this._refreshRowElements(S,C),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(y)}handleFocus(){this._rowContainer.classList.add(y)}handleSelectionChanged(S,C,x){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(S,C,x),this.renderRows(0,this._bufferService.rows-1),!S||!C)return;let L=S[1]-this._bufferService.buffer.ydisp,R=C[1]-this._bufferService.buffer.ydisp,T=Math.max(L,0),I=Math.min(R,this._bufferService.rows-1);if(T>=this._bufferService.rows||I<0)return;let N=document.createDocumentFragment();if(x){let F=S[0]>C[0];N.appendChild(this._createSelectionElement(T,F?C[0]:S[0],F?S[0]:C[0],I-T+1))}else{let F=L===T?S[0]:0,E=T===R?C[0]:this._bufferService.cols;N.appendChild(this._createSelectionElement(T,F,E));let k=I-T-1;if(N.appendChild(this._createSelectionElement(T+1,0,this._bufferService.cols,k)),T!==I){let O=R===I?C[0]:this._bufferService.cols;N.appendChild(this._createSelectionElement(I,0,O))}}this._selectionContainer.appendChild(N)}_createSelectionElement(S,C,x,L=1){let R=document.createElement("div");return R.style.height=L*this.dimensions.css.cell.height+"px",R.style.top=S*this.dimensions.css.cell.height+"px",R.style.left=C*this.dimensions.css.cell.width+"px",R.style.width=this.dimensions.css.cell.width*(x-C)+"px",R}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions()}clear(){for(let S of this._rowElements)S.replaceChildren()}renderRows(S,C){let x=this._bufferService.buffer.ybase+this._bufferService.buffer.y,L=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),R=this._optionsService.rawOptions.cursorBlink;for(let T=S;T<=C;T++){let I=this._rowElements[T],N=T+this._bufferService.buffer.ydisp,F=this._bufferService.buffer.lines.get(N),E=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[T]&&this._cellToRowElements[T].length===this._bufferService.cols||(this._cellToRowElements[T]=new Int16Array(this._bufferService.cols)),I.replaceChildren(this._rowFactory.createRow(F,N,N===x,E,L,R,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[T]))}}get _terminalSelector(){return`.${m}${this._terminalClass}`}_handleLinkHover(S){this._setCellUnderline(S.x1,S.x2,S.y1,S.y2,S.cols,!0)}_handleLinkLeave(S){this._setCellUnderline(S.x1,S.x2,S.y1,S.y2,S.cols,!1)}_setCellUnderline(S,C,x,L,R,T){if(S=this._cellToRowElements[x][S],C=this._cellToRowElements[L][C],S!==-1&&C!==-1)for(;S!==C||x!==L;){let I=this._rowElements[x];if(!I)return;let N=I.children[S];N&&(N.style.textDecoration=T?"underline":"none"),++S>=R&&(S=0,x++)}}};w=l([u(4,h.IInstantiationService),u(5,p.ICharSizeService),u(6,h.IOptionsService),u(7,h.IBufferService),u(8,p.ICoreBrowserService),u(9,p.IThemeService)],w),e.DomRenderer=w},3787:function(o,e,i){var l=this&&this.__decorate||function(b,w,S,C){var x,L=arguments.length,R=L<3?w:C===null?C=Object.getOwnPropertyDescriptor(w,S):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(b,w,S,C);else for(var T=b.length-1;T>=0;T--)(x=b[T])&&(R=(L<3?x(R):L>3?x(w,S,R):x(w,S))||R);return L>3&&R&&Object.defineProperty(w,S,R),R},u=this&&this.__param||function(b,w){return function(S,C){w(S,C,b)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomRendererRowFactory=e.CURSOR_STYLE_UNDERLINE_CLASS=e.CURSOR_STYLE_BAR_CLASS=e.CURSOR_STYLE_BLOCK_CLASS=e.CURSOR_BLINK_CLASS=e.CURSOR_CLASS=e.STRIKETHROUGH_CLASS=e.UNDERLINE_CLASS=e.ITALIC_CLASS=e.DIM_CLASS=e.BOLD_CLASS=void 0;let d=i(2223),a=i(643),f=i(511),v=i(2585),p=i(8055),r=i(4725),_=i(4269),g=i(6171),h=i(3734);e.BOLD_CLASS="xterm-bold",e.DIM_CLASS="xterm-dim",e.ITALIC_CLASS="xterm-italic",e.UNDERLINE_CLASS="xterm-underline",e.STRIKETHROUGH_CLASS="xterm-strikethrough",e.CURSOR_CLASS="xterm-cursor",e.CURSOR_BLINK_CLASS="xterm-cursor-blink",e.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",e.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",e.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let m=class{constructor(b,w,S,C,x,L,R){this._document=b,this._characterJoinerService=w,this._optionsService=S,this._coreBrowserService=C,this._coreService=x,this._decorationService=L,this._themeService=R,this._workCell=new f.CellData,this._columnSelectMode=!1}handleSelectionChanged(b,w,S){this._selectionStart=b,this._selectionEnd=w,this._columnSelectMode=S}createRow(b,w,S,C,x,L,R,T,I){let N=this._document.createDocumentFragment(),F=this._characterJoinerService.getJoinedCharacters(w),E=0;for(let H=Math.min(b.length,T)-1;H>=0;H--)if(b.loadCell(H,this._workCell).getCode()!==a.NULL_CELL_CODE||S&&H===x){E=H+1;break}let k=this._themeService.colors,O=-1,P=0;for(;P<E;P++){b.loadCell(P,this._workCell);let H=this._workCell.getWidth();if(H===0){I[P]=O;continue}let U=!1,K=P,j=this._workCell;if(F.length>0&&P===F[0][0]){U=!0;let Y=F.shift();j=new _.JoinedCellData(this._workCell,b.translateToString(!0,Y[0],Y[1]),Y[1]-Y[0]),K=Y[1]-1,H=j.getWidth()}let $=this._document.createElement("span");if(H>1&&($.style.width=R*H+"px"),U&&($.style.display="inline",x>=P&&x<=K&&(x=P)),!this._coreService.isCursorHidden&&S&&P===x)switch($.classList.add(e.CURSOR_CLASS),L&&$.classList.add(e.CURSOR_BLINK_CLASS),C){case"bar":$.classList.add(e.CURSOR_STYLE_BAR_CLASS);break;case"underline":$.classList.add(e.CURSOR_STYLE_UNDERLINE_CLASS);break;default:$.classList.add(e.CURSOR_STYLE_BLOCK_CLASS)}if(j.isBold()&&$.classList.add(e.BOLD_CLASS),j.isItalic()&&$.classList.add(e.ITALIC_CLASS),j.isDim()&&$.classList.add(e.DIM_CLASS),j.isInvisible()?$.textContent=a.WHITESPACE_CELL_CHAR:$.textContent=j.getChars()||a.WHITESPACE_CELL_CHAR,j.isUnderline()&&($.classList.add(`${e.UNDERLINE_CLASS}-${j.extended.underlineStyle}`),$.textContent===" "&&($.textContent="\xA0"),!j.isUnderlineColorDefault()))if(j.isUnderlineColorRGB())$.style.textDecorationColor=`rgb(${h.AttributeData.toColorRGB(j.getUnderlineColor()).join(",")})`;else{let Y=j.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&j.isBold()&&Y<8&&(Y+=8),$.style.textDecorationColor=k.ansi[Y].css}j.isStrikethrough()&&$.classList.add(e.STRIKETHROUGH_CLASS);let D=j.getFgColor(),A=j.getFgColorMode(),B=j.getBgColor(),M=j.getBgColorMode(),W=!!j.isInverse();if(W){let Y=D;D=B,B=Y;let Qn=A;A=M,M=Qn}let Z,z,Q=!1;this._decorationService.forEachDecorationAtCell(P,w,void 0,Y=>{Y.options.layer!=="top"&&Q||(Y.backgroundColorRGB&&(M=50331648,B=Y.backgroundColorRGB.rgba>>8&16777215,Z=Y.backgroundColorRGB),Y.foregroundColorRGB&&(A=50331648,D=Y.foregroundColorRGB.rgba>>8&16777215,z=Y.foregroundColorRGB),Q=Y.options.layer==="top")});let re=this._isCellInSelection(P,w),ee;switch(Q||k.selectionForeground&&re&&(A=50331648,D=k.selectionForeground.rgba>>8&16777215,z=k.selectionForeground),re&&(Z=this._coreBrowserService.isFocused?k.selectionBackgroundOpaque:k.selectionInactiveBackgroundOpaque,Q=!0),Q&&$.classList.add("xterm-decoration-top"),M){case 16777216:case 33554432:ee=k.ansi[B],$.classList.add(`xterm-bg-${B}`);break;case 50331648:ee=p.rgba.toColor(B>>16,B>>8&255,255&B),this._addStyle($,`background-color:#${y((B>>>0).toString(16),"0",6)}`);break;default:W?(ee=k.foreground,$.classList.add(`xterm-bg-${d.INVERTED_DEFAULT_COLOR}`)):ee=k.background}switch(Z||j.isDim()&&(Z=p.color.multiplyOpacity(ee,.5)),A){case 16777216:case 33554432:j.isBold()&&D<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(D+=8),this._applyMinimumContrast($,ee,k.ansi[D],j,Z,void 0)||$.classList.add(`xterm-fg-${D}`);break;case 50331648:let Y=p.rgba.toColor(D>>16&255,D>>8&255,255&D);this._applyMinimumContrast($,ee,Y,j,Z,z)||this._addStyle($,`color:#${y(D.toString(16),"0",6)}`);break;default:this._applyMinimumContrast($,ee,k.foreground,j,Z,void 0)||W&&$.classList.add(`xterm-fg-${d.INVERTED_DEFAULT_COLOR}`)}N.appendChild($),I[P]=++O,P=K}return P<T-1&&I.subarray(P).fill(++O),N}_applyMinimumContrast(b,w,S,C,x,L){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,g.excludeFromContrastRatioDemands)(C.getCode()))return!1;let R;return x||L||(R=this._themeService.colors.contrastCache.getColor(w.rgba,S.rgba)),R===void 0&&(R=p.color.ensureContrastRatio(x||w,L||S,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((x||w).rgba,(L||S).rgba,R!=null?R:null)),!!R&&(this._addStyle(b,`color:${R.css}`),!0)}_addStyle(b,w){b.setAttribute("style",`${b.getAttribute("style")||""}${w};`)}_isCellInSelection(b,w){let S=this._selectionStart,C=this._selectionEnd;return!(!S||!C)&&(this._columnSelectMode?S[0]<=C[0]?b>=S[0]&&w>=S[1]&&b<C[0]&&w<=C[1]:b<S[0]&&w>=S[1]&&b>=C[0]&&w<=C[1]:w>S[1]&&w<C[1]||S[1]===C[1]&&w===S[1]&&b>=S[0]&&b<C[0]||S[1]<C[1]&&w===C[1]&&b<C[0]||S[1]<C[1]&&w===S[1]&&b>=S[0])}};function y(b,w,S){for(;b.length<S;)b=w+b;return b}m=l([u(1,r.ICharacterJoinerService),u(2,v.IOptionsService),u(3,r.ICoreBrowserService),u(4,v.ICoreService),u(5,v.IDecorationService),u(6,r.IThemeService)],m),e.DomRendererRowFactory=m},2223:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TEXT_BASELINE=e.DIM_OPACITY=e.INVERTED_DEFAULT_COLOR=void 0;let l=i(6114);e.INVERTED_DEFAULT_COLOR=257,e.DIM_OPACITY=.5,e.TEXT_BASELINE=l.isFirefox||l.isLegacyEdge?"bottom":"ideographic"},6171:(o,e)=>{function i(l){return 57508<=l&&l<=57558}Object.defineProperty(e,"__esModule",{value:!0}),e.createRenderDimensions=e.excludeFromContrastRatioDemands=e.isRestrictedPowerlineGlyph=e.isPowerlineGlyph=e.throwIfFalsy=void 0,e.throwIfFalsy=function(l){if(!l)throw new Error("value must not be falsy");return l},e.isPowerlineGlyph=i,e.isRestrictedPowerlineGlyph=function(l){return 57520<=l&&l<=57527},e.excludeFromContrastRatioDemands=function(l){return i(l)||function(u){return 9472<=u&&u<=9631}(l)},e.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionModel=void 0,e.SelectionModel=class{constructor(i){this._bufferService=i,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let i=this.selectionStart[0]+this.selectionStartLength;return i>this._bufferService.cols?i%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(i/this._bufferService.cols)-1]:[i%this._bufferService.cols,this.selectionStart[1]+Math.floor(i/this._bufferService.cols)]:[i,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let i=this.selectionStart[0]+this.selectionStartLength;return i>this._bufferService.cols?[i%this._bufferService.cols,this.selectionStart[1]+Math.floor(i/this._bufferService.cols)]:[Math.max(i,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let i=this.selectionStart,l=this.selectionEnd;return!(!i||!l)&&(i[1]>l[1]||i[1]===l[1]&&i[0]>l[0])}handleTrim(i){return this.selectionStart&&(this.selectionStart[1]-=i),this.selectionEnd&&(this.selectionEnd[1]-=i),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(o,e,i){var l=this&&this.__decorate||function(r,_,g,h){var m,y=arguments.length,b=y<3?_:h===null?h=Object.getOwnPropertyDescriptor(_,g):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,_,g,h);else for(var w=r.length-1;w>=0;w--)(m=r[w])&&(b=(y<3?m(b):y>3?m(_,g,b):m(_,g))||b);return y>3&&b&&Object.defineProperty(_,g,b),b},u=this&&this.__param||function(r,_){return function(g,h){_(g,h,r)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CharSizeService=void 0;let d=i(2585),a=i(8460),f=i(844),v=class extends f.Disposable{constructor(r,_,g){super(),this._optionsService=g,this.width=0,this.height=0,this._onCharSizeChange=this.register(new a.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new p(r,_,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){let r=this._measureStrategy.measure();r.width===this.width&&r.height===this.height||(this.width=r.width,this.height=r.height,this._onCharSizeChange.fire())}};v=l([u(2,d.IOptionsService)],v),e.CharSizeService=v;class p{constructor(_,g,h){this._document=_,this._parentElement=g,this._optionsService=h,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;let _=this._measureElement.getBoundingClientRect();return _.width!==0&&_.height!==0&&(this._result.width=_.width,this._result.height=Math.ceil(_.height)),this._result}}},4269:function(o,e,i){var l=this&&this.__decorate||function(_,g,h,m){var y,b=arguments.length,w=b<3?g:m===null?m=Object.getOwnPropertyDescriptor(g,h):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(_,g,h,m);else for(var S=_.length-1;S>=0;S--)(y=_[S])&&(w=(b<3?y(w):b>3?y(g,h,w):y(g,h))||w);return b>3&&w&&Object.defineProperty(g,h,w),w},u=this&&this.__param||function(_,g){return function(h,m){g(h,m,_)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CharacterJoinerService=e.JoinedCellData=void 0;let d=i(3734),a=i(643),f=i(511),v=i(2585);class p extends d.AttributeData{constructor(g,h,m){super(),this.content=0,this.combinedData="",this.fg=g.fg,this.bg=g.bg,this.combinedData=h,this._width=m}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(g){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.JoinedCellData=p;let r=class $n{constructor(g){this._bufferService=g,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new f.CellData}register(g){let h={id:this._nextCharacterJoinerId++,handler:g};return this._characterJoiners.push(h),h.id}deregister(g){for(let h=0;h<this._characterJoiners.length;h++)if(this._characterJoiners[h].id===g)return this._characterJoiners.splice(h,1),!0;return!1}getJoinedCharacters(g){if(this._characterJoiners.length===0)return[];let h=this._bufferService.buffer.lines.get(g);if(!h||h.length===0)return[];let m=[],y=h.translateToString(!0),b=0,w=0,S=0,C=h.getFg(0),x=h.getBg(0);for(let L=0;L<h.getTrimmedLength();L++)if(h.loadCell(L,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==C||this._workCell.bg!==x){if(L-b>1){let R=this._getJoinedRanges(y,S,w,h,b);for(let T=0;T<R.length;T++)m.push(R[T])}b=L,S=w,C=this._workCell.fg,x=this._workCell.bg}w+=this._workCell.getChars().length||a.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-b>1){let L=this._getJoinedRanges(y,S,w,h,b);for(let R=0;R<L.length;R++)m.push(L[R])}return m}_getJoinedRanges(g,h,m,y,b){let w=g.substring(h,m),S=[];try{S=this._characterJoiners[0].handler(w)}catch(C){console.error(C)}for(let C=1;C<this._characterJoiners.length;C++)try{let x=this._characterJoiners[C].handler(w);for(let L=0;L<x.length;L++)$n._mergeRanges(S,x[L])}catch(x){console.error(x)}return this._stringRangesToCellRanges(S,y,b),S}_stringRangesToCellRanges(g,h,m){let y=0,b=!1,w=0,S=g[y];if(S){for(let C=m;C<this._bufferService.cols;C++){let x=h.getWidth(C),L=h.getString(C).length||a.WHITESPACE_CELL_CHAR.length;if(x!==0){if(!b&&S[0]<=w&&(S[0]=C,b=!0),S[1]<=w){if(S[1]=C,S=g[++y],!S)break;S[0]<=w?(S[0]=C,b=!0):b=!1}w+=L}}S&&(S[1]=this._bufferService.cols)}}static _mergeRanges(g,h){let m=!1;for(let y=0;y<g.length;y++){let b=g[y];if(m){if(h[1]<=b[0])return g[y-1][1]=h[1],g;if(h[1]<=b[1])return g[y-1][1]=Math.max(h[1],b[1]),g.splice(y,1),g;g.splice(y,1),y--}else{if(h[1]<=b[0])return g.splice(y,0,h),g;if(h[1]<=b[1])return b[0]=Math.min(h[0],b[0]),g;h[0]<b[1]&&(b[0]=Math.min(h[0],b[0]),m=!0)}}return m?g[g.length-1][1]=h[1]:g.push(h),g}};r=l([u(0,v.IBufferService)],r),e.CharacterJoinerService=r},5114:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoreBrowserService=void 0,e.CoreBrowserService=class{constructor(i,l){this._textarea=i,this.window=l,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(o,e,i){var l=this&&this.__decorate||function(v,p,r,_){var g,h=arguments.length,m=h<3?p:_===null?_=Object.getOwnPropertyDescriptor(p,r):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(v,p,r,_);else for(var y=v.length-1;y>=0;y--)(g=v[y])&&(m=(h<3?g(m):h>3?g(p,r,m):g(p,r))||m);return h>3&&m&&Object.defineProperty(p,r,m),m},u=this&&this.__param||function(v,p){return function(r,_){p(r,_,v)}};Object.defineProperty(e,"__esModule",{value:!0}),e.MouseService=void 0;let d=i(4725),a=i(9806),f=class{constructor(v,p){this._renderService=v,this._charSizeService=p}getCoords(v,p,r,_,g){return(0,a.getCoords)(window,v,p,r,_,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,g)}getMouseReportCoords(v,p){let r=(0,a.getCoordsRelativeToElement)(window,v,p);if(!(!this._charSizeService.hasValidSize||r[0]<0||r[1]<0||r[0]>=this._renderService.dimensions.css.canvas.width||r[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(r[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(r[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(r[0]),y:Math.floor(r[1])}}};f=l([u(0,d.IRenderService),u(1,d.ICharSizeService)],f),e.MouseService=f},3230:function(o,e,i){var l=this&&this.__decorate||function(m,y,b,w){var S,C=arguments.length,x=C<3?y:w===null?w=Object.getOwnPropertyDescriptor(y,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(m,y,b,w);else for(var L=m.length-1;L>=0;L--)(S=m[L])&&(x=(C<3?S(x):C>3?S(y,b,x):S(y,b))||x);return C>3&&x&&Object.defineProperty(y,b,x),x},u=this&&this.__param||function(m,y){return function(b,w){y(b,w,m)}};Object.defineProperty(e,"__esModule",{value:!0}),e.RenderService=void 0;let d=i(6193),a=i(8460),f=i(844),v=i(5596),p=i(3656),r=i(2585),_=i(4725),g=i(7226),h=class extends f.Disposable{constructor(m,y,b,w,S,C,x,L){if(super(),this._rowCount=m,this._charSizeService=w,this._pausedResizeTask=new g.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new a.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new a.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new a.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new a.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var R;return(R=this._renderer)===null||R===void 0?void 0:R.dispose()}}),this._renderDebouncer=new d.RenderDebouncer(x.window,(R,T)=>this._renderRows(R,T)),this.register(this._renderDebouncer),this._screenDprMonitor=new v.ScreenDprMonitor(x.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(C.onResize(()=>this._fullRefresh())),this.register(C.buffers.onBufferActivate(()=>{var R;return(R=this._renderer)===null||R===void 0?void 0:R.clear()})),this.register(b.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(S.onDecorationRegistered(()=>this._fullRefresh())),this.register(S.onDecorationRemoved(()=>this._fullRefresh())),this.register(b.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(C.cols,C.rows),this._fullRefresh()})),this.register(b.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(C.buffer.y,C.buffer.y,!0))),this.register((0,p.addDisposableDomListener)(x.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(L.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in x.window){let R=new x.window.IntersectionObserver(T=>this._handleIntersectionChange(T[T.length-1]),{threshold:0});R.observe(y),this.register({dispose:()=>R.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(m){this._isPaused=m.isIntersecting===void 0?m.intersectionRatio===0:!m.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(m,y,b=!1){this._isPaused?this._needsFullRefresh=!0:(b||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(m,y,this._rowCount))}_renderRows(m,y){this._renderer&&(this._renderer.renderRows(m,y),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:m,end:y}),this._onRender.fire({start:m,end:y}),this._isNextRenderRedrawOnly=!0)}resize(m,y){this._rowCount=y,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(m){var y;(y=this._renderer)===null||y===void 0||y.dispose(),this._renderer=m,this._renderer.onRequestRedraw(b=>this.refreshRows(b.start,b.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(m){return this._renderDebouncer.addRefreshCallback(m)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var m,y;this._renderer&&((y=(m=this._renderer).clearTextureAtlas)===null||y===void 0||y.call(m),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(m,y){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(m,y)):this._renderer.handleResize(m,y),this._fullRefresh())}handleCharSizeChanged(){var m;(m=this._renderer)===null||m===void 0||m.handleCharSizeChanged()}handleBlur(){var m;(m=this._renderer)===null||m===void 0||m.handleBlur()}handleFocus(){var m;(m=this._renderer)===null||m===void 0||m.handleFocus()}handleSelectionChanged(m,y,b){var w;this._selectionState.start=m,this._selectionState.end=y,this._selectionState.columnSelectMode=b,(w=this._renderer)===null||w===void 0||w.handleSelectionChanged(m,y,b)}handleCursorMove(){var m;(m=this._renderer)===null||m===void 0||m.handleCursorMove()}clear(){var m;(m=this._renderer)===null||m===void 0||m.clear()}};h=l([u(2,r.IOptionsService),u(3,_.ICharSizeService),u(4,r.IDecorationService),u(5,r.IBufferService),u(6,_.ICoreBrowserService),u(7,_.IThemeService)],h),e.RenderService=h},9312:function(o,e,i){var l=this&&this.__decorate||function(S,C,x,L){var R,T=arguments.length,I=T<3?C:L===null?L=Object.getOwnPropertyDescriptor(C,x):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(S,C,x,L);else for(var N=S.length-1;N>=0;N--)(R=S[N])&&(I=(T<3?R(I):T>3?R(C,x,I):R(C,x))||I);return T>3&&I&&Object.defineProperty(C,x,I),I},u=this&&this.__param||function(S,C){return function(x,L){C(x,L,S)}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionService=void 0;let d=i(6114),a=i(456),f=i(511),v=i(8460),p=i(4725),r=i(2585),_=i(9806),g=i(9504),h=i(844),m=i(4841),y=String.fromCharCode(160),b=new RegExp(y,"g"),w=class extends h.Disposable{constructor(S,C,x,L,R,T,I,N,F){super(),this._element=S,this._screenElement=C,this._linkifier=x,this._bufferService=L,this._coreService=R,this._mouseService=T,this._optionsService=I,this._renderService=N,this._coreBrowserService=F,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new f.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new v.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new v.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new v.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new v.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=E=>this._handleMouseMove(E),this._mouseUpListener=E=>this._handleMouseUp(E),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(E=>this._handleTrim(E)),this.register(this._bufferService.buffers.onBufferActivate(E=>this._handleBufferActivate(E))),this.enable(),this._model=new a.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,h.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let S=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;return!(!S||!C||S[0]===C[0]&&S[1]===C[1])}get selectionText(){let S=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;if(!S||!C)return"";let x=this._bufferService.buffer,L=[];if(this._activeSelectionMode===3){if(S[0]===C[0])return"";let R=S[0]<C[0]?S[0]:C[0],T=S[0]<C[0]?C[0]:S[0];for(let I=S[1];I<=C[1];I++){let N=x.translateBufferLineToString(I,!0,R,T);L.push(N)}}else{let R=S[1]===C[1]?C[0]:void 0;L.push(x.translateBufferLineToString(S[1],!0,S[0],R));for(let T=S[1]+1;T<=C[1]-1;T++){let I=x.lines.get(T),N=x.translateBufferLineToString(T,!0);I!=null&&I.isWrapped?L[L.length-1]+=N:L.push(N)}if(S[1]!==C[1]){let T=x.lines.get(C[1]),I=x.translateBufferLineToString(C[1],!0,0,C[0]);T&&T.isWrapped?L[L.length-1]+=I:L.push(I)}}return L.map(R=>R.replace(b," ")).join(d.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(S){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),d.isLinux&&S&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(S){let C=this._getMouseBufferCoords(S),x=this._model.finalSelectionStart,L=this._model.finalSelectionEnd;return!!(x&&L&&C)&&this._areCoordsInSelection(C,x,L)}isCellInSelection(S,C){let x=this._model.finalSelectionStart,L=this._model.finalSelectionEnd;return!(!x||!L)&&this._areCoordsInSelection([S,C],x,L)}_areCoordsInSelection(S,C,x){return S[1]>C[1]&&S[1]<x[1]||C[1]===x[1]&&S[1]===C[1]&&S[0]>=C[0]&&S[0]<x[0]||C[1]<x[1]&&S[1]===x[1]&&S[0]<x[0]||C[1]<x[1]&&S[1]===C[1]&&S[0]>=C[0]}_selectWordAtCursor(S,C){var x,L;let R=(L=(x=this._linkifier.currentLink)===null||x===void 0?void 0:x.link)===null||L===void 0?void 0:L.range;if(R)return this._model.selectionStart=[R.start.x-1,R.start.y-1],this._model.selectionStartLength=(0,m.getRangeLength)(R,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let T=this._getMouseBufferCoords(S);return!!T&&(this._selectWordAt(T,C),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(S,C){this._model.clearSelection(),S=Math.max(S,0),C=Math.min(C,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,S],this._model.selectionEnd=[this._bufferService.cols,C],this.refresh(),this._onSelectionChange.fire()}_handleTrim(S){this._model.handleTrim(S)&&this.refresh()}_getMouseBufferCoords(S){let C=this._mouseService.getCoords(S,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(C)return C[0]--,C[1]--,C[1]+=this._bufferService.buffer.ydisp,C}_getMouseEventScrollAmount(S){let C=(0,_.getCoordsRelativeToElement)(this._coreBrowserService.window,S,this._screenElement)[1],x=this._renderService.dimensions.css.canvas.height;return C>=0&&C<=x?0:(C>x&&(C-=x),C=Math.min(Math.max(C,-50),50),C/=50,C/Math.abs(C)+Math.round(14*C))}shouldForceSelection(S){return d.isMac?S.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:S.shiftKey}handleMouseDown(S){if(this._mouseDownTimeStamp=S.timeStamp,(S.button!==2||!this.hasSelection)&&S.button===0){if(!this._enabled){if(!this.shouldForceSelection(S))return;S.stopPropagation()}S.preventDefault(),this._dragScrollAmount=0,this._enabled&&S.shiftKey?this._handleIncrementalClick(S):S.detail===1?this._handleSingleClick(S):S.detail===2?this._handleDoubleClick(S):S.detail===3&&this._handleTripleClick(S),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(S){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(S))}_handleSingleClick(S){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(S)?3:0,this._model.selectionStart=this._getMouseBufferCoords(S),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let C=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);C&&C.length!==this._model.selectionStart[0]&&C.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(S){this._selectWordAtCursor(S,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(S){let C=this._getMouseBufferCoords(S);C&&(this._activeSelectionMode=2,this._selectLineAt(C[1]))}shouldColumnSelect(S){return S.altKey&&!(d.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(S){if(S.stopImmediatePropagation(),!this._model.selectionStart)return;let C=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(S),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(S),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let x=this._bufferService.buffer;if(this._model.selectionEnd[1]<x.lines.length){let L=x.lines.get(this._model.selectionEnd[1]);L&&L.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}C&&C[0]===this._model.selectionEnd[0]&&C[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let S=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(S.ydisp+this._bufferService.rows,S.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=S.ydisp),this.refresh()}}_handleMouseUp(S){let C=S.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&C<500&&S.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let x=this._mouseService.getCoords(S,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(x&&x[0]!==void 0&&x[1]!==void 0){let L=(0,g.moveToCellSequence)(x[0]-1,x[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(L,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let S=this._model.finalSelectionStart,C=this._model.finalSelectionEnd,x=!(!S||!C||S[0]===C[0]&&S[1]===C[1]);x?S&&C&&(this._oldSelectionStart&&this._oldSelectionEnd&&S[0]===this._oldSelectionStart[0]&&S[1]===this._oldSelectionStart[1]&&C[0]===this._oldSelectionEnd[0]&&C[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(S,C,x)):this._oldHasSelection&&this._fireOnSelectionChange(S,C,x)}_fireOnSelectionChange(S,C,x){this._oldSelectionStart=S,this._oldSelectionEnd=C,this._oldHasSelection=x,this._onSelectionChange.fire()}_handleBufferActivate(S){this.clearSelection(),this._trimListener.dispose(),this._trimListener=S.activeBuffer.lines.onTrim(C=>this._handleTrim(C))}_convertViewportColToCharacterIndex(S,C){let x=C;for(let L=0;C>=L;L++){let R=S.loadCell(L,this._workCell).getChars().length;this._workCell.getWidth()===0?x--:R>1&&C!==L&&(x+=R-1)}return x}setSelection(S,C,x){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[S,C],this._model.selectionStartLength=x,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(S){this._isClickInSelection(S)||(this._selectWordAtCursor(S,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(S,C,x=!0,L=!0){if(S[0]>=this._bufferService.cols)return;let R=this._bufferService.buffer,T=R.lines.get(S[1]);if(!T)return;let I=R.translateBufferLineToString(S[1],!1),N=this._convertViewportColToCharacterIndex(T,S[0]),F=N,E=S[0]-N,k=0,O=0,P=0,H=0;if(I.charAt(N)===" "){for(;N>0&&I.charAt(N-1)===" ";)N--;for(;F<I.length&&I.charAt(F+1)===" ";)F++}else{let j=S[0],$=S[0];T.getWidth(j)===0&&(k++,j--),T.getWidth($)===2&&(O++,$++);let D=T.getString($).length;for(D>1&&(H+=D-1,F+=D-1);j>0&&N>0&&!this._isCharWordSeparator(T.loadCell(j-1,this._workCell));){T.loadCell(j-1,this._workCell);let A=this._workCell.getChars().length;this._workCell.getWidth()===0?(k++,j--):A>1&&(P+=A-1,N-=A-1),N--,j--}for(;$<T.length&&F+1<I.length&&!this._isCharWordSeparator(T.loadCell($+1,this._workCell));){T.loadCell($+1,this._workCell);let A=this._workCell.getChars().length;this._workCell.getWidth()===2?(O++,$++):A>1&&(H+=A-1,F+=A-1),F++,$++}}F++;let U=N+E-k+P,K=Math.min(this._bufferService.cols,F-N+k+O-P-H);if(C||I.slice(N,F).trim()!==""){if(x&&U===0&&T.getCodePoint(0)!==32){let j=R.lines.get(S[1]-1);if(j&&T.isWrapped&&j.getCodePoint(this._bufferService.cols-1)!==32){let $=this._getWordAt([this._bufferService.cols-1,S[1]-1],!1,!0,!1);if($){let D=this._bufferService.cols-$.start;U-=D,K+=D}}}if(L&&U+K===this._bufferService.cols&&T.getCodePoint(this._bufferService.cols-1)!==32){let j=R.lines.get(S[1]+1);if(j!=null&&j.isWrapped&&j.getCodePoint(0)!==32){let $=this._getWordAt([0,S[1]+1],!1,!1,!0);$&&(K+=$.length)}}return{start:U,length:K}}}_selectWordAt(S,C){let x=this._getWordAt(S,C);if(x){for(;x.start<0;)x.start+=this._bufferService.cols,S[1]--;this._model.selectionStart=[x.start,S[1]],this._model.selectionStartLength=x.length}}_selectToWordAt(S){let C=this._getWordAt(S,!0);if(C){let x=S[1];for(;C.start<0;)C.start+=this._bufferService.cols,x--;if(!this._model.areSelectionValuesReversed())for(;C.start+C.length>this._bufferService.cols;)C.length-=this._bufferService.cols,x++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?C.start:C.start+C.length,x]}}_isCharWordSeparator(S){return S.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(S.getChars())>=0}_selectLineAt(S){let C=this._bufferService.buffer.getWrappedRangeForLine(S),x={start:{x:0,y:C.first},end:{x:this._bufferService.cols-1,y:C.last}};this._model.selectionStart=[0,C.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,m.getRangeLength)(x,this._bufferService.cols)}};w=l([u(3,r.IBufferService),u(4,r.ICoreService),u(5,p.IMouseService),u(6,r.IOptionsService),u(7,p.IRenderService),u(8,p.ICoreBrowserService)],w),e.SelectionService=w},4725:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IThemeService=e.ICharacterJoinerService=e.ISelectionService=e.IRenderService=e.IMouseService=e.ICoreBrowserService=e.ICharSizeService=void 0;let l=i(8343);e.ICharSizeService=(0,l.createDecorator)("CharSizeService"),e.ICoreBrowserService=(0,l.createDecorator)("CoreBrowserService"),e.IMouseService=(0,l.createDecorator)("MouseService"),e.IRenderService=(0,l.createDecorator)("RenderService"),e.ISelectionService=(0,l.createDecorator)("SelectionService"),e.ICharacterJoinerService=(0,l.createDecorator)("CharacterJoinerService"),e.IThemeService=(0,l.createDecorator)("ThemeService")},6731:function(o,e,i){var l=this&&this.__decorate||function(w,S,C,x){var L,R=arguments.length,T=R<3?S:x===null?x=Object.getOwnPropertyDescriptor(S,C):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(w,S,C,x);else for(var I=w.length-1;I>=0;I--)(L=w[I])&&(T=(R<3?L(T):R>3?L(S,C,T):L(S,C))||T);return R>3&&T&&Object.defineProperty(S,C,T),T},u=this&&this.__param||function(w,S){return function(C,x){S(C,x,w)}};Object.defineProperty(e,"__esModule",{value:!0}),e.ThemeService=e.DEFAULT_ANSI_COLORS=void 0;let d=i(7239),a=i(8055),f=i(8460),v=i(844),p=i(2585),r=a.css.toColor("#ffffff"),_=a.css.toColor("#000000"),g=a.css.toColor("#ffffff"),h=a.css.toColor("#000000"),m={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};e.DEFAULT_ANSI_COLORS=Object.freeze((()=>{let w=[a.css.toColor("#2e3436"),a.css.toColor("#cc0000"),a.css.toColor("#4e9a06"),a.css.toColor("#c4a000"),a.css.toColor("#3465a4"),a.css.toColor("#75507b"),a.css.toColor("#06989a"),a.css.toColor("#d3d7cf"),a.css.toColor("#555753"),a.css.toColor("#ef2929"),a.css.toColor("#8ae234"),a.css.toColor("#fce94f"),a.css.toColor("#729fcf"),a.css.toColor("#ad7fa8"),a.css.toColor("#34e2e2"),a.css.toColor("#eeeeec")],S=[0,95,135,175,215,255];for(let C=0;C<216;C++){let x=S[C/36%6|0],L=S[C/6%6|0],R=S[C%6];w.push({css:a.channels.toCss(x,L,R),rgba:a.channels.toRgba(x,L,R)})}for(let C=0;C<24;C++){let x=8+10*C;w.push({css:a.channels.toCss(x,x,x),rgba:a.channels.toRgba(x,x,x)})}return w})());let y=class extends v.Disposable{constructor(w){super(),this._optionsService=w,this._onChangeColors=this.register(new f.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new d.ColorContrastCache,this._colors={foreground:r,background:_,cursor:g,cursorAccent:h,selectionForeground:void 0,selectionBackgroundTransparent:m,selectionBackgroundOpaque:a.color.blend(_,m),selectionInactiveBackgroundTransparent:m,selectionInactiveBackgroundOpaque:a.color.blend(_,m),ansi:e.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(w={}){let S=this._colors;if(S.foreground=b(w.foreground,r),S.background=b(w.background,_),S.cursor=b(w.cursor,g),S.cursorAccent=b(w.cursorAccent,h),S.selectionBackgroundTransparent=b(w.selectionBackground,m),S.selectionBackgroundOpaque=a.color.blend(S.background,S.selectionBackgroundTransparent),S.selectionInactiveBackgroundTransparent=b(w.selectionInactiveBackground,S.selectionBackgroundTransparent),S.selectionInactiveBackgroundOpaque=a.color.blend(S.background,S.selectionInactiveBackgroundTransparent),S.selectionForeground=w.selectionForeground?b(w.selectionForeground,a.NULL_COLOR):void 0,S.selectionForeground===a.NULL_COLOR&&(S.selectionForeground=void 0),a.color.isOpaque(S.selectionBackgroundTransparent)&&(S.selectionBackgroundTransparent=a.color.opacity(S.selectionBackgroundTransparent,.3)),a.color.isOpaque(S.selectionInactiveBackgroundTransparent)&&(S.selectionInactiveBackgroundTransparent=a.color.opacity(S.selectionInactiveBackgroundTransparent,.3)),S.ansi=e.DEFAULT_ANSI_COLORS.slice(),S.ansi[0]=b(w.black,e.DEFAULT_ANSI_COLORS[0]),S.ansi[1]=b(w.red,e.DEFAULT_ANSI_COLORS[1]),S.ansi[2]=b(w.green,e.DEFAULT_ANSI_COLORS[2]),S.ansi[3]=b(w.yellow,e.DEFAULT_ANSI_COLORS[3]),S.ansi[4]=b(w.blue,e.DEFAULT_ANSI_COLORS[4]),S.ansi[5]=b(w.magenta,e.DEFAULT_ANSI_COLORS[5]),S.ansi[6]=b(w.cyan,e.DEFAULT_ANSI_COLORS[6]),S.ansi[7]=b(w.white,e.DEFAULT_ANSI_COLORS[7]),S.ansi[8]=b(w.brightBlack,e.DEFAULT_ANSI_COLORS[8]),S.ansi[9]=b(w.brightRed,e.DEFAULT_ANSI_COLORS[9]),S.ansi[10]=b(w.brightGreen,e.DEFAULT_ANSI_COLORS[10]),S.ansi[11]=b(w.brightYellow,e.DEFAULT_ANSI_COLORS[11]),S.ansi[12]=b(w.brightBlue,e.DEFAULT_ANSI_COLORS[12]),S.ansi[13]=b(w.brightMagenta,e.DEFAULT_ANSI_COLORS[13]),S.ansi[14]=b(w.brightCyan,e.DEFAULT_ANSI_COLORS[14]),S.ansi[15]=b(w.brightWhite,e.DEFAULT_ANSI_COLORS[15]),w.extendedAnsi){let C=Math.min(S.ansi.length-16,w.extendedAnsi.length);for(let x=0;x<C;x++)S.ansi[x+16]=b(w.extendedAnsi[x],e.DEFAULT_ANSI_COLORS[x+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(w){this._restoreColor(w),this._onChangeColors.fire(this.colors)}_restoreColor(w){if(w!==void 0)switch(w){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[w]=this._restoreColors.ansi[w]}else for(let S=0;S<this._restoreColors.ansi.length;++S)this._colors.ansi[S]=this._restoreColors.ansi[S]}modifyColors(w){w(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function b(w,S){if(w!==void 0)try{return a.css.toColor(w)}catch(C){}return S}y=l([u(0,p.IOptionsService)],y),e.ThemeService=y},6349:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CircularList=void 0;let l=i(8460),u=i(844);class d extends u.Disposable{constructor(f){super(),this._maxLength=f,this.onDeleteEmitter=this.register(new l.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new l.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new l.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(f){if(this._maxLength===f)return;let v=new Array(f);for(let p=0;p<Math.min(f,this.length);p++)v[p]=this._array[this._getCyclicIndex(p)];this._array=v,this._maxLength=f,this._startIndex=0}get length(){return this._length}set length(f){if(f>this._length)for(let v=this._length;v<f;v++)this._array[v]=void 0;this._length=f}get(f){return this._array[this._getCyclicIndex(f)]}set(f,v){this._array[this._getCyclicIndex(f)]=v}push(f){this._array[this._getCyclicIndex(this._length)]=f,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(f,v,...p){if(v){for(let r=f;r<this._length-v;r++)this._array[this._getCyclicIndex(r)]=this._array[this._getCyclicIndex(r+v)];this._length-=v,this.onDeleteEmitter.fire({index:f,amount:v})}for(let r=this._length-1;r>=f;r--)this._array[this._getCyclicIndex(r+p.length)]=this._array[this._getCyclicIndex(r)];for(let r=0;r<p.length;r++)this._array[this._getCyclicIndex(f+r)]=p[r];if(p.length&&this.onInsertEmitter.fire({index:f,amount:p.length}),this._length+p.length>this._maxLength){let r=this._length+p.length-this._maxLength;this._startIndex+=r,this._length=this._maxLength,this.onTrimEmitter.fire(r)}else this._length+=p.length}trimStart(f){f>this._length&&(f=this._length),this._startIndex+=f,this._length-=f,this.onTrimEmitter.fire(f)}shiftElements(f,v,p){if(!(v<=0)){if(f<0||f>=this._length)throw new Error("start argument out of range");if(f+p<0)throw new Error("Cannot shift elements in list beyond index 0");if(p>0){for(let _=v-1;_>=0;_--)this.set(f+_+p,this.get(f+_));let r=f+v+p-this._length;if(r>0)for(this._length+=r;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let r=0;r<v;r++)this.set(f+r+p,this.get(f+r))}}_getCyclicIndex(f){return(this._startIndex+f)%this._maxLength}}e.CircularList=d},1439:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.clone=void 0,e.clone=function i(l,u=5){if(typeof l!="object")return l;let d=Array.isArray(l)?[]:{};for(let a in l)d[a]=u<=1?l[a]:l[a]&&i(l[a],u-1);return d}},8055:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.contrastRatio=e.toPaddedHex=e.rgba=e.rgb=e.css=e.color=e.channels=e.NULL_COLOR=void 0;let l=i(6114),u=0,d=0,a=0,f=0;var v,p,r;function _(h){let m=h.toString(16);return m.length<2?"0"+m:m}function g(h,m){return h<m?(m+.05)/(h+.05):(h+.05)/(m+.05)}e.NULL_COLOR={css:"#00000000",rgba:0},function(h){h.toCss=function(m,y,b,w){return w!==void 0?`#${_(m)}${_(y)}${_(b)}${_(w)}`:`#${_(m)}${_(y)}${_(b)}`},h.toRgba=function(m,y,b,w=255){return(m<<24|y<<16|b<<8|w)>>>0}}(v=e.channels||(e.channels={})),function(h){function m(y,b){return f=Math.round(255*b),[u,d,a]=r.toChannels(y.rgba),{css:v.toCss(u,d,a,f),rgba:v.toRgba(u,d,a,f)}}h.blend=function(y,b){if(f=(255&b.rgba)/255,f===1)return{css:b.css,rgba:b.rgba};let w=b.rgba>>24&255,S=b.rgba>>16&255,C=b.rgba>>8&255,x=y.rgba>>24&255,L=y.rgba>>16&255,R=y.rgba>>8&255;return u=x+Math.round((w-x)*f),d=L+Math.round((S-L)*f),a=R+Math.round((C-R)*f),{css:v.toCss(u,d,a),rgba:v.toRgba(u,d,a)}},h.isOpaque=function(y){return(255&y.rgba)==255},h.ensureContrastRatio=function(y,b,w){let S=r.ensureContrastRatio(y.rgba,b.rgba,w);if(S)return r.toColor(S>>24&255,S>>16&255,S>>8&255)},h.opaque=function(y){let b=(255|y.rgba)>>>0;return[u,d,a]=r.toChannels(b),{css:v.toCss(u,d,a),rgba:b}},h.opacity=m,h.multiplyOpacity=function(y,b){return f=255&y.rgba,m(y,f*b/255)},h.toColorRGB=function(y){return[y.rgba>>24&255,y.rgba>>16&255,y.rgba>>8&255]}}(e.color||(e.color={})),function(h){let m,y;if(!l.isNode){let b=document.createElement("canvas");b.width=1,b.height=1;let w=b.getContext("2d",{willReadFrequently:!0});w&&(m=w,m.globalCompositeOperation="copy",y=m.createLinearGradient(0,0,1,1))}h.toColor=function(b){if(b.match(/#[\da-f]{3,8}/i))switch(b.length){case 4:return u=parseInt(b.slice(1,2).repeat(2),16),d=parseInt(b.slice(2,3).repeat(2),16),a=parseInt(b.slice(3,4).repeat(2),16),r.toColor(u,d,a);case 5:return u=parseInt(b.slice(1,2).repeat(2),16),d=parseInt(b.slice(2,3).repeat(2),16),a=parseInt(b.slice(3,4).repeat(2),16),f=parseInt(b.slice(4,5).repeat(2),16),r.toColor(u,d,a,f);case 7:return{css:b,rgba:(parseInt(b.slice(1),16)<<8|255)>>>0};case 9:return{css:b,rgba:parseInt(b.slice(1),16)>>>0}}let w=b.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(w)return u=parseInt(w[1]),d=parseInt(w[2]),a=parseInt(w[3]),f=Math.round(255*(w[5]===void 0?1:parseFloat(w[5]))),r.toColor(u,d,a,f);if(!m||!y)throw new Error("css.toColor: Unsupported css format");if(m.fillStyle=y,m.fillStyle=b,typeof m.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(m.fillRect(0,0,1,1),[u,d,a,f]=m.getImageData(0,0,1,1).data,f!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:v.toRgba(u,d,a,f),css:b}}}(e.css||(e.css={})),function(h){function m(y,b,w){let S=y/255,C=b/255,x=w/255;return .2126*(S<=.03928?S/12.92:Math.pow((S+.055)/1.055,2.4))+.7152*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))+.0722*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))}h.relativeLuminance=function(y){return m(y>>16&255,y>>8&255,255&y)},h.relativeLuminance2=m}(p=e.rgb||(e.rgb={})),function(h){function m(b,w,S){let C=b>>24&255,x=b>>16&255,L=b>>8&255,R=w>>24&255,T=w>>16&255,I=w>>8&255,N=g(p.relativeLuminance2(R,T,I),p.relativeLuminance2(C,x,L));for(;N<S&&(R>0||T>0||I>0);)R-=Math.max(0,Math.ceil(.1*R)),T-=Math.max(0,Math.ceil(.1*T)),I-=Math.max(0,Math.ceil(.1*I)),N=g(p.relativeLuminance2(R,T,I),p.relativeLuminance2(C,x,L));return(R<<24|T<<16|I<<8|255)>>>0}function y(b,w,S){let C=b>>24&255,x=b>>16&255,L=b>>8&255,R=w>>24&255,T=w>>16&255,I=w>>8&255,N=g(p.relativeLuminance2(R,T,I),p.relativeLuminance2(C,x,L));for(;N<S&&(R<255||T<255||I<255);)R=Math.min(255,R+Math.ceil(.1*(255-R))),T=Math.min(255,T+Math.ceil(.1*(255-T))),I=Math.min(255,I+Math.ceil(.1*(255-I))),N=g(p.relativeLuminance2(R,T,I),p.relativeLuminance2(C,x,L));return(R<<24|T<<16|I<<8|255)>>>0}h.ensureContrastRatio=function(b,w,S){let C=p.relativeLuminance(b>>8),x=p.relativeLuminance(w>>8);if(g(C,x)<S){if(x<C){let T=m(b,w,S),I=g(C,p.relativeLuminance(T>>8));if(I<S){let N=y(b,w,S);return I>g(C,p.relativeLuminance(N>>8))?T:N}return T}let L=y(b,w,S),R=g(C,p.relativeLuminance(L>>8));if(R<S){let T=m(b,w,S);return R>g(C,p.relativeLuminance(T>>8))?L:T}return L}},h.reduceLuminance=m,h.increaseLuminance=y,h.toChannels=function(b){return[b>>24&255,b>>16&255,b>>8&255,255&b]},h.toColor=function(b,w,S,C){return{css:v.toCss(b,w,S,C),rgba:v.toRgba(b,w,S,C)}}}(r=e.rgba||(e.rgba={})),e.toPaddedHex=_,e.contrastRatio=g},8969:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoreTerminal=void 0;let l=i(844),u=i(2585),d=i(4348),a=i(7866),f=i(744),v=i(7302),p=i(6975),r=i(8460),_=i(1753),g=i(1480),h=i(7994),m=i(9282),y=i(5435),b=i(5981),w=i(2660),S=!1;class C extends l.Disposable{constructor(L){super(),this._onBinary=this.register(new r.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new r.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new r.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new r.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new r.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new r.EventEmitter),this._instantiationService=new d.InstantiationService,this.optionsService=this.register(new v.OptionsService(L)),this._instantiationService.setService(u.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(f.BufferService)),this._instantiationService.setService(u.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(a.LogService)),this._instantiationService.setService(u.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(p.CoreService)),this._instantiationService.setService(u.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(_.CoreMouseService)),this._instantiationService.setService(u.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(g.UnicodeService)),this._instantiationService.setService(u.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(h.CharsetService),this._instantiationService.setService(u.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(w.OscLinkService),this._instantiationService.setService(u.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new y.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,r.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,r.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,r.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,r.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onSpecificOptionChange("windowsMode",R=>this._handleWindowsModeOptionChange(R))),this.register(this._bufferService.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new b.WriteBuffer((R,T)=>this._inputHandler.parse(R,T))),this.register((0,r.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,l.toDisposable)(()=>{var R;(R=this._windowsMode)===null||R===void 0||R.dispose(),this._windowsMode=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new r.EventEmitter),this._onScroll.event(L=>{var R;(R=this._onScrollApi)===null||R===void 0||R.fire(L.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(L){for(let R in L)this.optionsService.options[R]=L[R]}write(L,R){this._writeBuffer.write(L,R)}writeSync(L,R){this._logService.logLevel<=u.LogLevelEnum.WARN&&!S&&(this._logService.warn("writeSync is unreliable and will be removed soon."),S=!0),this._writeBuffer.writeSync(L,R)}resize(L,R){isNaN(L)||isNaN(R)||(L=Math.max(L,f.MINIMUM_COLS),R=Math.max(R,f.MINIMUM_ROWS),this._bufferService.resize(L,R))}scroll(L,R=!1){this._bufferService.scroll(L,R)}scrollLines(L,R,T){this._bufferService.scrollLines(L,R,T)}scrollPages(L){this._bufferService.scrollPages(L)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(L){this._bufferService.scrollToLine(L)}registerEscHandler(L,R){return this._inputHandler.registerEscHandler(L,R)}registerDcsHandler(L,R){return this._inputHandler.registerDcsHandler(L,R)}registerCsiHandler(L,R){return this._inputHandler.registerCsiHandler(L,R)}registerOscHandler(L,R){return this._inputHandler.registerOscHandler(L,R)}_setup(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsModeOptionChange(L){var R;L?this._enableWindowsMode():((R=this._windowsMode)===null||R===void 0||R.dispose(),this._windowsMode=void 0)}_enableWindowsMode(){if(!this._windowsMode){let L=[];L.push(this.onLineFeed(m.updateWindowsModeWrappedState.bind(null,this._bufferService))),L.push(this.registerCsiHandler({final:"H"},()=>((0,m.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsMode={dispose:()=>{for(let R of L)R.dispose()}}}}}e.CoreTerminal=C},8460:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.forwardEvent=e.EventEmitter=void 0,e.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=i=>(this._listeners.push(i),{dispose:()=>{if(!this._disposed){for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===i)return void this._listeners.splice(l,1)}}})),this._event}fire(i,l){let u=[];for(let d=0;d<this._listeners.length;d++)u.push(this._listeners[d]);for(let d=0;d<u.length;d++)u[d].call(void 0,i,l)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},e.forwardEvent=function(i,l){return i(u=>l.fire(u))}},5435:function(o,e,i){var l=this&&this.__decorate||function(F,E,k,O){var P,H=arguments.length,U=H<3?E:O===null?O=Object.getOwnPropertyDescriptor(E,k):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,E,k,O);else for(var K=F.length-1;K>=0;K--)(P=F[K])&&(U=(H<3?P(U):H>3?P(E,k,U):P(E,k))||U);return H>3&&U&&Object.defineProperty(E,k,U),U},u=this&&this.__param||function(F,E){return function(k,O){E(k,O,F)}};Object.defineProperty(e,"__esModule",{value:!0}),e.InputHandler=e.WindowsOptionsReportType=void 0;let d=i(2584),a=i(7116),f=i(2015),v=i(844),p=i(482),r=i(8437),_=i(8460),g=i(643),h=i(511),m=i(3734),y=i(2585),b=i(6242),w=i(6351),S=i(5941),C={"(":0,")":1,"*":2,"+":3,"-":1,".":2},x=131072;function L(F,E){if(F>24)return E.setWinLines||!1;switch(F){case 1:return!!E.restoreWin;case 2:return!!E.minimizeWin;case 3:return!!E.setWinPosition;case 4:return!!E.setWinSizePixels;case 5:return!!E.raiseWin;case 6:return!!E.lowerWin;case 7:return!!E.refreshWin;case 8:return!!E.setWinSizeChars;case 9:return!!E.maximizeWin;case 10:return!!E.fullscreenWin;case 11:return!!E.getWinState;case 13:return!!E.getWinPosition;case 14:return!!E.getWinSizePixels;case 15:return!!E.getScreenSizePixels;case 16:return!!E.getCellSizePixels;case 18:return!!E.getWinSizeChars;case 19:return!!E.getScreenSizeChars;case 20:return!!E.getIconTitle;case 21:return!!E.getWinTitle;case 22:return!!E.pushTitle;case 23:return!!E.popTitle;case 24:return!!E.setWinLines}return!1}var R;(function(F){F[F.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",F[F.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(R=e.WindowsOptionsReportType||(e.WindowsOptionsReportType={}));let T=0;class I extends v.Disposable{constructor(E,k,O,P,H,U,K,j,$=new f.EscapeSequenceParser){super(),this._bufferService=E,this._charsetService=k,this._coreService=O,this._logService=P,this._optionsService=H,this._oscLinkService=U,this._coreMouseService=K,this._unicodeService=j,this._parser=$,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new p.StringToUtf32,this._utf8Decoder=new p.Utf8ToUtf32,this._workCell=new h.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=r.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new _.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new _.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new _.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new _.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new _.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new _.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new _.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new _.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new _.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new _.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new _.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new _.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new _.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new N(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(D=>this._activeBuffer=D.activeBuffer)),this._parser.setCsiHandlerFallback((D,A)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(D),params:A.toArray()})}),this._parser.setEscHandlerFallback(D=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(D)})}),this._parser.setExecuteHandlerFallback(D=>{this._logService.debug("Unknown EXECUTE code: ",{code:D})}),this._parser.setOscHandlerFallback((D,A,B)=>{this._logService.debug("Unknown OSC code: ",{identifier:D,action:A,data:B})}),this._parser.setDcsHandlerFallback((D,A,B)=>{A==="HOOK"&&(B=B.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(D),action:A,payload:B})}),this._parser.setPrintHandler((D,A,B)=>this.print(D,A,B)),this._parser.registerCsiHandler({final:"@"},D=>this.insertChars(D)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},D=>this.scrollLeft(D)),this._parser.registerCsiHandler({final:"A"},D=>this.cursorUp(D)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},D=>this.scrollRight(D)),this._parser.registerCsiHandler({final:"B"},D=>this.cursorDown(D)),this._parser.registerCsiHandler({final:"C"},D=>this.cursorForward(D)),this._parser.registerCsiHandler({final:"D"},D=>this.cursorBackward(D)),this._parser.registerCsiHandler({final:"E"},D=>this.cursorNextLine(D)),this._parser.registerCsiHandler({final:"F"},D=>this.cursorPrecedingLine(D)),this._parser.registerCsiHandler({final:"G"},D=>this.cursorCharAbsolute(D)),this._parser.registerCsiHandler({final:"H"},D=>this.cursorPosition(D)),this._parser.registerCsiHandler({final:"I"},D=>this.cursorForwardTab(D)),this._parser.registerCsiHandler({final:"J"},D=>this.eraseInDisplay(D,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},D=>this.eraseInDisplay(D,!0)),this._parser.registerCsiHandler({final:"K"},D=>this.eraseInLine(D,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},D=>this.eraseInLine(D,!0)),this._parser.registerCsiHandler({final:"L"},D=>this.insertLines(D)),this._parser.registerCsiHandler({final:"M"},D=>this.deleteLines(D)),this._parser.registerCsiHandler({final:"P"},D=>this.deleteChars(D)),this._parser.registerCsiHandler({final:"S"},D=>this.scrollUp(D)),this._parser.registerCsiHandler({final:"T"},D=>this.scrollDown(D)),this._parser.registerCsiHandler({final:"X"},D=>this.eraseChars(D)),this._parser.registerCsiHandler({final:"Z"},D=>this.cursorBackwardTab(D)),this._parser.registerCsiHandler({final:"`"},D=>this.charPosAbsolute(D)),this._parser.registerCsiHandler({final:"a"},D=>this.hPositionRelative(D)),this._parser.registerCsiHandler({final:"b"},D=>this.repeatPrecedingCharacter(D)),this._parser.registerCsiHandler({final:"c"},D=>this.sendDeviceAttributesPrimary(D)),this._parser.registerCsiHandler({prefix:">",final:"c"},D=>this.sendDeviceAttributesSecondary(D)),this._parser.registerCsiHandler({final:"d"},D=>this.linePosAbsolute(D)),this._parser.registerCsiHandler({final:"e"},D=>this.vPositionRelative(D)),this._parser.registerCsiHandler({final:"f"},D=>this.hVPosition(D)),this._parser.registerCsiHandler({final:"g"},D=>this.tabClear(D)),this._parser.registerCsiHandler({final:"h"},D=>this.setMode(D)),this._parser.registerCsiHandler({prefix:"?",final:"h"},D=>this.setModePrivate(D)),this._parser.registerCsiHandler({final:"l"},D=>this.resetMode(D)),this._parser.registerCsiHandler({prefix:"?",final:"l"},D=>this.resetModePrivate(D)),this._parser.registerCsiHandler({final:"m"},D=>this.charAttributes(D)),this._parser.registerCsiHandler({final:"n"},D=>this.deviceStatus(D)),this._parser.registerCsiHandler({prefix:"?",final:"n"},D=>this.deviceStatusPrivate(D)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},D=>this.softReset(D)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},D=>this.setCursorStyle(D)),this._parser.registerCsiHandler({final:"r"},D=>this.setScrollRegion(D)),this._parser.registerCsiHandler({final:"s"},D=>this.saveCursor(D)),this._parser.registerCsiHandler({final:"t"},D=>this.windowOptions(D)),this._parser.registerCsiHandler({final:"u"},D=>this.restoreCursor(D)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},D=>this.insertColumns(D)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},D=>this.deleteColumns(D)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},D=>this.selectProtected(D)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},D=>this.requestMode(D,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},D=>this.requestMode(D,!1)),this._parser.setExecuteHandler(d.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(d.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(d.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(d.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(d.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(d.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(d.C1.IND,()=>this.index()),this._parser.setExecuteHandler(d.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(d.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new b.OscHandler(D=>(this.setTitle(D),this.setIconName(D),!0))),this._parser.registerOscHandler(1,new b.OscHandler(D=>this.setIconName(D))),this._parser.registerOscHandler(2,new b.OscHandler(D=>this.setTitle(D))),this._parser.registerOscHandler(4,new b.OscHandler(D=>this.setOrReportIndexedColor(D))),this._parser.registerOscHandler(8,new b.OscHandler(D=>this.setHyperlink(D))),this._parser.registerOscHandler(10,new b.OscHandler(D=>this.setOrReportFgColor(D))),this._parser.registerOscHandler(11,new b.OscHandler(D=>this.setOrReportBgColor(D))),this._parser.registerOscHandler(12,new b.OscHandler(D=>this.setOrReportCursorColor(D))),this._parser.registerOscHandler(104,new b.OscHandler(D=>this.restoreIndexedColor(D))),this._parser.registerOscHandler(110,new b.OscHandler(D=>this.restoreFgColor(D))),this._parser.registerOscHandler(111,new b.OscHandler(D=>this.restoreBgColor(D))),this._parser.registerOscHandler(112,new b.OscHandler(D=>this.restoreCursorColor(D))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let D in a.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:D},()=>this.selectCharset("("+D)),this._parser.registerEscHandler({intermediates:")",final:D},()=>this.selectCharset(")"+D)),this._parser.registerEscHandler({intermediates:"*",final:D},()=>this.selectCharset("*"+D)),this._parser.registerEscHandler({intermediates:"+",final:D},()=>this.selectCharset("+"+D)),this._parser.registerEscHandler({intermediates:"-",final:D},()=>this.selectCharset("-"+D)),this._parser.registerEscHandler({intermediates:".",final:D},()=>this.selectCharset("."+D)),this._parser.registerEscHandler({intermediates:"/",final:D},()=>this.selectCharset("/"+D));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(D=>(this._logService.error("Parsing error: ",D),D)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new w.DcsHandler((D,A)=>this.requestStatusString(D,A)))}getAttrData(){return this._curAttrData}_preserveStack(E,k,O,P){this._parseStack.paused=!0,this._parseStack.cursorStartX=E,this._parseStack.cursorStartY=k,this._parseStack.decodedLength=O,this._parseStack.position=P}_logSlowResolvingAsync(E){this._logService.logLevel<=y.LogLevelEnum.WARN&&Promise.race([E,new Promise((k,O)=>setTimeout(()=>O("#SLOW_TIMEOUT"),5e3))]).catch(k=>{if(k!=="#SLOW_TIMEOUT")throw k;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(E,k){let O,P=this._activeBuffer.x,H=this._activeBuffer.y,U=0,K=this._parseStack.paused;if(K){if(O=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,k))return this._logSlowResolvingAsync(O),O;P=this._parseStack.cursorStartX,H=this._parseStack.cursorStartY,this._parseStack.paused=!1,E.length>x&&(U=this._parseStack.position+x)}if(this._logService.logLevel<=y.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof E=="string"?` "${E}"`:` "${Array.prototype.map.call(E,j=>String.fromCharCode(j)).join("")}"`),typeof E=="string"?E.split("").map(j=>j.charCodeAt(0)):E),this._parseBuffer.length<E.length&&this._parseBuffer.length<x&&(this._parseBuffer=new Uint32Array(Math.min(E.length,x))),K||this._dirtyRowTracker.clearRange(),E.length>x)for(let j=U;j<E.length;j+=x){let $=j+x<E.length?j+x:E.length,D=typeof E=="string"?this._stringDecoder.decode(E.substring(j,$),this._parseBuffer):this._utf8Decoder.decode(E.subarray(j,$),this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,D))return this._preserveStack(P,H,D,j),this._logSlowResolvingAsync(O),O}else if(!K){let j=typeof E=="string"?this._stringDecoder.decode(E,this._parseBuffer):this._utf8Decoder.decode(E,this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,j))return this._preserveStack(P,H,j,0),this._logSlowResolvingAsync(O),O}this._activeBuffer.x===P&&this._activeBuffer.y===H||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(E,k,O){let P,H,U=this._charsetService.charset,K=this._optionsService.rawOptions.screenReaderMode,j=this._bufferService.cols,$=this._coreService.decPrivateModes.wraparound,D=this._coreService.modes.insertMode,A=this._curAttrData,B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&O-k>0&&B.getWidth(this._activeBuffer.x-1)===2&&B.setCellFromCodePoint(this._activeBuffer.x-1,0,1,A.fg,A.bg,A.extended);for(let M=k;M<O;++M){if(P=E[M],H=this._unicodeService.wcwidth(P),P<127&&U){let W=U[String.fromCharCode(P)];W&&(P=W.charCodeAt(0))}if(K&&this._onA11yChar.fire((0,p.stringFromCodePoint)(P)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),H||!this._activeBuffer.x){if(this._activeBuffer.x+H-1>=j){if($){for(;this._activeBuffer.x<j;)B.setCellFromCodePoint(this._activeBuffer.x++,0,1,A.fg,A.bg,A.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=j-1,H===2)continue}if(D&&(B.insertCells(this._activeBuffer.x,H,this._activeBuffer.getNullCell(A),A),B.getWidth(j-1)===2&&B.setCellFromCodePoint(j-1,g.NULL_CELL_CODE,g.NULL_CELL_WIDTH,A.fg,A.bg,A.extended)),B.setCellFromCodePoint(this._activeBuffer.x++,P,H,A.fg,A.bg,A.extended),H>0)for(;--H;)B.setCellFromCodePoint(this._activeBuffer.x++,0,0,A.fg,A.bg,A.extended)}else B.getWidth(this._activeBuffer.x-1)?B.addCodepointToCell(this._activeBuffer.x-1,P):B.addCodepointToCell(this._activeBuffer.x-2,P)}O-k>0&&(B.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<j&&O-k>0&&B.getWidth(this._activeBuffer.x)===0&&!B.hasContent(this._activeBuffer.x)&&B.setCellFromCodePoint(this._activeBuffer.x,0,1,A.fg,A.bg,A.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(E,k){return E.final!=="t"||E.prefix||E.intermediates?this._parser.registerCsiHandler(E,k):this._parser.registerCsiHandler(E,O=>!L(O.params[0],this._optionsService.rawOptions.windowOptions)||k(O))}registerDcsHandler(E,k){return this._parser.registerDcsHandler(E,new w.DcsHandler(k))}registerEscHandler(E,k){return this._parser.registerEscHandler(E,k)}registerOscHandler(E,k){return this._parser.registerOscHandler(E,new b.OscHandler(k))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var E;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||E===void 0)&&E.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);k.hasWidth(this._activeBuffer.x)&&!k.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-E),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(E=this._bufferService.cols-1){this._activeBuffer.x=Math.min(E,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(E,k){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=E,this._activeBuffer.y=this._activeBuffer.scrollTop+k):(this._activeBuffer.x=E,this._activeBuffer.y=k),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(E,k){this._restrictCursor(),this._setCursor(this._activeBuffer.x+E,this._activeBuffer.y+k)}cursorUp(E){let k=this._activeBuffer.y-this._activeBuffer.scrollTop;return k>=0?this._moveCursor(0,-Math.min(k,E.params[0]||1)):this._moveCursor(0,-(E.params[0]||1)),!0}cursorDown(E){let k=this._activeBuffer.scrollBottom-this._activeBuffer.y;return k>=0?this._moveCursor(0,Math.min(k,E.params[0]||1)):this._moveCursor(0,E.params[0]||1),!0}cursorForward(E){return this._moveCursor(E.params[0]||1,0),!0}cursorBackward(E){return this._moveCursor(-(E.params[0]||1),0),!0}cursorNextLine(E){return this.cursorDown(E),this._activeBuffer.x=0,!0}cursorPrecedingLine(E){return this.cursorUp(E),this._activeBuffer.x=0,!0}cursorCharAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(E){return this._setCursor(E.length>=2?(E.params[1]||1)-1:0,(E.params[0]||1)-1),!0}charPosAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(E){return this._moveCursor(E.params[0]||1,0),!0}linePosAbsolute(E){return this._setCursor(this._activeBuffer.x,(E.params[0]||1)-1),!0}vPositionRelative(E){return this._moveCursor(0,E.params[0]||1),!0}hVPosition(E){return this.cursorPosition(E),!0}tabClear(E){let k=E.params[0];return k===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:k===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let k=E.params[0]||1;for(;k--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let k=E.params[0]||1;for(;k--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(E){let k=E.params[0];return k===1&&(this._curAttrData.bg|=536870912),k!==2&&k!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(E,k,O,P=!1,H=!1){let U=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);U.replaceCells(k,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),H),P&&(U.isWrapped=!1)}_resetBufferLine(E,k=!1){let O=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);O.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),k),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+E),O.isWrapped=!1}eraseInDisplay(E,k=!1){let O;switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,k);O<this._bufferService.rows;O++)this._resetBufferLine(O,k);this._dirtyRowTracker.markDirty(O);break;case 1:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O,0,this._activeBuffer.x+1,!0,k),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(O+1).isWrapped=!1);O--;)this._resetBufferLine(O,k);this._dirtyRowTracker.markDirty(0);break;case 2:for(O=this._bufferService.rows,this._dirtyRowTracker.markDirty(O-1);O--;)this._resetBufferLine(O,k);this._dirtyRowTracker.markDirty(0);break;case 3:let P=this._activeBuffer.lines.length-this._bufferService.rows;P>0&&(this._activeBuffer.lines.trimStart(P),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-P,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-P,0),this._onScroll.fire(0))}return!0}eraseInLine(E,k=!1){switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,k);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,k);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,k)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(E){this._restrictCursor();let k=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let O=this._activeBuffer.ybase+this._activeBuffer.y,P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,H=this._bufferService.rows-1+this._activeBuffer.ybase-P+1;for(;k--;)this._activeBuffer.lines.splice(H-1,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(E){this._restrictCursor();let k=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let O=this._activeBuffer.ybase+this._activeBuffer.y,P;for(P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,P=this._bufferService.rows-1+this._activeBuffer.ybase-P;k--;)this._activeBuffer.lines.splice(O,1),this._activeBuffer.lines.splice(P,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(E){this._restrictCursor();let k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return k&&(k.insertCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(E){this._restrictCursor();let k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return k&&(k.deleteCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(E){let k=E.params[0]||1;for(;k--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(E){let k=E.params[0]||1;for(;k--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(r.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let k=E.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){let P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.deleteCells(0,k,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let k=E.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){let P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.insertCells(0,k,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let k=E.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){let P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.insertCells(this._activeBuffer.x,k,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let k=E.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){let P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.deleteCells(this._activeBuffer.x,k,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(E){this._restrictCursor();let k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return k&&(k.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(E.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(E){if(!this._parser.precedingCodepoint)return!0;let k=E.params[0]||1,O=new Uint32Array(k);for(let P=0;P<k;++P)O[P]=this._parser.precedingCodepoint;return this.print(O,0,O.length),!0}sendDeviceAttributesPrimary(E){return E.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(d.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(d.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(E){return E.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(d.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(d.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(E.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(d.C0.ESC+"[>83;40003;0c")),!0}_is(E){return(this._optionsService.rawOptions.termName+"").indexOf(E)===0}setMode(E){for(let k=0;k<E.length;k++)switch(E.params[k]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(E){for(let k=0;k<E.length;k++)switch(E.params[k]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,a.DEFAULT_CHARSET),this._charsetService.setgCharset(1,a.DEFAULT_CHARSET),this._charsetService.setgCharset(2,a.DEFAULT_CHARSET),this._charsetService.setgCharset(3,a.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(E){for(let k=0;k<E.length;k++)switch(E.params[k]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(E){for(let k=0;k<E.length;k++)switch(E.params[k]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),E.params[k]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(E,k){let O=this._coreService.decPrivateModes,{activeProtocol:P,activeEncoding:H}=this._coreMouseService,U=this._coreService,{buffers:K,cols:j}=this._bufferService,{active:$,alt:D}=K,A=this._optionsService.rawOptions,B=z=>z?1:2,M=E.params[0];return W=M,Z=k?M===2?3:M===4?B(U.modes.insertMode):M===12?4:M===20?B(A.convertEol):0:M===1?B(O.applicationCursorKeys):M===3?A.windowOptions.setWinLines?j===80?2:j===132?1:0:0:M===6?B(O.origin):M===7?B(O.wraparound):M===8?3:M===9?B(P==="X10"):M===12?B(A.cursorBlink):M===25?B(!U.isCursorHidden):M===45?B(O.reverseWraparound):M===66?B(O.applicationKeypad):M===1e3?B(P==="VT200"):M===1002?B(P==="DRAG"):M===1003?B(P==="ANY"):M===1004?B(O.sendFocus):M===1005?4:M===1006?B(H==="SGR"):M===1015?4:M===1016?B(H==="SGR_PIXELS"):M===1048?1:M===47||M===1047||M===1049?B($===D):M===2004?B(O.bracketedPasteMode):0,U.triggerDataEvent(`${d.C0.ESC}[${k?"":"?"}${W};${Z}$y`),!0;var W,Z}_updateAttrColor(E,k,O,P,H){return k===2?(E|=50331648,E&=-16777216,E|=m.AttributeData.fromColorRGB([O,P,H])):k===5&&(E&=-50331904,E|=33554432|255&O),E}_extractColor(E,k,O){let P=[0,0,-1,0,0,0],H=0,U=0;do{if(P[U+H]=E.params[k+U],E.hasSubParams(k+U)){let K=E.getSubParams(k+U),j=0;do P[1]===5&&(H=1),P[U+j+1+H]=K[j];while(++j<K.length&&j+U+1+H<P.length);break}if(P[1]===5&&U+H>=2||P[1]===2&&U+H>=5)break;P[1]&&(H=1)}while(++U+k<E.length&&U+H<P.length);for(let K=2;K<P.length;++K)P[K]===-1&&(P[K]=0);switch(P[0]){case 38:O.fg=this._updateAttrColor(O.fg,P[1],P[3],P[4],P[5]);break;case 48:O.bg=this._updateAttrColor(O.bg,P[1],P[3],P[4],P[5]);break;case 58:O.extended=O.extended.clone(),O.extended.underlineColor=this._updateAttrColor(O.extended.underlineColor,P[1],P[3],P[4],P[5])}return U}_processUnderline(E,k){k.extended=k.extended.clone(),(!~E||E>5)&&(E=1),k.extended.underlineStyle=E,k.fg|=268435456,E===0&&(k.fg&=-268435457),k.updateExtended()}_processSGR0(E){E.fg=r.DEFAULT_ATTR_DATA.fg,E.bg=r.DEFAULT_ATTR_DATA.bg,E.extended=E.extended.clone(),E.extended.underlineStyle=0,E.extended.underlineColor&=-67108864,E.updateExtended()}charAttributes(E){if(E.length===1&&E.params[0]===0)return this._processSGR0(this._curAttrData),!0;let k=E.length,O,P=this._curAttrData;for(let H=0;H<k;H++)O=E.params[H],O>=30&&O<=37?(P.fg&=-50331904,P.fg|=16777216|O-30):O>=40&&O<=47?(P.bg&=-50331904,P.bg|=16777216|O-40):O>=90&&O<=97?(P.fg&=-50331904,P.fg|=16777224|O-90):O>=100&&O<=107?(P.bg&=-50331904,P.bg|=16777224|O-100):O===0?this._processSGR0(P):O===1?P.fg|=134217728:O===3?P.bg|=67108864:O===4?(P.fg|=268435456,this._processUnderline(E.hasSubParams(H)?E.getSubParams(H)[0]:1,P)):O===5?P.fg|=536870912:O===7?P.fg|=67108864:O===8?P.fg|=1073741824:O===9?P.fg|=2147483648:O===2?P.bg|=134217728:O===21?this._processUnderline(2,P):O===22?(P.fg&=-134217729,P.bg&=-134217729):O===23?P.bg&=-67108865:O===24?(P.fg&=-268435457,this._processUnderline(0,P)):O===25?P.fg&=-536870913:O===27?P.fg&=-67108865:O===28?P.fg&=-1073741825:O===29?P.fg&=2147483647:O===39?(P.fg&=-67108864,P.fg|=16777215&r.DEFAULT_ATTR_DATA.fg):O===49?(P.bg&=-67108864,P.bg|=16777215&r.DEFAULT_ATTR_DATA.bg):O===38||O===48||O===58?H+=this._extractColor(E,H,P):O===59?(P.extended=P.extended.clone(),P.extended.underlineColor=-1,P.updateExtended()):O===100?(P.fg&=-67108864,P.fg|=16777215&r.DEFAULT_ATTR_DATA.fg,P.bg&=-67108864,P.bg|=16777215&r.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",O);return!0}deviceStatus(E){switch(E.params[0]){case 5:this._coreService.triggerDataEvent(`${d.C0.ESC}[0n`);break;case 6:let k=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${d.C0.ESC}[${k};${O}R`)}return!0}deviceStatusPrivate(E){if(E.params[0]===6){let k=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${d.C0.ESC}[?${k};${O}R`)}return!0}softReset(E){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(E){let k=E.params[0]||1;switch(k){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}let O=k%2==1;return this._optionsService.options.cursorBlink=O,!0}setScrollRegion(E){let k=E.params[0]||1,O;return(E.length<2||(O=E.params[1])>this._bufferService.rows||O===0)&&(O=this._bufferService.rows),O>k&&(this._activeBuffer.scrollTop=k-1,this._activeBuffer.scrollBottom=O-1,this._setCursor(0,0)),!0}windowOptions(E){if(!L(E.params[0],this._optionsService.rawOptions.windowOptions))return!0;let k=E.length>1?E.params[1]:0;switch(E.params[0]){case 14:k!==2&&this._onRequestWindowsOptionsReport.fire(R.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(R.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${d.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:k!==0&&k!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),k!==0&&k!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:k!==0&&k!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),k!==0&&k!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(E){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(E){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(E){return this._windowTitle=E,this._onTitleChange.fire(E),!0}setIconName(E){return this._iconName=E,!0}setOrReportIndexedColor(E){let k=[],O=E.split(";");for(;O.length>1;){let P=O.shift(),H=O.shift();if(/^\d+$/.exec(P)){let U=parseInt(P);if(0<=U&&U<256)if(H==="?")k.push({type:0,index:U});else{let K=(0,S.parseColor)(H);K&&k.push({type:1,index:U,color:K})}}}return k.length&&this._onColor.fire(k),!0}setHyperlink(E){let k=E.split(";");return!(k.length<2)&&(k[1]?this._createHyperlink(k[0],k[1]):!k[0]&&this._finishHyperlink())}_createHyperlink(E,k){this._getCurrentLinkId()&&this._finishHyperlink();let O=E.split(":"),P,H=O.findIndex(U=>U.startsWith("id="));return H!==-1&&(P=O[H].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:P,uri:k}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(E,k){let O=E.split(";");for(let P=0;P<O.length&&!(k>=this._specialColors.length);++P,++k)if(O[P]==="?")this._onColor.fire([{type:0,index:this._specialColors[k]}]);else{let H=(0,S.parseColor)(O[P]);H&&this._onColor.fire([{type:1,index:this._specialColors[k],color:H}])}return!0}setOrReportFgColor(E){return this._setOrReportSpecialColor(E,0)}setOrReportBgColor(E){return this._setOrReportSpecialColor(E,1)}setOrReportCursorColor(E){return this._setOrReportSpecialColor(E,2)}restoreIndexedColor(E){if(!E)return this._onColor.fire([{type:2}]),!0;let k=[],O=E.split(";");for(let P=0;P<O.length;++P)if(/^\d+$/.exec(O[P])){let H=parseInt(O[P]);0<=H&&H<256&&k.push({type:2,index:H})}return k.length&&this._onColor.fire(k),!0}restoreFgColor(E){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(E){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(E){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,a.DEFAULT_CHARSET),!0}selectCharset(E){return E.length!==2?(this.selectDefaultCharset(),!0):(E[0]==="/"||this._charsetService.setgCharset(C[E[0]],a.CHARSETS[E[1]]||a.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let E=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,E,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=r.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(E){return this._charsetService.setgLevel(E),!0}screenAlignmentPattern(){let E=new h.CellData;E.content=4194304|"E".charCodeAt(0),E.fg=this._curAttrData.fg,E.bg=this._curAttrData.bg,this._setCursor(0,0);for(let k=0;k<this._bufferService.rows;++k){let O=this._activeBuffer.ybase+this._activeBuffer.y+k,P=this._activeBuffer.lines.get(O);P&&(P.fill(E),P.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(E,k){let O=this._bufferService.buffer,P=this._optionsService.rawOptions;return(H=>(this._coreService.triggerDataEvent(`${d.C0.ESC}${H}${d.C0.ESC}\\`),!0))(E==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:E==='"p'?'P1$r61;1"p':E==="r"?`P1$r${O.scrollTop+1};${O.scrollBottom+1}r`:E==="m"?"P1$r0m":E===" q"?`P1$r${{block:2,underline:4,bar:6}[P.cursorStyle]-(P.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(E,k){this._dirtyRowTracker.markRangeDirty(E,k)}}e.InputHandler=I;let N=class{constructor(F){this._bufferService=F,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(F){F<this.start?this.start=F:F>this.end&&(this.end=F)}markRangeDirty(F,E){F>E&&(T=F,F=E,E=T),F<this.start&&(this.start=F),E>this.end&&(this.end=E)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};N=l([u(0,y.IBufferService)],N)},844:(o,e)=>{function i(l){for(let u of l)u.dispose();l.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.toDisposable=e.Disposable=void 0,e.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let l of this._disposables)l.dispose();this._disposables.length=0}register(l){return this._disposables.push(l),l}unregister(l){let u=this._disposables.indexOf(l);u!==-1&&this._disposables.splice(u,1)}},e.toDisposable=function(l){return{dispose:l}},e.disposeArray=i,e.getDisposeArrayDisposable=function(l){return{dispose:()=>i(l)}}},1505:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FourKeyMap=e.TwoKeyMap=void 0;class i{constructor(){this._data={}}set(u,d,a){this._data[u]||(this._data[u]={}),this._data[u][d]=a}get(u,d){return this._data[u]?this._data[u][d]:void 0}clear(){this._data={}}}e.TwoKeyMap=i,e.FourKeyMap=class{constructor(){this._data=new i}set(l,u,d,a,f){this._data.get(l,u)||this._data.set(l,u,new i),this._data.get(l,u).set(d,a,f)}get(l,u,d,a){var f;return(f=this._data.get(l,u))===null||f===void 0?void 0:f.get(d,a)}clear(){this._data.clear()}}},6114:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isChromeOS=e.isLinux=e.isWindows=e.isIphone=e.isIpad=e.isMac=e.getSafariVersion=e.isSafari=e.isLegacyEdge=e.isFirefox=e.isNode=void 0,e.isNode=typeof navigator=="undefined";let i=e.isNode?"node":navigator.userAgent,l=e.isNode?"node":navigator.platform;e.isFirefox=i.includes("Firefox"),e.isLegacyEdge=i.includes("Edge"),e.isSafari=/^((?!chrome|android).)*safari/i.test(i),e.getSafariVersion=function(){if(!e.isSafari)return 0;let u=i.match(/Version\/(\d+)/);return u===null||u.length<2?0:parseInt(u[1])},e.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(l),e.isIpad=l==="iPad",e.isIphone=l==="iPhone",e.isWindows=["Windows","Win16","Win32","WinCE"].includes(l),e.isLinux=l.indexOf("Linux")>=0,e.isChromeOS=/\bCrOS\b/.test(i)},6106:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SortedList=void 0;let i=0;e.SortedList=class{constructor(l){this._getKey=l,this._array=[]}clear(){this._array.length=0}insert(l){this._array.length!==0?(i=this._search(this._getKey(l),0,this._array.length-1),this._array.splice(i,0,l)):this._array.push(l)}delete(l){if(this._array.length===0)return!1;let u=this._getKey(l);if(u===void 0||(i=this._search(u,0,this._array.length-1),i===-1)||this._getKey(this._array[i])!==u)return!1;do if(this._array[i]===l)return this._array.splice(i,1),!0;while(++i<this._array.length&&this._getKey(this._array[i])===u);return!1}*getKeyIterator(l){if(this._array.length!==0&&(i=this._search(l,0,this._array.length-1),!(i<0||i>=this._array.length)&&this._getKey(this._array[i])===l))do yield this._array[i];while(++i<this._array.length&&this._getKey(this._array[i])===l)}forEachByKey(l,u){if(this._array.length!==0&&(i=this._search(l,0,this._array.length-1),!(i<0||i>=this._array.length)&&this._getKey(this._array[i])===l))do u(this._array[i]);while(++i<this._array.length&&this._getKey(this._array[i])===l)}values(){return this._array.values()}_search(l,u,d){if(d<u)return u;let a=Math.floor((u+d)/2),f=this._getKey(this._array[a]);if(f>l)return this._search(l,u,a-1);if(f<l)return this._search(l,a+1,d);for(;a>0&&this._getKey(this._array[a-1])===l;)a--;return a}}},7226:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DebouncedIdleTask=e.IdleTaskQueue=e.PriorityTaskQueue=void 0;let l=i(6114);class u{constructor(){this._tasks=[],this._i=0}enqueue(f){this._tasks.push(f),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(f){this._idleCallback=void 0;let v=0,p=0,r=f.timeRemaining(),_=0;for(;this._i<this._tasks.length;){if(v=Date.now(),this._tasks[this._i]()||this._i++,v=Math.max(1,Date.now()-v),p=Math.max(v,p),_=f.timeRemaining(),1.5*p>_)return r-v<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(r-v))}ms`),void this._start();r=_}this.clear()}}class d extends u{_requestCallback(f){return setTimeout(()=>f(this._createDeadline(16)))}_cancelCallback(f){clearTimeout(f)}_createDeadline(f){let v=Date.now()+f;return{timeRemaining:()=>Math.max(0,v-Date.now())}}}e.PriorityTaskQueue=d,e.IdleTaskQueue=!l.isNode&&"requestIdleCallback"in window?class extends u{_requestCallback(a){return requestIdleCallback(a)}_cancelCallback(a){cancelIdleCallback(a)}}:d,e.DebouncedIdleTask=class{constructor(){this._queue=new e.IdleTaskQueue}set(a){this._queue.clear(),this._queue.enqueue(a)}flush(){this._queue.flush()}}},9282:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.updateWindowsModeWrappedState=void 0;let l=i(643);e.updateWindowsModeWrappedState=function(u){let d=u.buffer.lines.get(u.buffer.ybase+u.buffer.y-1),a=d==null?void 0:d.get(u.cols-1),f=u.buffer.lines.get(u.buffer.ybase+u.buffer.y);f&&a&&(f.isWrapped=a[l.CHAR_DATA_CODE_INDEX]!==l.NULL_CELL_CODE&&a[l.CHAR_DATA_CODE_INDEX]!==l.WHITESPACE_CELL_CODE)}},3734:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedAttrs=e.AttributeData=void 0;class i{constructor(){this.fg=0,this.bg=0,this.extended=new l}static toColorRGB(d){return[d>>>16&255,d>>>8&255,255&d]}static fromColorRGB(d){return(255&d[0])<<16|(255&d[1])<<8|255&d[2]}clone(){let d=new i;return d.fg=this.fg,d.bg=this.bg,d.extended=this.extended.clone(),d}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}e.AttributeData=i;class l{constructor(d=0,a=0){this._ext=0,this._urlId=0,this._ext=d,this._urlId=a}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(d){this._ext=d}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(d){this._ext&=-469762049,this._ext|=d<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(d){this._ext&=-67108864,this._ext|=67108863&d}get urlId(){return this._urlId}set urlId(d){this._urlId=d}clone(){return new l(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}e.ExtendedAttrs=l},9092:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferStringIterator=e.Buffer=e.MAX_BUFFER_SIZE=void 0;let l=i(6349),u=i(8437),d=i(511),a=i(643),f=i(4634),v=i(4863),p=i(7116),r=i(3734),_=i(7226);e.MAX_BUFFER_SIZE=4294967295,e.Buffer=class{constructor(h,m,y){this._hasScrollback=h,this._optionsService=m,this._bufferService=y,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=u.DEFAULT_ATTR_DATA.clone(),this.savedCharset=p.DEFAULT_CHARSET,this.markers=[],this._nullCell=d.CellData.fromCharData([0,a.NULL_CELL_CHAR,a.NULL_CELL_WIDTH,a.NULL_CELL_CODE]),this._whitespaceCell=d.CellData.fromCharData([0,a.WHITESPACE_CELL_CHAR,a.WHITESPACE_CELL_WIDTH,a.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new _.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(h){return h?(this._nullCell.fg=h.fg,this._nullCell.bg=h.bg,this._nullCell.extended=h.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new r.ExtendedAttrs),this._nullCell}getWhitespaceCell(h){return h?(this._whitespaceCell.fg=h.fg,this._whitespaceCell.bg=h.bg,this._whitespaceCell.extended=h.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new r.ExtendedAttrs),this._whitespaceCell}getBlankLine(h,m){return new u.BufferLine(this._bufferService.cols,this.getNullCell(h),m)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let h=this.ybase+this.y-this.ydisp;return h>=0&&h<this._rows}_getCorrectBufferLength(h){if(!this._hasScrollback)return h;let m=h+this._optionsService.rawOptions.scrollback;return m>e.MAX_BUFFER_SIZE?e.MAX_BUFFER_SIZE:m}fillViewportRows(h){if(this.lines.length===0){h===void 0&&(h=u.DEFAULT_ATTR_DATA);let m=this._rows;for(;m--;)this.lines.push(this.getBlankLine(h))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(h,m){let y=this.getNullCell(u.DEFAULT_ATTR_DATA),b=0,w=this._getCorrectBufferLength(m);if(w>this.lines.maxLength&&(this.lines.maxLength=w),this.lines.length>0){if(this._cols<h)for(let C=0;C<this.lines.length;C++)b+=+this.lines.get(C).resize(h,y);let S=0;if(this._rows<m)for(let C=this._rows;C<m;C++)this.lines.length<m+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new u.BufferLine(h,y)):this.ybase>0&&this.lines.length<=this.ybase+this.y+S+1?(this.ybase--,S++,this.ydisp>0&&this.ydisp--):this.lines.push(new u.BufferLine(h,y)));else for(let C=this._rows;C>m;C--)this.lines.length>m+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(w<this.lines.maxLength){let C=this.lines.length-w;C>0&&(this.lines.trimStart(C),this.ybase=Math.max(this.ybase-C,0),this.ydisp=Math.max(this.ydisp-C,0),this.savedY=Math.max(this.savedY-C,0)),this.lines.maxLength=w}this.x=Math.min(this.x,h-1),this.y=Math.min(this.y,m-1),S&&(this.y+=S),this.savedX=Math.min(this.savedX,h-1),this.scrollTop=0}if(this.scrollBottom=m-1,this._isReflowEnabled&&(this._reflow(h,m),this._cols>h))for(let S=0;S<this.lines.length;S++)b+=+this.lines.get(S).resize(h,y);this._cols=h,this._rows=m,this._memoryCleanupQueue.clear(),b>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let h=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,h=!1);let m=0;for(;this._memoryCleanupPosition<this.lines.length;)if(m+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),m>100)return!0;return h}get _isReflowEnabled(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(h,m){this._cols!==h&&(h>this._cols?this._reflowLarger(h,m):this._reflowSmaller(h,m))}_reflowLarger(h,m){let y=(0,f.reflowLargerGetLinesToRemove)(this.lines,this._cols,h,this.ybase+this.y,this.getNullCell(u.DEFAULT_ATTR_DATA));if(y.length>0){let b=(0,f.reflowLargerCreateNewLayout)(this.lines,y);(0,f.reflowLargerApplyNewLayout)(this.lines,b.layout),this._reflowLargerAdjustViewport(h,m,b.countRemoved)}}_reflowLargerAdjustViewport(h,m,y){let b=this.getNullCell(u.DEFAULT_ATTR_DATA),w=y;for(;w-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<m&&this.lines.push(new u.BufferLine(h,b))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-y,0)}_reflowSmaller(h,m){let y=this.getNullCell(u.DEFAULT_ATTR_DATA),b=[],w=0;for(let S=this.lines.length-1;S>=0;S--){let C=this.lines.get(S);if(!C||!C.isWrapped&&C.getTrimmedLength()<=h)continue;let x=[C];for(;C.isWrapped&&S>0;)C=this.lines.get(--S),x.unshift(C);let L=this.ybase+this.y;if(L>=S&&L<S+x.length)continue;let R=x[x.length-1].getTrimmedLength(),T=(0,f.reflowSmallerGetNewLineLengths)(x,this._cols,h),I=T.length-x.length,N;N=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+I):Math.max(0,this.lines.length-this.lines.maxLength+I);let F=[];for(let U=0;U<I;U++){let K=this.getBlankLine(u.DEFAULT_ATTR_DATA,!0);F.push(K)}F.length>0&&(b.push({start:S+x.length+w,newLines:F}),w+=F.length),x.push(...F);let E=T.length-1,k=T[E];k===0&&(E--,k=T[E]);let O=x.length-I-1,P=R;for(;O>=0;){let U=Math.min(P,k);if(x[E]===void 0)break;if(x[E].copyCellsFrom(x[O],P-U,k-U,U,!0),k-=U,k===0&&(E--,k=T[E]),P-=U,P===0){O--;let K=Math.max(O,0);P=(0,f.getWrappedLineTrimmedLength)(x,K,this._cols)}}for(let U=0;U<x.length;U++)T[U]<h&&x[U].setCell(T[U],y);let H=I-N;for(;H-- >0;)this.ybase===0?this.y<m-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+w)-m&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+I,this.ybase+m-1)}if(b.length>0){let S=[],C=[];for(let E=0;E<this.lines.length;E++)C.push(this.lines.get(E));let x=this.lines.length,L=x-1,R=0,T=b[R];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+w);let I=0;for(let E=Math.min(this.lines.maxLength-1,x+w-1);E>=0;E--)if(T&&T.start>L+I){for(let k=T.newLines.length-1;k>=0;k--)this.lines.set(E--,T.newLines[k]);E++,S.push({index:L+1,amount:T.newLines.length}),I+=T.newLines.length,T=b[++R]}else this.lines.set(E,C[L--]);let N=0;for(let E=S.length-1;E>=0;E--)S[E].index+=N,this.lines.onInsertEmitter.fire(S[E]),N+=S[E].amount;let F=Math.max(0,x+w-this.lines.maxLength);F>0&&this.lines.onTrimEmitter.fire(F)}}stringIndexToBufferIndex(h,m,y=!1){for(;m;){let b=this.lines.get(h);if(!b)return[-1,-1];let w=y?b.getTrimmedLength():b.length;for(let S=0;S<w;++S)if(b.get(S)[a.CHAR_DATA_WIDTH_INDEX]&&(m-=b.get(S)[a.CHAR_DATA_CHAR_INDEX].length||1),m<0)return[h,S];h++}return[h,0]}translateBufferLineToString(h,m,y=0,b){let w=this.lines.get(h);return w?w.translateToString(m,y,b):""}getWrappedRangeForLine(h){let m=h,y=h;for(;m>0&&this.lines.get(m).isWrapped;)m--;for(;y+1<this.lines.length&&this.lines.get(y+1).isWrapped;)y++;return{first:m,last:y}}setupTabStops(h){for(h!=null?this.tabs[h]||(h=this.prevStop(h)):(this.tabs={},h=0);h<this._cols;h+=this._optionsService.rawOptions.tabStopWidth)this.tabs[h]=!0}prevStop(h){for(h==null&&(h=this.x);!this.tabs[--h]&&h>0;);return h>=this._cols?this._cols-1:h<0?0:h}nextStop(h){for(h==null&&(h=this.x);!this.tabs[++h]&&h<this._cols;);return h>=this._cols?this._cols-1:h<0?0:h}clearMarkers(h){this._isClearing=!0;for(let m=0;m<this.markers.length;m++)this.markers[m].line===h&&(this.markers[m].dispose(),this.markers.splice(m--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let h=0;h<this.markers.length;h++)this.markers[h].dispose(),this.markers.splice(h--,1);this._isClearing=!1}addMarker(h){let m=new v.Marker(h);return this.markers.push(m),m.register(this.lines.onTrim(y=>{m.line-=y,m.line<0&&m.dispose()})),m.register(this.lines.onInsert(y=>{m.line>=y.index&&(m.line+=y.amount)})),m.register(this.lines.onDelete(y=>{m.line>=y.index&&m.line<y.index+y.amount&&m.dispose(),m.line>y.index&&(m.line-=y.amount)})),m.register(m.onDispose(()=>this._removeMarker(m))),m}_removeMarker(h){this._isClearing||this.markers.splice(this.markers.indexOf(h),1)}iterator(h,m,y,b,w){return new g(this,h,m,y,b,w)}};class g{constructor(m,y,b=0,w=m.lines.length,S=0,C=0){this._buffer=m,this._trimRight=y,this._startIndex=b,this._endIndex=w,this._startOverscan=S,this._endOverscan=C,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}hasNext(){return this._current<this._endIndex}next(){let m=this._buffer.getWrappedRangeForLine(this._current);m.first<this._startIndex-this._startOverscan&&(m.first=this._startIndex-this._startOverscan),m.last>this._endIndex+this._endOverscan&&(m.last=this._endIndex+this._endOverscan),m.first=Math.max(m.first,0),m.last=Math.min(m.last,this._buffer.lines.length);let y="";for(let b=m.first;b<=m.last;++b)y+=this._buffer.translateBufferLineToString(b,this._trimRight);return this._current=m.last+1,{range:m,content:y}}}e.BufferStringIterator=g},8437:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferLine=e.DEFAULT_ATTR_DATA=void 0;let l=i(482),u=i(643),d=i(511),a=i(3734);e.DEFAULT_ATTR_DATA=Object.freeze(new a.AttributeData);let f=0;class v{constructor(r,_,g=!1){this.isWrapped=g,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*r);let h=_||d.CellData.fromCharData([0,u.NULL_CELL_CHAR,u.NULL_CELL_WIDTH,u.NULL_CELL_CODE]);for(let m=0;m<r;++m)this.setCell(m,h);this.length=r}get(r){let _=this._data[3*r+0],g=2097151&_;return[this._data[3*r+1],2097152&_?this._combined[r]:g?(0,l.stringFromCodePoint)(g):"",_>>22,2097152&_?this._combined[r].charCodeAt(this._combined[r].length-1):g]}set(r,_){this._data[3*r+1]=_[u.CHAR_DATA_ATTR_INDEX],_[u.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[r]=_[1],this._data[3*r+0]=2097152|r|_[u.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*r+0]=_[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|_[u.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(r){return this._data[3*r+0]>>22}hasWidth(r){return 12582912&this._data[3*r+0]}getFg(r){return this._data[3*r+1]}getBg(r){return this._data[3*r+2]}hasContent(r){return 4194303&this._data[3*r+0]}getCodePoint(r){let _=this._data[3*r+0];return 2097152&_?this._combined[r].charCodeAt(this._combined[r].length-1):2097151&_}isCombined(r){return 2097152&this._data[3*r+0]}getString(r){let _=this._data[3*r+0];return 2097152&_?this._combined[r]:2097151&_?(0,l.stringFromCodePoint)(2097151&_):""}isProtected(r){return 536870912&this._data[3*r+2]}loadCell(r,_){return f=3*r,_.content=this._data[f+0],_.fg=this._data[f+1],_.bg=this._data[f+2],2097152&_.content&&(_.combinedData=this._combined[r]),268435456&_.bg&&(_.extended=this._extendedAttrs[r]),_}setCell(r,_){2097152&_.content&&(this._combined[r]=_.combinedData),268435456&_.bg&&(this._extendedAttrs[r]=_.extended),this._data[3*r+0]=_.content,this._data[3*r+1]=_.fg,this._data[3*r+2]=_.bg}setCellFromCodePoint(r,_,g,h,m,y){268435456&m&&(this._extendedAttrs[r]=y),this._data[3*r+0]=_|g<<22,this._data[3*r+1]=h,this._data[3*r+2]=m}addCodepointToCell(r,_){let g=this._data[3*r+0];2097152&g?this._combined[r]+=(0,l.stringFromCodePoint)(_):(2097151&g?(this._combined[r]=(0,l.stringFromCodePoint)(2097151&g)+(0,l.stringFromCodePoint)(_),g&=-2097152,g|=2097152):g=_|4194304,this._data[3*r+0]=g)}insertCells(r,_,g,h){if((r%=this.length)&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs),_<this.length-r){let m=new d.CellData;for(let y=this.length-r-_-1;y>=0;--y)this.setCell(r+_+y,this.loadCell(r+y,m));for(let y=0;y<_;++y)this.setCell(r+y,g)}else for(let m=r;m<this.length;++m)this.setCell(m,g);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs)}deleteCells(r,_,g,h){if(r%=this.length,_<this.length-r){let m=new d.CellData;for(let y=0;y<this.length-r-_;++y)this.setCell(r+y,this.loadCell(r+_+y,m));for(let y=this.length-_;y<this.length;++y)this.setCell(y,g)}else for(let m=r;m<this.length;++m)this.setCell(m,g);r&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs),this.getWidth(r)!==0||this.hasContent(r)||this.setCellFromCodePoint(r,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs)}replaceCells(r,_,g,h,m=!1){if(m)for(r&&this.getWidth(r-1)===2&&!this.isProtected(r-1)&&this.setCellFromCodePoint(r-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs),_<this.length&&this.getWidth(_-1)===2&&!this.isProtected(_)&&this.setCellFromCodePoint(_,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs);r<_&&r<this.length;)this.isProtected(r)||this.setCell(r,g),r++;else for(r&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs),_<this.length&&this.getWidth(_-1)===2&&this.setCellFromCodePoint(_,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new a.ExtendedAttrs);r<_&&r<this.length;)this.setCell(r++,g)}resize(r,_){if(r===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;let g=3*r;if(r>this.length){if(this._data.buffer.byteLength>=4*g)this._data=new Uint32Array(this._data.buffer,0,g);else{let h=new Uint32Array(g);h.set(this._data),this._data=h}for(let h=this.length;h<r;++h)this.setCell(h,_)}else{this._data=this._data.subarray(0,g);let h=Object.keys(this._combined);for(let y=0;y<h.length;y++){let b=parseInt(h[y],10);b>=r&&delete this._combined[b]}let m=Object.keys(this._extendedAttrs);for(let y=0;y<m.length;y++){let b=parseInt(m[y],10);b>=r&&delete this._extendedAttrs[b]}}return this.length=r,4*g*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){let r=new Uint32Array(this._data.length);return r.set(this._data),this._data=r,1}return 0}fill(r,_=!1){if(_)for(let g=0;g<this.length;++g)this.isProtected(g)||this.setCell(g,r);else{this._combined={},this._extendedAttrs={};for(let g=0;g<this.length;++g)this.setCell(g,r)}}copyFrom(r){this.length!==r.length?this._data=new Uint32Array(r._data):this._data.set(r._data),this.length=r.length,this._combined={};for(let _ in r._combined)this._combined[_]=r._combined[_];this._extendedAttrs={};for(let _ in r._extendedAttrs)this._extendedAttrs[_]=r._extendedAttrs[_];this.isWrapped=r.isWrapped}clone(){let r=new v(0);r._data=new Uint32Array(this._data),r.length=this.length;for(let _ in this._combined)r._combined[_]=this._combined[_];for(let _ in this._extendedAttrs)r._extendedAttrs[_]=this._extendedAttrs[_];return r.isWrapped=this.isWrapped,r}getTrimmedLength(){for(let r=this.length-1;r>=0;--r)if(4194303&this._data[3*r+0])return r+(this._data[3*r+0]>>22);return 0}copyCellsFrom(r,_,g,h,m){let y=r._data;if(m)for(let w=h-1;w>=0;w--){for(let S=0;S<3;S++)this._data[3*(g+w)+S]=y[3*(_+w)+S];268435456&y[3*(_+w)+2]&&(this._extendedAttrs[g+w]=r._extendedAttrs[_+w])}else for(let w=0;w<h;w++){for(let S=0;S<3;S++)this._data[3*(g+w)+S]=y[3*(_+w)+S];268435456&y[3*(_+w)+2]&&(this._extendedAttrs[g+w]=r._extendedAttrs[_+w])}let b=Object.keys(r._combined);for(let w=0;w<b.length;w++){let S=parseInt(b[w],10);S>=_&&(this._combined[S-_+g]=r._combined[S])}}translateToString(r=!1,_=0,g=this.length){r&&(g=Math.min(g,this.getTrimmedLength()));let h="";for(;_<g;){let m=this._data[3*_+0],y=2097151&m;h+=2097152&m?this._combined[_]:y?(0,l.stringFromCodePoint)(y):u.WHITESPACE_CELL_CHAR,_+=m>>22||1}return h}}e.BufferLine=v},4841:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getRangeLength=void 0,e.getRangeLength=function(i,l){if(i.start.y>i.end.y)throw new Error(`Buffer range end (${i.end.x}, ${i.end.y}) cannot be before start (${i.start.x}, ${i.start.y})`);return l*(i.end.y-i.start.y)+(i.end.x-i.start.x+1)}},4634:(o,e)=>{function i(l,u,d){if(u===l.length-1)return l[u].getTrimmedLength();let a=!l[u].hasContent(d-1)&&l[u].getWidth(d-1)===1,f=l[u+1].getWidth(0)===2;return a&&f?d-1:d}Object.defineProperty(e,"__esModule",{value:!0}),e.getWrappedLineTrimmedLength=e.reflowSmallerGetNewLineLengths=e.reflowLargerApplyNewLayout=e.reflowLargerCreateNewLayout=e.reflowLargerGetLinesToRemove=void 0,e.reflowLargerGetLinesToRemove=function(l,u,d,a,f){let v=[];for(let p=0;p<l.length-1;p++){let r=p,_=l.get(++r);if(!_.isWrapped)continue;let g=[l.get(p)];for(;r<l.length&&_.isWrapped;)g.push(_),_=l.get(++r);if(a>=p&&a<r){p+=g.length-1;continue}let h=0,m=i(g,h,u),y=1,b=0;for(;y<g.length;){let S=i(g,y,u),C=S-b,x=d-m,L=Math.min(C,x);g[h].copyCellsFrom(g[y],b,m,L,!1),m+=L,m===d&&(h++,m=0),b+=L,b===S&&(y++,b=0),m===0&&h!==0&&g[h-1].getWidth(d-1)===2&&(g[h].copyCellsFrom(g[h-1],d-1,m++,1,!1),g[h-1].setCell(d-1,f))}g[h].replaceCells(m,d,f);let w=0;for(let S=g.length-1;S>0&&(S>h||g[S].getTrimmedLength()===0);S--)w++;w>0&&(v.push(p+g.length-w),v.push(w)),p+=g.length-1}return v},e.reflowLargerCreateNewLayout=function(l,u){let d=[],a=0,f=u[a],v=0;for(let p=0;p<l.length;p++)if(f===p){let r=u[++a];l.onDeleteEmitter.fire({index:p-v,amount:r}),p+=r-1,v+=r,f=u[++a]}else d.push(p);return{layout:d,countRemoved:v}},e.reflowLargerApplyNewLayout=function(l,u){let d=[];for(let a=0;a<u.length;a++)d.push(l.get(u[a]));for(let a=0;a<d.length;a++)l.set(a,d[a]);l.length=u.length},e.reflowSmallerGetNewLineLengths=function(l,u,d){let a=[],f=l.map((_,g)=>i(l,g,u)).reduce((_,g)=>_+g),v=0,p=0,r=0;for(;r<f;){if(f-r<d){a.push(f-r);break}v+=d;let _=i(l,p,u);v>_&&(v-=_,p++);let g=l[p].getWidth(v-1)===2;g&&v--;let h=g?d-1:d;a.push(h),r+=h}return a},e.getWrappedLineTrimmedLength=i},5295:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferSet=void 0;let l=i(9092),u=i(8460),d=i(844);class a extends d.Disposable{constructor(v,p){super(),this._optionsService=v,this._bufferService=p,this._onBufferActivate=this.register(new u.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new l.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new l.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(v){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(v),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(v,p){this._normal.resize(v,p),this._alt.resize(v,p),this.setupTabStops(v)}setupTabStops(v){this._normal.setupTabStops(v),this._alt.setupTabStops(v)}}e.BufferSet=a},511:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CellData=void 0;let l=i(482),u=i(643),d=i(3734);class a extends d.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new d.ExtendedAttrs,this.combinedData=""}static fromCharData(v){let p=new a;return p.setFromCharData(v),p}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,l.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(v){this.fg=v[u.CHAR_DATA_ATTR_INDEX],this.bg=0;let p=!1;if(v[u.CHAR_DATA_CHAR_INDEX].length>2)p=!0;else if(v[u.CHAR_DATA_CHAR_INDEX].length===2){let r=v[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=r&&r<=56319){let _=v[u.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=_&&_<=57343?this.content=1024*(r-55296)+_-56320+65536|v[u.CHAR_DATA_WIDTH_INDEX]<<22:p=!0}else p=!0}else this.content=v[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[u.CHAR_DATA_WIDTH_INDEX]<<22;p&&(this.combinedData=v[u.CHAR_DATA_CHAR_INDEX],this.content=2097152|v[u.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.CellData=a},643:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WHITESPACE_CELL_CODE=e.WHITESPACE_CELL_WIDTH=e.WHITESPACE_CELL_CHAR=e.NULL_CELL_CODE=e.NULL_CELL_WIDTH=e.NULL_CELL_CHAR=e.CHAR_DATA_CODE_INDEX=e.CHAR_DATA_WIDTH_INDEX=e.CHAR_DATA_CHAR_INDEX=e.CHAR_DATA_ATTR_INDEX=e.DEFAULT_EXT=e.DEFAULT_ATTR=e.DEFAULT_COLOR=void 0,e.DEFAULT_COLOR=0,e.DEFAULT_ATTR=256|e.DEFAULT_COLOR<<9,e.DEFAULT_EXT=0,e.CHAR_DATA_ATTR_INDEX=0,e.CHAR_DATA_CHAR_INDEX=1,e.CHAR_DATA_WIDTH_INDEX=2,e.CHAR_DATA_CODE_INDEX=3,e.NULL_CELL_CHAR="",e.NULL_CELL_WIDTH=1,e.NULL_CELL_CODE=0,e.WHITESPACE_CELL_CHAR=" ",e.WHITESPACE_CELL_WIDTH=1,e.WHITESPACE_CELL_CODE=32},4863:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Marker=void 0;let l=i(8460),u=i(844);class d{constructor(f){this.line=f,this.isDisposed=!1,this._disposables=[],this._id=d._nextId++,this._onDispose=this.register(new l.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,u.disposeArray)(this._disposables),this._disposables.length=0)}register(f){return this._disposables.push(f),f}}e.Marker=d,d._nextId=1},7116:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_CHARSET=e.CHARSETS=void 0,e.CHARSETS={},e.DEFAULT_CHARSET=e.CHARSETS.B,e.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},e.CHARSETS.A={"#":"\xA3"},e.CHARSETS.B=void 0,e.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},e.CHARSETS.C=e.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},e.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},e.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},e.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},e.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},e.CHARSETS.E=e.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},e.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},e.CHARSETS.H=e.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},e.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:(o,e)=>{var i,l;Object.defineProperty(e,"__esModule",{value:!0}),e.C1_ESCAPED=e.C1=e.C0=void 0,function(u){u.NUL="\0",u.SOH="",u.STX="",u.ETX="",u.EOT="",u.ENQ="",u.ACK="",u.BEL="\x07",u.BS="\b",u.HT="	",u.LF=`
`,u.VT="\v",u.FF="\f",u.CR="\r",u.SO="",u.SI="",u.DLE="",u.DC1="",u.DC2="",u.DC3="",u.DC4="",u.NAK="",u.SYN="",u.ETB="",u.CAN="",u.EM="",u.SUB="",u.ESC="\x1B",u.FS="",u.GS="",u.RS="",u.US="",u.SP=" ",u.DEL="\x7F"}(i=e.C0||(e.C0={})),(l=e.C1||(e.C1={})).PAD="\x80",l.HOP="\x81",l.BPH="\x82",l.NBH="\x83",l.IND="\x84",l.NEL="\x85",l.SSA="\x86",l.ESA="\x87",l.HTS="\x88",l.HTJ="\x89",l.VTS="\x8A",l.PLD="\x8B",l.PLU="\x8C",l.RI="\x8D",l.SS2="\x8E",l.SS3="\x8F",l.DCS="\x90",l.PU1="\x91",l.PU2="\x92",l.STS="\x93",l.CCH="\x94",l.MW="\x95",l.SPA="\x96",l.EPA="\x97",l.SOS="\x98",l.SGCI="\x99",l.SCI="\x9A",l.CSI="\x9B",l.ST="\x9C",l.OSC="\x9D",l.PM="\x9E",l.APC="\x9F",(e.C1_ESCAPED||(e.C1_ESCAPED={})).ST=`${i.ESC}\\`},7399:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.evaluateKeyboardEvent=void 0;let l=i(2584),u={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};e.evaluateKeyboardEvent=function(d,a,f,v){let p={type:0,cancel:!1,key:void 0},r=(d.shiftKey?1:0)|(d.altKey?2:0)|(d.ctrlKey?4:0)|(d.metaKey?8:0);switch(d.keyCode){case 0:d.key==="UIKeyInputUpArrow"?p.key=a?l.C0.ESC+"OA":l.C0.ESC+"[A":d.key==="UIKeyInputLeftArrow"?p.key=a?l.C0.ESC+"OD":l.C0.ESC+"[D":d.key==="UIKeyInputRightArrow"?p.key=a?l.C0.ESC+"OC":l.C0.ESC+"[C":d.key==="UIKeyInputDownArrow"&&(p.key=a?l.C0.ESC+"OB":l.C0.ESC+"[B");break;case 8:if(d.altKey){p.key=l.C0.ESC+l.C0.DEL;break}p.key=l.C0.DEL;break;case 9:if(d.shiftKey){p.key=l.C0.ESC+"[Z";break}p.key=l.C0.HT,p.cancel=!0;break;case 13:p.key=d.altKey?l.C0.ESC+l.C0.CR:l.C0.CR,p.cancel=!0;break;case 27:p.key=l.C0.ESC,d.altKey&&(p.key=l.C0.ESC+l.C0.ESC),p.cancel=!0;break;case 37:if(d.metaKey)break;r?(p.key=l.C0.ESC+"[1;"+(r+1)+"D",p.key===l.C0.ESC+"[1;3D"&&(p.key=l.C0.ESC+(f?"b":"[1;5D"))):p.key=a?l.C0.ESC+"OD":l.C0.ESC+"[D";break;case 39:if(d.metaKey)break;r?(p.key=l.C0.ESC+"[1;"+(r+1)+"C",p.key===l.C0.ESC+"[1;3C"&&(p.key=l.C0.ESC+(f?"f":"[1;5C"))):p.key=a?l.C0.ESC+"OC":l.C0.ESC+"[C";break;case 38:if(d.metaKey)break;r?(p.key=l.C0.ESC+"[1;"+(r+1)+"A",f||p.key!==l.C0.ESC+"[1;3A"||(p.key=l.C0.ESC+"[1;5A")):p.key=a?l.C0.ESC+"OA":l.C0.ESC+"[A";break;case 40:if(d.metaKey)break;r?(p.key=l.C0.ESC+"[1;"+(r+1)+"B",f||p.key!==l.C0.ESC+"[1;3B"||(p.key=l.C0.ESC+"[1;5B")):p.key=a?l.C0.ESC+"OB":l.C0.ESC+"[B";break;case 45:d.shiftKey||d.ctrlKey||(p.key=l.C0.ESC+"[2~");break;case 46:p.key=r?l.C0.ESC+"[3;"+(r+1)+"~":l.C0.ESC+"[3~";break;case 36:p.key=r?l.C0.ESC+"[1;"+(r+1)+"H":a?l.C0.ESC+"OH":l.C0.ESC+"[H";break;case 35:p.key=r?l.C0.ESC+"[1;"+(r+1)+"F":a?l.C0.ESC+"OF":l.C0.ESC+"[F";break;case 33:d.shiftKey?p.type=2:d.ctrlKey?p.key=l.C0.ESC+"[5;"+(r+1)+"~":p.key=l.C0.ESC+"[5~";break;case 34:d.shiftKey?p.type=3:d.ctrlKey?p.key=l.C0.ESC+"[6;"+(r+1)+"~":p.key=l.C0.ESC+"[6~";break;case 112:p.key=r?l.C0.ESC+"[1;"+(r+1)+"P":l.C0.ESC+"OP";break;case 113:p.key=r?l.C0.ESC+"[1;"+(r+1)+"Q":l.C0.ESC+"OQ";break;case 114:p.key=r?l.C0.ESC+"[1;"+(r+1)+"R":l.C0.ESC+"OR";break;case 115:p.key=r?l.C0.ESC+"[1;"+(r+1)+"S":l.C0.ESC+"OS";break;case 116:p.key=r?l.C0.ESC+"[15;"+(r+1)+"~":l.C0.ESC+"[15~";break;case 117:p.key=r?l.C0.ESC+"[17;"+(r+1)+"~":l.C0.ESC+"[17~";break;case 118:p.key=r?l.C0.ESC+"[18;"+(r+1)+"~":l.C0.ESC+"[18~";break;case 119:p.key=r?l.C0.ESC+"[19;"+(r+1)+"~":l.C0.ESC+"[19~";break;case 120:p.key=r?l.C0.ESC+"[20;"+(r+1)+"~":l.C0.ESC+"[20~";break;case 121:p.key=r?l.C0.ESC+"[21;"+(r+1)+"~":l.C0.ESC+"[21~";break;case 122:p.key=r?l.C0.ESC+"[23;"+(r+1)+"~":l.C0.ESC+"[23~";break;case 123:p.key=r?l.C0.ESC+"[24;"+(r+1)+"~":l.C0.ESC+"[24~";break;default:if(!d.ctrlKey||d.shiftKey||d.altKey||d.metaKey)if(f&&!v||!d.altKey||d.metaKey)!f||d.altKey||d.ctrlKey||d.shiftKey||!d.metaKey?d.key&&!d.ctrlKey&&!d.altKey&&!d.metaKey&&d.keyCode>=48&&d.key.length===1?p.key=d.key:d.key&&d.ctrlKey&&(d.key==="_"&&(p.key=l.C0.US),d.key==="@"&&(p.key=l.C0.NUL)):d.keyCode===65&&(p.type=1);else{let _=u[d.keyCode],g=_==null?void 0:_[d.shiftKey?1:0];if(g)p.key=l.C0.ESC+g;else if(d.keyCode>=65&&d.keyCode<=90){let h=d.ctrlKey?d.keyCode-64:d.keyCode+32,m=String.fromCharCode(h);d.shiftKey&&(m=m.toUpperCase()),p.key=l.C0.ESC+m}else if(d.keyCode===32)p.key=l.C0.ESC+(d.ctrlKey?l.C0.NUL:" ");else if(d.key==="Dead"&&d.code.startsWith("Key")){let h=d.code.slice(3,4);d.shiftKey||(h=h.toLowerCase()),p.key=l.C0.ESC+h,p.cancel=!0}}else d.keyCode>=65&&d.keyCode<=90?p.key=String.fromCharCode(d.keyCode-64):d.keyCode===32?p.key=l.C0.NUL:d.keyCode>=51&&d.keyCode<=55?p.key=String.fromCharCode(d.keyCode-51+27):d.keyCode===56?p.key=l.C0.DEL:d.keyCode===219?p.key=l.C0.ESC:d.keyCode===220?p.key=l.C0.FS:d.keyCode===221&&(p.key=l.C0.GS)}return p}},482:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Utf8ToUtf32=e.StringToUtf32=e.utf32ToString=e.stringFromCodePoint=void 0,e.stringFromCodePoint=function(i){return i>65535?(i-=65536,String.fromCharCode(55296+(i>>10))+String.fromCharCode(i%1024+56320)):String.fromCharCode(i)},e.utf32ToString=function(i,l=0,u=i.length){let d="";for(let a=l;a<u;++a){let f=i[a];f>65535?(f-=65536,d+=String.fromCharCode(55296+(f>>10))+String.fromCharCode(f%1024+56320)):d+=String.fromCharCode(f)}return d},e.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(i,l){let u=i.length;if(!u)return 0;let d=0,a=0;if(this._interim){let f=i.charCodeAt(a++);56320<=f&&f<=57343?l[d++]=1024*(this._interim-55296)+f-56320+65536:(l[d++]=this._interim,l[d++]=f),this._interim=0}for(let f=a;f<u;++f){let v=i.charCodeAt(f);if(55296<=v&&v<=56319){if(++f>=u)return this._interim=v,d;let p=i.charCodeAt(f);56320<=p&&p<=57343?l[d++]=1024*(v-55296)+p-56320+65536:(l[d++]=v,l[d++]=p)}else v!==65279&&(l[d++]=v)}return d}},e.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(i,l){let u=i.length;if(!u)return 0;let d,a,f,v,p=0,r=0,_=0;if(this.interim[0]){let m=!1,y=this.interim[0];y&=(224&y)==192?31:(240&y)==224?15:7;let b,w=0;for(;(b=63&this.interim[++w])&&w<4;)y<<=6,y|=b;let S=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,C=S-w;for(;_<C;){if(_>=u)return 0;if(b=i[_++],(192&b)!=128){_--,m=!0;break}this.interim[w++]=b,y<<=6,y|=63&b}m||(S===2?y<128?_--:l[p++]=y:S===3?y<2048||y>=55296&&y<=57343||y===65279||(l[p++]=y):y<65536||y>1114111||(l[p++]=y)),this.interim.fill(0)}let g=u-4,h=_;for(;h<u;){for(;!(!(h<g)||128&(d=i[h])||128&(a=i[h+1])||128&(f=i[h+2])||128&(v=i[h+3]));)l[p++]=d,l[p++]=a,l[p++]=f,l[p++]=v,h+=4;if(d=i[h++],d<128)l[p++]=d;else if((224&d)==192){if(h>=u)return this.interim[0]=d,p;if(a=i[h++],(192&a)!=128){h--;continue}if(r=(31&d)<<6|63&a,r<128){h--;continue}l[p++]=r}else if((240&d)==224){if(h>=u)return this.interim[0]=d,p;if(a=i[h++],(192&a)!=128){h--;continue}if(h>=u)return this.interim[0]=d,this.interim[1]=a,p;if(f=i[h++],(192&f)!=128){h--;continue}if(r=(15&d)<<12|(63&a)<<6|63&f,r<2048||r>=55296&&r<=57343||r===65279)continue;l[p++]=r}else if((248&d)==240){if(h>=u)return this.interim[0]=d,p;if(a=i[h++],(192&a)!=128){h--;continue}if(h>=u)return this.interim[0]=d,this.interim[1]=a,p;if(f=i[h++],(192&f)!=128){h--;continue}if(h>=u)return this.interim[0]=d,this.interim[1]=a,this.interim[2]=f,p;if(v=i[h++],(192&v)!=128){h--;continue}if(r=(7&d)<<18|(63&a)<<12|(63&f)<<6|63&v,r<65536||r>1114111)continue;l[p++]=r}}return p}}},225:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeV6=void 0;let i=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],l=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],u;e.UnicodeV6=class{constructor(){if(this.version="6",!u){u=new Uint8Array(65536),u.fill(1),u[0]=0,u.fill(0,1,32),u.fill(0,127,160),u.fill(2,4352,4448),u[9001]=2,u[9002]=2,u.fill(2,11904,42192),u[12351]=1,u.fill(2,44032,55204),u.fill(2,63744,64256),u.fill(2,65040,65050),u.fill(2,65072,65136),u.fill(2,65280,65377),u.fill(2,65504,65511);for(let d=0;d<i.length;++d)u.fill(0,i[d][0],i[d][1]+1)}}wcwidth(d){return d<32?0:d<127?1:d<65536?u[d]:function(a,f){let v,p=0,r=f.length-1;if(a<f[0][0]||a>f[r][1])return!1;for(;r>=p;)if(v=p+r>>1,a>f[v][1])p=v+1;else{if(!(a<f[v][0]))return!0;r=v-1}return!1}(d,l)?0:d>=131072&&d<=196605||d>=196608&&d<=262141?2:1}}},5981:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WriteBuffer=void 0;let l=i(8460),u=i(844);class d extends u.Disposable{constructor(f){super(),this._action=f,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new l.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(f,v){if(v!==void 0&&this._syncCalls>v)return void(this._syncCalls=0);if(this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let p;for(this._isSyncWriting=!0;p=this._writeBuffer.shift();){this._action(p);let r=this._callbacks.shift();r&&r()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(f,v){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(v),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(v)}_innerWrite(f=0,v=!0){let p=f||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){let r=this._writeBuffer[this._bufferOffset],_=this._action(r,v);if(_){let h=m=>Date.now()-p>=12?setTimeout(()=>this._innerWrite(0,m)):this._innerWrite(p,m);return void _.catch(m=>(queueMicrotask(()=>{throw m}),Promise.resolve(!1))).then(h)}let g=this._callbacks[this._bufferOffset];if(g&&g(),this._bufferOffset++,this._pendingData-=r.length,Date.now()-p>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}e.WriteBuffer=d},5941:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.toRgbString=e.parseColor=void 0;let i=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,l=/^[\da-f]+$/;function u(d,a){let f=d.toString(16),v=f.length<2?"0"+f:f;switch(a){case 4:return f[0];case 8:return v;case 12:return(v+v).slice(0,3);default:return v+v}}e.parseColor=function(d){if(!d)return;let a=d.toLowerCase();if(a.indexOf("rgb:")===0){a=a.slice(4);let f=i.exec(a);if(f){let v=f[1]?15:f[4]?255:f[7]?4095:65535;return[Math.round(parseInt(f[1]||f[4]||f[7]||f[10],16)/v*255),Math.round(parseInt(f[2]||f[5]||f[8]||f[11],16)/v*255),Math.round(parseInt(f[3]||f[6]||f[9]||f[12],16)/v*255)]}}else if(a.indexOf("#")===0&&(a=a.slice(1),l.exec(a)&&[3,6,9,12].includes(a.length))){let f=a.length/3,v=[0,0,0];for(let p=0;p<3;++p){let r=parseInt(a.slice(f*p,f*p+f),16);v[p]=f===1?r<<4:f===2?r:f===3?r>>4:r>>8}return v}},e.toRgbString=function(d,a=16){let[f,v,p]=d;return`rgb:${u(f,a)}/${u(v,a)}/${u(p,a)}`}},5770:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PAYLOAD_LIMIT=void 0,e.PAYLOAD_LIMIT=1e7},6351:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DcsHandler=e.DcsParser=void 0;let l=i(482),u=i(8742),d=i(5770),a=[];e.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=a,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=a}registerHandler(v,p){this._handlers[v]===void 0&&(this._handlers[v]=[]);let r=this._handlers[v];return r.push(p),{dispose:()=>{let _=r.indexOf(p);_!==-1&&r.splice(_,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}reset(){if(this._active.length)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].unhook(!1);this._stack.paused=!1,this._active=a,this._ident=0}hook(v,p){if(this.reset(),this._ident=v,this._active=this._handlers[v]||a,this._active.length)for(let r=this._active.length-1;r>=0;r--)this._active[r].hook(p);else this._handlerFb(this._ident,"HOOK",p)}put(v,p,r){if(this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].put(v,p,r);else this._handlerFb(this._ident,"PUT",(0,l.utf32ToString)(v,p,r))}unhook(v,p=!0){if(this._active.length){let r=!1,_=this._active.length-1,g=!1;if(this._stack.paused&&(_=this._stack.loopPosition-1,r=p,g=this._stack.fallThrough,this._stack.paused=!1),!g&&r===!1){for(;_>=0&&(r=this._active[_].unhook(v),r!==!0);_--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!1,r;_--}for(;_>=0;_--)if(r=this._active[_].unhook(!1),r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!0,r}else this._handlerFb(this._ident,"UNHOOK",v);this._active=a,this._ident=0}};let f=new u.Params;f.addParam(0),e.DcsHandler=class{constructor(v){this._handler=v,this._data="",this._params=f,this._hitLimit=!1}hook(v){this._params=v.length>1||v.params[0]?v.clone():f,this._data="",this._hitLimit=!1}put(v,p,r){this._hitLimit||(this._data+=(0,l.utf32ToString)(v,p,r),this._data.length>d.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(v){let p=!1;if(this._hitLimit)p=!1;else if(v&&(p=this._handler(this._data,this._params),p instanceof Promise))return p.then(r=>(this._params=f,this._data="",this._hitLimit=!1,r));return this._params=f,this._data="",this._hitLimit=!1,p}}},2015:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EscapeSequenceParser=e.VT500_TRANSITION_TABLE=e.TransitionTable=void 0;let l=i(844),u=i(8742),d=i(6242),a=i(6351);class f{constructor(_){this.table=new Uint8Array(_)}setDefault(_,g){this.table.fill(_<<4|g)}add(_,g,h,m){this.table[g<<8|_]=h<<4|m}addMany(_,g,h,m){for(let y=0;y<_.length;y++)this.table[g<<8|_[y]]=h<<4|m}}e.TransitionTable=f;let v=160;e.VT500_TRANSITION_TABLE=function(){let r=new f(4095),_=Array.apply(null,Array(256)).map((w,S)=>S),g=(w,S)=>_.slice(w,S),h=g(32,127),m=g(0,24);m.push(25),m.push.apply(m,g(28,32));let y=g(0,14),b;for(b in r.setDefault(1,0),r.addMany(h,0,2,0),y)r.addMany([24,26,153,154],b,3,0),r.addMany(g(128,144),b,3,0),r.addMany(g(144,152),b,3,0),r.add(156,b,0,0),r.add(27,b,11,1),r.add(157,b,4,8),r.addMany([152,158,159],b,0,7),r.add(155,b,11,3),r.add(144,b,11,9);return r.addMany(m,0,3,0),r.addMany(m,1,3,1),r.add(127,1,0,1),r.addMany(m,8,0,8),r.addMany(m,3,3,3),r.add(127,3,0,3),r.addMany(m,4,3,4),r.add(127,4,0,4),r.addMany(m,6,3,6),r.addMany(m,5,3,5),r.add(127,5,0,5),r.addMany(m,2,3,2),r.add(127,2,0,2),r.add(93,1,4,8),r.addMany(h,8,5,8),r.add(127,8,5,8),r.addMany([156,27,24,26,7],8,6,0),r.addMany(g(28,32),8,0,8),r.addMany([88,94,95],1,0,7),r.addMany(h,7,0,7),r.addMany(m,7,0,7),r.add(156,7,0,0),r.add(127,7,0,7),r.add(91,1,11,3),r.addMany(g(64,127),3,7,0),r.addMany(g(48,60),3,8,4),r.addMany([60,61,62,63],3,9,4),r.addMany(g(48,60),4,8,4),r.addMany(g(64,127),4,7,0),r.addMany([60,61,62,63],4,0,6),r.addMany(g(32,64),6,0,6),r.add(127,6,0,6),r.addMany(g(64,127),6,0,0),r.addMany(g(32,48),3,9,5),r.addMany(g(32,48),5,9,5),r.addMany(g(48,64),5,0,6),r.addMany(g(64,127),5,7,0),r.addMany(g(32,48),4,9,5),r.addMany(g(32,48),1,9,2),r.addMany(g(32,48),2,9,2),r.addMany(g(48,127),2,10,0),r.addMany(g(48,80),1,10,0),r.addMany(g(81,88),1,10,0),r.addMany([89,90,92],1,10,0),r.addMany(g(96,127),1,10,0),r.add(80,1,11,9),r.addMany(m,9,0,9),r.add(127,9,0,9),r.addMany(g(28,32),9,0,9),r.addMany(g(32,48),9,9,12),r.addMany(g(48,60),9,8,10),r.addMany([60,61,62,63],9,9,10),r.addMany(m,11,0,11),r.addMany(g(32,128),11,0,11),r.addMany(g(28,32),11,0,11),r.addMany(m,10,0,10),r.add(127,10,0,10),r.addMany(g(28,32),10,0,10),r.addMany(g(48,60),10,8,10),r.addMany([60,61,62,63],10,0,11),r.addMany(g(32,48),10,9,12),r.addMany(m,12,0,12),r.add(127,12,0,12),r.addMany(g(28,32),12,0,12),r.addMany(g(32,48),12,9,12),r.addMany(g(48,64),12,0,11),r.addMany(g(64,127),12,12,13),r.addMany(g(64,127),10,12,13),r.addMany(g(64,127),9,12,13),r.addMany(m,13,13,13),r.addMany(h,13,13,13),r.add(127,13,0,13),r.addMany([27,156,24,26],13,14,0),r.add(v,0,2,0),r.add(v,8,5,8),r.add(v,6,0,6),r.add(v,11,0,11),r.add(v,13,13,13),r}();class p extends l.Disposable{constructor(_=e.VT500_TRANSITION_TABLE){super(),this._transitions=_,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new u.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(g,h,m)=>{},this._executeHandlerFb=g=>{},this._csiHandlerFb=(g,h)=>{},this._escHandlerFb=g=>{},this._errorHandlerFb=g=>g,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,l.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new d.OscParser),this._dcsParser=this.register(new a.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(_,g=[64,126]){let h=0;if(_.prefix){if(_.prefix.length>1)throw new Error("only one byte as prefix supported");if(h=_.prefix.charCodeAt(0),h&&60>h||h>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(_.intermediates){if(_.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let y=0;y<_.intermediates.length;++y){let b=_.intermediates.charCodeAt(y);if(32>b||b>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");h<<=8,h|=b}}if(_.final.length!==1)throw new Error("final must be a single byte");let m=_.final.charCodeAt(0);if(g[0]>m||m>g[1])throw new Error(`final must be in range ${g[0]} .. ${g[1]}`);return h<<=8,h|=m,h}identToString(_){let g=[];for(;_;)g.push(String.fromCharCode(255&_)),_>>=8;return g.reverse().join("")}setPrintHandler(_){this._printHandler=_}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(_,g){let h=this._identifier(_,[48,126]);this._escHandlers[h]===void 0&&(this._escHandlers[h]=[]);let m=this._escHandlers[h];return m.push(g),{dispose:()=>{let y=m.indexOf(g);y!==-1&&m.splice(y,1)}}}clearEscHandler(_){this._escHandlers[this._identifier(_,[48,126])]&&delete this._escHandlers[this._identifier(_,[48,126])]}setEscHandlerFallback(_){this._escHandlerFb=_}setExecuteHandler(_,g){this._executeHandlers[_.charCodeAt(0)]=g}clearExecuteHandler(_){this._executeHandlers[_.charCodeAt(0)]&&delete this._executeHandlers[_.charCodeAt(0)]}setExecuteHandlerFallback(_){this._executeHandlerFb=_}registerCsiHandler(_,g){let h=this._identifier(_);this._csiHandlers[h]===void 0&&(this._csiHandlers[h]=[]);let m=this._csiHandlers[h];return m.push(g),{dispose:()=>{let y=m.indexOf(g);y!==-1&&m.splice(y,1)}}}clearCsiHandler(_){this._csiHandlers[this._identifier(_)]&&delete this._csiHandlers[this._identifier(_)]}setCsiHandlerFallback(_){this._csiHandlerFb=_}registerDcsHandler(_,g){return this._dcsParser.registerHandler(this._identifier(_),g)}clearDcsHandler(_){this._dcsParser.clearHandler(this._identifier(_))}setDcsHandlerFallback(_){this._dcsParser.setHandlerFallback(_)}registerOscHandler(_,g){return this._oscParser.registerHandler(_,g)}clearOscHandler(_){this._oscParser.clearHandler(_)}setOscHandlerFallback(_){this._oscParser.setHandlerFallback(_)}setErrorHandler(_){this._errorHandler=_}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(_,g,h,m,y){this._parseStack.state=_,this._parseStack.handlers=g,this._parseStack.handlerPos=h,this._parseStack.transition=m,this._parseStack.chunkPos=y}parse(_,g,h){let m,y=0,b=0,w=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,w=this._parseStack.chunkPos+1;else{if(h===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let S=this._parseStack.handlers,C=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(h===!1&&C>-1){for(;C>=0&&(m=S[C](this._params),m!==!0);C--)if(m instanceof Promise)return this._parseStack.handlerPos=C,m}this._parseStack.handlers=[];break;case 4:if(h===!1&&C>-1){for(;C>=0&&(m=S[C](),m!==!0);C--)if(m instanceof Promise)return this._parseStack.handlerPos=C,m}this._parseStack.handlers=[];break;case 6:if(y=_[this._parseStack.chunkPos],m=this._dcsParser.unhook(y!==24&&y!==26,h),m)return m;y===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(y=_[this._parseStack.chunkPos],m=this._oscParser.end(y!==24&&y!==26,h),m)return m;y===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,w=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let S=w;S<g;++S){switch(y=_[S],b=this._transitions.table[this.currentState<<8|(y<160?y:v)],b>>4){case 2:for(let T=S+1;;++T){if(T>=g||(y=_[T])<32||y>126&&y<v){this._printHandler(_,S,T),S=T-1;break}if(++T>=g||(y=_[T])<32||y>126&&y<v){this._printHandler(_,S,T),S=T-1;break}if(++T>=g||(y=_[T])<32||y>126&&y<v){this._printHandler(_,S,T),S=T-1;break}if(++T>=g||(y=_[T])<32||y>126&&y<v){this._printHandler(_,S,T),S=T-1;break}}break;case 3:this._executeHandlers[y]?this._executeHandlers[y]():this._executeHandlerFb(y),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:S,code:y,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let C=this._csiHandlers[this._collect<<8|y],x=C?C.length-1:-1;for(;x>=0&&(m=C[x](this._params),m!==!0);x--)if(m instanceof Promise)return this._preserveStack(3,C,x,b,S),m;x<0&&this._csiHandlerFb(this._collect<<8|y,this._params),this.precedingCodepoint=0;break;case 8:do switch(y){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(y-48)}while(++S<g&&(y=_[S])>47&&y<60);S--;break;case 9:this._collect<<=8,this._collect|=y;break;case 10:let L=this._escHandlers[this._collect<<8|y],R=L?L.length-1:-1;for(;R>=0&&(m=L[R](),m!==!0);R--)if(m instanceof Promise)return this._preserveStack(4,L,R,b,S),m;R<0&&this._escHandlerFb(this._collect<<8|y),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|y,this._params);break;case 13:for(let T=S+1;;++T)if(T>=g||(y=_[T])===24||y===26||y===27||y>127&&y<v){this._dcsParser.put(_,S,T),S=T-1;break}break;case 14:if(m=this._dcsParser.unhook(y!==24&&y!==26),m)return this._preserveStack(6,[],0,b,S),m;y===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let T=S+1;;T++)if(T>=g||(y=_[T])<32||y>127&&y<v){this._oscParser.put(_,S,T),S=T-1;break}break;case 6:if(m=this._oscParser.end(y!==24&&y!==26),m)return this._preserveStack(5,[],0,b,S),m;y===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&b}}}e.EscapeSequenceParser=p},6242:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OscHandler=e.OscParser=void 0;let l=i(5770),u=i(482),d=[];e.OscParser=class{constructor(){this._state=0,this._active=d,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(a,f){this._handlers[a]===void 0&&(this._handlers[a]=[]);let v=this._handlers[a];return v.push(f),{dispose:()=>{let p=v.indexOf(f);p!==-1&&v.splice(p,1)}}}clearHandler(a){this._handlers[a]&&delete this._handlers[a]}setHandlerFallback(a){this._handlerFb=a}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}reset(){if(this._state===2)for(let a=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;a>=0;--a)this._active[a].end(!1);this._stack.paused=!1,this._active=d,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||d,this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].start();else this._handlerFb(this._id,"START")}_put(a,f,v){if(this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].put(a,f,v);else this._handlerFb(this._id,"PUT",(0,u.utf32ToString)(a,f,v))}start(){this.reset(),this._state=1}put(a,f,v){if(this._state!==3){if(this._state===1)for(;f<v;){let p=a[f++];if(p===59){this._state=2,this._start();break}if(p<48||57<p)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+p-48}this._state===2&&v-f>0&&this._put(a,f,v)}}end(a,f=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let v=!1,p=this._active.length-1,r=!1;if(this._stack.paused&&(p=this._stack.loopPosition-1,v=f,r=this._stack.fallThrough,this._stack.paused=!1),!r&&v===!1){for(;p>=0&&(v=this._active[p].end(a),v!==!0);p--)if(v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!1,v;p--}for(;p>=0;p--)if(v=this._active[p].end(!1),v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!0,v}else this._handlerFb(this._id,"END",a);this._active=d,this._id=-1,this._state=0}}},e.OscHandler=class{constructor(a){this._handler=a,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(a,f,v){this._hitLimit||(this._data+=(0,u.utf32ToString)(a,f,v),this._data.length>l.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(a){let f=!1;if(this._hitLimit)f=!1;else if(a&&(f=this._handler(this._data),f instanceof Promise))return f.then(v=>(this._data="",this._hitLimit=!1,v));return this._data="",this._hitLimit=!1,f}}},8742:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Params=void 0;let i=2147483647;class l{constructor(d=32,a=32){if(this.maxLength=d,this.maxSubParamsLength=a,a>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(d),this.length=0,this._subParams=new Int32Array(a),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(d),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(d){let a=new l;if(!d.length)return a;for(let f=Array.isArray(d[0])?1:0;f<d.length;++f){let v=d[f];if(Array.isArray(v))for(let p=0;p<v.length;++p)a.addSubParam(v[p]);else a.addParam(v)}return a}clone(){let d=new l(this.maxLength,this.maxSubParamsLength);return d.params.set(this.params),d.length=this.length,d._subParams.set(this._subParams),d._subParamsLength=this._subParamsLength,d._subParamsIdx.set(this._subParamsIdx),d._rejectDigits=this._rejectDigits,d._rejectSubDigits=this._rejectSubDigits,d._digitIsSub=this._digitIsSub,d}toArray(){let d=[];for(let a=0;a<this.length;++a){d.push(this.params[a]);let f=this._subParamsIdx[a]>>8,v=255&this._subParamsIdx[a];v-f>0&&d.push(Array.prototype.slice.call(this._subParams,f,v))}return d}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(d){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(d<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=d>i?i:d}}addSubParam(d){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(d<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=d>i?i:d,this._subParamsIdx[this.length-1]++}}hasSubParams(d){return(255&this._subParamsIdx[d])-(this._subParamsIdx[d]>>8)>0}getSubParams(d){let a=this._subParamsIdx[d]>>8,f=255&this._subParamsIdx[d];return f-a>0?this._subParams.subarray(a,f):null}getSubParamsAll(){let d={};for(let a=0;a<this.length;++a){let f=this._subParamsIdx[a]>>8,v=255&this._subParamsIdx[a];v-f>0&&(d[a]=this._subParams.slice(f,v))}return d}addDigit(d){let a;if(this._rejectDigits||!(a=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let f=this._digitIsSub?this._subParams:this.params,v=f[a-1];f[a-1]=~v?Math.min(10*v+d,i):d}}e.Params=l},5741:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AddonManager=void 0,e.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let i=this._addons.length-1;i>=0;i--)this._addons[i].instance.dispose()}loadAddon(i,l){let u={instance:l,dispose:l.dispose,isDisposed:!1};this._addons.push(u),l.dispose=()=>this._wrappedAddonDispose(u),l.activate(i)}_wrappedAddonDispose(i){if(i.isDisposed)return;let l=-1;for(let u=0;u<this._addons.length;u++)if(this._addons[u]===i){l=u;break}if(l===-1)throw new Error("Could not dispose an addon that has not been loaded");i.isDisposed=!0,i.dispose.apply(i.instance),this._addons.splice(l,1)}}},8771:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferApiView=void 0;let l=i(3785),u=i(511);e.BufferApiView=class{constructor(d,a){this._buffer=d,this.type=a}init(d){return this._buffer=d,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(d){let a=this._buffer.lines.get(d);if(a)return new l.BufferLineApiView(a)}getNullCell(){return new u.CellData}}},3785:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferLineApiView=void 0;let l=i(511);e.BufferLineApiView=class{constructor(u){this._line=u}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(u,d){if(!(u<0||u>=this._line.length))return d?(this._line.loadCell(u,d),d):this._line.loadCell(u,new l.CellData)}translateToString(u,d,a){return this._line.translateToString(u,d,a)}}},8285:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferNamespaceApi=void 0;let l=i(8771),u=i(8460);e.BufferNamespaceApi=class{constructor(d){this._core=d,this._onBufferChange=new u.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new l.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new l.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ParserApi=void 0,e.ParserApi=class{constructor(i){this._core=i}registerCsiHandler(i,l){return this._core.registerCsiHandler(i,u=>l(u.toArray()))}addCsiHandler(i,l){return this.registerCsiHandler(i,l)}registerDcsHandler(i,l){return this._core.registerDcsHandler(i,(u,d)=>l(u,d.toArray()))}addDcsHandler(i,l){return this.registerDcsHandler(i,l)}registerEscHandler(i,l){return this._core.registerEscHandler(i,l)}addEscHandler(i,l){return this.registerEscHandler(i,l)}registerOscHandler(i,l){return this._core.registerOscHandler(i,l)}addOscHandler(i,l){return this.registerOscHandler(i,l)}}},7090:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeApi=void 0,e.UnicodeApi=class{constructor(i){this._core=i}register(i){this._core.unicodeService.register(i)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(i){this._core.unicodeService.activeVersion=i}}},744:function(o,e,i){var l=this&&this.__decorate||function(r,_,g,h){var m,y=arguments.length,b=y<3?_:h===null?h=Object.getOwnPropertyDescriptor(_,g):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,_,g,h);else for(var w=r.length-1;w>=0;w--)(m=r[w])&&(b=(y<3?m(b):y>3?m(_,g,b):m(_,g))||b);return y>3&&b&&Object.defineProperty(_,g,b),b},u=this&&this.__param||function(r,_){return function(g,h){_(g,h,r)}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferService=e.MINIMUM_ROWS=e.MINIMUM_COLS=void 0;let d=i(2585),a=i(5295),f=i(8460),v=i(844);e.MINIMUM_COLS=2,e.MINIMUM_ROWS=1;let p=class extends v.Disposable{constructor(r){super(),this.isUserScrolling=!1,this._onResize=this.register(new f.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new f.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(r.rawOptions.cols||0,e.MINIMUM_COLS),this.rows=Math.max(r.rawOptions.rows||0,e.MINIMUM_ROWS),this.buffers=this.register(new a.BufferSet(r,this))}get buffer(){return this.buffers.active}resize(r,_){this.cols=r,this.rows=_,this.buffers.resize(r,_),this._onResize.fire({cols:r,rows:_})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(r,_=!1){let g=this.buffer,h;h=this._cachedBlankLine,h&&h.length===this.cols&&h.getFg(0)===r.fg&&h.getBg(0)===r.bg||(h=g.getBlankLine(r,_),this._cachedBlankLine=h),h.isWrapped=_;let m=g.ybase+g.scrollTop,y=g.ybase+g.scrollBottom;if(g.scrollTop===0){let b=g.lines.isFull;y===g.lines.length-1?b?g.lines.recycle().copyFrom(h):g.lines.push(h.clone()):g.lines.splice(y+1,0,h.clone()),b?this.isUserScrolling&&(g.ydisp=Math.max(g.ydisp-1,0)):(g.ybase++,this.isUserScrolling||g.ydisp++)}else{let b=y-m+1;g.lines.shiftElements(m+1,b-1,-1),g.lines.set(y,h.clone())}this.isUserScrolling||(g.ydisp=g.ybase),this._onScroll.fire(g.ydisp)}scrollLines(r,_,g){let h=this.buffer;if(r<0){if(h.ydisp===0)return;this.isUserScrolling=!0}else r+h.ydisp>=h.ybase&&(this.isUserScrolling=!1);let m=h.ydisp;h.ydisp=Math.max(Math.min(h.ydisp+r,h.ybase),0),m!==h.ydisp&&(_||this._onScroll.fire(h.ydisp))}scrollPages(r){this.scrollLines(r*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(r){let _=r-this.buffer.ydisp;_!==0&&this.scrollLines(_)}};p=l([u(0,d.IOptionsService)],p),e.BufferService=p},7994:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CharsetService=void 0,e.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(i){this.glevel=i,this.charset=this._charsets[i]}setgCharset(i,l){this._charsets[i]=l,this.glevel===i&&(this.charset=l)}}},1753:function(o,e,i){var l=this&&this.__decorate||function(h,m,y,b){var w,S=arguments.length,C=S<3?m:b===null?b=Object.getOwnPropertyDescriptor(m,y):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(h,m,y,b);else for(var x=h.length-1;x>=0;x--)(w=h[x])&&(C=(S<3?w(C):S>3?w(m,y,C):w(m,y))||C);return S>3&&C&&Object.defineProperty(m,y,C),C},u=this&&this.__param||function(h,m){return function(y,b){m(y,b,h)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreMouseService=void 0;let d=i(2585),a=i(8460),f=i(844),v={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:h=>h.button!==4&&h.action===1&&(h.ctrl=!1,h.alt=!1,h.shift=!1,!0)},VT200:{events:19,restrict:h=>h.action!==32},DRAG:{events:23,restrict:h=>h.action!==32||h.button!==3},ANY:{events:31,restrict:h=>!0}};function p(h,m){let y=(h.ctrl?16:0)|(h.shift?4:0)|(h.alt?8:0);return h.button===4?(y|=64,y|=h.action):(y|=3&h.button,4&h.button&&(y|=64),8&h.button&&(y|=128),h.action===32?y|=32:h.action!==0||m||(y|=3)),y}let r=String.fromCharCode,_={DEFAULT:h=>{let m=[p(h,!1)+32,h.col+32,h.row+32];return m[0]>255||m[1]>255||m[2]>255?"":`\x1B[M${r(m[0])}${r(m[1])}${r(m[2])}`},SGR:h=>{let m=h.action===0&&h.button!==4?"m":"M";return`\x1B[<${p(h,!0)};${h.col};${h.row}${m}`},SGR_PIXELS:h=>{let m=h.action===0&&h.button!==4?"m":"M";return`\x1B[<${p(h,!0)};${h.x};${h.y}${m}`}},g=class extends f.Disposable{constructor(h,m){super(),this._bufferService=h,this._coreService=m,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new a.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(let y of Object.keys(v))this.addProtocol(y,v[y]);for(let y of Object.keys(_))this.addEncoding(y,_[y]);this.reset()}addProtocol(h,m){this._protocols[h]=m}addEncoding(h,m){this._encodings[h]=m}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(h){if(!this._protocols[h])throw new Error(`unknown protocol "${h}"`);this._activeProtocol=h,this._onProtocolChange.fire(this._protocols[h].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(h){if(!this._encodings[h])throw new Error(`unknown encoding "${h}"`);this._activeEncoding=h}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(h){if(h.col<0||h.col>=this._bufferService.cols||h.row<0||h.row>=this._bufferService.rows||h.button===4&&h.action===32||h.button===3&&h.action!==32||h.button!==4&&(h.action===2||h.action===3)||(h.col++,h.row++,h.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,h,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(h))return!1;let m=this._encodings[this._activeEncoding](h);return m&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(m):this._coreService.triggerDataEvent(m,!0)),this._lastEvent=h,!0}explainEvents(h){return{down:!!(1&h),up:!!(2&h),drag:!!(4&h),move:!!(8&h),wheel:!!(16&h)}}_equalEvents(h,m,y){if(y){if(h.x!==m.x||h.y!==m.y)return!1}else if(h.col!==m.col||h.row!==m.row)return!1;return h.button===m.button&&h.action===m.action&&h.ctrl===m.ctrl&&h.alt===m.alt&&h.shift===m.shift}};g=l([u(0,d.IBufferService),u(1,d.ICoreService)],g),e.CoreMouseService=g},6975:function(o,e,i){var l=this&&this.__decorate||function(g,h,m,y){var b,w=arguments.length,S=w<3?h:y===null?y=Object.getOwnPropertyDescriptor(h,m):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(g,h,m,y);else for(var C=g.length-1;C>=0;C--)(b=g[C])&&(S=(w<3?b(S):w>3?b(h,m,S):b(h,m))||S);return w>3&&S&&Object.defineProperty(h,m,S),S},u=this&&this.__param||function(g,h){return function(m,y){h(m,y,g)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreService=void 0;let d=i(2585),a=i(8460),f=i(1439),v=i(844),p=Object.freeze({insertMode:!1}),r=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),_=class extends v.Disposable{constructor(g,h,m){super(),this._bufferService=g,this._logService=h,this._optionsService=m,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new a.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new a.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new a.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new a.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,f.clone)(p),this.decPrivateModes=(0,f.clone)(r)}reset(){this.modes=(0,f.clone)(p),this.decPrivateModes=(0,f.clone)(r)}triggerDataEvent(g,h=!1){if(this._optionsService.rawOptions.disableStdin)return;let m=this._bufferService.buffer;h&&this._optionsService.rawOptions.scrollOnUserInput&&m.ybase!==m.ydisp&&this._onRequestScrollToBottom.fire(),h&&this._onUserInput.fire(),this._logService.debug(`sending data "${g}"`,()=>g.split("").map(y=>y.charCodeAt(0))),this._onData.fire(g)}triggerBinaryEvent(g){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${g}"`,()=>g.split("").map(h=>h.charCodeAt(0))),this._onBinary.fire(g))}};_=l([u(0,d.IBufferService),u(1,d.ILogService),u(2,d.IOptionsService)],_),e.CoreService=_},9074:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DecorationService=void 0;let l=i(8055),u=i(8460),d=i(844),a=i(6106),f=0,v=0;class p extends d.Disposable{constructor(){super(),this._decorations=new a.SortedList(g=>g==null?void 0:g.marker.line),this._onDecorationRegistered=this.register(new u.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new u.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,d.toDisposable)(()=>{for(let g of this._decorations.values())this._onDecorationRemoved.fire(g);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(g){if(g.marker.isDisposed)return;let h=new r(g);if(h){let m=h.marker.onDispose(()=>h.dispose());h.onDispose(()=>{h&&(this._decorations.delete(h)&&this._onDecorationRemoved.fire(h),m.dispose())}),this._decorations.insert(h),this._onDecorationRegistered.fire(h)}return h}reset(){for(let g of this._decorations.values())g.dispose();this._decorations.clear()}*getDecorationsAtCell(g,h,m){var y,b,w;let S=0,C=0;for(let x of this._decorations.getKeyIterator(h))S=(y=x.options.x)!==null&&y!==void 0?y:0,C=S+((b=x.options.width)!==null&&b!==void 0?b:1),g>=S&&g<C&&(!m||((w=x.options.layer)!==null&&w!==void 0?w:"bottom")===m)&&(yield x)}forEachDecorationAtCell(g,h,m,y){this._decorations.forEachByKey(h,b=>{var w,S,C;f=(w=b.options.x)!==null&&w!==void 0?w:0,v=f+((S=b.options.width)!==null&&S!==void 0?S:1),g>=f&&g<v&&(!m||((C=b.options.layer)!==null&&C!==void 0?C:"bottom")===m)&&y(b)})}dispose(){for(let g of this._decorations.values())this._onDecorationRemoved.fire(g);this.reset()}}e.DecorationService=p;class r extends d.Disposable{constructor(g){super(),this.options=g,this.isDisposed=!1,this.onRenderEmitter=this.register(new u.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new u.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=g.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=l.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=l.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InstantiationService=e.ServiceCollection=void 0;let l=i(2585),u=i(8343);class d{constructor(...f){this._entries=new Map;for(let[v,p]of f)this.set(v,p)}set(f,v){let p=this._entries.get(f);return this._entries.set(f,v),p}forEach(f){for(let[v,p]of this._entries.entries())f(v,p)}has(f){return this._entries.has(f)}get(f){return this._entries.get(f)}}e.ServiceCollection=d,e.InstantiationService=class{constructor(){this._services=new d,this._services.set(l.IInstantiationService,this)}setService(a,f){this._services.set(a,f)}getService(a){return this._services.get(a)}createInstance(a,...f){let v=(0,u.getServiceDependencies)(a).sort((_,g)=>_.index-g.index),p=[];for(let _ of v){let g=this._services.get(_.id);if(!g)throw new Error(`[createInstance] ${a.name} depends on UNKNOWN service ${_.id}.`);p.push(g)}let r=v.length>0?v[0].index:f.length;if(f.length!==r)throw new Error(`[createInstance] First service dependency of ${a.name} at position ${r+1} conflicts with ${f.length} static arguments`);return new a(...f,...p)}}},7866:function(o,e,i){var l=this&&this.__decorate||function(p,r,_,g){var h,m=arguments.length,y=m<3?r:g===null?g=Object.getOwnPropertyDescriptor(r,_):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(p,r,_,g);else for(var b=p.length-1;b>=0;b--)(h=p[b])&&(y=(m<3?h(y):m>3?h(r,_,y):h(r,_))||y);return m>3&&y&&Object.defineProperty(r,_,y),y},u=this&&this.__param||function(p,r){return function(_,g){r(_,g,p)}};Object.defineProperty(e,"__esModule",{value:!0}),e.LogService=void 0;let d=i(844),a=i(2585),f={debug:a.LogLevelEnum.DEBUG,info:a.LogLevelEnum.INFO,warn:a.LogLevelEnum.WARN,error:a.LogLevelEnum.ERROR,off:a.LogLevelEnum.OFF},v=class extends d.Disposable{constructor(p){super(),this._optionsService=p,this.logLevel=a.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=f[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(p){for(let r=0;r<p.length;r++)typeof p[r]=="function"&&(p[r]=p[r]())}_log(p,r,_){this._evalLazyOptionalParams(_),p.call(console,"xterm.js: "+r,..._)}debug(p,...r){this.logLevel<=a.LogLevelEnum.DEBUG&&this._log(console.log,p,r)}info(p,...r){this.logLevel<=a.LogLevelEnum.INFO&&this._log(console.info,p,r)}warn(p,...r){this.logLevel<=a.LogLevelEnum.WARN&&this._log(console.warn,p,r)}error(p,...r){this.logLevel<=a.LogLevelEnum.ERROR&&this._log(console.error,p,r)}};v=l([u(0,a.IOptionsService)],v),e.LogService=v},7302:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionsService=e.DEFAULT_OPTIONS=void 0;let l=i(8460),u=i(6114),d=i(844);e.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:u.isMac,windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};let a=["normal","bold","100","200","300","400","500","600","700","800","900"];class f extends d.Disposable{constructor(p){super(),this._onOptionChange=this.register(new l.EventEmitter),this.onOptionChange=this._onOptionChange.event;let r=Object.assign({},e.DEFAULT_OPTIONS);for(let _ in p)if(_ in r)try{let g=p[_];r[_]=this._sanitizeAndValidateOption(_,g)}catch(g){console.error(g)}this.rawOptions=r,this.options=Object.assign({},r),this._setupOptions()}onSpecificOptionChange(p,r){return this.onOptionChange(_=>{_===p&&r(this.rawOptions[p])})}onMultipleOptionChange(p,r){return this.onOptionChange(_=>{p.indexOf(_)!==-1&&r()})}_setupOptions(){let p=_=>{if(!(_ in e.DEFAULT_OPTIONS))throw new Error(`No option with key "${_}"`);return this.rawOptions[_]},r=(_,g)=>{if(!(_ in e.DEFAULT_OPTIONS))throw new Error(`No option with key "${_}"`);g=this._sanitizeAndValidateOption(_,g),this.rawOptions[_]!==g&&(this.rawOptions[_]=g,this._onOptionChange.fire(_))};for(let _ in this.rawOptions){let g={get:p.bind(this,_),set:r.bind(this,_)};Object.defineProperty(this.options,_,g)}}_sanitizeAndValidateOption(p,r){switch(p){case"cursorStyle":if(r||(r=e.DEFAULT_OPTIONS[p]),!function(_){return _==="block"||_==="underline"||_==="bar"}(r))throw new Error(`"${r}" is not a valid value for ${p}`);break;case"wordSeparator":r||(r=e.DEFAULT_OPTIONS[p]);break;case"fontWeight":case"fontWeightBold":if(typeof r=="number"&&1<=r&&r<=1e3)break;r=a.includes(r)?r:e.DEFAULT_OPTIONS[p];break;case"cursorWidth":r=Math.floor(r);case"lineHeight":case"tabStopWidth":if(r<1)throw new Error(`${p} cannot be less than 1, value: ${r}`);break;case"minimumContrastRatio":r=Math.max(1,Math.min(21,Math.round(10*r)/10));break;case"scrollback":if((r=Math.min(r,4294967295))<0)throw new Error(`${p} cannot be less than 0, value: ${r}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(r<=0)throw new Error(`${p} cannot be less than or equal to 0, value: ${r}`);case"rows":case"cols":if(!r&&r!==0)throw new Error(`${p} must be numeric, value: ${r}`)}return r}}e.OptionsService=f},2660:function(o,e,i){var l=this&&this.__decorate||function(f,v,p,r){var _,g=arguments.length,h=g<3?v:r===null?r=Object.getOwnPropertyDescriptor(v,p):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(f,v,p,r);else for(var m=f.length-1;m>=0;m--)(_=f[m])&&(h=(g<3?_(h):g>3?_(v,p,h):_(v,p))||h);return g>3&&h&&Object.defineProperty(v,p,h),h},u=this&&this.__param||function(f,v){return function(p,r){v(p,r,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OscLinkService=void 0;let d=i(2585),a=class{constructor(f){this._bufferService=f,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(f){let v=this._bufferService.buffer;if(f.id===void 0){let m=v.addMarker(v.ybase+v.y),y={data:f,id:this._nextId++,lines:[m]};return m.onDispose(()=>this._removeMarkerFromLink(y,m)),this._dataByLinkId.set(y.id,y),y.id}let p=f,r=this._getEntryIdKey(p),_=this._entriesWithId.get(r);if(_)return this.addLineToLink(_.id,v.ybase+v.y),_.id;let g=v.addMarker(v.ybase+v.y),h={id:this._nextId++,key:this._getEntryIdKey(p),data:p,lines:[g]};return g.onDispose(()=>this._removeMarkerFromLink(h,g)),this._entriesWithId.set(h.key,h),this._dataByLinkId.set(h.id,h),h.id}addLineToLink(f,v){let p=this._dataByLinkId.get(f);if(p&&p.lines.every(r=>r.line!==v)){let r=this._bufferService.buffer.addMarker(v);p.lines.push(r),r.onDispose(()=>this._removeMarkerFromLink(p,r))}}getLinkData(f){var v;return(v=this._dataByLinkId.get(f))===null||v===void 0?void 0:v.data}_getEntryIdKey(f){return`${f.id};;${f.uri}`}_removeMarkerFromLink(f,v){let p=f.lines.indexOf(v);p!==-1&&(f.lines.splice(p,1),f.lines.length===0&&(f.data.id!==void 0&&this._entriesWithId.delete(f.key),this._dataByLinkId.delete(f.id)))}};a=l([u(0,d.IBufferService)],a),e.OscLinkService=a},8343:(o,e)=>{function i(l,u,d){u.di$target===u?u.di$dependencies.push({id:l,index:d}):(u.di$dependencies=[{id:l,index:d}],u.di$target=u)}Object.defineProperty(e,"__esModule",{value:!0}),e.createDecorator=e.getServiceDependencies=e.serviceRegistry=void 0,e.serviceRegistry=new Map,e.getServiceDependencies=function(l){return l.di$dependencies||[]},e.createDecorator=function(l){if(e.serviceRegistry.has(l))return e.serviceRegistry.get(l);let u=function(d,a,f){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");i(u,d,f)};return u.toString=()=>l,e.serviceRegistry.set(l,u),u}},2585:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IDecorationService=e.IUnicodeService=e.IOscLinkService=e.IOptionsService=e.ILogService=e.LogLevelEnum=e.IInstantiationService=e.ICharsetService=e.ICoreService=e.ICoreMouseService=e.IBufferService=void 0;let l=i(8343);var u;e.IBufferService=(0,l.createDecorator)("BufferService"),e.ICoreMouseService=(0,l.createDecorator)("CoreMouseService"),e.ICoreService=(0,l.createDecorator)("CoreService"),e.ICharsetService=(0,l.createDecorator)("CharsetService"),e.IInstantiationService=(0,l.createDecorator)("InstantiationService"),(u=e.LogLevelEnum||(e.LogLevelEnum={}))[u.DEBUG=0]="DEBUG",u[u.INFO=1]="INFO",u[u.WARN=2]="WARN",u[u.ERROR=3]="ERROR",u[u.OFF=4]="OFF",e.ILogService=(0,l.createDecorator)("LogService"),e.IOptionsService=(0,l.createDecorator)("OptionsService"),e.IOscLinkService=(0,l.createDecorator)("OscLinkService"),e.IUnicodeService=(0,l.createDecorator)("UnicodeService"),e.IDecorationService=(0,l.createDecorator)("DecorationService")},1480:(o,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeService=void 0;let l=i(8460),u=i(225);e.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new l.EventEmitter,this.onChange=this._onChange.event;let d=new u.UnicodeV6;this.register(d),this._active=d.version,this._activeProvider=d}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(d){if(!this._providers[d])throw new Error(`unknown Unicode version "${d}"`);this._active=d,this._activeProvider=this._providers[d],this._onChange.fire(d)}register(d){this._providers[d.version]=d}wcwidth(d){return this._activeProvider.wcwidth(d)}getStringCellWidth(d){let a=0,f=d.length;for(let v=0;v<f;++v){let p=d.charCodeAt(v);if(55296<=p&&p<=56319){if(++v>=f)return a+this.wcwidth(p);let r=d.charCodeAt(v);56320<=r&&r<=57343?p=1024*(p-55296)+r-56320+65536:a+=this.wcwidth(r)}a+=this.wcwidth(p)}return a}}}},s={};function n(o){var e=s[o];if(e!==void 0)return e.exports;var i=s[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}var c={};return(()=>{var o=c;Object.defineProperty(o,"__esModule",{value:!0}),o.Terminal=void 0;let e=n(3236),i=n(9042),l=n(7975),u=n(7090),d=n(5741),a=n(8285),f=["cols","rows"];o.Terminal=class{constructor(v){this._core=new e.Terminal(v),this._addonManager=new d.AddonManager,this._publicOptions=Object.assign({},this._core.options);let p=_=>this._core.options[_],r=(_,g)=>{this._checkReadonlyOptions(_),this._core.options[_]=g};for(let _ in this._core.options){let g={get:p.bind(this,_),set:r.bind(this,_)};Object.defineProperty(this._publicOptions,_,g)}}_checkReadonlyOptions(v){if(f.includes(v))throw new Error(`Option "${v}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new l.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new u.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new a.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let v=this._core.coreService.decPrivateModes,p="none";switch(this._core.coreMouseService.activeProtocol){case"X10":p="x10";break;case"VT200":p="vt200";break;case"DRAG":p="drag";break;case"ANY":p="any"}return{applicationCursorKeysMode:v.applicationCursorKeys,applicationKeypadMode:v.applicationKeypad,bracketedPasteMode:v.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:p,originMode:v.origin,reverseWraparoundMode:v.reverseWraparound,sendFocusMode:v.sendFocus,wraparoundMode:v.wraparound}}get options(){return this._publicOptions}set options(v){for(let p in v)this._publicOptions[p]=v[p]}blur(){this._core.blur()}focus(){this._core.focus()}resize(v,p){this._verifyIntegers(v,p),this._core.resize(v,p)}open(v){this._core.open(v)}attachCustomKeyEventHandler(v){this._core.attachCustomKeyEventHandler(v)}registerLinkProvider(v){return this._core.registerLinkProvider(v)}registerCharacterJoiner(v){return this._checkProposedApi(),this._core.registerCharacterJoiner(v)}deregisterCharacterJoiner(v){this._checkProposedApi(),this._core.deregisterCharacterJoiner(v)}registerMarker(v=0){return this._verifyIntegers(v),this._core.addMarker(v)}registerDecoration(v){var p,r,_;return this._checkProposedApi(),this._verifyPositiveIntegers((p=v.x)!==null&&p!==void 0?p:0,(r=v.width)!==null&&r!==void 0?r:0,(_=v.height)!==null&&_!==void 0?_:0),this._core.registerDecoration(v)}hasSelection(){return this._core.hasSelection()}select(v,p,r){this._verifyIntegers(v,p,r),this._core.select(v,p,r)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(v,p){this._verifyIntegers(v,p),this._core.selectLines(v,p)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(v){this._verifyIntegers(v),this._core.scrollLines(v)}scrollPages(v){this._verifyIntegers(v),this._core.scrollPages(v)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(v){this._verifyIntegers(v),this._core.scrollToLine(v)}clear(){this._core.clear()}write(v,p){this._core.write(v,p)}writeln(v,p){this._core.write(v),this._core.write(`\r
`,p)}paste(v){this._core.paste(v)}refresh(v,p){this._verifyIntegers(v,p),this._core.refresh(v,p)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(v){return this._addonManager.loadAddon(this,v)}static get strings(){return i}_verifyIntegers(...v){for(let p of v)if(p===1/0||isNaN(p)||p%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...v){for(let p of v)if(p&&(p===1/0||isNaN(p)||p%1!=0||p<0))throw new Error("This API only accepts positive integers")}}})(),c})()})});var qn=te((wr,Di)=>{(function(t,s){typeof wr=="object"&&typeof Di=="object"?Di.exports=s():typeof define=="function"&&define.amd?define([],s):typeof wr=="object"?wr.WebLinksAddon=s():t.WebLinksAddon=s()})(self,function(){return(()=>{"use strict";var t={6:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LinkComputer=e.WebLinkProvider=void 0,e.WebLinkProvider=class{constructor(l,u,d,a={}){this._terminal=l,this._regex=u,this._handler=d,this._options=a}provideLinks(l,u){let d=i.computeLink(l,this._regex,this._terminal,this._handler);u(this._addCallbacks(d))}_addCallbacks(l){return l.map(u=>(u.leave=this._options.leave,u.hover=(d,a)=>{if(this._options.hover){let{range:f}=u;this._options.hover(d,a,f)}},u))}};class i{static computeLink(u,d,a,f){let v=new RegExp(d.source,(d.flags||"")+"g"),[p,r]=i._getWindowedLineStrings(u-1,a),_=p.join(""),g,h=[];for(;g=v.exec(_);){let m=g[0];try{let x=new URL(m),L=decodeURI(x.toString());if(m!==L&&m+"/"!==L)continue}catch(x){continue}let[y,b]=i._mapStrIdx(a,r,0,g.index),[w,S]=i._mapStrIdx(a,y,b,m.length);if(y===-1||b===-1||w===-1||S===-1)continue;let C={start:{x:b+1,y:y+1},end:{x:S,y:w+1}};h.push({range:C,text:m,activate:f})}return h}static _getWindowedLineStrings(u,d){let a,f=u,v=u,p=0,r="",_=[];if(a=d.buffer.active.getLine(u)){let g=a.translateToString(!0);if(a.isWrapped&&g[0]!==" "){for(p=0;(a=d.buffer.active.getLine(--f))&&p<2048&&(r=a.translateToString(!0),p+=r.length,_.push(r),a.isWrapped&&r.indexOf(" ")===-1););_.reverse()}for(_.push(g),p=0;(a=d.buffer.active.getLine(++v))&&a.isWrapped&&p<2048&&(r=a.translateToString(!0),p+=r.length,_.push(r),r.indexOf(" ")===-1););}return[_,f]}static _mapStrIdx(u,d,a,f){let v=u.buffer.active,p=v.getNullCell(),r=a;for(;f;){let _=v.getLine(d);if(!_)return[-1,-1];for(let g=r;g<_.length;++g){_.getCell(g,p);let h=p.getChars();if(p.getWidth()&&(f-=h.length||1,g===_.length-1&&h==="")){let m=v.getLine(d+1);m&&m.isWrapped&&(m.getCell(0,p),p.getWidth()===2&&(f+=1))}if(f<0)return[d,g]}d++,r=0}return[d,r]}}e.LinkComputer=i}},s={};function n(o){var e=s[o];if(e!==void 0)return e.exports;var i=s[o]={exports:{}};return t[o](i,i.exports,n),i.exports}var c={};return(()=>{var o=c;Object.defineProperty(o,"__esModule",{value:!0}),o.WebLinksAddon=void 0;let e=n(6),i=/https?:[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function l(u,d){let a=window.open();if(a){try{a.opener=null}catch(f){}a.location.href=d}else console.warn("Opening link blocked as opener could not be cleared")}o.WebLinksAddon=class{constructor(u=l,d={}){this._handler=u,this._options=d}activate(u){this._terminal=u;let d=this._options,a=d.urlRegex||i;this._linkProvider=this._terminal.registerLinkProvider(new e.WebLinkProvider(this._terminal,a,this._handler,d))}dispose(){var u;(u=this._linkProvider)===null||u===void 0||u.dispose()}}})(),c})()})});var Il={};st(Il,{TerminalPlugin:()=>ge,default:()=>Bl});module.exports=oo(Il);var Ye=require("obsidian");var _e=require("obsidian");var zt=require("obsidian");var Ii=[0,"SIGINT","SIGTERM"],Mi=500,Hi=500;var Ut=class{constructor(s){this.id=s}namespaced(s){return`${(s instanceof zt.Plugin?s.manifest:s).id}:${this.id}`}};function Or(t){return t instanceof Error?t:new Error(String(t))}function Ni(t,s,n,c){let o=t();return()=>c.replace(o,t()).replace(n,s())}function Fi(t){return structuredClone(t)}function $t(t){return(s,n)=>{t(c=>{try{s(c())}catch(o){n(o)}},c=>{try{n((c!=null?c:()=>{})())}catch(o){n(o)}})}}function ji(t,s="text/plain; charset=UTF-8;",n=""){let c=document.createElement("a");c.target="_blank",c.download=n;let o=URL.createObjectURL(new Blob([t],{type:s}));try{c.href=o,c.click()}finally{URL.revokeObjectURL(o)}}function ot(t,s){return t.includes(s)}function Wi(t,s){return"__type"in s?s.__type===t:!1}function Ae(t,s=0,n){let c=1e3*Math.max(s,0),o=new zt.Notice(t(),c);if(typeof n=="undefined")return o;let e=n.state.language.registerUse(()=>o.setMessage(t()));try{c===0?n.register(e):window.setTimeout(e,c)}catch(i){e()}return o}function Ui(t,s,n=!1){let c=new IntersectionObserver((o,e)=>{var i;for(let l of n?o.reverse():[(i=o.last())!=null?i:{isIntersecting:!1}])if(l.isIntersecting){s(e,t,l);break}});return c.observe(t),c}function zi(t){return window.open(t,"_blank","noreferrer")}function De(t,s=()=>"",n){console.error(`${s()}
`,t),Ae(t instanceof Error?()=>`${s()}
${t.name}: ${t.message}`:()=>`${s()}
${String(t)}`,0,n)}function $i(t){let s=t.getViewType(),n=t.getDisplayText(),c=document.querySelector(`.workspace-tab-header[data-type="${s}"]`);if(c===null)return!1;let o=c.querySelector(".workspace-tab-header-inner-title");if(o===null)return!1;let e=o.textContent;return e===null?!1:(o.textContent=n,c.ariaLabel=n,document.title=document.title.replace(e,n),!0)}var Ar={};st(Ar,{default:()=>ho,menus:()=>ao,settings:()=>co,views:()=>lo});var ao={"open-terminal-external-icon":"terminal-square","open-terminal-integrated-icon":"terminal","save-as-HTML-icon":"save"},lo={"terminal-icon":"terminal"},co={"add-to-commands-icon":"terminal","add-to-context-menus-icon":"menu","enable-Windows-conhost-workaround-icon":"code","executable-list-icon":"terminal-square","hide-status-bar-icon":"eye-off","language-icon":"languages","notice-timeout-icon":"timer","python-executable-icon":"scaling","reset-icon":"reset"},ho={menus:ao,views:lo,settings:co};var Dr={};st(Dr,{commands:()=>uo,default:()=>So,errors:()=>fo,menus:()=>_o,name:()=>po,notices:()=>go,settings:()=>vo,views:()=>mo});var uo={"open-terminal-external-root":"Open root in external terminal","open-terminal-external-current":"Open current folder in external terminal","open-terminal-integrated-root":"Open root in integrated terminal","open-terminal-integrated-current":"Open current folder in integrated terminal"},fo={"cannot-find-status-bar":"Cannot find status bar","error-spawning-terminal":"Error spawning terminal","error-spawning-resizer":"Error spawning terminal resizer","resizer-disabled":"Terminal resizer disabled","resizer-exited-unexpectedly":"Terminal resizer exited unexpectedly: {{- code}}","unsupported-platform":"Unsupported platform"},_o={"open-terminal-external":"Open in external terminal","open-terminal-integrated":"Open in integrated terminal","save-as-HTML":"Save as HTML"},po="Terminal",go={"spawning-terminal":"Spawning terminal: {{- executable}}","terminal-exited":"Terminal exited: {{- code}}"},vo={"add-to-commands":"Add to commands","add-to-context-menus":"Add to context menus","enable-Windows-conhost-workaround":"Enable Windows 'conhost.exe' workaround","enable-Windows-conhost-workaround-description":"Disable if running 'conhost.exe' does not create a window. No guarantees this will work.",executables:"Executables","executable-list":{darwin:"macOS",linux:"Linux",win32:"Microsoft Windows"},"hide-status-bar":"Hide status bar","hide-status-bar-options":{never:"Never",always:"Always",focused:"When terminal is focused",running:"When terminal is running"},language:"Language","language-default":"Use app setting","language-description":"Applies to this plugin only.","notice-timeout":"Notice timeout (s)","notice-timeout-description":"Set to 0 s for no timeout.","python-executable":"Python executable","python-executable-description":"Clear field to disable terminal resizer.","python-executable-placeholder":"(Disabled)",reset:"Reset","reset-all":"Reset all"},mo={terminal:{"display-name":"Terminal: {{- executable}}"}},So={commands:uo,errors:fo,menus:_o,name:po,notices:go,settings:vo,views:mo};var Pr={};st(Pr,{default:()=>wo,en:()=>yo,"zh-Hans":()=>bo,"zh-Hant":()=>Co});var yo="English",bo="\u7B80\u4F53\u4E2D\u6587",Co="\u7E41\u9AD4\u4E2D\u6587",wo={en:yo,"zh-Hans":bo,"zh-Hant":Co};var Br={};st(Br,{commands:()=>Eo,default:()=>Ao,errors:()=>xo,menus:()=>Lo,name:()=>ko,notices:()=>Ro,settings:()=>To,views:()=>Oo});var Eo={"open-terminal-external-root":"\u5728\u5916\u90E8\u7EC8\u7AEF\u5F00\u555F\u6839\u76EE\u9332","open-terminal-external-current":"\u5728\u5916\u90E8\u7EC8\u7AEF\u5F00\u555F\u76EE\u524D\u76EE\u9332","open-terminal-integrated-root":"\u5728\u6574\u5408\u5F0F\u7EC8\u7AEF\u5F00\u555F\u6839\u76EE\u9332","open-terminal-integrated-current":"\u5728\u6574\u5408\u5F0F\u7EC8\u7AEF\u5F00\u555F\u76EE\u524D\u76EE\u9332"},xo={"cannot-find-status-bar":"\u627E\u4E0D\u5230\u72B6\u6001\u680F","error-spawning-terminal":"\u555F\u52A8\u7EC8\u7AEF\u65F6\u51FA\u9519","error-spawning-resizer":"\u555F\u52A8\u7EC8\u7AEF\u7F29\u653E\u8FF8\u7A0B\u65F6\u51FA\u9519","resizer-disabled":"\u7EC8\u7AEF\u7F29\u653E\u8FF8\u7A0B\u5DF2\u7981\u7528","resizer-exited-unexpectedly":"\u7EC8\u7AEF\u7F29\u653E\u8FF8\u7A0B\u610F\u5916\u9000\u51FA\uFF1A{{- code}}","unsupported-platform":"\u4E0D\u652F\u6301\u6B64\u5E73\u53F0"},Lo={"open-terminal-external":"\u5728\u5916\u90E8\u7EC8\u7AEF\u5F00\u555F","open-terminal-integrated":"\u5728\u6574\u5408\u5F0F\u7EC8\u7AEF\u5F00\u555F","save-as-HTML":"\u50A8\u5B58\u4E3A HTML"},ko="\u7EC8\u7AEF",Ro={"spawning-terminal":"\u7EC8\u7AEF\u555F\u52A8\u4E2D\uFF1A{{- executable}}","terminal-exited":"\u7EC8\u7AEF\u5DF2\u9000\u51FA\uFF1A{{- code}}"},To={"add-to-commands":"\u52A0\u5165\u81F3\u547D\u4EE4","add-to-context-menus":"\u52A0\u5165\u81F3\u53F3\u952E\u9009\u5355","enable-Windows-conhost-workaround":"\u542F\u7528 Windows\u300Cconhost.exe\u300D\u89E3\u51B3\u65B9\u6CD5","enable-Windows-conhost-workaround-description":"\u5982\u679C\u6267\u884C\u300Cconhost.exe\u300D\u6CA1\u6709\u521B\u5EFA\u89C6\u7A97\uFF0C\u8BF7\u7981\u7528\u3002\u65E0\u4FDD\u8BC1\u8FD9\u4F1A\u8D77\u4F5C\u7528\u3002",executables:"\u53EF\u6267\u884C\u6587\u4EF6","executable-list":{darwin:"macOS",linux:"Linux",win32:"Microsoft Windows"},"hide-status-bar":"\u9690\u85CF\u72B6\u6001\u680F","hide-status-bar-options":{never:"\u4ECE\u4E0D",always:"\u603B\u662F",focused:"\u5F53\u805A\u7126\u7EC8\u7AEF\u65F6",running:"\u5F53\u6267\u884C\u7EC8\u7AEF\u65F6"},language:"\u8BED\u8A00","language-default":"\u4F7F\u7528\u5E94\u7528\u8BBE\u5B9A","language-description":"\u4EC5\u9002\u7528\u65BC\u6B64\u63D2\u4EF6\u3002","notice-timeout":"\u901A\u77E5\u8D85\u65F6\uFF08\u79D2\uFF09","notice-timeout-description":"\u8BBE\u4E3A 0 \u79D2\u662F\u65E0\u8D85\u65F6\u3002","python-executable":"Python \u53EF\u6267\u884C\u6587\u4EF6","python-executable-description":"\u6E05\u9664\u6587\u672C\u6846\u4EE5\u7981\u7528\u7EC8\u7AEF\u7F29\u653E\u8FF8\u7A0B\u3002","python-executable-placeholder":"\uFF08\u5DF2\u7981\u7528\uFF09",reset:"\u91CD\u8BBE","reset-all":"\u91CD\u8BBE\u5168\u90E8"},Oo={terminal:{"display-name":"\u7EC8\u7AEF\uFF1A{{- executable}}"}},Ao={commands:Eo,errors:xo,menus:Lo,name:ko,notices:Ro,settings:To,views:Oo};var Ir={};st(Ir,{commands:()=>Do,default:()=>Fo,errors:()=>Po,menus:()=>Bo,name:()=>Io,notices:()=>Mo,settings:()=>Ho,views:()=>No});var Do={"open-terminal-external-root":"\u5728\u5916\u90E8\u7D42\u7AEF\u958B\u555F\u6839\u76EE\u9304","open-terminal-external-current":"\u5728\u5916\u90E8\u7D42\u7AEF\u958B\u555F\u76EE\u524D\u76EE\u9304","open-terminal-integrated-root":"\u5728\u6574\u5408\u5F0F\u7D42\u7AEF\u958B\u555F\u6839\u76EE\u9304","open-terminal-integrated-current":"\u5728\u6574\u5408\u5F0F\u7D42\u7AEF\u958B\u555F\u76EE\u524D\u76EE\u9304"},Po={"cannot-find-status-bar":"\u627E\u4E0D\u5230\u72C0\u614B\u6B04","error-spawning-terminal":"\u555F\u52D5\u7D42\u7AEF\u6642\u51FA\u932F","error-spawning-resizer":"\u555F\u52D5\u7D42\u7AEF\u7E2E\u653E\u7A0B\u5F0F\u6642\u51FA\u932F","resizer-disabled":"\u7D42\u7AEF\u7E2E\u653E\u7A0B\u5F0F\u5DF2\u7981\u7528","resizer-exited-unexpectedly":"\u7D42\u7AEF\u7E2E\u653E\u7A0B\u5F0F\u610F\u5916\u9000\u51FA\uFF1A{{- code}}","unsupported-platform":"\u4E0D\u652F\u6301\u6B64\u5E73\u53F0"},Bo={"open-terminal-external":"\u5728\u5916\u90E8\u7D42\u7AEF\u958B\u555F","open-terminal-integrated":"\u5728\u6574\u5408\u5F0F\u7D42\u7AEF\u958B\u555F","save-as-HTML":"\u5132\u5B58\u70BA HTML"},Io="\u7D42\u7AEF",Mo={"spawning-terminal":"\u7D42\u7AEF\u555F\u52D5\u4E2D\uFF1A{{- executable}}","terminal-exited":"\u7D42\u7AEF\u5DF2\u9000\u51FA\uFF1A{{- code}}"},Ho={"add-to-commands":"\u52A0\u5165\u81F3\u547D\u4EE4","add-to-context-menus":"\u52A0\u5165\u81F3\u53F3\u9375\u9078\u55AE","enable-Windows-conhost-workaround":"\u555F\u7528 Windows\u300Cconhost.exe\u300D\u89E3\u6C7A\u65B9\u6CD5","enable-Windows-conhost-workaround-description":"\u5982\u679C\u57F7\u884C\u300Cconhost.exe\u300D\u6C92\u6709\u5275\u5EFA\u8996\u7A97\uFF0C\u8ACB\u7981\u7528\u3002\u7121\u4FDD\u8B49\u9019\u6703\u8D77\u4F5C\u7528\u3002",executables:"\u57F7\u884C\u6A94","executable-list":{darwin:"macOS",linux:"Linux",win32:"Microsoft Windows"},"hide-status-bar":"\u96B1\u85CF\u72C0\u614B\u6B04","hide-status-bar-options":{never:"\u5F9E\u4E0D",always:"\u7E3D\u662F",focused:"\u7576\u805A\u7126\u7D42\u7AEF\u6642",running:"\u7576\u57F7\u884C\u7D42\u7AEF\u6642"},language:"\u8A9E\u8A00","language-default":"\u4F7F\u7528\u61C9\u7528\u7A0B\u5F0F\u8A2D\u5B9A","language-description":"\u50C5\u9069\u7528\u65BC\u6B64\u5916\u639B\u7A0B\u5F0F\u3002","notice-timeout":"\u901A\u77E5\u8D85\u6642\uFF08\u79D2\uFF09","notice-timeout-description":"\u8A2D\u70BA 0 \u79D2\u662F\u7121\u8D85\u6642\u3002","python-executable":"Python \u57F7\u884C\u6A94","python-executable-description":"\u6E05\u9664\u6587\u5B57\u57DF\u4EE5\u7981\u7528\u7D42\u7AEF\u7E2E\u653E\u7A0B\u5F0F\u3002","python-executable-placeholder":"\uFF08\u5DF2\u7981\u7528\uFF09",reset:"\u91CD\u8A2D","reset-all":"\u91CD\u8A2D\u5168\u90E8"},No={terminal:{"display-name":"\u7D42\u7AEF\uFF1A{{- executable}}"}},Fo={commands:Do,errors:Po,menus:Bo,name:Io,notices:Mo,settings:Ho,views:No};var Ki=!1,xt="translation",at="en",qi={default:[at],zh:["zh-Hans",at],"zh-CN":["zh-Hans","zh",at],"zh-TW":["zh-Hant","zh",at]},Vt={en:{[xt]:Dr,asset:Ar,language:Pr},"zh-Hans":{[xt]:Br},"zh-Hant":{[xt]:Ir}};var je;(c=>{c.HIDE_STATUS_BAR_OPTIONS=["never","always","focused","running"];async function s(o,e){Object.assign(o,await e.loadData())}c.load=s;async function n(o,e){await e.saveData(o)}c.save=n})(je||(je={}));var be={command:!0,contextMenu:!0,enableWindowsConhostWorkaround:!0,executables:{darwin:{args:[],name:"/System/Applications/Utilities/Terminal.app/Contents/MacOS/Terminal"},linux:{args:[],name:"xterm-256color"},win32:{args:[],name:"C:\\Windows\\System32\\cmd.exe"}},hideStatusBar:"focused",language:"",noticeTimeout:5,pythonExecutable:"python"},Ce,Pe,Yt,Vi,pe,Le,Gt=class extends _e.PluginSettingTab{constructor(n){super(n.app,n);this.plugin=n;X(this,Ce);X(this,Yt);X(this,pe)}display(){let{containerEl:n,plugin:c}=this,{state:o}=c,{settings:e,language:i,statusBarHider:l}=o,{i18n:u}=i;n.empty(),n.createEl("h1",{text:u.t("name")}),new _e.Setting(n).setName(u.t("settings.language")).setDesc(u.t("settings.language-description")).addDropdown(V(this,Ce,Pe).call(this,()=>e.language,d=>void(e.language=d),{post:(d,a)=>void d.onChange(async f=>{await a(f),await i.changeLanguage(e.language),this.display()}),pre:d=>void d.addOption("",u.t("settings.language-default")).addOptions(Object.fromEntries(Object.entries(Vt.en.language).filter(a=>a.every(f=>typeof f=="string"))))})).addExtraButton(V(this,pe,Le).call(this,()=>void(e.language=be.language),u.t("asset:settings.language-icon"),{post:(d,a)=>void d.onClick(async()=>{await a(),await i.changeLanguage(e.language),this.display()})})),new _e.Setting(n).setName(u.t("settings.reset-all")).addButton(V(this,pe,Le).call(this,async()=>{Object.assign(e,be),await i.changeLanguage(e.language)})),new _e.Setting(n).setName(u.t("settings.add-to-commands")).addToggle(V(this,Ce,Pe).call(this,()=>e.command,d=>void(e.command=d))).addExtraButton(V(this,pe,Le).call(this,()=>void(e.command=be.command),u.t("asset:settings.add-to-commands-icon"))),new _e.Setting(n).setName(u.t("settings.add-to-context-menus")).addToggle(V(this,Ce,Pe).call(this,()=>e.contextMenu,d=>void(e.contextMenu=d))).addExtraButton(V(this,pe,Le).call(this,()=>void(e.contextMenu=be.contextMenu),u.t("asset:settings.add-to-context-menus-icon"))),new _e.Setting(n).setName(u.t("settings.hide-status-bar")).addDropdown(V(this,Ce,Pe).call(this,()=>e.hideStatusBar,d=>ot(je.HIDE_STATUS_BAR_OPTIONS,d)?(e.hideStatusBar=d,!0):!1,{post:(d,a)=>void d.onChange(async f=>{await a(f),l.update()}),pre:d=>void d.addOptions(Object.fromEntries(je.HIDE_STATUS_BAR_OPTIONS.map(a=>[a,u.t(`settings.hide-status-bar-options.${a}`)])))})).addExtraButton(V(this,pe,Le).call(this,()=>void(e.hideStatusBar=be.hideStatusBar),u.t("asset:settings.hide-status-bar-icon"),{post:(d,a)=>void d.onClick(async()=>{await a(),l.update()})})),new _e.Setting(n).setName(u.t("settings.notice-timeout")).setDesc(u.t("settings.notice-timeout-description")).addText(V(this,Ce,Pe).call(this,()=>e.noticeTimeout.toString(),V(this,Yt,Vi).call(this,d=>void(e.noticeTimeout=d)))).addExtraButton(V(this,pe,Le).call(this,()=>void(e.noticeTimeout=be.noticeTimeout),u.t("asset:settings.notice-timeout-icon"))),new _e.Setting(n).setName(u.t("settings.python-executable")).setDesc(u.t("settings.python-executable-description")).addText(V(this,Ce,Pe).call(this,()=>e.pythonExecutable,d=>void(e.pythonExecutable=d),{post:d=>void d.setPlaceholder(u.t("settings.python-executable-placeholder"))})).addExtraButton(V(this,pe,Le).call(this,()=>void(e.pythonExecutable=be.pythonExecutable),u.t("asset:settings.python-executable-icon"))),n.createEl("h2",{text:u.t("settings.executables")});for(let d of ge.PLATFORMS)new _e.Setting(n).setName(u.t(`settings.executable-list.${d}`)).addText(V(this,Ce,Pe).call(this,()=>e.executables[d].name,a=>void(e.executables[d].name=a))).addExtraButton(V(this,pe,Le).call(this,()=>void(e.executables[d].name=be.executables[d].name),u.t("asset:settings.executable-list-icon")));new _e.Setting(n).setName(u.t("settings.enable-Windows-conhost-workaround")).setDesc(u.t("settings.enable-Windows-conhost-workaround-description")).addToggle(V(this,Ce,Pe).call(this,()=>e.enableWindowsConhostWorkaround,d=>void(e.enableWindowsConhostWorkaround=d))).addExtraButton(V(this,pe,Le).call(this,()=>void(e.enableWindowsConhostWorkaround=be.enableWindowsConhostWorkaround),u.t("asset:settings.enable-Windows-conhost-workaround-icon")))}};Ce=new WeakSet,Pe=function(n,c,o={}){return e=>{var l,u;((l=o.pre)!=null?l:()=>{})(e);let i=async d=>{let a=await c(d,e,n);typeof a=="boolean"&&!a||await je.save(this.plugin.state.settings,this.plugin)};e.setValue(n()).onChange(i),((u=o.post)!=null?u:()=>{})(e,i)}},Yt=new WeakSet,Vi=function(n,c=!1){return async(o,e,i)=>{let l=Number(o);if(!(c?Number.isSafeInteger(l):isFinite(l)))return e.setValue(i()),!1;let u=await n(l,e,i);return!(typeof u=="boolean"&&!u)}},pe=new WeakSet,Le=function(n,c=this.plugin.state.language.i18n.t("asset:settings.reset-icon"),o={}){return e=>{var l,u;((l=o.pre)!=null?l:()=>{})(e);let i=async()=>{let d=await n(e);if(typeof d=="boolean"&&!d)return;let a=je.save(this.plugin.state.settings,this.plugin);this.display(),await a};e.setTooltip(this.plugin.state.language.i18n.t("settings.reset")).setIcon(c).onClick(i),((u=o.post)!=null?u:()=>{})(e,i)}};var hr=require("child_process");var dn=require("util"),fn=require("fs");var Gi=`# -*- coding: UTF-8 -*-\r
# pip install psutil pywinctl\r
import contextlib as _contextlib\r
import os as _os\r
import psutil as _psutil\r
import pywinctl as _pywinctl  # type: ignore\r
import sys as _sys\r
import types as _types\r
import typing as _typing\r
\r
if _sys.platform == "darwin":\r
    pass\r
elif _sys.platform == "linux":\r
    import ewmh as _ewmh\r
    import termios as _termios\r
elif _sys.platform == "win32":\r
    import pywintypes as _pywintypes\r
    import win32con as _win32con\r
    import win32console as _win32console\r
    import win32file as _win32file\r
    import win32gui as _win32gui\r
    import win32process as _win32process\r
\r
\r
def main() -> None:\r
    pid = int(input("PID: "))\r
    print(f"received: {pid}")\r
    proc = _psutil.Process(pid)\r
    procs = (proc,) + tuple(proc.children(recursive=True))\r
    print(f"Process(es): {procs}")\r
    pids: _typing.Mapping[int, _psutil.Process] = _types.MappingProxyType(\r
        {proc.pid: proc for proc in procs}\r
    )\r
\r
    windows: _typing.Collection[_pywinctl.Window] = _pywinctl.getAllWindows()\r
    print(f"windows: {windows}")\r
    for win in windows:\r
        win_pid = win_to_pid(win)\r
        if win_pid in pids:\r
            resizer(pids[_typing.cast(int, win_pid)], win)\r
            break\r
    resizer(proc, None)\r
\r
\r
def win_to_pid(window: _pywinctl.Window) -> int | None:\r
    if _sys.platform == "darwin":\r
        return window._app.processIdentifier()\r
    elif _sys.platform == "linux":\r
        return _ewmh.getWmPid(window.getHandle())\r
    elif _sys.platform == "win32":\r
        return _win32process.GetWindowThreadProcessId(window.getHandle())[1]\r
    return None\r
\r
\r
def resizer(process: _psutil.Process, window: _pywinctl.BaseWindow | None) -> None:\r
    print(f"window: {window}")\r
    r_in = resizer_in(process)\r
    r_out = resizer_out(process, window)\r
    next(r_out)\r
    for size in r_in:\r
        r_out.send(size)\r
\r
\r
def resizer_in(process: _psutil.Process) -> _typing.Iterator[tuple[int, int]]:\r
    while True:\r
        size0 = ""\r
        while not size0:  # stdin watchdog triggers this loop\r
            if not process.is_running():\r
                return\r
            size0 = input("size: ")\r
        size = _typing.cast(\r
            tuple[int, int],\r
            tuple(int(s.strip()) for s in size0.split("x", 2)),\r
        )\r
        print(f"received: {'x'.join(map(str, size))}")\r
        yield size\r
\r
\r
def resizer_out(\r
    process: _psutil.Process, window: _pywinctl.BaseWindow | None\r
) -> _typing.Generator[None, tuple[int, int], None]:\r
    if window is None:\r
        while True:\r
            yield\r
    window.hide()\r
    if _sys.platform == "win32":\r
\r
        @_typing.final\r
        class ConsoleScreenBufferInfo(_typing.TypedDict):\r
            Size: _win32console.PyCOORDType\r
            CursorPosition: _win32console.PyCOORDType\r
            Attributes: int\r
            Window: _win32console.PySMALL_RECTType\r
            MaximumWindowSize: _win32console.PyCOORDType\r
\r
        def ignore_error(func: _typing.Callable[[], None]) -> bool:\r
            try:\r
                func()\r
                return True\r
            except _pywintypes.error:\r
                return False\r
\r
        @_contextlib.contextmanager\r
        def attach_console(\r
            pid: int,\r
        ) -> _typing.Iterator[_win32console.PyConsoleScreenBufferType]:\r
            try:\r
                _win32console.AttachConsole(pid)  # type: ignore\r
                yield (_win32console.PyConsoleScreenBufferType)(  # type: ignore\r
                    _win32file.CreateFile(\r
                        "CONOUT$",\r
                        _win32file.GENERIC_READ | _win32file.GENERIC_WRITE,\r
                        _win32file.FILE_SHARE_WRITE,\r
                        None,\r
                        _win32file.OPEN_EXISTING,\r
                        0,\r
                        None,\r
                    )  # GetStdHandle gives the piped handle instead of the console handle\r
                )\r
            finally:\r
                _win32console.FreeConsole()\r
\r
        _win32console.FreeConsole()\r
        with attach_console(process.pid) as console:\r
            while True:\r
                columns: int\r
                rows: int\r
                columns, rows = yield\r
                info: ConsoleScreenBufferInfo = (\r
                    console.GetConsoleScreenBufferInfo()  # type: ignore\r
                )\r
                old_rect = window.getClientFrame()\r
                old_actual_rect = window.size\r
                old_cols: int = (\r
                    info["Window"].Right - info["Window"].Left + 1  # type: ignore\r
                )\r
                old_rows: int = (\r
                    info["Window"].Bottom - info["Window"].Top + 1  # type: ignore\r
                )\r
                old_width = old_rect.right - old_rect.left\r
                old_height = old_rect.bottom - old_rect.top\r
                size = (\r
                    int(old_width * columns / old_cols)\r
                    + old_actual_rect.width\r
                    - old_width,\r
                    int(old_height * rows / old_rows)\r
                    + old_actual_rect.height\r
                    - old_height,\r
                )\r
                print(f"pixel size: {size}")\r
                setters = [\r
                    # almost accurate, works for alternate screen buffer\r
                    lambda: _win32gui.SetWindowPos(\r
                        _typing.cast(int, window.getHandle()),\r
                        None,\r
                        0,\r
                        0,\r
                        *size,\r
                        _win32con.SWP_NOACTIVATE\r
                        | _win32con.SWP_NOREDRAW\r
                        | _win32con.SWP_NOZORDER,\r
                    ),\r
                    # accurate, SetConsoleWindowInfo does not work for alternate screen buffer\r
                    lambda: console.SetConsoleWindowInfo(  # type: ignore\r
                        True,\r
                        _win32console.PySMALL_RECTType(0, 0, columns - 1, old_rows - 1),  # type: ignore\r
                    ),\r
                    lambda: console.SetConsoleScreenBufferSize(\r
                        _win32console.PyCOORDType(columns, old_rows)  # type: ignore\r
                    ),\r
                    lambda: console.SetConsoleWindowInfo(  # type: ignore\r
                        True,\r
                        _win32console.PySMALL_RECTType(0, 0, columns - 1, rows - 1),  # type: ignore\r
                    ),\r
                    lambda: console.SetConsoleScreenBufferSize(\r
                        _win32console.PyCOORDType(columns, rows)  # type: ignore\r
                    ),\r
                ]\r
                if old_cols < columns:\r
                    setters[1], setters[2] = setters[2], setters[1]\r
                if old_rows < rows:\r
                    setters[3], setters[4] = setters[4], setters[3]\r
                for setter in setters:\r
                    ignore_error(setter)\r
                print(f"resized")  # used by the plugin\r
    else:\r
\r
        @_contextlib.contextmanager\r
        def open_tty(pid: int) -> _typing.Iterator[int]:\r
            fd = _os.open(f"/proc/{pid}/fd/0", _os.O_RDONLY)\r
            try:\r
                yield fd\r
            finally:\r
                _os.close(fd)\r
\r
        with open_tty(process.pid) as tty:\r
            while True:\r
                columns: int\r
                rows: int\r
                columns, rows = yield\r
                _termios.tcsetwinsize(tty, (rows, columns))\r
                print(f"resized")  # used by the plugin\r
\r
\r
if __name__ == "__main__":\r
    main()\r
`;var _n=nt(un());var vi=class{constructor(s){this.plugin=s}},et,_t,pt,or=class extends vi{constructor(n,c){super(n);ye(this,"shell");X(this,et,!1);X(this,_t,(()=>{let{plugin:n}=this,{settings:c,language:o}=n.state,{pythonExecutable:e}=c,{i18n:i}=o;if(e==="")return null;let l=(0,hr.spawn)(e,["-c",Gi],{stdio:["pipe","pipe","pipe"],windowsHide:!0});return l.once("spawn",()=>{xe(this,et,!0);let u=n.registerInterval(window.setInterval(()=>void q(this,pt).call(this,`
`).catch(()=>{}),Hi)),d=()=>{window.clearInterval(u)};try{l.once("exit",d).once("error",d)}catch(a){throw d(),a}}).once("exit",(u,d)=>{xe(this,et,!1),u!==0&&Ae(()=>i.t("errors.resizer-exited-unexpectedly",{code:u!=null?u:d}),0,n)}).once("error",u=>{xe(this,et,!1),De(u,()=>i.t("errors.error-spawning-resizer"),n)}),l.stderr.on("data",u=>{console.error(u.toString())}),l})());X(this,pt,(0,dn.promisify)((n,c)=>{let o=q(this,_t);if(o===null)return c(new Error(this.plugin.state.language.i18n.t("errors.resizer-disabled"))),!1;try{return o.stdin.write(n,c)}catch(e){c(Or(e))}return!1}));this.shell=new Promise($t(o=>{let e=q(this,_t);if(e===null){o(()=>c(!1));return}let i=a=>a.once("spawn",()=>{let{pid:f}=a;if(typeof f=="undefined"){e.kill();return}q(this,pt).call(this,`${f}
`).catch(v=>{try{De(v,()=>this.plugin.state.language.i18n.t("errors.error-spawning-resizer"),this.plugin)}finally{e.kill()}})}),l=()=>{try{o(()=>i(c(!0)))}finally{e.removeListener("error",d)}},u=e;function d(){try{o(()=>c(!1))}finally{u.removeListener("spawn",l)}}e.once("spawn",l).once("error",d)}))}get resizable(){return q(this,et)}async resize(n,c){return new Promise($t((o,e)=>{let i=q(this,_t);if(i===null){e(()=>new Error(this.plugin.state.language.i18n.t("errors.resizer-disabled")));return}let l=i,{stdout:u}=i,d=v=>{if(v.toString().includes("resized"))try{o(()=>{})}finally{u.removeListener("data",d),i.removeListener("exit",a).removeListener("error",f)}};function a(...v){try{e(()=>new Error(v.toString()))}finally{u.removeListener("data",d),l.removeListener("error",f)}}function f(v){try{e(()=>v)}finally{u.removeListener("data",d),l.removeListener("exit",a)}}i.once("exit",a).once("error",f),u.on("data",d),q(this,pt).call(this,`${n}x${c}
`).catch(v=>{try{e(()=>Or(v))}finally{u.removeListener("data",d),i.removeListener("exit",a).removeListener("error",f)}})}))}};et=new WeakMap,_t=new WeakMap,pt=new WeakMap;var Dt,lr,pn,cr=class extends or{constructor(n,c,o,e){let i=n.state.settings.enableWindowsConhostWorkaround,l=(0,_n.fileSync)({discardDescriptor:!0});super(n,u=>{let d=V(cr,lr,pn).bind(cr),a=["C:\\Windows\\System32\\cmd.exe","/C",`${d(c)} ${(e!=null?e:[]).map(d).join(" ")} & call echo %^ERRORLEVEL% >${d(l.name)}`];return i&&a.unshift("C:\\Windows\\System32\\conhost.exe"),(0,hr.spawn)(a.shift(),a,{cwd:o,stdio:["pipe","pipe","pipe"],windowsHide:!u,windowsVerbatimArguments:!0})});ye(this,"conhost");X(this,Dt,void 0);this.conhost=i,xe(this,Dt,this.shell.then(async u=>new Promise($t((d,a)=>{u.once("exit",(f,v)=>{try{d(()=>{var r;let p=parseInt((0,fn.readFileSync)(l.name,{encoding:"utf-8",flag:"r"}).trim(),10);return isNaN(p)?(r=f!=null?f:v)!=null?r:NaN:p})}finally{l.removeCallback()}}).once("error",f=>{try{a(()=>f)}finally{l.removeCallback()}})}))))}async once(n,c){return q(this,Dt).then(c).catch(()=>{}),Promise.resolve(this)}},tt=cr;Dt=new WeakMap,lr=new WeakSet,pn=function(n){return`"${n.replace('"','\\"')}"`.replace(/(?<meta>[()%!^"<>&|])/gu,"^$<meta>")},X(tt,lr);var ar=class extends or{constructor(s,n,c,o){super(s,e=>(0,hr.spawn)(n,o,{cwd:c,stdio:["pipe","pipe","pipe"],windowsHide:!e}))}async once(s,n){return(await this.shell).once(s,(c,o)=>{var e;return void n((e=c!=null?c:o)!=null?e:NaN)}),this}};function le(t){return le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},le(t)}function ve(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function mi(t,s){if(le(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var c=n.call(t,s||"default");if(le(c)!=="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function Pt(t){var s=mi(t,"string");return le(s)==="symbol"?s:String(s)}function gn(t,s){for(var n=0;n<s.length;n++){var c=s[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,Pt(c.key),c)}}function me(t,s,n){return s&&gn(t.prototype,s),n&&gn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function we(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bt(t,s){return Bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,o){return c.__proto__=o,c},Bt(t,s)}function gt(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&Bt(t,s)}function rt(t,s){if(s&&(le(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return we(t)}function Se(t){return Se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Se(t)}function Re(t,s,n){return s=Pt(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Si(t){if(Array.isArray(t))return t}function yi(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ur(t,s){(s==null||s>t.length)&&(s=t.length);for(var n=0,c=new Array(s);n<s;n++)c[n]=t[n];return c}function bi(t,s){if(t){if(typeof t=="string")return ur(t,s);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ur(t,s)}}function Ci(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wi(t){return Si(t)||yi(t)||bi(t)||Ci()}function vn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);s&&(c=c.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,c)}return n}function mn(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?vn(Object(n),!0).forEach(function(c){Re(t,c,n[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vn(Object(n)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(n,c))})}return t}var nl={type:"logger",log:function(s){this.output("log",s)},warn:function(s){this.output("warn",s)},error:function(s){this.output("error",s)},output:function(s,n){console&&console[s]&&console[s].apply(console,n)}},ol=function(){function t(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ve(this,t),this.init(s,n)}return me(t,[{key:"init",value:function(n){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=c.prefix||"i18next:",this.logger=n||nl,this.options=c,this.debug=c.debug}},{key:"setDebug",value:function(n){this.debug=n}},{key:"log",value:function(){for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return this.forward(c,"log","",!0)}},{key:"warn",value:function(){for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return this.forward(c,"warn","",!0)}},{key:"error",value:function(){for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return this.forward(c,"error","")}},{key:"deprecate",value:function(){for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return this.forward(c,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(n,c,o,e){return e&&!this.debug?null:(typeof n[0]=="string"&&(n[0]="".concat(o).concat(this.prefix," ").concat(n[0])),this.logger[c](n))}},{key:"create",value:function(n){return new t(this.logger,mn(mn({},{prefix:"".concat(this.prefix,":").concat(n,":")}),this.options))}},{key:"clone",value:function(n){return n=n||this.options,n.prefix=n.prefix||this.prefix,new t(this.logger,n)}}]),t}(),Oe=new ol,Ve=function(){function t(){ve(this,t),this.observers={}}return me(t,[{key:"on",value:function(n,c){var o=this;return n.split(" ").forEach(function(e){o.observers[e]=o.observers[e]||[],o.observers[e].push(c)}),this}},{key:"off",value:function(n,c){if(this.observers[n]){if(!c){delete this.observers[n];return}this.observers[n]=this.observers[n].filter(function(o){return o!==c})}}},{key:"emit",value:function(n){for(var c=arguments.length,o=new Array(c>1?c-1:0),e=1;e<c;e++)o[e-1]=arguments[e];if(this.observers[n]){var i=[].concat(this.observers[n]);i.forEach(function(u){u.apply(void 0,o)})}if(this.observers["*"]){var l=[].concat(this.observers["*"]);l.forEach(function(u){u.apply(u,[n].concat(o))})}}}]),t}();function It(){var t,s,n=new Promise(function(c,o){t=c,s=o});return n.resolve=t,n.reject=s,n}function Sn(t){return t==null?"":""+t}function al(t,s,n){t.forEach(function(c){s[c]&&(n[c]=s[c])})}function xi(t,s,n){function c(l){return l&&l.indexOf("###")>-1?l.replace(/###/g,"."):l}function o(){return!t||typeof t=="string"}for(var e=typeof s!="string"?[].concat(s):s.split(".");e.length>1;){if(o())return{};var i=c(e.shift());!t[i]&&n&&(t[i]=new n),Object.prototype.hasOwnProperty.call(t,i)?t=t[i]:t={}}return o()?{}:{obj:t,k:c(e.shift())}}function yn(t,s,n){var c=xi(t,s,Object),o=c.obj,e=c.k;o[e]=n}function ll(t,s,n,c){var o=xi(t,s,Object),e=o.obj,i=o.k;e[i]=e[i]||[],c&&(e[i]=e[i].concat(n)),c||e[i].push(n)}function _r(t,s){var n=xi(t,s),c=n.obj,o=n.k;if(c)return c[o]}function bn(t,s,n){var c=_r(t,n);return c!==void 0?c:_r(s,n)}function In(t,s,n){for(var c in s)c!=="__proto__"&&c!=="constructor"&&(c in t?typeof t[c]=="string"||t[c]instanceof String||typeof s[c]=="string"||s[c]instanceof String?n&&(t[c]=s[c]):In(t[c],s[c],n):t[c]=s[c]);return t}function vt(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var cl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function hl(t){return typeof t=="string"?t.replace(/[&<>"'\/]/g,function(s){return cl[s]}):t}var gr=typeof window!="undefined"&&window.navigator&&typeof window.navigator.userAgentData=="undefined"&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,ul=[" ",",","?","!",";"];function dl(t,s,n){s=s||"",n=n||"";var c=ul.filter(function(l){return s.indexOf(l)<0&&n.indexOf(l)<0});if(c.length===0)return!0;var o=new RegExp("(".concat(c.map(function(l){return l==="?"?"\\?":l}).join("|"),")")),e=!o.test(t);if(!e){var i=t.indexOf(n);i>0&&!o.test(t.substring(0,i))&&(e=!0)}return e}function Cn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);s&&(c=c.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,c)}return n}function dr(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Cn(Object(n),!0).forEach(function(c){Re(t,c,n[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(n,c))})}return t}function fl(t){var s=_l();return function(){var c=Se(t),o;if(s){var e=Se(this).constructor;o=Reflect.construct(c,arguments,e)}else o=c.apply(this,arguments);return rt(this,o)}}function _l(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Mn(t,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(t){if(t[s])return t[s];for(var c=s.split(n),o=t,e=0;e<c.length;++e){if(!o||typeof o[c[e]]=="string"&&e+1<c.length)return;if(o[c[e]]===void 0){for(var i=2,l=c.slice(e,e+i).join(n),u=o[l];u===void 0&&c.length>e+i;)i++,l=c.slice(e,e+i).join(n),u=o[l];if(u===void 0)return;if(u===null)return null;if(s.endsWith(l)){if(typeof u=="string")return u;if(l&&typeof u[l]=="string")return u[l]}var d=c.slice(e+i).join(n);return d?Mn(u,d,n):void 0}o=o[c[e]]}return o}}var pl=function(t){gt(n,t);var s=fl(n);function n(c){var o,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};return ve(this,n),o=s.call(this),gr&&Ve.call(we(o)),o.data=c||{},o.options=e,o.options.keySeparator===void 0&&(o.options.keySeparator="."),o.options.ignoreJSONStructure===void 0&&(o.options.ignoreJSONStructure=!0),o}return me(n,[{key:"addNamespaces",value:function(o){this.options.ns.indexOf(o)<0&&this.options.ns.push(o)}},{key:"removeNamespaces",value:function(o){var e=this.options.ns.indexOf(o);e>-1&&this.options.ns.splice(e,1)}},{key:"getResource",value:function(o,e,i){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},u=l.keySeparator!==void 0?l.keySeparator:this.options.keySeparator,d=l.ignoreJSONStructure!==void 0?l.ignoreJSONStructure:this.options.ignoreJSONStructure,a=[o,e];i&&typeof i!="string"&&(a=a.concat(i)),i&&typeof i=="string"&&(a=a.concat(u?i.split(u):i)),o.indexOf(".")>-1&&(a=o.split("."));var f=_r(this.data,a);return f||!d||typeof i!="string"?f:Mn(this.data&&this.data[o]&&this.data[o][e],i,u)}},{key:"addResource",value:function(o,e,i,l){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},d=this.options.keySeparator;d===void 0&&(d=".");var a=[o,e];i&&(a=a.concat(d?i.split(d):i)),o.indexOf(".")>-1&&(a=o.split("."),l=e,e=a[1]),this.addNamespaces(e),yn(this.data,a,l),u.silent||this.emit("added",o,e,i,l)}},{key:"addResources",value:function(o,e,i){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(var u in i)(typeof i[u]=="string"||Object.prototype.toString.apply(i[u])==="[object Array]")&&this.addResource(o,e,u,i[u],{silent:!0});l.silent||this.emit("added",o,e,i)}},{key:"addResourceBundle",value:function(o,e,i,l,u){var d=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},a=[o,e];o.indexOf(".")>-1&&(a=o.split("."),l=i,i=e,e=a[1]),this.addNamespaces(e);var f=_r(this.data,a)||{};l?In(f,i,u):f=dr(dr({},f),i),yn(this.data,a,f),d.silent||this.emit("added",o,e,i)}},{key:"removeResourceBundle",value:function(o,e){this.hasResourceBundle(o,e)&&delete this.data[o][e],this.removeNamespaces(e),this.emit("removed",o,e)}},{key:"hasResourceBundle",value:function(o,e){return this.getResource(o,e)!==void 0}},{key:"getResourceBundle",value:function(o,e){return e||(e=this.options.defaultNS),this.options.compatibilityAPI==="v1"?dr(dr({},{}),this.getResource(o,e)):this.getResource(o,e)}},{key:"getDataByLanguage",value:function(o){return this.data[o]}},{key:"hasLanguageSomeTranslations",value:function(o){var e=this.getDataByLanguage(o),i=e&&Object.keys(e)||[];return!!i.find(function(l){return e[l]&&Object.keys(e[l]).length>0})}},{key:"toJSON",value:function(){return this.data}}]),n}(Ve),Hn={processors:{},addPostProcessor:function(s){this.processors[s.name]=s},handle:function(s,n,c,o,e){var i=this;return s.forEach(function(l){i.processors[l]&&(n=i.processors[l].process(n,c,o,e))}),n}};function wn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);s&&(c=c.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,c)}return n}function ce(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?wn(Object(n),!0).forEach(function(c){Re(t,c,n[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wn(Object(n)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(n,c))})}return t}function gl(t){var s=vl();return function(){var c=Se(t),o;if(s){var e=Se(this).constructor;o=Reflect.construct(c,arguments,e)}else o=c.apply(this,arguments);return rt(this,o)}}function vl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var En={},xn=function(t){gt(n,t);var s=gl(n);function n(c){var o,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ve(this,n),o=s.call(this),gr&&Ve.call(we(o)),al(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],c,we(o)),o.options=e,o.options.keySeparator===void 0&&(o.options.keySeparator="."),o.logger=Oe.create("translator"),o}return me(n,[{key:"changeLanguage",value:function(o){o&&(this.language=o)}},{key:"exists",value:function(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(o==null)return!1;var i=this.resolve(o,e);return i&&i.res!==void 0}},{key:"extractFromKey",value:function(o,e){var i=e.nsSeparator!==void 0?e.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");var l=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator,u=e.ns||this.options.defaultNS||[],d=i&&o.indexOf(i)>-1,a=!this.options.userDefinedKeySeparator&&!e.keySeparator&&!this.options.userDefinedNsSeparator&&!e.nsSeparator&&!dl(o,i,l);if(d&&!a){var f=o.match(this.interpolator.nestingRegexp);if(f&&f.length>0)return{key:o,namespaces:u};var v=o.split(i);(i!==l||i===l&&this.options.ns.indexOf(v[0])>-1)&&(u=v.shift()),o=v.join(l)}return typeof u=="string"&&(u=[u]),{key:o,namespaces:u}}},{key:"translate",value:function(o,e,i){var l=this;if(le(e)!=="object"&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),e||(e={}),o==null)return"";Array.isArray(o)||(o=[String(o)]);var u=e.returnDetails!==void 0?e.returnDetails:this.options.returnDetails,d=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator,a=this.extractFromKey(o[o.length-1],e),f=a.key,v=a.namespaces,p=v[v.length-1],r=e.lng||this.language,_=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(r&&r.toLowerCase()==="cimode"){if(_){var g=e.nsSeparator||this.options.nsSeparator;return u?(h.res="".concat(p).concat(g).concat(f),h):"".concat(p).concat(g).concat(f)}return u?(h.res=f,h):f}var h=this.resolve(o,e),m=h&&h.res,y=h&&h.usedKey||f,b=h&&h.exactUsedKey||f,w=Object.prototype.toString.apply(m),S=["[object Number]","[object Function]","[object RegExp]"],C=e.joinArrays!==void 0?e.joinArrays:this.options.joinArrays,x=!this.i18nFormat||this.i18nFormat.handleAsObject,L=typeof m!="string"&&typeof m!="boolean"&&typeof m!="number";if(x&&m&&L&&S.indexOf(w)<0&&!(typeof C=="string"&&w==="[object Array]")){if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var R=this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,m,ce(ce({},e),{},{ns:v})):"key '".concat(f," (").concat(this.language,")' returned an object instead of string.");return u?(h.res=R,h):R}if(d){var T=w==="[object Array]",I=T?[]:{},N=T?b:y;for(var F in m)if(Object.prototype.hasOwnProperty.call(m,F)){var E="".concat(N).concat(d).concat(F);I[F]=this.translate(E,ce(ce({},e),{joinArrays:!1,ns:v})),I[F]===E&&(I[F]=m[F])}m=I}}else if(x&&typeof C=="string"&&w==="[object Array]")m=m.join(C),m&&(m=this.extendTranslation(m,o,e,i));else{var k=!1,O=!1,P=e.count!==void 0&&typeof e.count!="string",H=n.hasDefaultValue(e),U=P?this.pluralResolver.getSuffix(r,e.count,e):"",K=e["defaultValue".concat(U)]||e.defaultValue;!this.isValidLookup(m)&&H&&(k=!0,m=K),this.isValidLookup(m)||(O=!0,m=f);var j=e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,$=j&&O?void 0:m,D=H&&K!==m&&this.options.updateMissing;if(O||k||D){if(this.logger.log(D?"updateKey":"missingKey",r,p,f,D?K:m),d){var A=this.resolve(f,ce(ce({},e),{},{keySeparator:!1}));A&&A.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var B=[],M=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if(this.options.saveMissingTo==="fallback"&&M&&M[0])for(var W=0;W<M.length;W++)B.push(M[W]);else this.options.saveMissingTo==="all"?B=this.languageUtils.toResolveHierarchy(e.lng||this.language):B.push(e.lng||this.language);var Z=function(Q,re,ee){var Y=H&&ee!==m?ee:$;l.options.missingKeyHandler?l.options.missingKeyHandler(Q,p,re,Y,D,e):l.backendConnector&&l.backendConnector.saveMissing&&l.backendConnector.saveMissing(Q,p,re,Y,D,e),l.emit("missingKey",Q,p,re,m)};this.options.saveMissing&&(this.options.saveMissingPlurals&&P?B.forEach(function(z){l.pluralResolver.getSuffixes(z,e).forEach(function(Q){Z([z],f+Q,e["defaultValue".concat(Q)]||K)})}):Z(B,f,K))}m=this.extendTranslation(m,o,e,h,i),O&&m===f&&this.options.appendNamespaceToMissingKey&&(m="".concat(p,":").concat(f)),(O||k)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?m=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(p,":").concat(f):f,k?m:void 0):m=this.options.parseMissingKeyHandler(m))}return u?(h.res=m,h):m}},{key:"extendTranslation",value:function(o,e,i,l,u){var d=this;if(this.i18nFormat&&this.i18nFormat.parse)o=this.i18nFormat.parse(o,ce(ce({},this.options.interpolation.defaultVariables),i),l.usedLng,l.usedNS,l.usedKey,{resolved:l});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init(ce(ce({},i),{interpolation:ce(ce({},this.options.interpolation),i.interpolation)}));var a=typeof o=="string"&&(i&&i.interpolation&&i.interpolation.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),f;if(a){var v=o.match(this.interpolator.nestingRegexp);f=v&&v.length}var p=i.replace&&typeof i.replace!="string"?i.replace:i;if(this.options.interpolation.defaultVariables&&(p=ce(ce({},this.options.interpolation.defaultVariables),p)),o=this.interpolator.interpolate(o,p,i.lng||this.language,i),a){var r=o.match(this.interpolator.nestingRegexp),_=r&&r.length;f<_&&(i.nest=!1)}i.nest!==!1&&(o=this.interpolator.nest(o,function(){for(var m=arguments.length,y=new Array(m),b=0;b<m;b++)y[b]=arguments[b];return u&&u[0]===y[0]&&!i.context?(d.logger.warn("It seems you are nesting recursively key: ".concat(y[0]," in key: ").concat(e[0])),null):d.translate.apply(d,y.concat([e]))},i)),i.interpolation&&this.interpolator.reset()}var g=i.postProcess||this.options.postProcess,h=typeof g=="string"?[g]:g;return o!=null&&h&&h.length&&i.applyPostProcessor!==!1&&(o=Hn.handle(h,o,e,this.options&&this.options.postProcessPassResolved?ce({i18nResolved:l},i):i,this)),o}},{key:"resolve",value:function(o){var e=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l,u,d,a,f;return typeof o=="string"&&(o=[o]),o.forEach(function(v){if(!e.isValidLookup(l)){var p=e.extractFromKey(v,i),r=p.key;u=r;var _=p.namespaces;e.options.fallbackNS&&(_=_.concat(e.options.fallbackNS));var g=i.count!==void 0&&typeof i.count!="string",h=g&&!i.ordinal&&i.count===0&&e.pluralResolver.shouldUseIntlApi(),m=i.context!==void 0&&(typeof i.context=="string"||typeof i.context=="number")&&i.context!=="",y=i.lngs?i.lngs:e.languageUtils.toResolveHierarchy(i.lng||e.language,i.fallbackLng);_.forEach(function(b){e.isValidLookup(l)||(f=b,!En["".concat(y[0],"-").concat(b)]&&e.utils&&e.utils.hasLoadedNamespace&&!e.utils.hasLoadedNamespace(f)&&(En["".concat(y[0],"-").concat(b)]=!0,e.logger.warn('key "'.concat(u,'" for languages "').concat(y.join(", "),`" won't get resolved as namespace "`).concat(f,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(function(w){if(!e.isValidLookup(l)){a=w;var S=[r];if(e.i18nFormat&&e.i18nFormat.addLookupKeys)e.i18nFormat.addLookupKeys(S,r,w,b,i);else{var C;g&&(C=e.pluralResolver.getSuffix(w,i.count,i));var x="".concat(e.options.pluralSeparator,"zero");if(g&&(S.push(r+C),h&&S.push(r+x)),m){var L="".concat(r).concat(e.options.contextSeparator).concat(i.context);S.push(L),g&&(S.push(L+C),h&&S.push(L+x))}}for(var R;R=S.pop();)e.isValidLookup(l)||(d=R,l=e.getResource(w,b,R,i))}}))})}}),{res:l,usedKey:u,exactUsedKey:d,usedLng:a,usedNS:f}}},{key:"isValidLookup",value:function(o){return o!==void 0&&!(!this.options.returnNull&&o===null)&&!(!this.options.returnEmptyString&&o==="")}},{key:"getResource",value:function(o,e,i){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(o,e,i,l):this.resourceStore.getResource(o,e,i,l)}}],[{key:"hasDefaultValue",value:function(o){var e="defaultValue";for(var i in o)if(Object.prototype.hasOwnProperty.call(o,i)&&e===i.substring(0,e.length)&&o[i]!==void 0)return!0;return!1}}]),n}(Ve);function Ei(t){return t.charAt(0).toUpperCase()+t.slice(1)}var Ln=function(){function t(s){ve(this,t),this.options=s,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Oe.create("languageUtils")}return me(t,[{key:"getScriptPartFromCode",value:function(n){if(!n||n.indexOf("-")<0)return null;var c=n.split("-");return c.length===2||(c.pop(),c[c.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(c.join("-"))}},{key:"getLanguagePartFromCode",value:function(n){if(!n||n.indexOf("-")<0)return n;var c=n.split("-");return this.formatLanguageCode(c[0])}},{key:"formatLanguageCode",value:function(n){if(typeof n=="string"&&n.indexOf("-")>-1){var c=["hans","hant","latn","cyrl","cans","mong","arab"],o=n.split("-");return this.options.lowerCaseLng?o=o.map(function(e){return e.toLowerCase()}):o.length===2?(o[0]=o[0].toLowerCase(),o[1]=o[1].toUpperCase(),c.indexOf(o[1].toLowerCase())>-1&&(o[1]=Ei(o[1].toLowerCase()))):o.length===3&&(o[0]=o[0].toLowerCase(),o[1].length===2&&(o[1]=o[1].toUpperCase()),o[0]!=="sgn"&&o[2].length===2&&(o[2]=o[2].toUpperCase()),c.indexOf(o[1].toLowerCase())>-1&&(o[1]=Ei(o[1].toLowerCase())),c.indexOf(o[2].toLowerCase())>-1&&(o[2]=Ei(o[2].toLowerCase()))),o.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?n.toLowerCase():n}},{key:"isSupportedCode",value:function(n){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(n=this.getLanguagePartFromCode(n)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(n)>-1}},{key:"getBestMatchFromCodes",value:function(n){var c=this;if(!n)return null;var o;return n.forEach(function(e){if(!o){var i=c.formatLanguageCode(e);(!c.options.supportedLngs||c.isSupportedCode(i))&&(o=i)}}),!o&&this.options.supportedLngs&&n.forEach(function(e){if(!o){var i=c.getLanguagePartFromCode(e);if(c.isSupportedCode(i))return o=i;o=c.options.supportedLngs.find(function(l){if(l.indexOf(i)===0)return l})}}),o||(o=this.getFallbackCodes(this.options.fallbackLng)[0]),o}},{key:"getFallbackCodes",value:function(n,c){if(!n)return[];if(typeof n=="function"&&(n=n(c)),typeof n=="string"&&(n=[n]),Object.prototype.toString.apply(n)==="[object Array]")return n;if(!c)return n.default||[];var o=n[c];return o||(o=n[this.getScriptPartFromCode(c)]),o||(o=n[this.formatLanguageCode(c)]),o||(o=n[this.getLanguagePartFromCode(c)]),o||(o=n.default),o||[]}},{key:"toResolveHierarchy",value:function(n,c){var o=this,e=this.getFallbackCodes(c||this.options.fallbackLng||[],n),i=[],l=function(d){d&&(o.isSupportedCode(d)?i.push(d):o.logger.warn("rejecting language code not found in supportedLngs: ".concat(d)))};return typeof n=="string"&&n.indexOf("-")>-1?(this.options.load!=="languageOnly"&&l(this.formatLanguageCode(n)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&l(this.getScriptPartFromCode(n)),this.options.load!=="currentOnly"&&l(this.getLanguagePartFromCode(n))):typeof n=="string"&&l(this.formatLanguageCode(n)),e.forEach(function(u){i.indexOf(u)<0&&l(o.formatLanguageCode(u))}),i}}]),t}(),ml=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Sl={1:function(s){return Number(s>1)},2:function(s){return Number(s!=1)},3:function(s){return 0},4:function(s){return Number(s%10==1&&s%100!=11?0:s%10>=2&&s%10<=4&&(s%100<10||s%100>=20)?1:2)},5:function(s){return Number(s==0?0:s==1?1:s==2?2:s%100>=3&&s%100<=10?3:s%100>=11?4:5)},6:function(s){return Number(s==1?0:s>=2&&s<=4?1:2)},7:function(s){return Number(s==1?0:s%10>=2&&s%10<=4&&(s%100<10||s%100>=20)?1:2)},8:function(s){return Number(s==1?0:s==2?1:s!=8&&s!=11?2:3)},9:function(s){return Number(s>=2)},10:function(s){return Number(s==1?0:s==2?1:s<7?2:s<11?3:4)},11:function(s){return Number(s==1||s==11?0:s==2||s==12?1:s>2&&s<20?2:3)},12:function(s){return Number(s%10!=1||s%100==11)},13:function(s){return Number(s!==0)},14:function(s){return Number(s==1?0:s==2?1:s==3?2:3)},15:function(s){return Number(s%10==1&&s%100!=11?0:s%10>=2&&(s%100<10||s%100>=20)?1:2)},16:function(s){return Number(s%10==1&&s%100!=11?0:s!==0?1:2)},17:function(s){return Number(s==1||s%10==1&&s%100!=11?0:1)},18:function(s){return Number(s==0?0:s==1?1:2)},19:function(s){return Number(s==1?0:s==0||s%100>1&&s%100<11?1:s%100>10&&s%100<20?2:3)},20:function(s){return Number(s==1?0:s==0||s%100>0&&s%100<20?1:2)},21:function(s){return Number(s%100==1?1:s%100==2?2:s%100==3||s%100==4?3:0)},22:function(s){return Number(s==1?0:s==2?1:(s<0||s>10)&&s%10==0?2:3)}},yl=["v1","v2","v3"],kn={zero:0,one:1,two:2,few:3,many:4,other:5};function bl(){var t={};return ml.forEach(function(s){s.lngs.forEach(function(n){t[n]={numbers:s.nr,plurals:Sl[s.fc]}})}),t}var Cl=function(){function t(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ve(this,t),this.languageUtils=s,this.options=n,this.logger=Oe.create("pluralResolver"),(!this.options.compatibilityJSON||this.options.compatibilityJSON==="v4")&&(typeof Intl=="undefined"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=bl()}return me(t,[{key:"addRule",value:function(n,c){this.rules[n]=c}},{key:"getRule",value:function(n){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(n,{type:c.ordinal?"ordinal":"cardinal"})}catch(o){return}return this.rules[n]||this.rules[this.languageUtils.getLanguagePartFromCode(n)]}},{key:"needsPlural",value:function(n){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.getRule(n,c);return this.shouldUseIntlApi()?o&&o.resolvedOptions().pluralCategories.length>1:o&&o.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(n,c){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(n,o).map(function(e){return"".concat(c).concat(e)})}},{key:"getSuffixes",value:function(n){var c=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=this.getRule(n,o);return e?this.shouldUseIntlApi()?e.resolvedOptions().pluralCategories.sort(function(i,l){return kn[i]-kn[l]}).map(function(i){return"".concat(c.options.prepend).concat(i)}):e.numbers.map(function(i){return c.getSuffix(n,i,o)}):[]}},{key:"getSuffix",value:function(n,c){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},e=this.getRule(n,o);return e?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(e.select(c)):this.getSuffixRetroCompatible(e,c):(this.logger.warn("no plural rule found for: ".concat(n)),"")}},{key:"getSuffixRetroCompatible",value:function(n,c){var o=this,e=n.noAbs?n.plurals(c):n.plurals(Math.abs(c)),i=n.numbers[e];this.options.simplifyPluralSuffix&&n.numbers.length===2&&n.numbers[0]===1&&(i===2?i="plural":i===1&&(i=""));var l=function(){return o.options.prepend&&i.toString()?o.options.prepend+i.toString():i.toString()};return this.options.compatibilityJSON==="v1"?i===1?"":typeof i=="number"?"_plural_".concat(i.toString()):l():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&n.numbers.length===2&&n.numbers[0]===1?l():this.options.prepend&&e.toString()?this.options.prepend+e.toString():e.toString()}},{key:"shouldUseIntlApi",value:function(){return!yl.includes(this.options.compatibilityJSON)}}]),t}();function Rn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);s&&(c=c.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,c)}return n}function Ee(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Rn(Object(n),!0).forEach(function(c){Re(t,c,n[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rn(Object(n)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(n,c))})}return t}var wl=function(){function t(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ve(this,t),this.logger=Oe.create("interpolator"),this.options=s,this.format=s.interpolation&&s.interpolation.format||function(n){return n},this.init(s)}return me(t,[{key:"init",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};n.interpolation||(n.interpolation={escapeValue:!0});var c=n.interpolation;this.escape=c.escape!==void 0?c.escape:hl,this.escapeValue=c.escapeValue!==void 0?c.escapeValue:!0,this.useRawValueToEscape=c.useRawValueToEscape!==void 0?c.useRawValueToEscape:!1,this.prefix=c.prefix?vt(c.prefix):c.prefixEscaped||"{{",this.suffix=c.suffix?vt(c.suffix):c.suffixEscaped||"}}",this.formatSeparator=c.formatSeparator?c.formatSeparator:c.formatSeparator||",",this.unescapePrefix=c.unescapeSuffix?"":c.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":c.unescapeSuffix||"",this.nestingPrefix=c.nestingPrefix?vt(c.nestingPrefix):c.nestingPrefixEscaped||vt("$t("),this.nestingSuffix=c.nestingSuffix?vt(c.nestingSuffix):c.nestingSuffixEscaped||vt(")"),this.nestingOptionsSeparator=c.nestingOptionsSeparator?c.nestingOptionsSeparator:c.nestingOptionsSeparator||",",this.maxReplaces=c.maxReplaces?c.maxReplaces:1e3,this.alwaysFormat=c.alwaysFormat!==void 0?c.alwaysFormat:!1,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var n="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(n,"g");var c="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(c,"g");var o="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(o,"g")}},{key:"interpolate",value:function(n,c,o,e){var i=this,l,u,d,a=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function f(g){return g.replace(/\$/g,"$$$$")}var v=function(h){if(h.indexOf(i.formatSeparator)<0){var m=bn(c,a,h);return i.alwaysFormat?i.format(m,void 0,o,Ee(Ee(Ee({},e),c),{},{interpolationkey:h})):m}var y=h.split(i.formatSeparator),b=y.shift().trim(),w=y.join(i.formatSeparator).trim();return i.format(bn(c,a,b),w,o,Ee(Ee(Ee({},e),c),{},{interpolationkey:b}))};this.resetRegExp();var p=e&&e.missingInterpolationHandler||this.options.missingInterpolationHandler,r=e&&e.interpolation&&e.interpolation.skipOnVariables!==void 0?e.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables,_=[{regex:this.regexpUnescape,safeValue:function(h){return f(h)}},{regex:this.regexp,safeValue:function(h){return i.escapeValue?f(i.escape(h)):f(h)}}];return _.forEach(function(g){for(d=0;l=g.regex.exec(n);){var h=l[1].trim();if(u=v(h),u===void 0)if(typeof p=="function"){var m=p(n,l,e);u=typeof m=="string"?m:""}else if(e&&e.hasOwnProperty(h))u="";else if(r){u=l[0];continue}else i.logger.warn("missed to pass in variable ".concat(h," for interpolating ").concat(n)),u="";else typeof u!="string"&&!i.useRawValueToEscape&&(u=Sn(u));var y=g.safeValue(u);if(n=n.replace(l[0],y),r?(g.regex.lastIndex+=u.length,g.regex.lastIndex-=l[0].length):g.regex.lastIndex=0,d++,d>=i.maxReplaces)break}}),n}},{key:"nest",value:function(n,c){var o=this,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,l,u;function d(p,r){var _=this.nestingOptionsSeparator;if(p.indexOf(_)<0)return p;var g=p.split(new RegExp("".concat(_,"[ ]*{"))),h="{".concat(g[1]);p=g[0],h=this.interpolate(h,u);var m=h.match(/'/g),y=h.match(/"/g);(m&&m.length%2===0&&!y||y.length%2!==0)&&(h=h.replace(/'/g,'"'));try{u=JSON.parse(h),r&&(u=Ee(Ee({},r),u))}catch(b){return this.logger.warn("failed parsing options string in nesting for key ".concat(p),b),"".concat(p).concat(_).concat(h)}return delete u.defaultValue,p}for(;i=this.nestingRegexp.exec(n);){var a=[];u=Ee({},e),u.applyPostProcessor=!1,delete u.defaultValue;var f=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){var v=i[1].split(this.formatSeparator).map(function(p){return p.trim()});i[1]=v.shift(),a=v,f=!0}if(l=c(d.call(this,i[1].trim(),u),u),l&&i[0]===n&&typeof l!="string")return l;typeof l!="string"&&(l=Sn(l)),l||(this.logger.warn("missed to resolve ".concat(i[1]," for nesting ").concat(n)),l=""),f&&(l=a.reduce(function(p,r){return o.format(p,r,e.lng,Ee(Ee({},e),{},{interpolationkey:i[1].trim()}))},l.trim())),n=n.replace(i[0],l),this.regexp.lastIndex=0}return n}}]),t}();function Tn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);s&&(c=c.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,c)}return n}function qe(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Tn(Object(n),!0).forEach(function(c){Re(t,c,n[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(n,c))})}return t}function El(t){var s=t.toLowerCase().trim(),n={};if(t.indexOf("(")>-1){var c=t.split("(");s=c[0].toLowerCase().trim();var o=c[1].substring(0,c[1].length-1);if(s==="currency"&&o.indexOf(":")<0)n.currency||(n.currency=o.trim());else if(s==="relativetime"&&o.indexOf(":")<0)n.range||(n.range=o.trim());else{var e=o.split(";");e.forEach(function(i){if(i){var l=i.split(":"),u=wi(l),d=u[0],a=u.slice(1),f=a.join(":").trim().replace(/^'+|'+$/g,"");n[d.trim()]||(n[d.trim()]=f),f==="false"&&(n[d.trim()]=!1),f==="true"&&(n[d.trim()]=!0),isNaN(f)||(n[d.trim()]=parseInt(f,10))}})}}return{formatName:s,formatOptions:n}}function mt(t){var s={};return function(c,o,e){var i=o+JSON.stringify(e),l=s[i];return l||(l=t(o,e),s[i]=l),l(c)}}var xl=function(){function t(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ve(this,t),this.logger=Oe.create("formatter"),this.options=s,this.formats={number:mt(function(n,c){var o=new Intl.NumberFormat(n,c);return function(e){return o.format(e)}}),currency:mt(function(n,c){var o=new Intl.NumberFormat(n,qe(qe({},c),{},{style:"currency"}));return function(e){return o.format(e)}}),datetime:mt(function(n,c){var o=new Intl.DateTimeFormat(n,qe({},c));return function(e){return o.format(e)}}),relativetime:mt(function(n,c){var o=new Intl.RelativeTimeFormat(n,qe({},c));return function(e){return o.format(e,c.range||"day")}}),list:mt(function(n,c){var o=new Intl.ListFormat(n,qe({},c));return function(e){return o.format(e)}})},this.init(s)}return me(t,[{key:"init",value:function(n){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}},o=c.interpolation;this.formatSeparator=o.formatSeparator?o.formatSeparator:o.formatSeparator||","}},{key:"add",value:function(n,c){this.formats[n.toLowerCase().trim()]=c}},{key:"addCached",value:function(n,c){this.formats[n.toLowerCase().trim()]=mt(c)}},{key:"format",value:function(n,c,o,e){var i=this,l=c.split(this.formatSeparator),u=l.reduce(function(d,a){var f=El(a),v=f.formatName,p=f.formatOptions;if(i.formats[v]){var r=d;try{var _=e&&e.formatParams&&e.formatParams[e.interpolationkey]||{},g=_.locale||_.lng||e.locale||e.lng||o;r=i.formats[v](d,g,qe(qe(qe({},p),e),_))}catch(h){i.logger.warn(h)}return r}else i.logger.warn("there was no format function for ".concat(v));return d},n);return u}}]),t}();function On(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);s&&(c=c.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,c)}return n}function An(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?On(Object(n),!0).forEach(function(c){Re(t,c,n[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):On(Object(n)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(n,c))})}return t}function Ll(t){var s=kl();return function(){var c=Se(t),o;if(s){var e=Se(this).constructor;o=Reflect.construct(c,arguments,e)}else o=c.apply(this,arguments);return rt(this,o)}}function kl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Rl(t,s){t.pending[s]!==void 0&&(delete t.pending[s],t.pendingCount--)}var Tl=function(t){gt(n,t);var s=Ll(n);function n(c,o,e){var i,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return ve(this,n),i=s.call(this),gr&&Ve.call(we(i)),i.backend=c,i.store=o,i.services=e,i.languageUtils=e.languageUtils,i.options=l,i.logger=Oe.create("backendConnector"),i.waitingReads=[],i.maxParallelReads=l.maxParallelReads||10,i.readingCalls=0,i.maxRetries=l.maxRetries>=0?l.maxRetries:5,i.retryTimeout=l.retryTimeout>=1?l.retryTimeout:350,i.state={},i.queue=[],i.backend&&i.backend.init&&i.backend.init(e,l.backend,l),i}return me(n,[{key:"queueLoad",value:function(o,e,i,l){var u=this,d={},a={},f={},v={};return o.forEach(function(p){var r=!0;e.forEach(function(_){var g="".concat(p,"|").concat(_);!i.reload&&u.store.hasResourceBundle(p,_)?u.state[g]=2:u.state[g]<0||(u.state[g]===1?a[g]===void 0&&(a[g]=!0):(u.state[g]=1,r=!1,a[g]===void 0&&(a[g]=!0),d[g]===void 0&&(d[g]=!0),v[_]===void 0&&(v[_]=!0)))}),r||(f[p]=!0)}),(Object.keys(d).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:l}),{toLoad:Object.keys(d),pending:Object.keys(a),toLoadLanguages:Object.keys(f),toLoadNamespaces:Object.keys(v)}}},{key:"loaded",value:function(o,e,i){var l=o.split("|"),u=l[0],d=l[1];e&&this.emit("failedLoading",u,d,e),i&&this.store.addResourceBundle(u,d,i),this.state[o]=e?-1:2;var a={};this.queue.forEach(function(f){ll(f.loaded,[u],d),Rl(f,o),e&&f.errors.push(e),f.pendingCount===0&&!f.done&&(Object.keys(f.loaded).forEach(function(v){a[v]||(a[v]={});var p=f.loaded[v];p.length&&p.forEach(function(r){a[v][r]===void 0&&(a[v][r]=!0)})}),f.done=!0,f.errors.length?f.callback(f.errors):f.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(function(f){return!f.done})}},{key:"read",value:function(o,e,i){var l=this,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,a=arguments.length>5?arguments[5]:void 0;if(!o.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:o,ns:e,fcName:i,tried:u,wait:d,callback:a});return}this.readingCalls++;var f=function(_,g){if(l.readingCalls--,l.waitingReads.length>0){var h=l.waitingReads.shift();l.read(h.lng,h.ns,h.fcName,h.tried,h.wait,h.callback)}if(_&&g&&u<l.maxRetries){setTimeout(function(){l.read.call(l,o,e,i,u+1,d*2,a)},d);return}a(_,g)},v=this.backend[i].bind(this.backend);if(v.length===2){try{var p=v(o,e);p&&typeof p.then=="function"?p.then(function(r){return f(null,r)}).catch(f):f(null,p)}catch(r){f(r)}return}return v(o,e,f)}},{key:"prepareLoading",value:function(o,e){var i=this,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),u&&u();typeof o=="string"&&(o=this.languageUtils.toResolveHierarchy(o)),typeof e=="string"&&(e=[e]);var d=this.queueLoad(o,e,l,u);if(!d.toLoad.length)return d.pending.length||u(),null;d.toLoad.forEach(function(a){i.loadOne(a)})}},{key:"load",value:function(o,e,i){this.prepareLoading(o,e,{},i)}},{key:"reload",value:function(o,e,i){this.prepareLoading(o,e,{reload:!0},i)}},{key:"loadOne",value:function(o){var e=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",l=o.split("|"),u=l[0],d=l[1];this.read(u,d,"read",void 0,void 0,function(a,f){a&&e.logger.warn("".concat(i,"loading namespace ").concat(d," for language ").concat(u," failed"),a),!a&&f&&e.logger.log("".concat(i,"loaded namespace ").concat(d," for language ").concat(u),f),e.loaded(o,a,f)})}},{key:"saveMissing",value:function(o,e,i,l,u){var d=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:function(){};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)){this.logger.warn('did not save key "'.concat(i,'" as the namespace "').concat(e,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if(this.backend&&this.backend.create){var f=An(An({},d),{},{isUpdate:u}),v=this.backend.create.bind(this.backend);if(v.length<6)try{var p;v.length===5?p=v(o,e,i,l,f):p=v(o,e,i,l),p&&typeof p.then=="function"?p.then(function(r){return a(null,r)}).catch(a):a(null,p)}catch(r){a(r)}else v(o,e,i,l,a,f)}!o||!o[0]||this.store.addResource(o[0],e,i,l)}}}]),n}(Ve);function Dn(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(s){var n={};if(le(s[1])==="object"&&(n=s[1]),typeof s[1]=="string"&&(n.defaultValue=s[1]),typeof s[2]=="string"&&(n.tDescription=s[2]),le(s[2])==="object"||le(s[3])==="object"){var c=s[3]||s[2];Object.keys(c).forEach(function(o){n[o]=c[o]})}return n},interpolation:{escapeValue:!0,format:function(s,n,c,o){return s},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function Pn(t){return typeof t.ns=="string"&&(t.ns=[t.ns]),typeof t.fallbackLng=="string"&&(t.fallbackLng=[t.fallbackLng]),typeof t.fallbackNS=="string"&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function Bn(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);s&&(c=c.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,c)}return n}function Te(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Bn(Object(n),!0).forEach(function(c){Re(t,c,n[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bn(Object(n)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(n,c))})}return t}function Ol(t){var s=Al();return function(){var c=Se(t),o;if(s){var e=Se(this).constructor;o=Reflect.construct(c,arguments,e)}else o=c.apply(this,arguments);return rt(this,o)}}function Al(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function fr(){}function Dl(t){var s=Object.getOwnPropertyNames(Object.getPrototypeOf(t));s.forEach(function(n){typeof t[n]=="function"&&(t[n]=t[n].bind(t))})}var pr=function(t){gt(n,t);var s=Ol(n);function n(){var c,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;if(ve(this,n),c=s.call(this),gr&&Ve.call(we(c)),c.options=Pn(o),c.services={},c.logger=Oe,c.modules={external:[]},Dl(we(c)),e&&!c.isInitialized&&!o.isClone){if(!c.options.initImmediate)return c.init(o,e),rt(c,we(c));setTimeout(function(){c.init(o,e)},0)}return c}return me(n,[{key:"init",value:function(){var o=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;typeof e=="function"&&(i=e,e={}),!e.defaultNS&&e.defaultNS!==!1&&e.ns&&(typeof e.ns=="string"?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));var l=Dn();this.options=Te(Te(Te({},l),this.options),Pn(e)),this.options.compatibilityAPI!=="v1"&&(this.options.interpolation=Te(Te({},l.interpolation),this.options.interpolation)),e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);function u(h){return h?typeof h=="function"?new h:h:null}if(!this.options.isClone){this.modules.logger?Oe.init(u(this.modules.logger),this.options):Oe.init(null,this.options);var d;this.modules.formatter?d=this.modules.formatter:typeof Intl!="undefined"&&(d=xl);var a=new Ln(this.options);this.store=new pl(this.options.resources,this.options);var f=this.services;f.logger=Oe,f.resourceStore=this.store,f.languageUtils=a,f.pluralResolver=new Cl(a,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),d&&(!this.options.interpolation.format||this.options.interpolation.format===l.interpolation.format)&&(f.formatter=u(d),f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new wl(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new Tl(u(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",function(h){for(var m=arguments.length,y=new Array(m>1?m-1:0),b=1;b<m;b++)y[b-1]=arguments[b];o.emit.apply(o,[h].concat(y))}),this.modules.languageDetector&&(f.languageDetector=u(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=u(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new xn(this.services,this.options),this.translator.on("*",function(h){for(var m=arguments.length,y=new Array(m>1?m-1:0),b=1;b<m;b++)y[b-1]=arguments[b];o.emit.apply(o,[h].concat(y))}),this.modules.external.forEach(function(h){h.init&&h.init(o)})}if(this.format=this.options.interpolation.format,i||(i=fr),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var v=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);v.length>0&&v[0]!=="dev"&&(this.options.lng=v[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined");var p=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];p.forEach(function(h){o[h]=function(){var m;return(m=o.store)[h].apply(m,arguments)}});var r=["addResource","addResources","addResourceBundle","removeResourceBundle"];r.forEach(function(h){o[h]=function(){var m;return(m=o.store)[h].apply(m,arguments),o}});var _=It(),g=function(){var m=function(b,w){o.isInitialized&&!o.initializedStoreOnce&&o.logger.warn("init: i18next is already initialized. You should call init just once!"),o.isInitialized=!0,o.options.isClone||o.logger.log("initialized",o.options),o.emit("initialized",o.options),_.resolve(w),i(b,w)};if(o.languages&&o.options.compatibilityAPI!=="v1"&&!o.isInitialized)return m(null,o.t.bind(o));o.changeLanguage(o.options.lng,m)};return this.options.resources||!this.options.initImmediate?g():setTimeout(g,0),_}},{key:"loadResources",value:function(o){var e=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fr,l=i,u=typeof o=="string"?o:this.language;if(typeof o=="function"&&(l=o),!this.options.resources||this.options.partialBundledLanguages){if(u&&u.toLowerCase()==="cimode")return l();var d=[],a=function(p){if(p){var r=e.services.languageUtils.toResolveHierarchy(p);r.forEach(function(_){d.indexOf(_)<0&&d.push(_)})}};if(u)a(u);else{var f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.forEach(function(v){return a(v)})}this.options.preload&&this.options.preload.forEach(function(v){return a(v)}),this.services.backendConnector.load(d,this.options.ns,function(v){!v&&!e.resolvedLanguage&&e.language&&e.setResolvedLanguage(e.language),l(v)})}else l(null)}},{key:"reloadResources",value:function(o,e,i){var l=It();return o||(o=this.languages),e||(e=this.options.ns),i||(i=fr),this.services.backendConnector.reload(o,e,function(u){l.resolve(),i(u)}),l}},{key:"use",value:function(o){if(!o)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!o.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return o.type==="backend"&&(this.modules.backend=o),(o.type==="logger"||o.log&&o.warn&&o.error)&&(this.modules.logger=o),o.type==="languageDetector"&&(this.modules.languageDetector=o),o.type==="i18nFormat"&&(this.modules.i18nFormat=o),o.type==="postProcessor"&&Hn.addPostProcessor(o),o.type==="formatter"&&(this.modules.formatter=o),o.type==="3rdParty"&&this.modules.external.push(o),this}},{key:"setResolvedLanguage",value:function(o){if(!(!o||!this.languages)&&!(["cimode","dev"].indexOf(o)>-1))for(var e=0;e<this.languages.length;e++){var i=this.languages[e];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}}},{key:"changeLanguage",value:function(o,e){var i=this;this.isLanguageChangingTo=o;var l=It();this.emit("languageChanging",o);var u=function(v){i.language=v,i.languages=i.services.languageUtils.toResolveHierarchy(v),i.resolvedLanguage=void 0,i.setResolvedLanguage(v)},d=function(v,p){p?(u(p),i.translator.changeLanguage(p),i.isLanguageChangingTo=void 0,i.emit("languageChanged",p),i.logger.log("languageChanged",p)):i.isLanguageChangingTo=void 0,l.resolve(function(){return i.t.apply(i,arguments)}),e&&e(v,function(){return i.t.apply(i,arguments)})},a=function(v){!o&&!v&&i.services.languageDetector&&(v=[]);var p=typeof v=="string"?v:i.services.languageUtils.getBestMatchFromCodes(v);p&&(i.language||u(p),i.translator.language||i.translator.changeLanguage(p),i.services.languageDetector&&i.services.languageDetector.cacheUserLanguage&&i.services.languageDetector.cacheUserLanguage(p)),i.loadResources(p,function(r){d(r,p)})};return!o&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!o&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(o),l}},{key:"getFixedT",value:function(o,e,i){var l=this,u=function d(a,f){var v;if(le(f)!=="object"){for(var p=arguments.length,r=new Array(p>2?p-2:0),_=2;_<p;_++)r[_-2]=arguments[_];v=l.options.overloadTranslationOptionHandler([a,f].concat(r))}else v=Te({},f);v.lng=v.lng||d.lng,v.lngs=v.lngs||d.lngs,v.ns=v.ns||d.ns,v.keyPrefix=v.keyPrefix||i||d.keyPrefix;var g=l.options.keySeparator||".",h=v.keyPrefix?"".concat(v.keyPrefix).concat(g).concat(a):a;return l.t(h,v)};return typeof o=="string"?u.lng=o:u.lngs=o,u.ns=e,u.keyPrefix=i,u}},{key:"t",value:function(){var o;return this.translator&&(o=this.translator).translate.apply(o,arguments)}},{key:"exists",value:function(){var o;return this.translator&&(o=this.translator).exists.apply(o,arguments)}},{key:"setDefaultNamespace",value:function(o){this.options.defaultNS=o}},{key:"hasLoadedNamespace",value:function(o){var e=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var l=this.resolvedLanguage||this.languages[0],u=this.options?this.options.fallbackLng:!1,d=this.languages[this.languages.length-1];if(l.toLowerCase()==="cimode")return!0;var a=function(p,r){var _=e.services.backendConnector.state["".concat(p,"|").concat(r)];return _===-1||_===2};if(i.precheck){var f=i.precheck(this,a);if(f!==void 0)return f}return!!(this.hasResourceBundle(l,o)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(l,o)&&(!u||a(d,o)))}},{key:"loadNamespaces",value:function(o,e){var i=this,l=It();return this.options.ns?(typeof o=="string"&&(o=[o]),o.forEach(function(u){i.options.ns.indexOf(u)<0&&i.options.ns.push(u)}),this.loadResources(function(u){l.resolve(),e&&e(u)}),l):(e&&e(),Promise.resolve())}},{key:"loadLanguages",value:function(o,e){var i=It();typeof o=="string"&&(o=[o]);var l=this.options.preload||[],u=o.filter(function(d){return l.indexOf(d)<0});return u.length?(this.options.preload=l.concat(u),this.loadResources(function(d){i.resolve(),e&&e(d)}),i):(e&&e(),Promise.resolve())}},{key:"dir",value:function(o){if(o||(o=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!o)return"rtl";var e=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=this.services&&this.services.languageUtils||new Ln(Dn());return e.indexOf(i.getLanguagePartFromCode(o))>-1||o.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}},{key:"cloneInstance",value:function(){var o=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fr,l=Te(Te(Te({},this.options),e),{isClone:!0}),u=new n(l);(e.debug!==void 0||e.prefix!==void 0)&&(u.logger=u.logger.clone(e));var d=["store","services","language"];return d.forEach(function(a){u[a]=o[a]}),u.services=Te({},this.services),u.services.utils={hasLoadedNamespace:u.hasLoadedNamespace.bind(u)},u.translator=new xn(u.services,u.options),u.translator.on("*",function(a){for(var f=arguments.length,v=new Array(f>1?f-1:0),p=1;p<f;p++)v[p-1]=arguments[p];u.emit.apply(u,[a].concat(v))}),u.init(l,i),u.translator.options=u.options,u.translator.backendConnector.services.utils={hasLoadedNamespace:u.hasLoadedNamespace.bind(u)},u}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),n}(Ve);Re(pr,"createInstance",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;return new pr(t,s)});var ne=pr.createInstance();ne.createInstance=pr.createInstance;var nh=ne.createInstance,oh=ne.dir,ah=ne.init,lh=ne.loadResources,ch=ne.reloadResources,hh=ne.use,uh=ne.changeLanguage,dh=ne.getFixedT,fh=ne.t,_h=ne.exists,ph=ne.setDefaultNamespace,gh=ne.hasLoadedNamespace,vh=ne.loadNamespaces,mh=ne.loadLanguages;var Nn=require("obsidian");var Pl=Promise.resolve(ne.createInstance({cleanCode:!0,defaultNS:xt,fallbackLng:qi,initImmediate:!0,nonExplicitSupportedLngs:!0,resources:Vt,returnNull:Ki})).then(async t=>(await t.init(),t)).catch(t=>{throw De(t,()=>"i18n error"),t}),Mt,St,vr=class{constructor(s){this.plugin=s;X(this,Mt,ne);X(this,St,[])}get i18n(){return q(this,Mt)}async load(){xe(this,Mt,await Pl),await this.changeLanguage(this.plugin.state.settings.language)}async changeLanguage(s){await this.i18n.changeLanguage(s===""?Nn.moment.locale():s),await Promise.all(q(this,St).map(n=>n()))}registerUse(s){return q(this,St).push(s),()=>{q(this,St).remove(s)}}};Mt=new WeakMap,St=new WeakMap;function Fn(t){let s=document.querySelector("div.status-bar");return s!==null&&(t!=null?t:()=>{})(s),s}var yt,Ht,Li,Nt,ki,mr=class{constructor(s){this.plugin=s;X(this,Ht);X(this,Nt);X(this,yt,[])}load(){let{plugin:s}=this;s.app.workspace.onLayoutReady(()=>{Fn(n=>{let c=new MutationObserver(V(this,Ht,Li).bind(this,n));s.register(()=>{try{c.disconnect()}finally{V(this,Nt,ki).call(this,n)}}),this.update(),c.observe(n,{attributeFilter:["style"]})})===null&&Ae(()=>s.state.language.i18n.t("errors.cannot-find-status-bar"),0,s)})}hide(s){return q(this,yt).push(s),this.update(),()=>{q(this,yt).remove(s),this.update()}}update(){Fn(s=>{V(this,Nt,ki).call(this,s),V(this,Ht,Li).call(this,s)})}};yt=new WeakMap,Ht=new WeakSet,Li=function(s){(this.plugin.state.settings.hideStatusBar==="always"||q(this,yt).some(n=>n()))&&(s.style.visibility="hidden")},Nt=new WeakSet,ki=function(s){s.style.visibility=""};var kr=require("obsidian");var Wn=nt(jn());var Sr=class{constructor(s){this.terminal=s;ye(this,"serializer",new Wn.SerializeAddon);this.terminal.loadAddon(this.serializer)}unserialize(s){this.terminal.resize(s.columns,s.rows),this.terminal.write(s.data)}serialize(){return{columns:this.terminal.cols,data:this.serializer.serialize({excludeAltBuffer:!0,excludeModes:!0}),rows:this.terminal.rows}}};var Rr=require("path"),Vn=nt(Un()),Gn=nt(zn()),Yn=nt(Kn()),Xn=nt(qn());var it,ae,jt,bt,Ct,xr,Wt,Pi,wt,Er,Lr,Jn,Ge=class extends kr.ItemView{constructor(n,c){super(c);this.plugin=n;X(this,Wt);X(this,wt);X(this,Lr);X(this,it,{__type:Ge.State.TYPE,args:[],cwd:"",executable:""});X(this,ae,new Yn.Terminal({allowProposedApi:!0}));X(this,jt,{fit:new Vn.FitAddon,search:new Gn.SearchAddon,webLinks:new Xn.WebLinksAddon((n,c)=>zi(c))});X(this,bt,void 0);X(this,Ct,new Sr(q(this,ae)));X(this,xr,(0,kr.debounce)(async(n,c)=>{var o;try{await((o=q(this,bt))==null?void 0:o.resize(n,c)),q(this,ae).resize(n,c),this.plugin.app.workspace.requestSaveLayout()}catch(e){}},Mi,!1));for(let o of Object.values(q(this,jt)))q(this,ae).loadAddon(o)}async setState(n,c){if(await super.setState(n,c),!Wi(Ge.State.TYPE,n)||typeof q(this,bt)!="undefined")return;xe(this,it,n);let{plugin:o}=this,{i18n:e}=o.state.language,i=new o.platform.terminalPty(o,n.executable,n.cwd,n.args);this.register(async()=>(await i.shell).kill()),xe(this,bt,i);let l=await(await i.once("exit",f=>{this.leaf.detach(),Ae(()=>e.t("notices.terminal-exited",{code:f}),ot(Ii,f)?o.state.settings.noticeTimeout:0,o)})).shell;l.once("error",f=>{this.leaf.detach(),De(f,()=>e.t("errors.error-spawning-terminal"),o)});let{serial:u}=n,d;(p=>(p[p.conhost=1]="conhost",p[p.clear=2]="clear"))(d||(d={}));let a=(i instanceof tt&&i.conhost?0:1)|2;typeof u!="undefined"&&(a&=-3,q(this,Ct).unserialize(u),q(this,ae).resize(u.columns,u.rows),q(this,ae).write(u.data)),l.stdout.on("data",f=>{if(!(a&1)){a|=1;return}a&2||(a|=2,V(this,wt,Er).call(this,`
\x1B[K`.repeat(q(this,ae).rows)),V(this,wt,Er).call(this,"\x1B[H")),V(this,wt,Er).call(this,f)}),l.stderr.on("data",f=>{q(this,ae).write(f)}),q(this,ae).onData(f=>l.stdin.write(f))}getState(){return q(this,it).serial=q(this,Ct).serialize(),Object.assign(super.getState(),q(this,it))}onResize(){super.onResize();let{containerEl:n}=this;if(n.offsetWidth<=0||n.offsetHeight<=0)return;let{fit:c}=q(this,jt),o=c.proposeDimensions();typeof o!="undefined"&&(c.fit(),q(this,xr).call(this,o.cols,o.rows))}getDisplayText(){return this.plugin.state.language.i18n.t(`views.${Ge.type.id}.display-name`,{executable:V(this,Wt,Pi).call(this)})}getIcon(){return this.plugin.state.language.i18n.t(`asset:views.${Ge.type.id}-icon`)}getViewType(){return Ge.namespacedViewType}onPaneMenu(n,c){super.onPaneMenu(n,c);let{leaf:o,plugin:e}=this,{i18n:i}=e.state.language;n.addSeparator().addItem(l=>l.setTitle(i.t("menus.save-as-HTML")).setIcon(i.t("asset:menus.save-as-HTML-icon")).onClick(()=>{let u=q(this,ae),d=()=>{ji(q(this,Ct).serializer.serializeAsHTML({includeGlobalBackground:!1,onlySelection:!1}),"text/html; charset=UTF-8;",`${V(this,Wt,Pi).call(this)}.html`)};if(typeof u.element=="undefined"){let{workspace:a}=e.app,f=a.getMostRecentLeaf(),v=u.onRender(()=>{try{d()}finally{try{f!==null&&a.setActiveLeaf(f)}finally{v.dispose()}}});try{a.setActiveLeaf(o)}catch(p){v.dispose()}return}d()}))}async onOpen(){await super.onOpen();let{containerEl:n,plugin:c}=this,{app:o,state:e}=c,{language:i,statusBarHider:l}=e;n.empty(),n.createDiv({},u=>{let d=Ui(u,a=>{try{this.register(()=>{q(this,ae).dispose()}),q(this,ae).open(u)}finally{a.disconnect()}});this.register(()=>{d.disconnect()})}),this.registerEvent(o.workspace.on("active-leaf-change",u=>{if(u===this.leaf){q(this,ae).focus();return}q(this,ae).blur()})),this.register(i.registerUse(()=>$i(this))),this.register(l.hide(V(this,Lr,Jn).bind(this))),this.registerEvent(o.workspace.on("active-leaf-change",l.update.bind(l)))}},he=Ge;it=new WeakMap,ae=new WeakMap,jt=new WeakMap,bt=new WeakMap,Ct=new WeakMap,xr=new WeakMap,Wt=new WeakSet,Pi=function(){let{executable:n}=q(this,it);return(0,Rr.basename)(n,(0,Rr.extname)(n))},wt=new WeakSet,Er=function(n){q(this,ae).write(n),this.plugin.app.workspace.requestSaveLayout()},Lr=new WeakSet,Jn=function(){let{plugin:n}=this;switch(n.state.settings.hideStatusBar){case"focused":return n.app.workspace.getActiveViewOfType(Ge)===this;case"running":return!0;default:return!1}},ye(he,"type",new Ut("terminal")),ye(he,"namespacedViewType");(s=>{let t;(c=>c.TYPE="8d54e44a-32e7-4297-8ae2-cff88e92ce28")(t=s.State||(s.State={}))})(he||(he={}));var Zn=require("child_process");var ge=class extends Ye.Plugin{constructor(n,c){he.namespacedViewType=he.type.namespaced(c);super(n,c);ye(this,"state",{language:new vr(this),settings:Fi(be),statusBarHider:new mr(this)});ye(this,"platform",(()=>{let n=ot(ge.PLATFORMS,process.platform)?process.platform:null;return{spawnTerminal:(()=>n===null?c=>{throw new Error(c.state.language.i18n.t("errors.unsupported-platform"))}:async(c,o,e)=>{let{settings:i,language:l}=c.state,{i18n:u}=l,d=i.executables[n];switch(Ae(()=>u.t("notices.spawning-terminal",{executable:d.name}),i.noticeTimeout,c),e){case"external":{let a=(0,Zn.spawn)(d.name,d.args,{cwd:o,detached:!0,shell:!0,stdio:"ignore"}).once("error",f=>{De(f,()=>u.t("errors.error-spawning-terminal"),c)});return a.unref(),new Promise((f,v)=>{a.once("spawn",f).once("error",v)})}case"integrated":{let{workspace:a}=c.app,f=a.getLeavesOfType(he.type.namespaced(c)),v={__type:he.State.TYPE,args:d.args,cwd:o,executable:d.name};return(()=>{let p=f.last();return typeof p=="undefined"?a.getLeaf("split","horizontal"):(a.setActiveLeaf(p,{focus:!1}),a.getLeaf("tab"))})().setViewState({active:!0,state:v,type:he.type.namespaced(c)})}default:throw new TypeError(e)}})(),terminalPty:n==="win32"?tt:ar}})())}async onload(){if(super.onload(),!Ye.Platform.isDesktopApp)return;let{state:n}=this,{settings:c,language:o,statusBarHider:e}=n;await je.load(c,this),await o.load(),e.load();let{i18n:i}=o;this.addSettingTab(new Gt(this)),this.registerView(he.type.namespaced(this),f=>new he(this,f));let l=this.app.vault.adapter,u=["root","current"],d=(f,v)=>p=>{if(!c.command)return!1;switch(v){case"root":return p||this.platform.spawnTerminal(this,l.getBasePath(),f),!0;case"current":{let r=this.app.workspace.getActiveFile();return r===null?!1:(p||this.platform.spawnTerminal(this,l.getFullPath(r.parent.path),f),!0)}default:throw new TypeError(v)}};for(let f of ge.TERMINAL_TYPES)for(let v of u){let p=`open-terminal-${f}-${v}`,r=()=>i.t(`commands.${p}`);this.addCommand({checkCallback:d(f,v),id:p,get name(){return r()},set name(_){r=Ni(()=>i.t(`commands.${p}`),()=>i.t("name"),i.t("name",{lng:at}),_)}})}let a=(f,v)=>{f.addSeparator().addItem(p=>p.setTitle(i.t("menus.open-terminal-external")).setIcon(i.t("asset:menus.open-terminal-external-icon")).onClick(async()=>this.platform.spawnTerminal(this,l.getFullPath(v.path),"external"))).addItem(p=>p.setTitle(i.t("menus.open-terminal-integrated")).setIcon(i.t("asset:menus.open-terminal-integrated-icon")).onClick(async()=>this.platform.spawnTerminal(this,l.getFullPath(v.path),"integrated")))};this.registerEvent(this.app.workspace.on("file-menu",(f,v)=>{c.contextMenu&&a(f,v instanceof Ye.TFolder?v:v.parent)})),this.registerEvent(this.app.workspace.on("editor-menu",(f,v,p)=>{!c.contextMenu||p instanceof Ye.MarkdownView||p.file===null||a(f,p.file.parent)}))}};(n=>(n.PLATFORMS=["darwin","linux","win32"],n.TERMINAL_TYPES=["external","integrated"]))(ge||(ge={}));var Bl=ge;
/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD.
If you want to view the source, please visit the repository of this plugin.
*/
